<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html xmlns:erl="http://erlang.org" xmlns:fn="http://www.w3.org/2005/02/xpath-functions">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta charset="utf-8">
<link rel="stylesheet" href="../../otp_doc.css" type="text/css">
<title>Erlang -- DTrace and Erlang/OTP</title>
</head>
<body>
<div id="container">
<script id="js" type="text/javascript" language="JavaScript" src="../../js/flipmenu/flipmenu.js"></script><script id="js2" type="text/javascript" src="../../js/erlresolvelinks.js"></script><script id="js3" type="text/javascript" src="../../../../doc/js/topbar.js"></script><script language="JavaScript" type="text/javascript">
            <!--
              function setscrollpos() {
                var objf = document.getElementById('loadscrollpos');
                if (objf) {
                  document.getElementById("leftnav").firstChild.scrollTop = objf.offsetTop - 10;
                }
              }

              function addEvent(obj, evType, fn){
                if (obj.addEventListener){
                obj.addEventListener(evType, fn, true);
                return true;
              } else if (obj.attachEvent){
                var r = obj.attachEvent("on"+evType, fn);
                return r;
              } else {
                return false;
              }
             }

             addEvent(window, 'load', setscrollpos);

             //-->
</script><div class="topbar">
<div class="topbar-expand "><button onclick="toggleDisplay();"><svg xmlns="http://www.w3.org/2000/svg" version="1.1" id="Capa_1" viewBox="0 0 54 54" width="24" height="24"><g><path style="fill:#000000;" d="M27,54c-0.552,0-1-0.448-1-1V8c0-0.552,0.448-1,1-1s1,0.448,1,1v45C28,53.552,27.552,54,27,54z"></path><path style="fill:#000000;" d="M11,25c-0.256,0-0.512-0.098-0.707-0.293c-0.391-0.391-0.391-1.023,0-1.414l16-16                                      c0.391-0.391,1.023-0.391,1.414,0s0.391,1.023,0,1.414l-16,16C11.512,24.902,11.256,25,11,25z"></path><path style="fill:#000000;" d="M43,25c-0.256,0-0.512-0.098-0.707-0.293l-16-16c-0.391-0.391-0.391-1.023,0-1.414                                      s1.023-0.391,1.414,0l16,16c0.391,0.391,0.391,1.023,0,1.414C43.512,24.902,43.256,25,43,25z"></path><path style="fill:#000000;" d="M43,2H11c-0.552,0-1-0.448-1-1s0.448-1,1-1h32c0.552,0,1,0.448,1,1S43.552,2,43,2z"></path></g></svg></button></div>
<div class="topbar-title"><h1 id="DTrace and Erlang/OTP">2 
                DTrace and Erlang/OTP</h1></div>
<div class="search-expand ">        <button id="docsearch-mobile">
            <svg fill="#000000" xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 50 50" width="24" height="24"><path d="M 21 3 C 11.621094 3 4 10.621094 4 20 C 4 29.378906 11.621094 37 21 37 C 24.710938 37 28.140625 35.804688 30.9375 33.78125 L 44.09375 46.90625 L 46.90625 44.09375 L 33.90625 31.0625 C 36.460938 28.085938 38 24.222656 38 20 C 38 10.621094 30.378906 3 21 3 Z M 21 5 C 29.296875 5 36 11.703125 36 20 C 36 28.296875 29.296875 35 21 35 C 12.703125 35 6 28.296875 6 20 C 6 11.703125 12.703125 5 21 5 Z"/></svg>
        </button>
</div>
</div>
<aside class="hide-mobile" id="leftnav"><nav class="leftnav-tube"><div class="erlang-logo-wrapper"><a href="../../index.html"><img alt="Erlang Logo" src="../../erlang-logo.png" class="erlang-logo"></a></div>
<p class="section-title">Runtime_Tools</p>
<p class="section-subtitle">User's Guide</p>
<p class="section-version">Version 1.17</p>
<ul class="panel-sections">
<li><a href="users_guide.html">User's Guide</a></li>
<li><a href="index.html">Reference Manual</a></li>
<li><a href="notes.html">Release Notes</a></li>
<li><a href="runtime_tools.pdf">PDF</a></li>
<li><a href="../../index.html">Top</a></li>
</ul>
<div id="docsearch"></div>
<ul class="expand-collapse-items">
<li><a href="javascript:openAllFlips()">Expand All</a></li>
<li><a href="javascript:closeAllFlips()">Contract All</a></li>
</ul>
<h3 id="chapters">Chapters</h3>
<ul class="flipMenu" imagePath="../../js/flipmenu">
<li id="no" title="LTTng and Erlang/OTP" expanded="false">LTTng and Erlang/OTP<ul>
<li><a href="LTTng.html">
              Top of chapter
            </a></li>
<li title="Introduction"><a href="LTTng.html#introduction">Introduction</a></li>
<li title="Building Erlang/OTP with LTTng support"><a href="LTTng.html#building-erlang-otp-with-lttng-support">Building Erlang/OTP with LTTng support</a></li>
<li title="Dyntrace Tracepoints"><a href="LTTng.html#dyntrace-tracepoints">Dyntrace Tracepoints</a></li>
<li title="BEAM Tracepoints"><a href="LTTng.html#beam-tracepoints">BEAM Tracepoints</a></li>
<li title="Example of process tracing"><a href="LTTng.html#example-of-process-tracing">Example of process tracing</a></li>
</ul>
</li>
<li id="loadscrollpos" title="DTrace and Erlang/OTP" expanded="true">DTrace and Erlang/OTP<ul>
<li><a href="DTRACE.html">
              Top of chapter
            </a></li>
<li title="History"><a href="DTRACE.html#history">History</a></li>
<li title="Goals"><a href="DTRACE.html#goals">Goals</a></li>
<li title="Supported platforms"><a href="DTRACE.html#supported-platforms">Supported platforms</a></li>
<li title="Status"><a href="DTRACE.html#status">Status</a></li>
<li title="DTrace probe specifications"><a href="DTRACE.html#dtrace-probe-specifications">DTrace probe specifications</a></li>
</ul>
</li>
<li id="no" title="SystemTap and Erlang/OTP" expanded="false">SystemTap and Erlang/OTP<ul>
<li><a href="SYSTEMTAP.html">
              Top of chapter
            </a></li>
<li title="Introduction"><a href="SYSTEMTAP.html#introduction">Introduction</a></li>
<li title="Requisites"><a href="SYSTEMTAP.html#requisites">Requisites</a></li>
<li title="Building Erlang"><a href="SYSTEMTAP.html#building-erlang">Building Erlang</a></li>
<li title="Testing"><a href="SYSTEMTAP.html#testing">Testing</a></li>
<li title="Running SystemTap scripts"><a href="SYSTEMTAP.html#running-systemtap-scripts">Running SystemTap scripts</a></li>
</ul>
</li>
</ul></nav></aside><div id="content">
<div class="innertube">
<h1 id="DTrace and Erlang/OTP">2 DTrace and Erlang/OTP</h1>


<a name="History"></a><h3 id="history" class="title-link" onMouseOver="document.getElementById('ghlink-history-idm785').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-history-idm785').style.visibility = 'hidden';">
<div class="title-name">2.1 
        History</div>
<div class="title-anchors"><span id="ghlink-history-idm785" class="ghlink-after"><a href="#history" title="Link to this place!"><span class="paperclip-after"></span></a></span></div>
</h3>



<p>
The first implementation of DTrace probes for the Erlang virtual
machine was presented at the <span class="bold_code bc-20"><a href="http://www.erlang.org/euc/08/">2008 Erlang User Conference</a></span>.  That
work, based on the Erlang/OTP R12 release, was discontinued due to
what appears to be miscommunication with the original developers.
</p>

<p>
Several users have created Erlang port drivers, linked-in drivers, or
NIFs that allow Erlang code to try to activate a probe,
e.g. <span class="code">foo_module:dtrace_probe("message goes here!")</span>.
</p>



<a name="Goals"></a><h3 id="goals" class="title-link" onMouseOver="document.getElementById('ghlink-goals-idm792').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-goals-idm792').style.visibility = 'hidden';">
<div class="title-name">2.2 
        Goals</div>
<div class="title-anchors"><span id="ghlink-goals-idm792" class="ghlink-after"><a href="#goals" title="Link to this place!"><span class="paperclip-after"></span></a></span></div>
</h3>



<ul>
<li>
Annotate as much of the Erlang VM as is practical.

</li>
<li>
The initial goal is to trace file I/O operations.

</li>
<li>
Support all platforms that implement DTrace: OS X, Solaris,
and (I hope) FreeBSD and NetBSD.

</li>
<li>
To the extent that it's practical, support SystemTap on Linux
via DTrace provider compatibility.

</li>
<li>
Allow Erlang code to supply annotations.

</li>
</ul>


<a name="Supported-platforms"></a><h3 id="supported-platforms" class="title-link" onMouseOver="document.getElementById('ghlink-supported-platforms-idm801').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-supported-platforms-idm801').style.visibility = 'hidden';">
<div class="title-name">2.3 
        Supported platforms</div>
<div class="title-anchors"><span id="ghlink-supported-platforms-idm801" class="ghlink-after"><a href="#supported-platforms" title="Link to this place!"><span class="paperclip-after"></span></a></span></div>
</h3>



<ul>
<li>
OS X 10.6.x / Snow Leopard, OS X 10.7.x / Lion and probably newer versions.

</li>
<li>
Solaris 10.  I have done limited testing on Solaris 11 and
OpenIndiana release 151a, and both appear to work.

</li>
<li>
FreeBSD 9.0 and 10.0.

</li>
<li>
Linux via SystemTap compatibility.  Please see
<span class="bold_code bc-19"><a href="SYSTEMTAP.html">$ERL_TOP/HOWTO/SYSTEMTAP.md</a></span> for more details.

</li>
</ul>
<p>
Just add the <span class="code">--with-dynamic-trace=dtrace</span> option to your command when you 
run the <span class="code">configure</span> script. If you are using systemtap, the configure option 
is <span class="code">--with-dynamic-trace=systemtap</span>
</p>



<a name="Status"></a><h3 id="status" class="title-link" onMouseOver="document.getElementById('ghlink-status-idm814').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-status-idm814').style.visibility = 'hidden';">
<div class="title-name">2.4 
        Status</div>
<div class="title-anchors"><span id="ghlink-status-idm814" class="ghlink-after"><a href="#status" title="Link to this place!"><span class="paperclip-after"></span></a></span></div>
</h3>



<p>
As of R15B01, the dynamic trace code is included in the OTP source distribution,
although it's considered experimental. The main development of the dtrace code 
still happens outside of Ericsson, but there is no need to fetch a patched 
version of the OTP source to get the basic functionality.
</p>



<a name="DTrace-probe-specifications"></a><h3 id="dtrace-probe-specifications" class="title-link" onMouseOver="document.getElementById('ghlink-dtrace-probe-specifications-idm818').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-dtrace-probe-specifications-idm818').style.visibility = 'hidden';">
<div class="title-name">2.5 
        DTrace probe specifications</div>
<div class="title-anchors"><span id="ghlink-dtrace-probe-specifications-idm818" class="ghlink-after"><a href="#dtrace-probe-specifications" title="Link to this place!"><span class="paperclip-after"></span></a></span></div>
</h3>



<p>
Probe specifications can be found in <span class="code">erts/emulator/beam/erlang_dtrace.d</span>, and
a few example scripts can be found under <span class="code">lib/runtime_tools/examples/</span>.
</p>



</div>
<div class="footer">
<hr>
<p>Copyright © 1999-2021 Ericsson AB. All Rights Reserved.</p>
</div>
</div>
</div>
<script type="text/javascript">window.__otpTopDocDir = '../../js/';</script><script type="text/javascript" src="../../js/highlight.js"></script>
<script src="/assets/js/doc-search.bundle.js"></script>
</body>
</html>
