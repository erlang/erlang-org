<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html xmlns:erl="http://erlang.org" xmlns:fn="http://www.w3.org/2005/02/xpath-functions">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta charset="utf-8">
<link rel="stylesheet" href="../../otp_doc.css" type="text/css">
<title>Erlang -- Engine Load</title>
</head>
<body>
<div id="container">
<script id="js" type="text/javascript" language="JavaScript" src="../../js/flipmenu/flipmenu.js"></script><script id="js2" type="text/javascript" src="../../js/erlresolvelinks.js"></script><script id="js3" type="text/javascript" src="../../../../doc/js/topbar.js"></script><script language="JavaScript" type="text/javascript">
            <!--
              function setscrollpos() {
                var objf = document.getElementById('loadscrollpos');
                if (objf) {
                  document.getElementById("leftnav").firstChild.scrollTop = objf.offsetTop - 10;
                }
              }

              function addEvent(obj, evType, fn){
                if (obj.addEventListener){
                obj.addEventListener(evType, fn, true);
                return true;
              } else if (obj.attachEvent){
                var r = obj.attachEvent("on"+evType, fn);
                return r;
              } else {
                return false;
              }
             }

             addEvent(window, 'load', setscrollpos);

             //-->
</script><div class="topbar">
<div class="topbar-expand "><button onclick="toggleDisplay();"><svg xmlns="http://www.w3.org/2000/svg" version="1.1" id="Capa_1" viewBox="0 0 54 54" width="24" height="24"><g><path style="fill:#000000;" d="M27,54c-0.552,0-1-0.448-1-1V8c0-0.552,0.448-1,1-1s1,0.448,1,1v45C28,53.552,27.552,54,27,54z"></path><path style="fill:#000000;" d="M11,25c-0.256,0-0.512-0.098-0.707-0.293c-0.391-0.391-0.391-1.023,0-1.414l16-16                                      c0.391-0.391,1.023-0.391,1.414,0s0.391,1.023,0,1.414l-16,16C11.512,24.902,11.256,25,11,25z"></path><path style="fill:#000000;" d="M43,25c-0.256,0-0.512-0.098-0.707-0.293l-16-16c-0.391-0.391-0.391-1.023,0-1.414                                      s1.023-0.391,1.414,0l16,16c0.391,0.391,0.391,1.023,0,1.414C43.512,24.902,43.256,25,43,25z"></path><path style="fill:#000000;" d="M43,2H11c-0.552,0-1-0.448-1-1s0.448-1,1-1h32c0.552,0,1,0.448,1,1S43.552,2,43,2z"></path></g></svg></button></div>
<div class="topbar-title"><h1 id="Engine Load">3 
                Engine Load</h1></div>
<div class="search-expand ">        <button id="docsearch-mobile">
            <svg fill="#000000" xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 50 50" width="24" height="24"><path d="M 21 3 C 11.621094 3 4 10.621094 4 20 C 4 29.378906 11.621094 37 21 37 C 24.710938 37 28.140625 35.804688 30.9375 33.78125 L 44.09375 46.90625 L 46.90625 44.09375 L 33.90625 31.0625 C 36.460938 28.085938 38 24.222656 38 20 C 38 10.621094 30.378906 3 21 3 Z M 21 5 C 29.296875 5 36 11.703125 36 20 C 36 28.296875 29.296875 35 21 35 C 12.703125 35 6 28.296875 6 20 C 6 11.703125 12.703125 5 21 5 Z"/></svg>
        </button>
</div>
</div>
<aside class="hide-mobile" id="leftnav"><nav class="leftnav-tube"><div class="erlang-logo-wrapper"><a href="../../index.html"><img alt="Erlang Logo" src="../../erlang-logo.png" class="erlang-logo"></a></div>
<p class="section-title">crypto</p>
<p class="section-subtitle">User's Guide</p>
<p class="section-version">Version 5.0.4</p>
<ul class="panel-sections">
<li><a href="users_guide.html">User's Guide</a></li>
<li><a href="index.html">Reference Manual</a></li>
<li><a href="notes.html">Release Notes</a></li>
<li><a href="crypto.pdf">PDF</a></li>
<li><a href="../../index.html">Top</a></li>
</ul>
<div id="docsearch"></div>
<ul class="expand-collapse-items">
<li><a href="javascript:openAllFlips()">Expand All</a></li>
<li><a href="javascript:closeAllFlips()">Contract All</a></li>
</ul>
<h3 id="chapters">Chapters</h3>
<ul class="flipMenu" imagePath="../../js/flipmenu">
<li id="no" title="Licenses" expanded="false">Licenses<ul>
<li><a href="licenses.html">
              Top of chapter
            </a></li>
<li title="OpenSSL License"><a href="licenses.html#openssl-license">OpenSSL License</a></li>
<li title="SSLeay License"><a href="licenses.html#ssleay-license">SSLeay License</a></li>
</ul>
</li>
<li id="no" title="FIPS mode" expanded="false">FIPS mode<ul>
<li><a href="fips.html">
              Top of chapter
            </a></li>
<li title="Background"><a href="fips.html#background">Background</a></li>
<li title="Enabling FIPS mode"><a href="fips.html#enabling-fips-mode">Enabling FIPS mode</a></li>
<li title="Incompatibilities with regular builds"><a href="fips.html#incompatibilities-with-regular-builds">Incompatibilities with regular builds</a></li>
<li title="Common caveats"><a href="fips.html#common-caveats">Common caveats</a></li>
</ul>
</li>
<li id="loadscrollpos" title="Engine Load" expanded="true">Engine Load<ul>
<li><a href="engine_load.html">
              Top of chapter
            </a></li>
<li title="Background"><a href="engine_load.html#background">Background</a></li>
<li title="Use Cases"><a href="engine_load.html#use-cases">Use Cases</a></li>
</ul>
</li>
<li id="no" title="Engine Stored Keys" expanded="false">Engine Stored Keys<ul>
<li><a href="engine_keys.html">
              Top of chapter
            </a></li>
<li title="Background"><a href="engine_keys.html#background">Background</a></li>
<li title="Use Cases"><a href="engine_keys.html#use-cases">Use Cases</a></li>
</ul>
</li>
<li id="no" title="Algorithm Details" expanded="false">Algorithm Details<ul>
<li><a href="algorithm_details.html">
              Top of chapter
            </a></li>
<li title="Ciphers"><a href="algorithm_details.html#ciphers">Ciphers</a></li>
<li title="Message Authentication Codes (MACs)"><a href="algorithm_details.html#message-authentication-codes--macs-">Message Authentication Codes (MACs)</a></li>
<li title="Hash"><a href="algorithm_details.html#hash">Hash</a></li>
<li title="Public Key Cryptography"><a href="algorithm_details.html#public-key-cryptography">Public Key Cryptography</a></li>
</ul>
</li>
<li id="no" title="New and Old API" expanded="false">New and Old API<ul>
<li><a href="new_api.html">
              Top of chapter
            </a></li>
<li title="Background"><a href="new_api.html#background">Background</a></li>
<li title="The old API"><a href="new_api.html#the-old-api">The old API</a></li>
<li title="The new API"><a href="new_api.html#the-new-api">The new API</a></li>
<li title="Examples of the new api"><a href="new_api.html#examples-of-the-new-api">Examples of the new api</a></li>
<li title="Retired cipher names"><a href="new_api.html#retired-cipher-names">Retired cipher names</a></li>
</ul>
</li>
</ul></nav></aside><div id="content">
<div class="innertube">
<h1 id="Engine Load">3 Engine Load</h1>
  
  <p>
    <a name="engine_load"></a>
    This chapter describes the support for loading encryption engines in the crypto application.
  </p>

  <h3 id="background" class="title-link" onMouseOver="document.getElementById('ghlink-background-idm175').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-background-idm175').style.visibility = 'hidden';">
<div class="title-name">3.1 
        Background</div>
<div class="title-anchors"><span id="ghlink-background-idm175" class="ghlink-after"><a href="#background" title="Link to this place!"><span class="paperclip-after"></span></a><a href="https://github.com/erlang/otp/edit/maint/lib/crypto/doc/src/engine_load.xml#L32" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil-after"></span></a></span></div>
</h3>
    
    <p>
      OpenSSL exposes an Engine API, which makes it possible to plug in alternative
      implementations for some or all of the cryptographic operations implemented by OpenSSL.
      When configured appropriately, OpenSSL calls the engine's implementation of these
      operations instead of its own.
    </p>
    <p>
      Typically, OpenSSL engines provide a hardware implementation of specific cryptographic
      operations. The hardware implementation usually offers improved performance over its
      software-based counterpart, which is known as cryptographic acceleration.
    </p>
    <div class="note">
<div class="label">Note</div>
<div class="content"><p>
      <p>The file name requirement on the engine dynamic library can differ between SSL versions.</p>
    </p></div>
</div>
  

  <h3 id="use-cases" class="title-link" onMouseOver="document.getElementById('ghlink-use-cases-idm181').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-use-cases-idm181').style.visibility = 'hidden';">
<div class="title-name">3.2 
        Use Cases</div>
<div class="title-anchors"><span id="ghlink-use-cases-idm181" class="ghlink-after"><a href="#use-cases" title="Link to this place!"><span class="paperclip-after"></span></a><a href="https://github.com/erlang/otp/edit/maint/lib/crypto/doc/src/engine_load.xml#L50" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil-after"></span></a></span></div>
</h3>
    
    <h4 id="dynamically-load-an-engine-from-default-directory" class="title-link" onMouseOver="document.getElementById('ghlink-dynamically-load-an-engine-from-default-directory-idm183').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-dynamically-load-an-engine-from-default-directory-idm183').style.visibility = 'hidden';">
<div class="title-name">Dynamically load an engine from default directory</div>
<div class="title-anchors"><span id="ghlink-dynamically-load-an-engine-from-default-directory-idm183" class="ghlink-after"><a href="#dynamically-load-an-engine-from-default-directory" title="Link to this place!"><span class="paperclip-after"></span></a><a href="https://github.com/erlang/otp/edit/maint/lib/crypto/doc/src/engine_load.xml#L52" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil-after"></span></a></span></div>
</h4>
      
      <p>
	If the engine is located in the OpenSSL/LibreSSL installation <span class="code">engines</span> directory.
      </p>
      <div class="example example-none"><pre>1&gt; {ok, Engine} = crypto:engine_load(&lt;&lt;"otp_test_engine"&gt;&gt;, [], []).
 {ok, #Ref}</pre></div>
    

    <h4 id="load-an-engine-with-the-dynamic-engine" class="title-link" onMouseOver="document.getElementById('ghlink-load-an-engine-with-the-dynamic-engine-idm188').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-load-an-engine-with-the-dynamic-engine-idm188').style.visibility = 'hidden';">
<div class="title-name">Load an engine with the dynamic engine</div>
<div class="title-anchors"><span id="ghlink-load-an-engine-with-the-dynamic-engine-idm188" class="ghlink-after"><a href="#load-an-engine-with-the-dynamic-engine" title="Link to this place!"><span class="paperclip-after"></span></a><a href="https://github.com/erlang/otp/edit/maint/lib/crypto/doc/src/engine_load.xml#L62" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil-after"></span></a></span></div>
</h4>
      
      <p>
	Load an engine with the help of the dynamic engine by giving the path to the library.
      </p>
      <div class="example example-none"><pre> 2&gt; {ok, Engine} = crypto:engine_load(&lt;&lt;"dynamic"&gt;&gt;,
                                      [{&lt;&lt;"SO_PATH"&gt;&gt;,
                                        &lt;&lt;"/some/path/otp_test_engine.so"&gt;&gt;},
                                       {&lt;&lt;"ID"&gt;&gt;, &lt;&lt;"MD5"&gt;&gt;},
                                       &lt;&lt;"LOAD"&gt;&gt;],
                                      []).
 {ok, #Ref}</pre></div>
    

    <h4 id="load-an-engine-and-replace-some-methods" class="title-link" onMouseOver="document.getElementById('ghlink-load-an-engine-and-replace-some-methods-idm192').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-load-an-engine-and-replace-some-methods-idm192').style.visibility = 'hidden';">
<div class="title-name">Load an engine and replace some methods</div>
<div class="title-anchors"><span id="ghlink-load-an-engine-and-replace-some-methods-idm192" class="ghlink-after"><a href="#load-an-engine-and-replace-some-methods" title="Link to this place!"><span class="paperclip-after"></span></a><a href="https://github.com/erlang/otp/edit/maint/lib/crypto/doc/src/engine_load.xml#L77" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil-after"></span></a></span></div>
</h4>
      
      <p>
	Load an engine with the help of the dynamic engine and just
	replace some engine methods.
      </p>
      <div class="example example-none"><pre> 3&gt; Methods = crypto:engine_get_all_methods() -- [engine_method_dh,engine_method_rand,
engine_method_ciphers,engine_method_digests, engine_method_store,
engine_method_pkey_meths, engine_method_pkey_asn1_meths].
[engine_method_rsa,engine_method_dsa,
 engine_method_ecdh,engine_method_ecdsa]
 4&gt; {ok, Engine} = crypto:engine_load(&lt;&lt;"dynamic"&gt;&gt;,
                                      [{&lt;&lt;"SO_PATH"&gt;&gt;,
                                        &lt;&lt;"/some/path/otp_test_engine.so"&gt;&gt;},
                                       {&lt;&lt;"ID"&gt;&gt;, &lt;&lt;"MD5"&gt;&gt;},
                                       &lt;&lt;"LOAD"&gt;&gt;],
                                      [],
		                      Methods).
 {ok, #Ref}</pre></div>
    

    <h4 id="load-with-the-ensure-loaded-function" class="title-link" onMouseOver="document.getElementById('ghlink-load-with-the-ensure-loaded-function-idm196').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-load-with-the-ensure-loaded-function-idm196').style.visibility = 'hidden';">
<div class="title-name">Load with the ensure loaded function</div>
<div class="title-anchors"><span id="ghlink-load-with-the-ensure-loaded-function-idm196" class="ghlink-after"><a href="#load-with-the-ensure-loaded-function" title="Link to this place!"><span class="paperclip-after"></span></a><a href="https://github.com/erlang/otp/edit/maint/lib/crypto/doc/src/engine_load.xml#L99" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil-after"></span></a></span></div>
</h4>
      
      <p>
	This function makes sure the engine is loaded just once and the ID is added to the internal
	engine list of OpenSSL. The following calls to the function will check if the ID is loaded
	and then just get a new reference to the engine.
      </p>
      <div class="example example-none"><pre> 5&gt; {ok, Engine} = crypto:ensure_engine_loaded(&lt;&lt;"MD5"&gt;&gt;,
                                               &lt;&lt;"/some/path/otp_test_engine.so"&gt;&gt;).
 {ok, #Ref}</pre></div>
      <p>
	To unload it use crypto:ensure_engine_unloaded/1 which removes the ID from the internal list
	before unloading the engine.
      </p>
      <div class="example example-none"><pre> 6&gt; crypto:ensure_engine_unloaded(&lt;&lt;"MD5"&gt;&gt;).
 ok</pre></div>
    



    <h4 id="list-all-engines-currently-loaded" class="title-link" onMouseOver="document.getElementById('ghlink-list-all-engines-currently-loaded-idm202').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-list-all-engines-currently-loaded-idm202').style.visibility = 'hidden';">
<div class="title-name">List all engines currently loaded</div>
<div class="title-anchors"><span id="ghlink-list-all-engines-currently-loaded-idm202" class="ghlink-after"><a href="#list-all-engines-currently-loaded" title="Link to this place!"><span class="paperclip-after"></span></a><a href="https://github.com/erlang/otp/edit/maint/lib/crypto/doc/src/engine_load.xml#L121" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil-after"></span></a></span></div>
</h4>
      
      <div class="example example-none"><pre> 5&gt; crypto:engine_list().
[&lt;&lt;"dynamic"&gt;&gt;, &lt;&lt;"MD5"&gt;&gt;]</pre></div>
    

  
</div>
<div class="footer">
<hr>
<p>Copyright © 1999-2021 Ericsson AB. All Rights Reserved.</p>
</div>
</div>
</div>
<script type="text/javascript">window.__otpTopDocDir = '../../js/';</script><script type="text/javascript" src="../../js/highlight.js"></script>
<script src="/assets/js/doc-search.bundle.js"></script>
</body>
</html>
