<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.38.1">
    <meta name="project" content="diameter v2.5.2">


<meta name="major-vsn" content="28">
<meta name="exdoc:full-text-search-url" content="/doc/search.html?v=28&q=">
<link rel="canonical" href="https://www.erlang.org/doc/apps/diameter/diameter_tcp.html" />
    <title>diameter_tcp — diameter v2.5.2</title>

    <link rel="stylesheet" href="dist/html-erlang-ZK43ZOAC.css" />

    <script defer src="dist/sidebar_items-24C2EAB1.js"></script>
    <script defer src="docs_config.js"></script>
    <script defer src="dist/html-DPJLHKSM.js"></script>

  </head>
  <body>
    <script>(()=>{var t="ex_doc:settings",e="dark";var o="dark",s="light";var E="sidebar_state",n="closed";var r="sidebar_width";var a="sidebar-open";var i=new URLSearchParams(window.location.search),S=i.get("theme")||JSON.parse(localStorage.getItem(t)||"{}").theme;(S===o||S!==s&&window.matchMedia("(prefers-color-scheme: dark)").matches)&&document.body.classList.add(e);var d=sessionStorage.getItem(E),A=d!==n&&!window.matchMedia(`screen and (max-width: ${768}px)`).matches;document.body.classList.toggle(a,A);var c=sessionStorage.getItem(r);c&&document.body.style.setProperty("--sidebarWidth",`${c}px`);var p=/(Macintosh|iPhone|iPad|iPod)/.test(window.navigator.userAgent);document.documentElement.classList.toggle("apple-os",p);})();
</script>

<div class="body-wrapper">

<button id="sidebar-menu" class="sidebar-button sidebar-toggle" aria-label="toggle sidebar" aria-controls="sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<nav id="sidebar" class="sidebar">

  <div class="sidebar-header">
    <div class="sidebar-projectInfo">

        <a href="../../index.html" class="sidebar-projectImage">
          <img src="assets/logo.png" alt="diameter" />
        </a>

      <div>
        <a href="../../index.html" class="sidebar-projectName" translate="no">
diameter
        </a>
        <div class="sidebar-projectVersion" translate="no">
          v2.5.2
        </div>
      </div>
    </div>
    <ul id="sidebar-list-nav" class="sidebar-list-nav" role="tablist" data-extras=""></ul>
  </div>
</nav>

<output role="status" id="toast"></output>

<main class="content page-module" id="main" data-type="modules">
  <div id="content" class="content-inner">
    <div class="top-search">
      <div class="search-settings">
        <form class="search-bar" action="search.html">
          <label class="search-label">
            <span class="sr-only">Search documentation of diameter</span>
            <input name="q" type="text" class="search-input" placeholder="Press / to search" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
          </label>
          <button type="submit" class="search-button" aria-label="Submit Search" tabindex="-1">
            <i class="ri-search-2-line ri-lg" aria-hidden="true"></i>
          </button>
          <button type="button" tabindex="-1" class="search-close-button" aria-hidden="true">
            <i class="ri-close-line ri-lg" title="Cancel search"></i>
          </button>
        </form>
        <div class="autocomplete">
        </div>
        <button class="icon-settings display-settings">
          <i class="ri-settings-3-line"></i>
          <span class="sr-only">Settings</span>
        </button>
      </div>
    </div>

<div id="top-content">
  <div class="heading-with-actions top-heading">
    <h1>
      <span translate="no">diameter_tcp</span> 
      <small class="app-vsn" translate="no">(diameter v2.5.2)</small>

    </h1>

      <a href="https://github.com/erlang/otp/blob/OTP-28.2/lib/diameter/src/transport/diameter_tcp.erl#L23" title="View Source" class="icon-action" rel="help">
        <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        <span class="sr-only">View Source</span>
      </a>

  </div>


    <section id="moduledoc">
<p>Diameter transport over TCP.</p><p>This module implements diameter transport over TCP using <a href="../../apps/kernel/gen_tcp.html"><code class="inline">gen_tcp</code></a>. It can be
specified as the value of a <code class="inline">transport_module</code> option to
<a href="diameter.html#add_transport/2"><code class="inline">diameter:add_transport/2</code></a> and implements the behaviour documented in
<a href="diameter_transport.html"><code class="inline">diameter_transport</code></a>. TLS security is supported, either as an upgrade
following capabilities exchange or at connection establishment.</p><p>Note that the ssl application is required for TLS and must be started before
configuring TLS capability on diameter transports.</p><p><a href="" id="start"></a></p><h2 id="module-see-also" class="section-heading"><a href="#module-see-also" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">SEE ALSO</span></h2><p><a href="diameter.html"><code class="inline">diameter</code></a>, <a href="diameter_transport.html"><code class="inline">diameter_transport</code></a>, <a href="../../apps/kernel/gen_tcp.html"><code class="inline">gen_tcp</code></a>, <a href="../../apps/kernel/inet.html"><code class="inline">inet</code></a>, <a href="../../apps/ssl/ssl.html"><code class="inline">ssl</code></a></p>
    </section>

</div>

  <section id="summary" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#summary">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Summary</span>
    </h1>
<div class="summary-types summary">
  <h2>
    <a href="#types">Types</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:connect_option/0" data-no-tooltip="" translate="no">connect_option()</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:listen_option/0" data-no-tooltip="" translate="no">listen_option()</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:match/0" data-no-tooltip="" translate="no">match()</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:option/0" data-no-tooltip="" translate="no">option()</a>

      </div>

    </div>

</div>
<div class="summary-functions summary">
  <h2>
    <a href="#functions">Functions</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#start/3" data-no-tooltip="" translate="no">start/3</a>

      </div>

        <div class="summary-synopsis"><p>start({Type, Ref}, Svc, [Opt]) -&gt; {ok, Pid} | {ok, Pid, [LAddr]} | {error,
Reason}</p></div>

    </div>

</div>

  </section>


  <section id="types" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#types">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Types</span>
    </h1>
    <div class="types-list">
<section class="detail" id="t:connect_option/0">

  <div class="detail-header">
    <a href="#t:connect_option/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">connect_option()</h1>

        <span class="note">(since OTP R14B03)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.2/lib/diameter/src/transport/diameter_tcp.erl#L117" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> connect_option() ::
          {raddr, <a href="../../apps/kernel/inet.html#t:ip_address/0">inet:ip_address</a>()} |
          {rport, <a href="../../apps/erts/erlang.html#t:pos_integer/0">pos_integer</a>()} |
          {ssl_options, true | [<a href="../../apps/ssl/ssl.html#t:tls_client_option/0">ssl:tls_client_option</a>()]} |
          <a href="#t:option/0">option</a>() |
          <a href="../../apps/ssl/ssl.html#t:tls_client_option/0">ssl:tls_client_option</a>() |
          <a href="../../apps/kernel/gen_tcp.html#t:connect_option/0">gen_tcp:connect_option</a>().</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:listen_option/0">

  <div class="detail-header">
    <a href="#t:listen_option/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">listen_option()</h1>

        <span class="note">(since OTP R14B03)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.2/lib/diameter/src/transport/diameter_tcp.erl#L128" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> listen_option() ::
          {accept, <a href="#t:match/0">match</a>()} |
          {ssl_options, true | [<a href="../../apps/ssl/ssl.html#t:tls_server_option/0">ssl:tls_server_option</a>()]} |
          <a href="#t:option/0">option</a>() |
          <a href="../../apps/ssl/ssl.html#t:tls_server_option/0">ssl:tls_server_option</a>() |
          <a href="../../apps/kernel/gen_tcp.html#t:listen_option/0">gen_tcp:listen_option</a>().</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:match/0">

  <div class="detail-header">
    <a href="#t:match/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">match()</h1>

        <span class="note">(not exported)</span>

        <span class="note">(since OTP R14B03)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.2/lib/diameter/src/transport/diameter_tcp.erl#L124" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> match() :: <a href="../../apps/kernel/inet.html#t:ip_address/0">inet:ip_address</a>() | <a href="../../apps/erts/erlang.html#t:string/0">string</a>() | [<a href="#t:match/0">match</a>()].</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:option/0">

  <div class="detail-header">
    <a href="#t:option/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">option()</h1>

        <span class="note">(not exported)</span>

        <span class="note">(since OTP R14B03)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.2/lib/diameter/src/transport/diameter_tcp.erl#L134" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> option() ::
          {port, <a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>()} |
          {sender, <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>()} |
          sender |
          {message_cb, false | <a href="diameter.html#t:eval/0">diameter:eval</a>()} |
          {fragment_timer, 0..4294967295}.</pre>

      </div>


  </section>
</section>

    </div>
  </section>

  <section id="functions" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#functions">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Functions</span>
    </h1>
    <div class="functions-list">
<section class="detail" id="start/3">

  <div class="detail-header">
    <a href="#start/3" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">start/3</h1>

        <span class="note">(since OTP R14B03)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.2/lib/diameter/src/transport/diameter_tcp.erl#L249" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> start({accept, Ref},
            #diameter_service{pid :: <a href="../../apps/erts/erlang.html#t:term/0">term</a>(), capabilities :: <a href="../../apps/erts/erlang.html#t:term/0">term</a>(), applications :: <a href="../../apps/erts/erlang.html#t:term/0">term</a>()},
            [<a href="#t:listen_option/0">listen_option</a>()]) ->
               {ok, <a href="../../apps/erts/erlang.html#t:pid/0">pid</a>(), [<a href="../../apps/kernel/inet.html#t:ip_address/0">inet:ip_address</a>()]}
               when Ref :: <a href="diameter.html#t:transport_ref/0">diameter:transport_ref</a>();
           ({connect, Ref},
            #diameter_service{pid :: <a href="../../apps/erts/erlang.html#t:term/0">term</a>(), capabilities :: <a href="../../apps/erts/erlang.html#t:term/0">term</a>(), applications :: <a href="../../apps/erts/erlang.html#t:term/0">term</a>()},
            [<a href="#t:connect_option/0">connect_option</a>()]) ->
               {ok, <a href="../../apps/erts/erlang.html#t:pid/0">pid</a>()}
               when Ref :: <a href="diameter.html#t:transport_ref/0">diameter:transport_ref</a>().</pre>

      </div>

<p>start({Type, Ref}, Svc, [Opt]) -&gt; {ok, Pid} | {ok, Pid, [LAddr]} | {error,
Reason}</p><p>The start function required by <a href="diameter_transport.html"><code class="inline">diameter_transport</code></a>.</p><p>Options <code class="inline">raddr</code> and <code class="inline">rport</code> specify the remote address and port for a connecting
transport and are not valid for a listening transport.</p><p>Option <code class="inline">accept</code> specifies remote addresses for a listening transport and is not
valid for a connecting transport. If specified, a remote address that does not
match one of the specified addresses causes the connection to be aborted.
Multiple <code class="inline">accept</code> options can be specified. A string-valued <code class="inline">Match</code> that does
not parse as an address is interpreted as a regular expression.</p><p>Option <code class="inline">ssl_options</code> must be specified for a transport that should support TLS:
a value of <code class="inline">true</code> results in a TLS handshake immediately upon connection
establishment while <a href="../../apps/erts/erlang.html#t:list/0"><code class="inline">list/0</code></a> specifies options to be passed to <a href="../../apps/ssl/ssl.html#connect/2"><code class="inline">ssl:connect/2</code></a>
or <a href="../../apps/ssl/ssl.html#handshake/2"><code class="inline">ssl:handshake/2</code></a> after capabilities exchange if TLS is negotiated.</p><p>Option <code class="inline">fragment_timer</code> specifies the timeout, in milliseconds, of a timer used
to flush messages from the incoming byte stream even if the number of bytes
indicated in the Message Length field of its Diameter Header have not yet been
accumulated: such a message is received over the transport interface after two
successive timeouts without the reception of additional bytes. Defaults to 1000.</p><p><a href="" id="sender"></a></p><p>Option <code class="inline">sender</code> specifies whether or not to use a dedicated process for sending
outgoing messages, which avoids the possibility of send blocking reception.
Defaults to <code class="inline">false</code>. If set to <code class="inline">true</code> then a <code class="inline">message_cb</code> that avoids the
possibility of messages being queued in the sender process without bound should
be configured.</p><p>Option <code class="inline">message_cb</code> specifies a callback that is invoked on incoming and
outgoing messages, that can be used to implement flow control. It is applied to
two arguments: an atom indicating the reason for the callback (<code class="inline">send</code>, <code class="inline">recv</code>,
or <code class="inline">ack</code> after a completed send), and the message in question (binary() on
<code class="inline">recv</code>, binary() or diameter<em>packet record on <code class="inline">send</code> or <code class="inline">ack</code>, or <code class="inline">false</code> on
<code class="inline">ack</code> when an incoming request has been discarded). It should return a list of
actions and a new callback as tail; eg. <code class="inline">[fun cb/3, State]</code>. Valid actions are
the atoms <code class="inline">send</code> or <code class="inline">recv</code>, to cause a following message-valued action to be
sent/received, a message to send/receive (binary() or diameter_packet record),
or a boolean() to enable/disable reading on the socket. More than one
<code class="inline">send</code>/<code class="inline">recv</code>/message sequence can be returned from the same callback, and an
initial <code class="inline">send</code>/<code class="inline">recv</code> can be omitted if the same as the value passed as the
callback's first argument. Reading is initially enabled, and returning <code class="inline">false</code>
does not imply there cannot be subsequent <code class="inline">recv</code> callbacks since messages may
already have been read. An empty tail is equivalent to the prevailing callback.
Defaults to a callback equivalent to `fun(ack, </em>) -&gt; []; (_, Msg) -&gt; [Msg]
end`.</p><p>Remaining options are any accepted by <a href="../../apps/ssl/ssl.html#connect/3"><code class="inline">ssl:connect/3</code></a> or <a href="../../apps/kernel/gen_tcp.html#connect/3"><code class="inline">gen_tcp:connect/3</code></a> for
a connecting transport, or <a href="../../apps/ssl/ssl.html#listen/2"><code class="inline">ssl:listen/2</code></a> or <a href="../../apps/kernel/gen_tcp.html#listen/2"><code class="inline">gen_tcp:listen/2</code></a> for a listening
transport, depending on whether or not <code class="inline">{ssl_options, true}</code> has been specified.
Options <code class="inline">binary</code>, <code class="inline">packet</code> and <code class="inline">active</code> cannot be specified. Also, option <code class="inline">port</code>
can be specified for a listening transport to specify the local listening port,
the default being the standardized 3868. Note that the option <code class="inline">ip</code> specifies the
local address.</p><p>An <code class="inline">ssl_options</code> list must be specified if and only if the transport in question
has set <code class="inline">Inband-Security-Id</code> to 1 (<code class="inline">TLS</code>), as specified to either
<a href="diameter.html#start_service/2"><code class="inline">diameter:start_service/2</code></a> or <a href="diameter.html#add_transport/2"><code class="inline">diameter:add_transport/2</code></a>, so that the transport
process will receive notification of whether or not to commence with a TLS
handshake following capabilities exchange. Failing to specify an options list on
a TLS-capable transport for which TLS is negotiated will cause TLS handshake to
fail. Failing to specify TLS capability when <code class="inline">ssl_options</code> has been specified
will cause the transport process to wait for a notification that will not be
forthcoming, which will eventually cause the RFC 3539 watchdog to take down the
connection.</p><p>The first element of a non-empty <code class="inline">Host-IP-Address</code> list in <code class="inline">Svc</code> provides the
local IP address if an <code class="inline">ip</code> option is not specified. The local address is either
returned from<a href="#start/3"><code class="inline">start/3</code></a> or passed in a <code class="inline">connected</code> message over the transport
interface.</p>
  </section>
</section>

    </div>
  </section>

    <footer class="footer">
      <p>

        <span class="line">
          <button class="a-main footer-button display-quick-switch" title="Search HexDocs packages">
            Search HexDocs
          </button>

            <a href="diameter.epub" title="ePub version">
              Download ePub version
            </a>

        </span>
      </p>

      <p class="built-using">
        Built using
        <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.38.1) for the

          <a href="https://erlang.org" title="Erlang" target="_blank" translate="no">Erlang programming language</a>

      </p>
<p>Copyright © 1996-2025 <a href="https://www.ericsson.com">Ericsson AB</a></p>
    </footer>
  </div>
</main>
</div>
  <script defer src="https://cdn.jsdelivr.net/npm/mermaid@11.4.1/dist/mermaid.min.js"></script>
  <script>
  let initialized = false;

  window.addEventListener("exdoc:loaded", () => {
      if (!initialized) {
      mermaid.initialize({
          startOnLoad: false,
          theme: document.body.className.includes("dark") ? "dark" : "default"
      });
      initialized = true;
      }

      let id = 0;
      for (const codeEl of document.querySelectorAll("pre code.mermaid")) {
      const preEl = codeEl.parentElement;
      const graphDefinition = codeEl.textContent;
      const graphEl = document.createElement("div");
      const graphId = "mermaid-graph-" + id++;
      mermaid.render(graphId, graphDefinition).then(({svg, bindFunctions}) => {
          graphEl.innerHTML = svg;
          bindFunctions?.(graphEl);
          preEl.insertAdjacentElement("afterend", graphEl);
          preEl.remove();
      });
      }
  });
  </script>

  </body>
</html>
