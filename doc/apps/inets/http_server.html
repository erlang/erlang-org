<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html xmlns:erl="http://erlang.org" xmlns:fn="http://www.w3.org/2005/02/xpath-functions">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta charset="utf-8">
<link rel="stylesheet" href="../../otp_doc.css" type="text/css">
<title>Erlang -- HTTP server</title>
</head>
<body>
<div id="container">
<script id="js" type="text/javascript" language="JavaScript" src="../../js/flipmenu/flipmenu.js"></script><script id="js2" type="text/javascript" src="../../js/erlresolvelinks.js"></script><script id="js3" type="text/javascript" src="../../../../doc/js/topbar.js"></script><script language="JavaScript" type="text/javascript">
            <!--
              function setscrollpos() {
                var objf = document.getElementById('loadscrollpos');
                if (objf) {
                  document.getElementById("leftnav").firstChild.scrollTop = objf.offsetTop - 10;
                }
              }

              function addEvent(obj, evType, fn){
                if (obj.addEventListener){
                obj.addEventListener(evType, fn, true);
                return true;
              } else if (obj.attachEvent){
                var r = obj.attachEvent("on"+evType, fn);
                return r;
              } else {
                return false;
              }
             }

             addEvent(window, 'load', setscrollpos);

             //-->
</script><div class="topbar">
<div class="topbar-expand "><button onclick="toggleDisplay();"><svg xmlns="http://www.w3.org/2000/svg" version="1.1" id="Capa_1" viewBox="0 0 54 54" width="24" height="24"><g><path style="fill:#000000;" d="M27,54c-0.552,0-1-0.448-1-1V8c0-0.552,0.448-1,1-1s1,0.448,1,1v45C28,53.552,27.552,54,27,54z"></path><path style="fill:#000000;" d="M11,25c-0.256,0-0.512-0.098-0.707-0.293c-0.391-0.391-0.391-1.023,0-1.414l16-16                                      c0.391-0.391,1.023-0.391,1.414,0s0.391,1.023,0,1.414l-16,16C11.512,24.902,11.256,25,11,25z"></path><path style="fill:#000000;" d="M43,25c-0.256,0-0.512-0.098-0.707-0.293l-16-16c-0.391-0.391-0.391-1.023,0-1.414                                      s1.023-0.391,1.414,0l16,16c0.391,0.391,0.391,1.023,0,1.414C43.512,24.902,43.256,25,43,25z"></path><path style="fill:#000000;" d="M43,2H11c-0.552,0-1-0.448-1-1s0.448-1,1-1h32c0.552,0,1,0.448,1,1S43.552,2,43,2z"></path></g></svg></button></div>
<div class="topbar-title"><h1 id="HTTP server">4 
                HTTP server</h1></div>
<div class="search-expand ">        <button id="docsearch-mobile">
            <svg fill="#000000" xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 50 50" width="24" height="24"><path d="M 21 3 C 11.621094 3 4 10.621094 4 20 C 4 29.378906 11.621094 37 21 37 C 24.710938 37 28.140625 35.804688 30.9375 33.78125 L 44.09375 46.90625 L 46.90625 44.09375 L 33.90625 31.0625 C 36.460938 28.085938 38 24.222656 38 20 C 38 10.621094 30.378906 3 21 3 Z M 21 5 C 29.296875 5 36 11.703125 36 20 C 36 28.296875 29.296875 35 21 35 C 12.703125 35 6 28.296875 6 20 C 6 11.703125 12.703125 5 21 5 Z"/></svg>
        </button>
</div>
</div>
<aside class="hide-mobile" id="leftnav"><nav class="leftnav-tube"><div class="erlang-logo-wrapper"><a href="../../index.html"><img alt="Erlang Logo" src="../../erlang-logo.png" class="erlang-logo"></a></div>
<p class="section-title">inets</p>
<p class="section-subtitle">User's Guide</p>
<p class="section-version">Version 7.4.2</p>
<ul class="panel-sections">
<li><a href="users_guide.html">User's Guide</a></li>
<li><a href="index.html">Reference Manual</a></li>
<li><a href="notes.html">Release Notes</a></li>
<li><a href="inets.pdf">PDF</a></li>
<li><a href="../../index.html">Top</a></li>
</ul>
<div id="docsearch"></div>
<ul class="expand-collapse-items">
<li><a href="javascript:openAllFlips()">Expand All</a></li>
<li><a href="javascript:closeAllFlips()">Contract All</a></li>
</ul>
<h3 id="chapters">Chapters</h3>
<ul class="flipMenu" imagePath="../../js/flipmenu">
<li id="no" title="Introduction" expanded="false">Introduction<ul>
<li><a href="introduction.html">
              Top of chapter
            </a></li>
<li title="Purpose"><a href="introduction.html#purpose">Purpose</a></li>
<li title="Prerequisites"><a href="introduction.html#prerequisites">Prerequisites</a></li>
</ul>
</li>
<li id="no" title="Inets" expanded="false">Inets<ul>
<li><a href="inets_services.html">
              Top of chapter
            </a></li>
<li title="Service Concept"><a href="inets_services.html#service-concept">Service Concept</a></li>
</ul>
</li>
<li id="no" title="HTTP Client" expanded="false">HTTP Client<ul>
<li><a href="http_client.html">
              Top of chapter
            </a></li>
<li title="Configuration"><a href="http_client.html#configuration">Configuration</a></li>
<li title="Getting Started"><a href="http_client.html#getting-started">Getting Started</a></li>
</ul>
</li>
<li id="loadscrollpos" title="HTTP server" expanded="true">HTTP server<ul>
<li><a href="http_server.html">
              Top of chapter
            </a></li>
<li title="Configuration"><a href="http_server.html#configuration">Configuration</a></li>
<li title="Getting Started"><a href="http_server.html#getting-started">Getting Started</a></li>
<li title="Dynamic Web Pages"><a href="http_server.html#dynamic-web-pages">Dynamic Web Pages</a></li>
<li title="Logging"><a href="http_server.html#logging">Logging</a></li>
<li title="Erlang Web Server API"><a href="http_server.html#erlang-web-server-api">Erlang Web Server API</a></li>
<li title="Inets Web Server Modules"><a href="http_server.html#inets-web-server-modules">Inets Web Server Modules</a></li>
</ul>
</li>
</ul></nav></aside><div id="content">
<div class="innertube">
<h1 id="HTTP server">4 HTTP server</h1>
  

  <h3 id="configuration" class="title-link" onMouseOver="document.getElementById('ghlink-configuration-idm159').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-configuration-idm159').style.visibility = 'hidden';">
<div class="title-name">4.1 
        Configuration</div>
<div class="title-anchors"><span id="ghlink-configuration-idm159" class="ghlink-after"><a href="#configuration" title="Link to this place!"><span class="paperclip-after"></span></a><a href="https://github.com/erlang/otp/edit/maint/lib/inets/doc/src/http_server.xml#L28" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil-after"></span></a></span></div>
</h3>
    
    <a name="config"></a>
    <p>The HTTP server, also referred to as httpd, handles HTTP requests
      as described in 
      <span class="bold_code bc-20"><a href="http://www.ietf.org/rfc/rfc2616.txt">RFC 2616</a></span>
      with a few exceptions, such as gateway
      and proxy functionality. The server supports IPv6 as long as the
      underlying mechanisms also do so.</p>

    <p>The server implements numerous features, such as:</p>
      <ul>
       <li>Secure Sockets Layer (SSL)</li>
       <li>Erlang Scripting Interface (ESI)</li>
       <li>Common Gateway Interface (CGI)</li>
       <li>User Authentication (using Mnesia,
       Dets or plain text database)</li>
       <li>Common Logfile Format (with or without disk_log(3) support)</li>
       <li>URL Aliasing</li>
       <li>Action Mappings</li>
       <li>Directory Listings</li>
      </ul>

    <p>The configuration of the server is provided as an Erlang
      property list.</p>

    <p>As of <span class="code">Inets</span> 5.0 the HTTP server is an easy to
      start/stop and customize web server providing the most basic
      web server functionality. Inets is designed for embedded systems
      and if you want a full-fledged web server there are other erlang
      open source alternatives.</p>
    
    <p>Almost all server functionality has been implemented using an
      especially crafted server API, which is described in the Erlang Web
      Server API. This API can be used
      to enhance the core server functionality, for example with custom
      logging and authentication.</p>

    <p>The following is to be put in the Erlang node application configuration 
      file to start an HTTP server at application startup:</p>
    
    <div class="example example-erl"><pre>      [{inets, [{services, [{httpd, [{proplist_file,
                 "/var/tmp/server_root/conf/8888_props.conf"}]},
                {httpd, [{proplist_file,
                 "/var/tmp/server_root/conf/8080_props.conf"}]}]}]}].</pre></div>

    <p>The server is configured using an Erlang property list.
      For the available properties, see
      <span class="bold_code bc-19"><a href="../../man/httpd.html">httpd(3)</a></span>.
    </p>
    
    <p>The available configuration properties are as follows:</p>
    <div class="example example-none"><pre>     httpd_service() -&gt; {httpd, httpd()}
     httpd()         -&gt; [httpd_config()] 
     httpd_config()  -&gt; {proplist_file, file()}
                        {debug, debug()} |
                        {accept_timeout, integer()}
     debug()         -&gt; disable | [debug_options()]
     debug_options() -&gt; {all_functions, modules()} | 
                        {exported_functions, modules()} |
                        {disable, modules()}
     modules()       -&gt; [atom()]</pre></div>
     <p>Here:</p>
     <dl>      
       <dt><strong><span class="code">{proplist_file, file()}</span></strong></dt>
       <dd><p>File containing an Erlang property
       list, followed by a full stop, describing the HTTP server
       configuration.</p></dd> 
       <dt><strong><span class="code">{debug, debug()}</span></strong></dt>
       <dd><p>Can enable trace on all functions or only exported functions 
       on chosen modules.</p></dd>
       <dt><strong><span class="code">{accept_timeout, integer()}</span></strong></dt>
       <dd><p>Sets the wanted time-out value for
      the server to set up a request connection.</p></dd>
     </dl>
  

  <h3 id="getting-started" class="title-link" onMouseOver="document.getElementById('ghlink-getting-started-idm198').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-getting-started-idm198').style.visibility = 'hidden';">
<div class="title-name">4.2 
        Getting Started</div>
<div class="title-anchors"><span id="ghlink-getting-started-idm198" class="ghlink-after"><a href="#getting-started" title="Link to this place!"><span class="paperclip-after"></span></a><a href="https://github.com/erlang/otp/edit/maint/lib/inets/doc/src/http_server.xml#L107" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil-after"></span></a></span></div>
</h3>
    
    <a name="using_http_server_api"></a>
    <p>Start <span class="code">Inets</span>:</p>
    <div class="example example-none"><pre>      1 &gt; inets:start().
      ok</pre></div>
    <p>Start an HTTP server with minimal required configuration.
       If you specify port <span class="code">0</span>, an arbitrary available port is
       used, and you can use function <span class="code">info</span> to find which port 
       number that was picked:</p>

    <div class="example example-none"><pre>      2 &gt; {ok, Pid} = inets:start(httpd, [{port, 0},
      {server_name,"httpd_test"}, {server_root,"/tmp"},
      {document_root,"/tmp/htdocs"}, {bind_address, "localhost"}]).
      {ok, 0.79.0}      </pre></div>
    
      <p>Call <span class="code">info</span>:</p>
    <div class="example example-none"><pre>      3 &gt;  httpd:info(Pid).
      [{mime_types,[{"html","text/html"},{"htm","text/html"}]},
      {server_name,"httpd_test"},
      {bind_address, {127,0,0,1}},
      {server_root,"/tmp"},
      {port,59408},
      {document_root,"/tmp/htdocs"}]</pre></div>

    <p>Reload the configuration without restarting the server:
      
    </p>
    <div class="example example-none"><pre>    4 &gt; httpd:reload_config([{port, 59408},
      {server_name,"httpd_test"}, {server_root,"/tmp/www_test"},
      {document_root,"/tmp/www_test/htdocs"},
      {bind_address, "localhost"}], non_disturbing).
    ok.</pre></div>

    <div class="note">
<div class="label">Note</div>
<div class="content"><p><p><span class="code">port</span> and <span class="code">bind_address</span> cannot be changed. 
      Clients trying to access the server during the reload
      get a service temporary unavailable answer.</p></p></div>
</div>

    <div class="example example-none"><pre>      5 &gt;  httpd:info(Pid, [server_root, document_root]).
      [{server_root,"/tmp/www_test"},{document_root,"/tmp/www_test/htdocs"}] </pre></div>

    <div class="example example-none"><pre>      6 &gt; ok = inets:stop(httpd, Pid).</pre></div>
    
    <p>Alternative:</p>
    
    <div class="example example-none"><pre>      6 &gt; ok = inets:stop(httpd, {{127,0,0,1}, 59408}).</pre></div>

    <p>Notice that <span class="code">bind_address</span> must be the IP address reported 
    by function <span class="code">info</span> and cannot be the hostname that is allowed 
    when putting in <span class="code">bind_address</span>.</p>
  

  <h3 id="dynamic-web-pages" class="title-link" onMouseOver="document.getElementById('ghlink-dynamic-web-pages-idm225').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-dynamic-web-pages-idm225').style.visibility = 'hidden';">
<div class="title-name">4.3 
        Dynamic Web Pages</div>
<div class="title-anchors"><span id="ghlink-dynamic-web-pages-idm225" class="ghlink-after"><a href="#dynamic-web-pages" title="Link to this place!"><span class="paperclip-after"></span></a><a href="https://github.com/erlang/otp/edit/maint/lib/inets/doc/src/http_server.xml#L166" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil-after"></span></a></span></div>
</h3>
    
    <a name="dynamic_we_pages"></a>
    <p><span class="code">Inets</span> HTTP server provides two ways of creating dynamic web
        pages, each with its own advantages and disadvantages:</p>
	<dl>
       <dt><strong><strong>CGI scripts</strong></strong></dt>
       <dd><p>Common Gateway Interface (CGI) scripts can be written 
       in any programming language. CGI scripts are standardized and 
       supported by most web servers. The drawback with CGI scripts is that 
       they are resource-intensive because of their design. CGI requires the 
       server to fork a new OS process for each executable it needs to start.
       </p></dd>
       <dt><strong><strong>ESI-functions</strong></strong></dt>
       <dd><p>Erlang Server Interface (ESI) functions provide a tight and efficient
        interface to the execution of Erlang functions. This interface,
        on the other hand, is <span class="code">Inets</span> specific.</p></dd>
     </dl>
      
      <h4 id="cgi-version-1.1,-rfc-3875" class="title-link" onMouseOver="document.getElementById('ghlink-cgi-version-1.1,-rfc-3875-idm240').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-cgi-version-1.1,-rfc-3875-idm240').style.visibility = 'hidden';">
<div class="title-name">CGI Version 1.1, RFC 3875</div>
<div class="title-anchors"><span id="ghlink-cgi-version-1.1,-rfc-3875-idm240" class="ghlink-after"><a href="#cgi-version-1.1,-rfc-3875" title="Link to this place!"><span class="paperclip-after"></span></a><a href="https://github.com/erlang/otp/edit/maint/lib/inets/doc/src/http_server.xml#L185" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil-after"></span></a></span></div>
</h4>
        
        <p>The module <span class="code">mod_cgi</span> enables execution of 
	<span class="bold_code bc-20"><a href="http://www.ietf.org/rfc/rfc3875.txt">CGI scripts</a></span>
          on the server. A file matching the definition of a
          ScriptAlias config directive is treated as a CGI script. A CGI
          script is executed by the server and its output is returned to
          the client.</p>
        <p>The CGI script response comprises a message header and a
          message body, separated by a blank line. The message header
          contains one or more header fields. The body can be
          empty.</p>
	 <p>Example:</p>
      
      <div class="example example-none"><pre>"Content-Type:text/plain\nAccept-Ranges:none\n\nsome very
	plain text"</pre></div>
      
        <p>The server interprets the message headers and most of them
          are transformed into HTTP headers and sent back to the
          client together with the message-body.</p>
        <p>Support for CGI-1.1 is implemented in accordance with 
	<span class="bold_code bc-20"><a href="http://www.ietf.org/rfc/rfc3875.txt">RFC 3875</a></span>.</p>
      

      <h4 id="esi" class="title-link" onMouseOver="document.getElementById('ghlink-esi-idm251').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-esi-idm251').style.visibility = 'hidden';">
<div class="title-name">ESI</div>
<div class="title-anchors"><span id="ghlink-esi-idm251" class="ghlink-after"><a href="#esi" title="Link to this place!"><span class="paperclip-after"></span></a><a href="https://github.com/erlang/otp/edit/maint/lib/inets/doc/src/http_server.xml#L209" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil-after"></span></a></span></div>
</h4>
        
        <p>The Erlang server interface is implemented by
          module <span class="code">mod_esi</span>.</p>

        <h5>ERL Scheme</h5>
          
          <p>The erl scheme is designed to mimic plain CGI, but without
            the extra overhead. An URL that calls an Erlang <span class="code">erl</span> function
            has the following syntax (regular expression): </p>
          <div class="example example-none"><pre>http://your.server.org/***/Module[:/]Function(?QueryString|/PathInfo)</pre></div>
          <p>*** depends on how the ErlScriptAlias config
            directive has been used.</p>
          <p>The module <span class="code">Module</span> referred to must be found in the code
            path, and it must define a function <span class="code">Function</span> with an arity
            of two or three. It is preferable to implement a function
            with arity three, as it permits to send chunks of the
            web page to the client during the generation
            phase instead of first generating the whole web page and
            then sending it to the client. The option to implement a
            function with arity two is only kept for
            backwards compatibility reasons.
            For implementation details of the ESI callback function, 
	    see <span class="bold_code bc-19"><a href="../../man/mod_esi.html">mod_esi(3)</a></span>.</p>
        

      
    

  <h3 id="logging" class="title-link" onMouseOver="document.getElementById('ghlink-logging-idm265').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-logging-idm265').style.visibility = 'hidden';">
<div class="title-name">4.4 
        Logging</div>
<div class="title-anchors"><span id="ghlink-logging-idm265" class="ghlink-after"><a href="#logging" title="Link to this place!"><span class="paperclip-after"></span></a><a href="https://github.com/erlang/otp/edit/maint/lib/inets/doc/src/http_server.xml#L239" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil-after"></span></a></span></div>
</h3>
    
    <a name="logging"></a>
    <p>Three types of logs are supported: transfer logs,
      security logs, and error logs. The de-facto standard Common
        Logfile Format is used for the transfer and security logging.
      There are numerous statistics programs available to analyze Common
      Logfile Format. The Common Logfile Format looks as follows:
        </p>
    <p><strong>remotehost rfc931 authuser [date] "request" status bytes</strong></p>
    <p>Here:</p>
    <dl>
      <dt><strong><strong>remotehost</strong></strong></dt>
      <dd>Remote hostname.</dd>
      <dt><strong><strong>rfc931</strong></strong></dt>
        <dd>The client remote username (<span class="bold_code bc-20"><a href="http://www.ietf.org/rfc/rfc931.txt">RFC 931</a></span>).</dd>
      <dt><strong><strong>authuser</strong></strong></dt>
      <dd>The username used for authentication.</dd>
      <dt><strong><strong>[date]</strong></strong></dt>
        <dd>Date and time of the request (<span class="bold_code bc-20"><a href="http://www.ietf.org/rfc/rfc1123.txt">RFC 1123</a></span>).</dd>
      <dt><strong><strong>"request"</strong></strong></dt>
        <dd>The request line exactly as it came from the client (<span class="bold_code bc-20"><a href="http://www.ietf.org/rfc/rfc1945.txt">RFC 1945</a></span>).</dd>
        <dt><strong><strong>status</strong></strong></dt>
        <dd>The HTTP status code returned to the client  (<span class="bold_code bc-20"><a href="http://www.ietf.org/rfc/rfc1945.txt">RFC 1945</a></span>).</dd>
        <dt><strong><strong>bytes</strong></strong></dt>
        <dd>The content-length of the document transferred. </dd>
      </dl>
      <p>Internal server errors are recorded in the error log file. The
        format of this file is a more unplanned format than the logs using
      Common Logfile Format, but conforms to the following syntax:
        </p>
      <p><strong>[date]</strong> access to <strong>path</strong> failed for
        <strong>remotehost</strong>, reason: <strong>reason</strong></p>
  
  
  <h3 id="erlang-web-server-api" class="title-link" onMouseOver="document.getElementById('ghlink-erlang-web-server-api-idm304').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-erlang-web-server-api-idm304').style.visibility = 'hidden';">
<div class="title-name">4.5 
        Erlang Web Server API</div>
<div class="title-anchors"><span id="ghlink-erlang-web-server-api-idm304" class="ghlink-after"><a href="#erlang-web-server-api" title="Link to this place!"><span class="paperclip-after"></span></a><a href="https://github.com/erlang/otp/edit/maint/lib/inets/doc/src/http_server.xml#L274" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil-after"></span></a></span></div>
</h3>
      
      <p>The process of handling an HTTP request involves several steps,
        such as:</p>
      <ul>
        <li>Setting up connections, sending and receiving data.</li>
        <li>URI to filename translation.</li>
        <li>Authentication/access checks.</li>
        <li>Retrieving/generating the response.</li>
        <li>Logging.</li>
      </ul>
      <p>To provide customization and extensibility of the request 
         handling of the HTTP servers, most of these steps are handled by 
	 one or more modules. These modules can be replaced or removed at 
	 runtime and new ones can be added. For each request, all modules are
         traversed in the order specified by the module directive in the
         server configuration file. Some parts, mainly the communication-
         related steps, are considered server core functionality and are
         not implemented using the Erlang web server API. A description of
         functionality implemented by the Erlang webserver API is described
         in <span class="bold_code bc-17"><a href="#Inets_Web_Server_Modules">Section 
	 Inets Web Server Modules</a></span>.</p>

      <p>A module can use data generated by previous modules in the
        Erlang webserver API module sequence or generate data to be used
        by consecutive Erlang Web Server API modules. This is
        possible owing to an internal list of key-value tuples, referred to
        as interaction data.</p>
      <div class="note">
<div class="label">Note</div>
<div class="content"><p>
        <p>Interaction data enforces module dependencies and
          is to be avoided if possible. This means that the order
          of modules in the modules property is significant.</p>
      </p></div>
</div>

      <h4 id="api-description" class="title-link" onMouseOver="document.getElementById('ghlink-api-description-idm318').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-api-description-idm318').style.visibility = 'hidden';">
<div class="title-name">API Description</div>
<div class="title-anchors"><span id="ghlink-api-description-idm318" class="ghlink-after"><a href="#api-description" title="Link to this place!"><span class="paperclip-after"></span></a><a href="https://github.com/erlang/otp/edit/maint/lib/inets/doc/src/http_server.xml#L308" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil-after"></span></a></span></div>
</h4>
        
        <p>Each module that implements server functionality
          using the Erlang web server API is to implement the following
          call back functions:</p>
        <ul>
          <li>
<span class="code">do/1</span> (mandatory) - the function called when
           a request is to be handled</li>
          <li><span class="code">load/2</span></li>
          <li><span class="code">store/2</span></li>
          <li><span class="code">remove/1</span></li>
        </ul>
        <p>The latter functions are needed only when new config
          directives are to be introduced. For details, see
          <span class="bold_code bc-19"><a href="../../man/httpd.html">httpd(3)</a></span>.</p>
      
    

  <h3 id="inets-web-server-modules" class="title-link" onMouseOver="document.getElementById('ghlink-inets-web-server-modules-idm332').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-inets-web-server-modules-idm332').style.visibility = 'hidden';">
<div class="title-name">4.6 
        Inets Web Server Modules</div>
<div class="title-anchors"><span id="ghlink-inets-web-server-modules-idm332" class="ghlink-after"><a href="#inets-web-server-modules" title="Link to this place!"><span class="paperclip-after"></span></a><a href="https://github.com/erlang/otp/edit/maint/lib/inets/doc/src/http_server.xml#L326" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil-after"></span></a></span></div>
</h3>
    
    <a name="Inets_Web_Server_Modules"></a>
    <p>The convention is that
      all modules implementing some web server functionality has the
      name <span class="code">mod_*</span>. When configuring the web server, an appropriate
      selection of these modules is to be present in the module
      directive. Notice that there are some interaction dependencies
      to take into account, so the order of the modules cannot be
      random.</p>

    <h4 id="mod_action---filetype-method-based-script-execution" class="title-link" onMouseOver="document.getElementById('ghlink-mod_action---filetype-method-based-script-execution-idm337').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-mod_action---filetype-method-based-script-execution-idm337').style.visibility = 'hidden';">
<div class="title-name">mod_action - Filetype/Method-Based Script Execution</div>
<div class="title-anchors"><span id="ghlink-mod_action---filetype-method-based-script-execution-idm337" class="ghlink-after"><a href="#mod_action---filetype-method-based-script-execution" title="Link to this place!"><span class="paperclip-after"></span></a><a href="https://github.com/erlang/otp/edit/maint/lib/inets/doc/src/http_server.xml#L337" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil-after"></span></a></span></div>
</h4>
      
      <p>This module runs CGI scripts whenever a file of a
	certain type or HTTP method (see 
	<span class="bold_code bc-20"><a href="http://tools.ietf.org/html/rfc1945">RFC 1945</a></span>)
	is requested.
      </p>
      <p>Uses the following Erlang Web Server API interaction data:
      </p>
      <ul>
	<li>
<span class="code">real_name</span> - from <span class="bold_code bc-19"><a href="../../man/mod_alias.html">mod_alias</a></span>.</li>
      </ul>
      <p>Exports the following Erlang Web Server API interaction data, if possible:
      </p>
      <dl>
	<dt><strong><span class="code">{new_request_uri, RequestURI}</span></strong></dt>
	<dd>An alternative <span class="code">RequestURI</span> has been generated.</dd>
      </dl>
    

    <h4 id="mod_alias---url-aliasing" class="title-link" onMouseOver="document.getElementById('ghlink-mod_alias---url-aliasing-idm352').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-mod_alias---url-aliasing-idm352').style.visibility = 'hidden';">
<div class="title-name">mod_alias - URL Aliasing</div>
<div class="title-anchors"><span id="ghlink-mod_alias---url-aliasing-idm352" class="ghlink-after"><a href="#mod_alias---url-aliasing" title="Link to this place!"><span class="paperclip-after"></span></a><a href="https://github.com/erlang/otp/edit/maint/lib/inets/doc/src/http_server.xml#L357" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil-after"></span></a></span></div>
</h4>
      
      <p>The <span class="bold_code bc-19"><a href="../../man/mod_alias.html">mod_alias</a></span>
      module makes it possible to map different parts of the
	host file system into the document tree, that is, creates aliases and
	redirections.</p>
        <p>Exports the following Erlang Web Server API interaction data, if possible:
      </p>
      <dl>
	<dt><strong><span class="code">{real_name, PathData}</span></strong></dt>
	<dd>
<span class="code">PathData</span> is the argument used for API function 
	<span class="bold_code bc-15"><a href="../../man/mod_alias.html#path-3">mod_alias:path/3</a></span>.</dd>
      </dl>
    
    
    <h4 id="mod_auth---user-authentication" class="title-link" onMouseOver="document.getElementById('ghlink-mod_auth---user-authentication-idm363').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-mod_auth---user-authentication-idm363').style.visibility = 'hidden';">
<div class="title-name">mod_auth - User Authentication</div>
<div class="title-anchors"><span id="ghlink-mod_auth---user-authentication-idm363" class="ghlink-after"><a href="#mod_auth---user-authentication" title="Link to this place!"><span class="paperclip-after"></span></a><a href="https://github.com/erlang/otp/edit/maint/lib/inets/doc/src/http_server.xml#L372" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil-after"></span></a></span></div>
</h4>
      
        <p>The <span class="bold_code bc-19"><a href="../../man/mod_auth.html">mod_auth(3)</a></span> 
	module provides for basic user authentication using
	textual files, Dets databases as well as Mnesia databases.</p>
      <p>Uses the following Erlang Web Server API interaction data:
      </p>
      <ul>
	<li>
<span class="code">real_name</span> - from <span class="bold_code bc-19"><a href="../../man/mod_alias.html">mod_alias</a></span>
</li>
        </ul>
      <p>Exports the following Erlang Web Server API interaction data:
      </p>
      <dl>
	<dt><strong><span class="code">{remote_user, User}</span></strong></dt>
          <dd>The username used for authentication.</dd>
      </dl>
      
      
      <h5>Mnesia As Authentication Database</h5>
	
	
	<p>If Mnesia is used as storage method, Mnesia must be
	  started before the HTTP server. The first time Mnesia is
	  started, the schema and the tables must be created before
	  Mnesia is started. A simple example of a module with two
	  functions that creates and start Mnesia is provided
	  here. Function <span class="code">first_start/0</span> is to be used the first
	  time. It creates the schema and the tables.
	  <span class="code">start/0</span> is to be used in consecutive startups. 
	  <span class="code">start/0</span> starts Mnesia and waits for the tables to
	  be initiated. This function must only be used when the
	  schema and the tables are already created.</p>
	
	<div class="example example-none"><pre>-module(mnesia_test).
-export([start/0,load_data/0]).
-include_lib("mod_auth.hrl").

first_start() -&gt;
    mnesia:create_schema([node()]),
    mnesia:start(),
    mnesia:create_table(httpd_user,
                        [{type, bag},
                         {disc_copies, [node()]},
                         {attributes, record_info(fields, 
                                                  httpd_user)}]),
    mnesia:create_table(httpd_group,
                        [{type, bag},
                         {disc_copies, [node()]},          
                         {attributes, record_info(fields, 
                                                  httpd_group)}]),
    mnesia:wait_for_tables([httpd_user, httpd_group], 60000).

start() -&gt;
    mnesia:start(),
    mnesia:wait_for_tables([httpd_user, httpd_group], 60000).  </pre></div>
	
	<p>To create the Mnesia tables, we use two records defined in
	  <span class="code">mod_auth.hrl</span>, so that file must be included. <span class="code">first_start/0</span> 
	  creates a schema that specifies on which nodes the database is to reside. 
	  Then it starts Mnesia and creates the tables. The first argument
	  is the name of the tables, the second argument is a list of options of 
	  how to create the table, see 
	  <span class="bold_code bc-18"><a href="../../man/mnesia.html"><span class="code">mnesia(3)</span></a></span>, documentation for
	  more information. As the implementation of the <span class="code">mod_auth_mnesia</span> 
	  saves one row for each user, the type must be <span class="code">bag</span>.
	  When the schema and the tables are created, function
	  <span class="bold_code bc-13"><a href="../../man/mnesia.html#start-0">mnesia:start/0</a></span>
	  is used to start Mnesia  and
	  waits for the tables to be loaded. Mnesia uses the
	  directory specified as <span class="code">mnesia_dir</span> at startup if specified,
	  otherwise Mnesia uses the current directory. For security
	  reasons, ensure that the Mnesia tables are stored outside
	  the document tree of the HTTP server. If they are placed in the
	  directory which it protects, clients can download the tables. 
	  Only the Dets and Mnesia storage
	  methods allow writing of dynamic user data to disk. <span class="code">plain</span> is
	  a read only method.</p>
      

    
    
    <h4 id="mod_cgi---cgi-scripts" class="title-link" onMouseOver="document.getElementById('ghlink-mod_cgi---cgi-scripts-idm394').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-mod_cgi---cgi-scripts-idm394').style.visibility = 'hidden';">
<div class="title-name">mod_cgi - CGI Scripts</div>
<div class="title-anchors"><span id="ghlink-mod_cgi---cgi-scripts-idm394" class="ghlink-after"><a href="#mod_cgi---cgi-scripts" title="Link to this place!"><span class="paperclip-after"></span></a><a href="https://github.com/erlang/otp/edit/maint/lib/inets/doc/src/http_server.xml#L454" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil-after"></span></a></span></div>
</h4>
      
        <p>This module handles invoking of CGI scripts.</p>
    
    
    <h4 id="mod_dir---directories" class="title-link" onMouseOver="document.getElementById('ghlink-mod_dir---directories-idm397').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-mod_dir---directories-idm397').style.visibility = 'hidden';">
<div class="title-name">mod_dir - Directories</div>
<div class="title-anchors"><span id="ghlink-mod_dir---directories-idm397" class="ghlink-after"><a href="#mod_dir---directories" title="Link to this place!"><span class="paperclip-after"></span></a><a href="https://github.com/erlang/otp/edit/maint/lib/inets/doc/src/http_server.xml#L459" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil-after"></span></a></span></div>
</h4>
      
      <p>This module generates an HTML directory listing
	(Apache-style) if a client sends a request for a directory
	instead of a file. This module must be removed from the
	Modules config directive if directory listings is unwanted.</p>
      <p>Uses the following Erlang Web Server API interaction data:
      </p>
      <ul>
	<li>
<span class="code">real_name</span> - from <span class="bold_code bc-19"><a href="../../man/mod_alias.html">mod_alias</a></span>
</li>
      </ul>
      <p>Exports the following Erlang Web Server API interaction data:
      </p>
      <dl>
	<dt><strong><span class="code">{mime_type, MimeType}</span></strong></dt>
	<dd>The file suffix of the incoming URL mapped into a
          <span class="code">MimeType</span>.</dd>
        </dl>
      

    <h4 id="mod_disk_log---logging-using-disk_log." class="title-link" onMouseOver="document.getElementById('ghlink-mod_disk_log---logging-using-disk_log.-idm411').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-mod_disk_log---logging-using-disk_log.-idm411').style.visibility = 'hidden';">
<div class="title-name">mod_disk_log - Logging Using Disk_Log.</div>
<div class="title-anchors"><span id="ghlink-mod_disk_log---logging-using-disk_log.-idm411" class="ghlink-after"><a href="#mod_disk_log---logging-using-disk_log." title="Link to this place!"><span class="paperclip-after"></span></a><a href="https://github.com/erlang/otp/edit/maint/lib/inets/doc/src/http_server.xml#L479" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil-after"></span></a></span></div>
</h4>
      
        <p>Standard logging using the "Common Logfile Format" and
	<span class="bold_code bc-18"><a href="../../man/disk_log.html">disk_log(3)</a></span>.</p>
        <p>Uses the following Erlang Web Server API interaction data:
      </p>
        <ul>
	<li>
<span class="code">remote_user</span> - from <span class="code">mod_auth</span>
</li>
      </ul>
    

    <h4 id="mod_esi---erlang-server-interface" class="title-link" onMouseOver="document.getElementById('ghlink-mod_esi---erlang-server-interface-idm420').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-mod_esi---erlang-server-interface-idm420').style.visibility = 'hidden';">
<div class="title-name">mod_esi - Erlang Server Interface</div>
<div class="title-anchors"><span id="ghlink-mod_esi---erlang-server-interface-idm420" class="ghlink-after"><a href="#mod_esi---erlang-server-interface" title="Link to this place!"><span class="paperclip-after"></span></a><a href="https://github.com/erlang/otp/edit/maint/lib/inets/doc/src/http_server.xml#L490" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil-after"></span></a></span></div>
</h4>
      
      <p>The <span class="bold_code bc-19"><a href="../../man/mod_esi.html">mod_esi(3)</a></span>
      module implements the Erlang Server Interface (ESI) providing a 
      tight and efficient interface to the execution of Erlang functions.</p>
      <p>Uses the following Erlang web server API interaction data:
      </p>
      <ul>
	<li>
<span class="code">remote_user</span> - from <span class="code">mod_auth</span>
</li>
      </ul>
      <p>Exports the following Erlang web server API interaction data:
          </p>
      <dl>
	<dt><strong><span class="code">{mime_type, MimeType}</span></strong></dt>
	<dd>The file suffix of the incoming URL mapped into a
          <span class="code">MimeType</span>
</dd>
        </dl>
      
    
      <h4 id="mod_get---regular-get-requests" class="title-link" onMouseOver="document.getElementById('ghlink-mod_get---regular-get-requests-idm435').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-mod_get---regular-get-requests-idm435').style.visibility = 'hidden';">
<div class="title-name">mod_get - Regular GET Requests</div>
<div class="title-anchors"><span id="ghlink-mod_get---regular-get-requests-idm435" class="ghlink-after"><a href="#mod_get---regular-get-requests" title="Link to this place!"><span class="paperclip-after"></span></a><a href="https://github.com/erlang/otp/edit/maint/lib/inets/doc/src/http_server.xml#L509" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil-after"></span></a></span></div>
</h4>
      
      <p>This module is responsible for handling GET requests to regular 
	files. GET requests for parts of files is handled by <span class="code">mod_range</span>.</p>
        <p>Uses the following Erlang web server API interaction data:
      </p>
      <ul>
          <li>
<span class="code">real_name</span> - from <span class="bold_code bc-19"><a href="../../man/mod_alias.html">mod_alias</a></span>
</li>
      </ul>
      
    
    <h4 id="mod_head---regular-head-requests" class="title-link" onMouseOver="document.getElementById('ghlink-mod_head---regular-head-requests-idm444').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-mod_head---regular-head-requests-idm444').style.visibility = 'hidden';">
<div class="title-name">mod_head - Regular HEAD Requests</div>
<div class="title-anchors"><span id="ghlink-mod_head---regular-head-requests-idm444" class="ghlink-after"><a href="#mod_head---regular-head-requests" title="Link to this place!"><span class="paperclip-after"></span></a><a href="https://github.com/erlang/otp/edit/maint/lib/inets/doc/src/http_server.xml#L520" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil-after"></span></a></span></div>
</h4>
      
        <p>This module is responsible for handling HEAD requests to regular 
	files. HEAD requests for dynamic content is handled by each module 
	responsible for dynamic content.</p>
        <p>Uses the following Erlang Web Server API interaction data:
      </p>
      <ul>
	<li>
<span class="code">real_name</span> - from <span class="bold_code bc-19"><a href="../../man/mod_alias.html">mod_alias</a></span>
</li>
        </ul>
    
        
    
    <h4 id="mod_log---logging-using-text-files." class="title-link" onMouseOver="document.getElementById('ghlink-mod_log---logging-using-text-files.-idm452').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-mod_log---logging-using-text-files.-idm452').style.visibility = 'hidden';">
<div class="title-name">mod_log - Logging Using Text Files.</div>
<div class="title-anchors"><span id="ghlink-mod_log---logging-using-text-files.-idm452" class="ghlink-after"><a href="#mod_log---logging-using-text-files." title="Link to this place!"><span class="paperclip-after"></span></a><a href="https://github.com/erlang/otp/edit/maint/lib/inets/doc/src/http_server.xml#L533" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil-after"></span></a></span></div>
</h4>
      
      <p>Standard logging using the "Common Logfile Format" and text
	files.</p>
        <p>Uses the following Erlang Web Server API interaction data:
      </p>
      <ul>
	<li>
<span class="code">remote_user</span> - from <span class="code">mod_auth</span>
</li>
        </ul>
    
    
      <h4 id="mod_range---requests-with-range-headers" class="title-link" onMouseOver="document.getElementById('ghlink-mod_range---requests-with-range-headers-idm460').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-mod_range---requests-with-range-headers-idm460').style.visibility = 'hidden';">
<div class="title-name">mod_range - Requests with Range Headers</div>
<div class="title-anchors"><span id="ghlink-mod_range---requests-with-range-headers-idm460" class="ghlink-after"><a href="#mod_range---requests-with-range-headers" title="Link to this place!"><span class="paperclip-after"></span></a><a href="https://github.com/erlang/otp/edit/maint/lib/inets/doc/src/http_server.xml#L544" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil-after"></span></a></span></div>
</h4>
      
      <p>This module responses to requests for one or many ranges of a
	file. This is especially useful when downloading large files,
	as a broken download can be resumed.</p>
      <p>Notice that request for multiple parts of a document report a
	size of zero to the log file.</p>
        <p>Uses the following Erlang Web Server API interaction data:
      </p>
      <ul>
	<li>
<span class="code">real_name</span> - from <span class="bold_code bc-19"><a href="../../man/mod_alias.html">mod_alias</a></span>
</li>
      </ul>
    

    <h4 id="mod_response_control---requests-with-if*-headers" class="title-link" onMouseOver="document.getElementById('ghlink-mod_response_control---requests-with-if*-headers-idm469').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-mod_response_control---requests-with-if*-headers-idm469').style.visibility = 'hidden';">
<div class="title-name">mod_response_control - Requests with If* Headers</div>
<div class="title-anchors"><span id="ghlink-mod_response_control---requests-with-if*-headers-idm469" class="ghlink-after"><a href="#mod_response_control---requests-with-if*-headers" title="Link to this place!"><span class="paperclip-after"></span></a><a href="https://github.com/erlang/otp/edit/maint/lib/inets/doc/src/http_server.xml#L558" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil-after"></span></a></span></div>
</h4>
      
      <p>This module controls that the conditions in the requests are
	fulfilled. For example, a request can specify that the answer
	only is of interest if the content is unchanged since the last
	retrieval. If the content is changed, the range request is to
	be converted to a request for the whole file instead.</p> 
	<p>If a client sends more than one of the header fields that 
	restricts the servers right to respond, the standard does not 
	specify how this is to be handled.
	<span class="bold_code bc-19"><a href="../../man/httpd.html">httpd(3)</a></span> controls each 
	field in the following order and if one of the fields does not 
	match the current state, the request is rejected with a proper 
	response:</p>
	<p><span class="code">If-modified</span></p>
	<p><span class="code">If-Unmodified</span></p>
	<p><span class="code">If-Match</span></p>
	<p><span class="code">If-Nomatch</span></p>
	
      <p>Uses the following Erlang Web Server API interaction data:
      </p>
      <ul>
	<li>
<span class="code">real_name</span> - from  <span class="bold_code bc-19"><a href="../../man/mod_alias.html">mod_alias</a></span>
</li>
      </ul>
      <p>Exports the following Erlang Web Server API interaction data:
      </p>
      <dl>
	<dt><strong><span class="code">{if_range, send_file}</span></strong></dt>
	<dd>The conditions for the range request are not fulfilled.
	  The response must not be treated as a range request, instead it
	  must be treated as an ordinary get request.</dd>
        </dl>
    
    
    <h4 id="mod_security---security-filter" class="title-link" onMouseOver="document.getElementById('ghlink-mod_security---security-filter-idm492').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-mod_security---security-filter-idm492').style.visibility = 'hidden';">
<div class="title-name">mod_security - Security Filter</div>
<div class="title-anchors"><span id="ghlink-mod_security---security-filter-idm492" class="ghlink-after"><a href="#mod_security---security-filter" title="Link to this place!"><span class="paperclip-after"></span></a><a href="https://github.com/erlang/otp/edit/maint/lib/inets/doc/src/http_server.xml#L592" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil-after"></span></a></span></div>
</h4>
      
        <p>The <span class="bold_code bc-19"><a href="../../man/mod_security.html">mod_security</a></span> 
	module serves as a filter for authenticated requests
	handled in <span class="bold_code bc-19"><a href="../../man/mod_auth.html">mod_auth(3)</a></span>. 
	It provides a possibility to restrict users from 
	access for a specified amount of time if they fail to
	authenticate several times. It logs failed authentication as
	well as blocking of users, and it calls a configurable
	callback module when the events occur.</p>
      <p>There is also an
	API to block or unblock users manually. This API can also list 
	blocked users or users who have been authenticated within a 
	configurable amount of time.</p>
    
    
    <h4 id="mod_trace---trace-request" class="title-link" onMouseOver="document.getElementById('ghlink-mod_trace---trace-request-idm498').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-mod_trace---trace-request-idm498').style.visibility = 'hidden';">
<div class="title-name">mod_trace - TRACE Request</div>
<div class="title-anchors"><span id="ghlink-mod_trace---trace-request-idm498" class="ghlink-after"><a href="#mod_trace---trace-request" title="Link to this place!"><span class="paperclip-after"></span></a><a href="https://github.com/erlang/otp/edit/maint/lib/inets/doc/src/http_server.xml#L608" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil-after"></span></a></span></div>
</h4>
      
      <p><span class="code">mod_trace</span> is responsible for handling of TRACE requests.
	Trace is a new request method in HTTP/1.1. The intended use of
	trace requests is for testing. The body of the trace response is
	the request message that the responding web server or proxy
	received.</p>
    
  
</div>
<div class="footer">
<hr>
<p>Copyright © 1997-2021 Ericsson AB. All Rights Reserved.</p>
</div>
</div>
</div>
<script type="text/javascript">window.__otpTopDocDir = '../../js/';</script><script type="text/javascript" src="../../js/highlight.js"></script>
<script src="/assets/js/doc-search.bundle.js"></script>
</body>
</html>
