<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.38.1">
    <meta name="project" content="stdlib v7.1">


<meta name="major-vsn" content="28">
<meta name="exdoc:full-text-search-url" content="/doc/search.html?v=28&q=">
<link rel="canonical" href="https://www.erlang.org/doc/apps/stdlib/re_incompat.html" />
    <title>PCRE2 Migration — stdlib v7.1</title>

    <link rel="stylesheet" href="dist/html-erlang-ZK43ZOAC.css" />

    <script defer src="dist/sidebar_items-296BF65E.js"></script>
    <script defer src="docs_config.js"></script>
    <script defer src="dist/html-DPJLHKSM.js"></script>

  </head>
  <body>
    <script>(()=>{var t="ex_doc:settings",e="dark";var o="dark",s="light";var E="sidebar_state",n="closed";var r="sidebar_width";var a="sidebar-open";var i=new URLSearchParams(window.location.search),S=i.get("theme")||JSON.parse(localStorage.getItem(t)||"{}").theme;(S===o||S!==s&&window.matchMedia("(prefers-color-scheme: dark)").matches)&&document.body.classList.add(e);var d=sessionStorage.getItem(E),A=d!==n&&!window.matchMedia(`screen and (max-width: ${768}px)`).matches;document.body.classList.toggle(a,A);var c=sessionStorage.getItem(r);c&&document.body.style.setProperty("--sidebarWidth",`${c}px`);var p=/(Macintosh|iPhone|iPad|iPod)/.test(window.navigator.userAgent);document.documentElement.classList.toggle("apple-os",p);})();
</script>

<div class="body-wrapper">

<button id="sidebar-menu" class="sidebar-button sidebar-toggle" aria-label="toggle sidebar" aria-controls="sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<nav id="sidebar" class="sidebar">

  <div class="sidebar-header">
    <div class="sidebar-projectInfo">

        <a href="../../index.html" class="sidebar-projectImage">
          <img src="assets/logo.png" alt="stdlib" />
        </a>

      <div>
        <a href="../../index.html" class="sidebar-projectName" translate="no">
stdlib
        </a>
        <div class="sidebar-projectVersion" translate="no">
          v7.1
        </div>
      </div>
    </div>
    <ul id="sidebar-list-nav" class="sidebar-list-nav" role="tablist" data-extras=""></ul>
  </div>
</nav>

<output role="status" id="toast"></output>

<main class="content page-extra" id="main" data-type="extras">
  <div id="content" class="content-inner">
    <div class="top-search">
      <div class="search-settings">
        <form class="search-bar" action="search.html">
          <label class="search-label">
            <span class="sr-only">Search documentation of stdlib</span>
            <input name="q" type="text" class="search-input" placeholder="Press / to search" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
          </label>
          <button type="submit" class="search-button" aria-label="Submit Search" tabindex="-1">
            <i class="ri-search-2-line ri-lg" aria-hidden="true"></i>
          </button>
          <button type="button" tabindex="-1" class="search-close-button" aria-hidden="true">
            <i class="ri-close-line ri-lg" title="Cancel search"></i>
          </button>
        </form>
        <div class="autocomplete">
        </div>
        <button class="icon-settings display-settings">
          <i class="ri-settings-3-line"></i>
          <span class="sr-only">Settings</span>
        </button>
      </div>
    </div>

<div id="top-content">
  <div class="heading-with-actions top-heading">
    <h1>PCRE2 Migration</h1>


      <a href="https://github.com/erlang/otp/blob/OTP-28.2/lib/stdlib/doc/guides/re_incompat.md#L1" title="View Source" class="icon-action" rel="help">
        <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        <span class="sr-only">View Source</span>
      </a>

  </div>


<p>Starting with Erlang/OTP 28, the underlying library for handling regular expressions via the <code class="inline">re</code>
module changes from PCRE to PCRE2. This upgrade brings Erlang's regular expression capabilities
more in line with modern standards, particularly Perl, but also introduces several breaking
changes and differences in behavior compared to PCRE.</p><p>A key philosophical difference is that <strong>PCRE2 is much stricter about pattern syntax</strong>. Invalid
constructs that PCRE might have ignored or treated as literal characters will now typically raise
compilation errors, similar to using Perl in strict mode.</p><p>Below is a summary of notable incompatibilities and behavioral changes:</p><h2 id="stricter-error-handling-syntax-validation" class="section-heading"><a href="#stricter-error-handling-syntax-validation" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Stricter Error Handling &amp; Syntax Validation</span></h2><ul><li><strong>Invalid Escapes:</strong> Undocumented escape sequences (for example, <code class="inline">\M</code>, <code class="inline">\i</code>) are now treated
as errors. PCRE often treated these as literal characters (for example, <code class="inline">\M</code> became <code class="inline">M</code>).</li><li><strong>Invalid Escapes in Character Classes:</strong> Using sequences that are not valid <em>within</em> a
character class (for example, anchors like <code class="inline">\B</code>, sequences like <code class="inline">\R</code> or <code class="inline">\X</code>) is now an error
(for example, <code class="inline">[\B]</code>). PCRE might have treated these literally.</li><li><strong>Invalid Character Ranges:</strong> Ranges where the start point is logically after the end point,
or involving incompatible types (for example, <code class="inline">[\d-a]</code>), are now errors. PCRE might have
interpreted this as matching a digit, a hyphen, or 'a' literally.</li><li><strong>Invalid Backreferences:</strong> Using a backreference to a non-existent capturing group (for
example, <code class="inline">\8</code> when only 7 groups exist) is now treated as an error.</li><li><strong>Invalid Control Characters (<code class="inline">\cx</code>):</strong> The <code class="inline">\c</code> escape must be followed by a character that
maps to a valid control character (typically ASCII characters <code class="inline">@</code> through <code class="inline">_</code>, corresponding to
<code class="inline">\x00</code> through <code class="inline">\x1F</code>, and <code class="inline">?</code> for <code class="inline">\x7F</code>). Using characters in the range 127-255 will result
in an error.</li></ul><h2 id="syntax-changes-requirements" class="section-heading"><a href="#syntax-changes-requirements" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Syntax Changes &amp; Requirements</span></h2><ul><li><strong><code class="inline">\x</code> Requires Hex Digits:</strong> The <code class="inline">\x</code> escape now <em>must</em> be followed by hexadecimal digits.
Use <code class="inline">\xNN</code> (one or two digits) or <code class="inline">\x{HHHH}</code> (variable number of digits in braces). Using <code class="inline">\x</code>
alone is an error.</li><li><strong><code class="inline">\N</code> (Match Non-Newline) in Character Classes:</strong> The shorthand <code class="inline">\N</code> is not allowed directly
within a character class (for example, <code class="inline">[\N]</code> is invalid). However, the named Unicode sequence
<code class="inline">\N{U+...}</code> <em>is</em> allowed (for example, <code class="inline">[\N{U+0041}]</code> to match 'A').</li><li><strong>Empty Group Names:</strong> Defining capturing groups with empty names using <code class="inline">(?''...)</code> syntax is
no longer supported and will cause an error.</li></ul><h2 id="option-handling" class="section-heading"><a href="#option-handling" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Option Handling</span></h2><ul><li><strong>Compile-Time vs. Run-Time Options:</strong> Options affecting newline conventions (<code class="inline">{newline, _}</code>)
or backslash R behavior (<code class="inline">bsr_anycrlf</code>, <code class="inline">bsr_unicode</code>) only control pattern <em>compilation</em>.
If a pattern is pre-compiled using <a href="re.html#compile/2"><code class="inline">re:compile/2</code></a>, passing incompatible options for these
settings later to <a href="re.html#run/3"><code class="inline">re:run/3</code></a>, <a href="re.html#replace/4"><code class="inline">re:replace/4</code></a>, or <a href="re.html#split/3"><code class="inline">re:split/3</code></a> will result in an error.
If present, the options must match those used at compile time.</li></ul><h2 id="behavioral-changes-feature-restrictions" class="section-heading"><a href="#behavioral-changes-feature-restrictions" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Behavioral Changes &amp; Feature Restrictions</span></h2><ul><li><strong><code class="inline">\K</code> in Lookarounds:</strong> The <code class="inline">\K</code> escape (reset match start) cannot be used inside lookahead
<code class="inline">(?=...)</code>, <code class="inline">(?!...)</code> or lookbehind <code class="inline">(?&lt;=...)</code>, <code class="inline">(?&lt;!...)</code> assertions.</li><li><strong><code class="inline">\K</code> in global match:</strong> does no longer produce a duplicate match.</li><li><strong><code class="inline">(*COMMIT)</code> with <code class="inline">no_start_optimize</code>:</strong> The interaction between the <code class="inline">(*COMMIT)</code> verb and
the <code class="inline">no_start_optimize</code> option may lead to different behavior than might be expected based on
previous versions or other regex engines. Careful testing is advised if using this combination.</li><li><strong><a href="re.html#split/3"><code class="inline">re:split/3</code></a> with Branch Reset Groups (<code class="inline">(?|...)</code>):</strong> The behavior of <a href="re.html#split/3"><code class="inline">re:split/3</code></a> when using
branch reset groups combined with backreferences within the pattern may differ from PCRE and
potentially current Perl versions.<ul><li><em>Example:</em> For <code class="inline">re:split(&quot;abcabc&quot;, &quot;(?|(abc)|(xyz))\\1&quot;, [{return, list}])</code>:<ul><li>PCRE2 (OTP 28) returns: <code class="inline">[&quot;&quot;, &quot;abc&quot;, &quot;&quot;]</code></li><li>Some interpretations might expect <code class="inline">[&quot;&quot;, &quot;abc&quot;, &quot;&quot;, &quot;&quot;]</code> (empty binary instead of
<code class="inline">undef</code> for the non-participating capture group within the split context). Reference:
<a href="https://github.com/Perl/perl5/issues/22912">Perl Issue #22912</a></li></ul></li></ul></li><li><strong>Default Handling of Bytes 128-255 Changed:</strong> In OTP 28, when the
<code class="inline">unicode</code> option is not used, character properties <code class="inline">\w</code>, <code class="inline">\s</code>, and so on, and option <code class="inline">caseless</code>
now operate strictly under ASCII rules (bytes 0-127 only). That means that <code class="inline">\w</code> will not match
latin-1 locale characters such as <code class="inline">åäö</code>.</li></ul><h2 id="unicode-property-updates-p-p" class="section-heading"><a href="#unicode-property-updates-p-p" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Unicode Property Updates (<code class="inline">\p{...}</code>, <code class="inline">\P{...}</code>)</span></h2><p>PCRE2 uses updated Unicode character property data. This means the set of characters matched by
properties like <code class="inline">\p{L}</code> (Letter), <code class="inline">\p{N}</code> (Number), script names (<code class="inline">\p{Arabic}</code>), etc., may have
changed slightly. Specific examples noted:</p><ul><li><code class="inline">\p{Lo}</code> (Letter, Other) now includes characters like <code class="inline">U+4DB6</code>.</li><li><code class="inline">\p{Arabic}</code> script now includes <code class="inline">U+061C</code> (Arabic Letter Mark) and formatting characters
<code class="inline">U+0650</code> - <code class="inline">U+0655</code>.</li><li><code class="inline">\p{Common}</code> script (characters used across multiple scripts) no longer includes <code class="inline">U+0589</code>
(Armenian Full Stop). <em>(Verify character if critical)</em>.</li></ul><h2 id="erlang-specific-changes" class="section-heading"><a href="#erlang-specific-changes" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Erlang-Specific Changes</span></h2><ul><li><strong>Compiled Patterns Should Not be Shared:</strong> Sharing the result of re:compile/2 across node
boundaries or persisting it has never been officially supported, although it might have
accidentally worked between certain previous versions. The internal format produced by
<a href="re.html#compile/2"><code class="inline">re:compile/2</code></a> has changed, and will not work on older OTP versions or across nodes. Relying
on this undocumented behavior must be changed to compile the regular expression on the node
instance where it is intended to be used.</li></ul>

</div>

<div class="bottom-actions" id="bottom-actions">
  <div class="bottom-actions-item">

      <a href="uri_string_usage.html" class="bottom-actions-button" rel="prev">
        <span class="subheader">
          ← Previous Page
        </span>
        <span class="title">
Uniform Resource Identifiers
        </span>
      </a>

  </div>
  <div class="bottom-actions-item">

      <a href="assert_hrl.html" class="bottom-actions-button" rel="next">
        <span class="subheader">
          Next Page →
        </span>
        <span class="title">
assert.hrl
        </span>
      </a>

  </div>
</div>
    <footer class="footer">
      <p>

        <span class="line">
          <button class="a-main footer-button display-quick-switch" title="Search HexDocs packages">
            Search HexDocs
          </button>

            <a href="stdlib.epub" title="ePub version">
              Download ePub version
            </a>

        </span>
      </p>

      <p class="built-using">
        Built using
        <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.38.1) for the

          <a href="https://erlang.org" title="Erlang" target="_blank" translate="no">Erlang programming language</a>

      </p>
<p>Copyright © 1996-2025 <a href="https://www.ericsson.com">Ericsson AB</a></p>
    </footer>
  </div>
</main>
</div>
  <script defer src="https://cdn.jsdelivr.net/npm/mermaid@11.4.1/dist/mermaid.min.js"></script>
  <script>
  let initialized = false;

  window.addEventListener("exdoc:loaded", () => {
      if (!initialized) {
      mermaid.initialize({
          startOnLoad: false,
          theme: document.body.className.includes("dark") ? "dark" : "default"
      });
      initialized = true;
      }

      let id = 0;
      for (const codeEl of document.querySelectorAll("pre code.mermaid")) {
      const preEl = codeEl.parentElement;
      const graphDefinition = codeEl.textContent;
      const graphEl = document.createElement("div");
      const graphId = "mermaid-graph-" + id++;
      mermaid.render(graphId, graphDefinition).then(({svg, bindFunctions}) => {
          graphEl.innerHTML = svg;
          bindFunctions?.(graphEl);
          preEl.insertAdjacentElement("afterend", graphEl);
          preEl.remove();
      });
      }
  });
  </script>

  </body>
</html>
