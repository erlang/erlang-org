<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.38.1">
    <meta name="project" content="ssl v11.3.1">


<meta name="exdoc:full-text-search-url" content="/doc/search.html?v=28&q=">
<meta name="major-vsn" content="28">
<link rel="canonical" href="https://www.erlang.org/doc/apps/ssl/ssl.html" />
    <title>ssl â€” ssl v11.3.1</title>

    <link rel="stylesheet" href="dist/html-erlang-ZK43ZOAC.css" />

    <script defer src="dist/sidebar_items-1EEA4FD7.js"></script>
    <script defer src="docs_config.js"></script>
    <script defer src="dist/html-DPJLHKSM.js"></script>

  </head>
  <body>
    <script>(()=>{var t="ex_doc:settings",e="dark";var o="dark",s="light";var E="sidebar_state",n="closed";var r="sidebar_width";var a="sidebar-open";var i=new URLSearchParams(window.location.search),S=i.get("theme")||JSON.parse(localStorage.getItem(t)||"{}").theme;(S===o||S!==s&&window.matchMedia("(prefers-color-scheme: dark)").matches)&&document.body.classList.add(e);var d=sessionStorage.getItem(E),A=d!==n&&!window.matchMedia(`screen and (max-width: ${768}px)`).matches;document.body.classList.toggle(a,A);var c=sessionStorage.getItem(r);c&&document.body.style.setProperty("--sidebarWidth",`${c}px`);var p=/(Macintosh|iPhone|iPad|iPod)/.test(window.navigator.userAgent);document.documentElement.classList.toggle("apple-os",p);})();
</script>

<div class="body-wrapper">

<button id="sidebar-menu" class="sidebar-button sidebar-toggle" aria-label="toggle sidebar" aria-controls="sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<nav id="sidebar" class="sidebar">

  <div class="sidebar-header">
    <div class="sidebar-projectInfo">

        <a href="../../index.html" class="sidebar-projectImage">
          <img src="assets/logo.png" alt="ssl" />
        </a>

      <div>
        <a href="../../index.html" class="sidebar-projectName" translate="no">
ssl
        </a>
        <div class="sidebar-projectVersion" translate="no">
          v11.3.1
        </div>
      </div>
    </div>
    <ul id="sidebar-list-nav" class="sidebar-list-nav" role="tablist" data-extras=""></ul>
  </div>
</nav>

<output role="status" id="toast"></output>

<main class="content page-module" id="main" data-type="modules">
  <div id="content" class="content-inner">
    <div class="top-search">
      <div class="search-settings">
        <form class="search-bar" action="search.html">
          <label class="search-label">
            <span class="sr-only">Search documentation of ssl</span>
            <input name="q" type="text" class="search-input" placeholder="Press / to search" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
          </label>
          <button type="submit" class="search-button" aria-label="Submit Search" tabindex="-1">
            <i class="ri-search-2-line ri-lg" aria-hidden="true"></i>
          </button>
          <button type="button" tabindex="-1" class="search-close-button" aria-hidden="true">
            <i class="ri-close-line ri-lg" title="Cancel search"></i>
          </button>
        </form>
        <div class="autocomplete">
        </div>
        <button class="icon-settings display-settings">
          <i class="ri-settings-3-line"></i>
          <span class="sr-only">Settings</span>
        </button>
      </div>
    </div>

<div id="top-content">
  <div class="heading-with-actions top-heading">
    <h1>
      <span translate="no">ssl</span> 
      <small class="app-vsn" translate="no">(ssl v11.3.1)</small>

    </h1>

      <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L28" title="View Source" class="icon-action" rel="help">
        <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        <span class="sr-only">View Source</span>
      </a>

  </div>


    <section id="moduledoc">
<p>Interface functions for TLS (Transport Layer Security)
and DTLS (Datagram Transport Layer Security).</p><section role="note" class="admonition info"><h4 class="admonition-title info">Note</h4><p>The application's name is still SSL because the first versions of the
TLS protocol were named SSL (Secure Socket Layer). However, no version
of the old SSL protocol is supported by this application.</p></section><p>Example:</p><pre><code class="makeup erlang" translate="no"><span class="gp unselectable">1&gt; </span><span class="nc">ssl</span><span class="p">:</span><span class="nf">start</span><span class="p" data-group-id="4664399529-1">(</span><span class="p" data-group-id="4664399529-1">)</span><span class="p">,</span><span class="w"> </span><span class="nc">ssl</span><span class="p">:</span><span class="nf">connect</span><span class="p" data-group-id="4664399529-2">(</span><span class="s">&quot;google.com&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">443</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="4664399529-3">[</span><span class="p" data-group-id="4664399529-4">{</span><span class="ss">verify</span><span class="p">,</span><span class="w"> </span><span class="ss">verify_peer</span><span class="p" data-group-id="4664399529-4">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="4664399529-5">{</span><span class="ss">cacerts</span><span class="p">,</span><span class="w"> </span><span class="nc">public_key</span><span class="p">:</span><span class="nf">cacerts_get</span><span class="p" data-group-id="4664399529-6">(</span><span class="p" data-group-id="4664399529-6">)</span><span class="p" data-group-id="4664399529-5">}</span><span class="p" data-group-id="4664399529-3">]</span><span class="p" data-group-id="4664399529-2">)</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="4664399529-7">{</span><span class="ss">ok</span><span class="p">,</span><span class="p" data-group-id="4664399529-8">{</span><span class="ss">sslsocket</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="4664399529-9">[</span><span class="p">.</span><span class="p">.</span><span class="p">.</span><span class="p" data-group-id="4664399529-9">]</span><span class="p" data-group-id="4664399529-8">}</span><span class="p" data-group-id="4664399529-7">}</span></code></pre><p>See <a href="using_ssl.html">Examples</a> for detailed usage and more examples of
this API.</p><p>Special Erlang node configuration for the application can be found in
<a href="ssl_app.html">SSL Application</a>.</p>
    </section>

</div>

  <section id="summary" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#summary">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Summary</span>
    </h1>
<div class="summary-types-algorithms summary">
  <h2>
    <a href="#types-algorithms">Types: Algorithms</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:cipher/0" data-no-tooltip="" translate="no">cipher()</a>

      </div>

        <div class="summary-synopsis"><p>Cipher algorithms that can be used for payload encryption.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:cipher_filters/0" data-no-tooltip="" translate="no">cipher_filters()</a>

      </div>

        <div class="summary-synopsis"><p>Filter that allows you to customize cipher suite list.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:cipher_suites/0" data-no-tooltip="" translate="no">cipher_suites()</a>

      </div>

        <div class="summary-synopsis"><p>A list of cipher suites that should be supported.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:ciphers/0" data-no-tooltip="" translate="no">ciphers()</a>

      </div>

        <div class="summary-synopsis"><p>Cipher suite formats.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:erl_cipher_suite/0" data-no-tooltip="" translate="no">erl_cipher_suite()</a>

      </div>

        <div class="summary-synopsis"><p>Erlang cipher suite representation</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:group/0" data-no-tooltip="" translate="no">group()</a>

      </div>

        <div class="summary-synopsis"><p>TLS-1.3 key exchange configuration.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:hash/0" data-no-tooltip="" translate="no">hash()</a>

      </div>

        <div class="summary-synopsis"><p>Hash algorithms used together with signing and encryption functions.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:kex_algo/0" data-no-tooltip="" translate="no">kex_algo()</a>

      </div>

        <div class="summary-synopsis"><p>Cipher Suite Key Exchange Algorithm will be <code class="inline">any</code>
in TLS-1.3 as key exchange is no longer part of cipher suite
configuration in TLS-1.3.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:named_curve/0" data-no-tooltip="" translate="no">named_curve()</a>

      </div>

        <div class="summary-synopsis"><p>Key exchange configuration prior to TLS-1.3.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:rsassa_pss_scheme/0" data-no-tooltip="" translate="no">rsassa_pss_scheme()</a>

      </div>

        <div class="summary-synopsis"><p>Supported in TLS-1.3 and TLS-1.2.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:sha2/0" data-no-tooltip="" translate="no">sha2()</a>

      </div>

        <div class="summary-synopsis"><p>SHA2 hash algorithms.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:sign_algo/0" data-no-tooltip="" translate="no">sign_algo()</a>

      </div>

        <div class="summary-synopsis"><p>Signature algorithms.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:sign_scheme/0" data-no-tooltip="" translate="no">sign_scheme()</a>

      </div>

        <div class="summary-synopsis"><p>Signature schemes, defined by TLS-1.3, and replacing signature algorithms from TLS-1.2.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:signature_algs/0" data-no-tooltip="" translate="no">signature_algs()</a>

      </div>

        <div class="summary-synopsis"><p>Explicitly list acceptable signature algorithms for certificates and handshake
messages in the preferred order.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:srp_param_type/0" data-no-tooltip="" translate="no">srp_param_type()</a>

      </div>

        <div class="summary-synopsis"><p>SRP cipher suite configuration prior to TLS-1.3.</p></div>

    </div>

</div>
<div class="summary-types-algorithms-legacy summary">
  <h2>
    <a href="#types-algorithms-legacy">Types: Algorithms Legacy</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:legacy_cipher/0" data-no-tooltip="" translate="no">legacy_cipher()</a>

      </div>

        <div class="summary-synopsis"><p>Cipher algorithms that are no longer supported by default for security reasons.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:legacy_hash/0" data-no-tooltip="" translate="no">legacy_hash()</a>

      </div>

        <div class="summary-synopsis"><p>Hash algorithms that are no longer supported by default for security reasons.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:legacy_named_curve/0" data-no-tooltip="" translate="no">legacy_named_curve()</a>

      </div>

        <div class="summary-synopsis"><p>Key exchange configuration prior to TLS-1.3.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:legacy_sign_algo/0" data-no-tooltip="" translate="no">legacy_sign_algo()</a>

      </div>

        <div class="summary-synopsis"><p>Signature algorithms that are no longer supported by default for security reasons.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:legacy_sign_scheme/0" data-no-tooltip="" translate="no">legacy_sign_scheme()</a>

      </div>

        <div class="summary-synopsis"><p>This is only used for certificate signatures if TLS-1.2 is negotiated,
meaning that the peer only supports TLS-1.2, but we also support
TLS-1.3.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:old_cipher_suite/0" data-no-tooltip="" translate="no">old_cipher_suite()</a>

      </div>

        <div class="summary-synopsis"><p>For backwards compatibility only; do not use.</p></div>

    </div>

</div>
<div class="summary-types-certificates summary">
  <h2>
    <a href="#types-certificates">Types: Certificates</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:anchor_fun/0" data-no-tooltip="" translate="no">anchor_fun()</a>

      </div>

        <div class="summary-synopsis"><p>Claim an intermediate CA in the chain as trusted.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:cert_key_conf/0" data-no-tooltip="" translate="no">cert_key_conf()</a>

      </div>

        <div class="summary-synopsis"><p>Configuration of the entity certificate and its corresponding key.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:crl_cache_opts/0" data-no-tooltip="" translate="no">crl_cache_opts()</a>

      </div>

        <div class="summary-synopsis"><p>Options for using built-in CRL cache support.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:key/0" data-no-tooltip="" translate="no">key()</a>

      </div>

        <div class="summary-synopsis"><p>The user's private key.</p></div>

    </div>

</div>
<div class="summary-types-client-options summary">
  <h2>
    <a href="#types-client-options">Types: Client Options</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:client_option/0" data-no-tooltip="" translate="no">client_option()</a>

      </div>

        <div class="summary-synopsis"><p>The following options are specific to the client side, or have
different semantics for the client and server</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:client_option_cert/0" data-no-tooltip="" translate="no">client_option_cert()</a>

      </div>

        <div class="summary-synopsis"><p>Certificate-related options specific to the client side, or with
different semantics for the client and server.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:client_option_legacy/0" data-no-tooltip="" translate="no">client_option_legacy()</a>

      </div>

        <div class="summary-synopsis"><p>Legacy client options.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:client_option_pre_tls13/0" data-no-tooltip="" translate="no">client_option_pre_tls13()</a>

      </div>

        <div class="summary-synopsis"><p>Options only relevant to TLS versions prior to TLS-1.3.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:client_option_tls13/0" data-no-tooltip="" translate="no">client_option_tls13()</a>

      </div>

        <div class="summary-synopsis"><p>Options only relevant for TLS-1.3.</p></div>

    </div>

</div>
<div class="summary-types-client-and-server-options summary">
  <h2>
    <a href="#types-client-and-server-options">Types: Client and Server Options</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:common_option/0" data-no-tooltip="" translate="no">common_option()</a>

      </div>

        <div class="summary-synopsis"><p>Options common to both client and server side.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:common_option_cert/0" data-no-tooltip="" translate="no">common_option_cert()</a>

      </div>

        <div class="summary-synopsis"><p>Common certificate related options to both client and server.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:common_option_dtls/0" data-no-tooltip="" translate="no">common_option_dtls()</a>

      </div>

        <div class="summary-synopsis"><p>Common options to client and server only valid for DTLS.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:common_option_legacy/0" data-no-tooltip="" translate="no">common_option_legacy()</a>

      </div>

        <div class="summary-synopsis"><p>Legacy options considered deprecated in favor of other options,
insecure to use, or plainly not relevant anymore.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:common_option_pre_tls13/0" data-no-tooltip="" translate="no">common_option_pre_tls13()</a>

      </div>

        <div class="summary-synopsis"><p>Options common to client and server side prior to TLS-1.3.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:common_option_tls13/0" data-no-tooltip="" translate="no">common_option_tls13()</a>

      </div>

        <div class="summary-synopsis"><p>Common options to both client and server for TLS-1.3.</p></div>

    </div>

</div>
<div class="summary-types-deprecated summary">
  <h2>
    <a href="#types-deprecated">Types: Deprecated</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:prf_random/0" data-no-tooltip="" translate="no">prf_random()</a>

          <span class="deprecated" title="the type ssl:prf_random() is deprecated; Only used in deprecated function prf/5 and will no longer be needed.">deprecated</span>

      </div>

    </div>

</div>
<div class="summary-types-info summary">
  <h2>
    <a href="#types-info">Types: Info</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:connection_info/0" data-no-tooltip="" translate="no">connection_info()</a>

      </div>

        <div class="summary-synopsis"><p>Key value list convening some information about the established connection.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:connection_info_keys/0" data-no-tooltip="" translate="no">connection_info_keys()</a>

      </div>

        <div class="summary-synopsis"><p>TLS connection keys for which information can be retrieved.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:connection_info_pre_tls13/0" data-no-tooltip="" translate="no">connection_info_pre_tls13()</a>

      </div>

        <div class="summary-synopsis"><p>TLS connection information relevant prior to TLS-1.3.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:security_info/0" data-no-tooltip="" translate="no">security_info()</a>

      </div>

        <div class="summary-synopsis"><p>TLS connection information that can be used for NSS key logging.</p></div>

    </div>

</div>
<div class="summary-types-server-options summary">
  <h2>
    <a href="#types-server-options">Types: Server Options</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:server_option/0" data-no-tooltip="" translate="no">server_option()</a>

      </div>

        <div class="summary-synopsis"><p>Options specific to the server side, or with different semantics for the client and server.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:server_option_cert/0" data-no-tooltip="" translate="no">server_option_cert()</a>

      </div>

        <div class="summary-synopsis"><p>Certificate related options for a server.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:server_option_legacy/0" data-no-tooltip="" translate="no">server_option_legacy()</a>

      </div>

        <div class="summary-synopsis"><p>Legacy server options.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:server_option_pre_tls13/0" data-no-tooltip="" translate="no">server_option_pre_tls13()</a>

      </div>

        <div class="summary-synopsis"><p>Options only relevant to TLS versions prior to TLS-1.3.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:server_option_tls13/0" data-no-tooltip="" translate="no">server_option_tls13()</a>

      </div>

        <div class="summary-synopsis"><p>Options only relevant for TLS-1.3.</p></div>

    </div>

</div>
<div class="summary-types-socket summary">
  <h2>
    <a href="#types-socket">Types: Socket</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:active_msgs/0" data-no-tooltip="" translate="no">active_msgs()</a>

      </div>

        <div class="summary-synopsis"><p>The type for the messages that are delivered to the owner of a
TLS/DTLS socket in active mode.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:dtls_legacy_version/0" data-no-tooltip="" translate="no">dtls_legacy_version()</a>

      </div>

        <div class="summary-synopsis"><p>A DTLS protocol version that are no longer supported by default for security reasons.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:dtls_version/0" data-no-tooltip="" translate="no">dtls_version()</a>

      </div>

        <div class="summary-synopsis"><p>DTLS protocol version.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:error_alert/0" data-no-tooltip="" translate="no">error_alert()</a>

      </div>

        <div class="summary-synopsis"><p>If a TLS connection fails a TLS protocol ALERT will be sent/received.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:host/0" data-no-tooltip="" translate="no">host()</a>

      </div>

        <div class="summary-synopsis"><p>A name or address to a host.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:protocol_extensions/0" data-no-tooltip="" translate="no">protocol_extensions()</a>

      </div>

        <div class="summary-synopsis"><p>Client hello extensions.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:protocol_version/0" data-no-tooltip="" translate="no">protocol_version()</a>

      </div>

        <div class="summary-synopsis"><p>TLS or DTLS protocol version.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:reason/0" data-no-tooltip="" translate="no">reason()</a>

      </div>

        <div class="summary-synopsis"><p>Error reason for debug purposes.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:session_id/0" data-no-tooltip="" translate="no">session_id()</a>

      </div>

        <div class="summary-synopsis"><p>Identifies a TLS session prior to TLS-1.3.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:socket/0" data-no-tooltip="" translate="no">socket()</a>

      </div>

        <div class="summary-synopsis"><p>A socket that can be used to perform a so-called &quot;START-TLS&quot;, which
means using an already connected socket previously used for plain TCP
traffic and upgrading it to use TLS.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:socket_option/0" data-no-tooltip="" translate="no">socket_option()</a>

      </div>

        <div class="summary-synopsis"><p>Options for the transport socket.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:sslsocket/0" data-no-tooltip="" translate="no">sslsocket()</a>

      </div>

        <div class="summary-synopsis"><p>An opaque reference to the TLS/DTLS connection.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:tls_alert/0" data-no-tooltip="" translate="no">tls_alert()</a>

      </div>

        <div class="summary-synopsis"><p>TLS Alert Protocol reasons.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:tls_client_option/0" data-no-tooltip="" translate="no">tls_client_option()</a>

      </div>

        <div class="summary-synopsis"><p>An option that can be supplied to a TLS client.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:tls_legacy_version/0" data-no-tooltip="" translate="no">tls_legacy_version()</a>

      </div>

        <div class="summary-synopsis"><p>A TLS protocol version that are no longer supported by default for security reasons.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:tls_option/0" data-no-tooltip="" translate="no">tls_option()</a>

      </div>

        <div class="summary-synopsis"><p>An option related to the TLS/DTLS protocol.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:tls_server_option/0" data-no-tooltip="" translate="no">tls_server_option()</a>

      </div>

        <div class="summary-synopsis"><p>An option that can be supplied to a TLS server.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:tls_version/0" data-no-tooltip="" translate="no">tls_version()</a>

      </div>

        <div class="summary-synopsis"><p>TLS protocol version.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:transport_option/0" data-no-tooltip="" translate="no">transport_option()</a>

      </div>

        <div class="summary-synopsis"><p>Transport option defines a callback module and message tags to handle the underlying transport socket.</p></div>

    </div>

</div>
<div class="summary-types summary">
  <h2>
    <a href="#types">Types</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:keylog_info/0" data-no-tooltip="" translate="no">keylog_info()</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:keylog_item/0" data-no-tooltip="" translate="no">keylog_item()</a>

      </div>

    </div>

</div>
<div class="summary-client-api summary">
  <h2>
    <a href="#client-api">Client API</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#connect/2" data-no-tooltip="" translate="no">connect(TCPSocket, TLSOptions)</a>

      </div>

        <div class="summary-synopsis"><p>Equivalent to <a><code class="inline">connect(TCPSocket, TLSOptions, infinity)</code></a>.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#connect/3" data-no-tooltip="" translate="no">connect(TCPSocketOrHost, TLSOptionsOrPort, TimeoutOrTLSOptions)</a>

      </div>

        <div class="summary-synopsis"><p>Opens a TLS/DTLS connection.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#connect/4" data-no-tooltip="" translate="no">connect(Host, Port, TLSOptions, Timeout)</a>

      </div>

        <div class="summary-synopsis"><p>Opens a TLS/DTLS connection to <code class="inline">Host</code>, <code class="inline">Port</code>.</p></div>

    </div>

</div>
<div class="summary-client-and-server-api summary">
  <h2>
    <a href="#client-and-server-api">Client and Server API</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#close/1" data-no-tooltip="" translate="no">close(SslSocket)</a>

      </div>

        <div class="summary-synopsis"><p>Closes a TLS/DTLS connection.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#close/2" data-no-tooltip="" translate="no">close(SslSocket, How)</a>

      </div>

        <div class="summary-synopsis"><p>Closes or downgrades a TLS connection.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#controlling_process/2" data-no-tooltip="" translate="no">controlling_process(SslSocket, NewController)</a>

      </div>

        <div class="summary-synopsis"><p>Assigns a new controlling process to the SSL socket.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#handshake_cancel/1" data-no-tooltip="" translate="no">handshake_cancel(Socket)</a>

      </div>

        <div class="summary-synopsis"><p>Cancel the handshake with a fatal <code class="inline">USER_CANCELED</code> alert.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#handshake_continue/2" data-no-tooltip="" translate="no">handshake_continue(HsSocket, Options)</a>

      </div>

        <div class="summary-synopsis"><p>Equivalent to <a><code class="inline">handshake_continue(HsSocket, Options, infinity)</code></a>.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#handshake_continue/3" data-no-tooltip="" translate="no">handshake_continue(HsSocket, Options, Timeout)</a>

      </div>

        <div class="summary-synopsis"><p>Continue the TLS handshake, possibly with new, additional, or changed options.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#recv/2" data-no-tooltip="" translate="no">recv(SslSocket, Length)</a>

      </div>

        <div class="summary-synopsis"><p>Equivalent to <a><code class="inline">recv(Socket, Length, infinity)</code></a>.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#recv/3" data-no-tooltip="" translate="no">recv(SslSocket, Length, Timeout)</a>

      </div>

        <div class="summary-synopsis"><p>Receives a packet from a socket in passive mode.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#send/2" data-no-tooltip="" translate="no">send(SslSocket, Data)</a>

      </div>

        <div class="summary-synopsis"><p>Writes <code class="inline">Data</code> to <code class="inline">SslSocket</code>.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#setopts/2" data-no-tooltip="" translate="no">setopts(SslSocket, Options)</a>

      </div>

        <div class="summary-synopsis"><p>Sets options according to <code class="inline">Options</code> for socket <code class="inline">SslSocket</code>.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#shutdown/2" data-no-tooltip="" translate="no">shutdown(SslSocket, How)</a>

      </div>

        <div class="summary-synopsis"><p>Immediately closes a socket in one or two directions.</p></div>

    </div>

</div>
<div class="summary-deprecated-api summary">
  <h2>
    <a href="#deprecated-api">Deprecated API</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#prf/5" data-no-tooltip="" translate="no">prf(SslSocket, Secret, Label, Seed, WantedLength)</a>

          <span class="deprecated" title="ssl:prf/5 is deprecated; Use export_key_materials/4 instead. Note that in OTP 28 the 'testing' way of calling this function will no longer be supported.">deprecated</span>

      </div>

        <div class="summary-synopsis"><p>Uses the Pseudo-Random Function (PRF) of a TLS session to generate extra key
material.</p></div>

    </div>

</div>
<div class="summary-pre-tls-1-3-api summary">
  <h2>
    <a href="#pre-tls-1-3-api">Pre TLS-1.3 API</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#eccs/0" data-no-tooltip="" translate="no">eccs()</a>

      </div>

        <div class="summary-synopsis"><p>Returns a list of all supported elliptic curves, including legacy
curves, for all TLS/DTLS versions prior to TLS-1.3.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#eccs/1" data-no-tooltip="" translate="no">eccs(Version)</a>

      </div>

        <div class="summary-synopsis"><p>Returns the elliptic curves supported by default for <code class="inline">Version</code>.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#renegotiate/1" data-no-tooltip="" translate="no">renegotiate(SslSocket)</a>

      </div>

        <div class="summary-synopsis"><p>Initiates a new handshake.</p></div>

    </div>

</div>
<div class="summary-server-api summary">
  <h2>
    <a href="#server-api">Server API</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#handshake/1" data-no-tooltip="" translate="no">handshake(HsSocket)</a>

      </div>

        <div class="summary-synopsis"><p>Equivalent to <a><code class="inline">handshake(HsSocket, infinity)</code></a>.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#handshake/2" data-no-tooltip="" translate="no">handshake(HsSocket, OptionsOrTimeout)</a>

      </div>

        <div class="summary-synopsis"><p>Performs the TLS/DTLS server-side handshake.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#handshake/3" data-no-tooltip="" translate="no">handshake(Socket, Options, Timeout)</a>

      </div>

        <div class="summary-synopsis"><p>Performs the TLS/DTLS server-side handshake.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#listen/2" data-no-tooltip="" translate="no">listen(Port, Options)</a>

      </div>

        <div class="summary-synopsis"><p>Creates an SSL listen socket.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#transport_accept/1" data-no-tooltip="" translate="no">transport_accept(ListenSocket)</a>

      </div>

        <div class="summary-synopsis"><p>Equivalent to <a><code class="inline">transport_accept(ListenSocket, infinity)</code></a>.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#transport_accept/2" data-no-tooltip="" translate="no">transport_accept(ListenSocket, Timeout)</a>

      </div>

        <div class="summary-synopsis"><p>Accepts an incoming connection request on a listen socket.</p></div>

    </div>

</div>
<div class="summary-tls-1-3-only-api summary">
  <h2>
    <a href="#tls-1-3-only-api">TLS-1.3 Only API</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#groups/0" data-no-tooltip="" translate="no">groups()</a>

      </div>

        <div class="summary-synopsis"><p>Returns all supported groups in TLS 1.3.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#groups/1" data-no-tooltip="" translate="no">groups(Description)</a>

      </div>

        <div class="summary-synopsis"><p>Returns default supported groups in TLS 1.3.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#update_keys/2" data-no-tooltip="" translate="no">update_keys(SslSocket, Type)</a>

      </div>

        <div class="summary-synopsis"><p>Create new session keys.</p></div>

    </div>

</div>
<div class="summary-utility-functions summary">
  <h2>
    <a href="#utility-functions">Utility Functions</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#append_cipher_suites/2" data-no-tooltip="" translate="no">append_cipher_suites(Deferred, Suites)</a>

      </div>

        <div class="summary-synopsis"><p>Make <code class="inline">Deferred</code> suites become the least preferred suites.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#cipher_suites/2" data-no-tooltip="" translate="no">cipher_suites(Description, Version)</a>

      </div>

        <div class="summary-synopsis"><p>Lists all available cipher suites corresponding to <code class="inline">Description</code>.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#cipher_suites/3" data-no-tooltip="" translate="no">cipher_suites(Description, Version, StringType)</a>

      </div>

        <div class="summary-synopsis"><p>Equivalent to <a><code class="inline">cipher_suites/2</code></a>, but lists RFC or OpenSSL string names instead of
<a><code class="inline">erl_cipher_suite()</code></a>.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#clear_pem_cache/0" data-no-tooltip="" translate="no">clear_pem_cache()</a>

      </div>

        <div class="summary-synopsis"><p>Clears the PEM cache.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#connection_information/1" data-no-tooltip="" translate="no">connection_information(SslSocket)</a>

      </div>

        <div class="summary-synopsis"><p>Returns the most relevant information about the connection.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#connection_information/2" data-no-tooltip="" translate="no">connection_information(SslSocket, Items)</a>

      </div>

        <div class="summary-synopsis"><p>Returns the requested information items about the connection if they are
defined.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#export_key_materials/4" data-no-tooltip="" translate="no">export_key_materials(SslSocket, Labels, Contexts, WantedLengths)</a>

      </div>

        <div class="summary-synopsis"><p>Equivalent to <a><code class="inline">export_key_materials(TLSSocket, Labels, Contexts, WantedLengths, true)</code></a>.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#export_key_materials/5" data-no-tooltip="" translate="no">export_key_materials(SslSocket, Labels, Contexts, WantedLengths, ConsumeSecret)</a>

      </div>

        <div class="summary-synopsis"><p>Uses a Pseudo-Random Function (PRF prior to TLS-1.3) or a Key
Derivation Function (HKDF in TLS-1.3) for a TLS connection to
generate and export keying materials.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#filter_cipher_suites/2" data-no-tooltip="" translate="no">filter_cipher_suites(Suites, Filters)</a>

      </div>

        <div class="summary-synopsis"><p>Removes cipher suites if any of the filter functions returns <code class="inline">false</code> for any part
of the cipher suite.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#format_error/1" data-no-tooltip="" translate="no">format_error(Error)</a>

      </div>

        <div class="summary-synopsis"><p>Presents the error returned by an SSL function as a printable string.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#getopts/2" data-no-tooltip="" translate="no">getopts(SslSocket, OptionNames)</a>

      </div>

        <div class="summary-synopsis"><p>Gets the values of the specified socket options.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#getstat/1" data-no-tooltip="" translate="no">getstat(SslSocket)</a>

      </div>

        <div class="summary-synopsis"><p>Get statistics for the underlying socket.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#getstat/2" data-no-tooltip="" translate="no">getstat(SslSocket, Options)</a>

      </div>

        <div class="summary-synopsis"><p>Get one or more statistic values for the underlying socket.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#negotiated_protocol/1" data-no-tooltip="" translate="no">negotiated_protocol(SslSocket)</a>

      </div>

        <div class="summary-synopsis"><p>Returns the protocol negotiated through ALPN or NPN extensions.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#peercert/1" data-no-tooltip="" translate="no">peercert(SslSocket)</a>

      </div>

        <div class="summary-synopsis"><p>The peer certificate is returned as a DER-encoded binary.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#peername/1" data-no-tooltip="" translate="no">peername(SslSocket)</a>

      </div>

        <div class="summary-synopsis"><p>Returns the address and port number of the peer.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#prepend_cipher_suites/2" data-no-tooltip="" translate="no">prepend_cipher_suites(Preferred, Suites)</a>

      </div>

        <div class="summary-synopsis"><p>Make <code class="inline">Preferred</code> suites become the most preferred suites.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#signature_algs/2" data-no-tooltip="" translate="no">signature_algs(Description, Version)</a>

      </div>

        <div class="summary-synopsis"><p>Lists all available signature algorithms corresponding to <code class="inline">Description</code>.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#sockname/1" data-no-tooltip="" translate="no">sockname(SslSocket)</a>

      </div>

        <div class="summary-synopsis"><p>Returns the local address and port number of socket <code class="inline">SslSocket</code>.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#start/0" data-no-tooltip="" translate="no">start()</a>

      </div>

        <div class="summary-synopsis"><p>Equivalent to <a><code class="inline">start(temporary)</code></a>.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#start/1" data-no-tooltip="" translate="no">start(Type)</a>

      </div>

        <div class="summary-synopsis"><p>Starts the SSL application.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#stop/0" data-no-tooltip="" translate="no">stop()</a>

      </div>

        <div class="summary-synopsis"><p>Stops the SSL application.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#str_to_suite/1" data-no-tooltip="" translate="no">str_to_suite(CipherSuiteName)</a>

      </div>

        <div class="summary-synopsis"><p>Converts an RFC or OpenSSL name string to an <a><code class="inline">erl_cipher_suite/0</code></a></p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#suite_to_openssl_str/1" data-no-tooltip="" translate="no">suite_to_openssl_str(CipherSuite)</a>

      </div>

        <div class="summary-synopsis"><p>Converts an <a><code class="inline">erl_cipher_suite()</code></a> value to
an OpenSSL name string.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#suite_to_str/1" data-no-tooltip="" translate="no">suite_to_str(CipherSuite)</a>

      </div>

        <div class="summary-synopsis"><p>Converts an <a><code class="inline">erl_cipher_suite()</code></a> value to an RFC
name string.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#versions/0" data-no-tooltip="" translate="no">versions()</a>

      </div>

        <div class="summary-synopsis"><p>Lists information, mainly concerning TLS/DTLS versions, in runtime for debugging
and testing purposes.</p></div>

    </div>

</div>

  </section>


  <section id="types-algorithms" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#types-algorithms">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Types: Algorithms</span>
    </h1>
    <div class="types-algorithms-list">
<section class="detail" id="t:cipher/0">

  <div class="detail-header">
    <a href="#t:cipher/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">cipher()</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L330" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> cipher() ::
          aes_256_gcm | aes_128_gcm | aes_256_ccm | aes_128_ccm | chacha20_poly1305 | aes_256_ccm_8 |
          aes_128_ccm_8 | aes_128_cbc | aes_256_cbc |
          <a href="#t:legacy_cipher/0">legacy_cipher</a>().</pre>

      </div>

<p>Cipher algorithms that can be used for payload encryption.</p>
  </section>
</section>
<section class="detail" id="t:cipher_filters/0">

  <div class="detail-header">
    <a href="#t:cipher_filters/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">cipher_filters()</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L1194" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> cipher_filters() ::
          [{key_exchange | cipher | mac | prf,
            fun((<a href="#t:kex_algo/0">kex_algo</a>() | <a href="#t:cipher/0">cipher</a>() | <a href="#t:hash/0">hash</a>() | aead | default_prf) -> true | false)}].</pre>

      </div>

<p>Filter that allows you to customize cipher suite list.</p>
  </section>
</section>
<section class="detail" id="t:cipher_suites/0">

  <div class="detail-header">
    <a href="#t:cipher_suites/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">cipher_suites()</h1>

        <span class="note">(not exported)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L1177" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> cipher_suites() :: <a href="#t:ciphers/0">ciphers</a>().</pre>

      </div>

<p>A list of cipher suites that should be supported.</p><p>Function <a href="#cipher_suites/2">ssl:cipher_suites/2 </a> can be used to find all
cipher suites that are supported by default and all cipher suites that can be
configured.</p><p>If you compose your own <a href="#t:cipher_suites/0"><code class="inline">cipher_suites/0</code></a> make sure they are
filtered for crypto library support using <a href="#filter_cipher_suites/2">ssl:filter_cipher_suites/2
</a>.</p><p>The following function can help creating customized cipher suite lists:</p><ul><li><a href="#append_cipher_suites/2">ssl:append_cipher_suites/2 </a></li><li><a href="#prepend_cipher_suites/2">ssl:prepend_cipher_suites/2</a></li><li><a href="#suite_to_str/1">ssl:suite_to_str/1</a></li><li><a href="#str_to_suite/1">ssl:str_to_suite/1</a></li><li><a href="#suite_to_openssl_str/1">ssl:suite_to_openssl_str/1</a></li></ul><section role="note" class="admonition info"><h4 class="admonition-title info">Note</h4><p>Note that TLS-1.3 and TLS-1.2 use different sets of cipher suites. To
support both versions, cipher suites from both sets need to be
included. If the supplied list does not comply with the configured
versions or crypto library, that is, resulting in an empty list, the option
will fall back to its appropriate default value for the configured
versions.</p></section><p>Non-default cipher suites, including anonymous cipher suites (prior to
TLS 1.3), are supported for interoperability and testing
purposes. These can be used by adding them to your cipher suite
list. Note that they also need to be supported and enabled by the peer
to be actually used, and they may require additional configuration;
see <a href="#t:srp_param_type/0"><code class="inline">srp_param_type()</code></a>.</p>
  </section>
</section>
<section class="detail" id="t:ciphers/0">

  <div class="detail-header">
    <a href="#t:ciphers/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">ciphers()</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L1188" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> ciphers() :: [<a href="#t:erl_cipher_suite/0">erl_cipher_suite</a>()] | <a href="../../apps/erts/erlang.html#t:string/0">string</a>().</pre>

      </div>

<p>Cipher suite formats.</p><p>For backwards compatibility, cipher suites can be configured as a
colon-separated string of cipher suite RFC names (or even old OpenSSL
names). However, a more flexible approach is to use utility functions
together with <a href="#t:cipher_filters/0"><code class="inline">cipher_filters()</code></a> if a customized
cipher suite option is needed.</p>
  </section>
</section>
<section class="detail" id="t:erl_cipher_suite/0">

  <div class="detail-header">
    <a href="#t:erl_cipher_suite/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">erl_cipher_suite()</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L489" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> erl_cipher_suite() ::
          #{key_exchange := <a href="#t:kex_algo/0">kex_algo</a>(),
            cipher := <a href="#t:cipher/0">cipher</a>(),
            mac := <a href="#t:hash/0">hash</a>() | aead,
            prf := <a href="#t:hash/0">hash</a>() | default_prf}.</pre>

      </div>

<p>Erlang cipher suite representation</p><section role="note" class="admonition warning"><h4 class="admonition-title warning">Warning</h4><p>Enabling cipher suites using RSA as a key exchange algorithm is
strongly discouraged (only available prior to TLS-1.3). For some
configurations software preventions may exist, and can make them
usable if they work, but relying on them to work is risky. There
exists more reliable cipher suites that can be used instead.</p></section>
  </section>
</section>
<section class="detail" id="t:group/0">

  <div class="detail-header">
    <a href="#t:group/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">group()</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L550" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> group() ::
          x25519 | x448 | secp256r1 | secp384r1 | secp521r1 | ffdhe2048 | ffdhe3072 | ffdhe4096 |
          ffdhe6144 | ffdhe8192.</pre>

      </div>

<p>TLS-1.3 key exchange configuration.</p>
  </section>
</section>
<section class="detail" id="t:hash/0">

  <div class="detail-header">
    <a href="#t:hash/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">hash()</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L352" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> hash() :: <a href="#t:sha2/0">sha2</a>() | <a href="#t:legacy_hash/0">legacy_hash</a>().</pre>

      </div>

<p>Hash algorithms used together with signing and encryption functions.</p>
  </section>
</section>
<section class="detail" id="t:kex_algo/0">

  <div class="detail-header">
    <a href="#t:kex_algo/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">kex_algo()</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L461" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> kex_algo() ::
          ecdhe_ecdsa | ecdh_ecdsa | ecdh_rsa | rsa | dhe_rsa | dhe_dss | srp_rsa | srp_dss | dhe_psk |
          rsa_psk | psk | ecdh_anon | dh_anon | srp_anon | any.</pre>

      </div>

<p>Cipher Suite Key Exchange Algorithm will be <code class="inline">any</code>
in TLS-1.3 as key exchange is no longer part of cipher suite
configuration in TLS-1.3.</p>
  </section>
</section>
<section class="detail" id="t:named_curve/0">

  <div class="detail-header">
    <a href="#t:named_curve/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">named_curve()</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L507" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> named_curve() ::
          x25519 | x448 | secp521r1 | brainpoolP512r1 | brainpoolP384r1 | secp384r1 | brainpoolP256r1 |
          secp256r1 |
          <a href="#t:legacy_named_curve/0">legacy_named_curve</a>().</pre>

      </div>

<p>Key exchange configuration prior to TLS-1.3.</p>
  </section>
</section>
<section class="detail" id="t:rsassa_pss_scheme/0">

  <div class="detail-header">
    <a href="#t:rsassa_pss_scheme/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">rsassa_pss_scheme()</h1>

        <span class="note">(not exported)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L435" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> rsassa_pss_scheme() ::
          rsa_pss_rsae_sha512 | rsa_pss_rsae_sha384 | rsa_pss_rsae_sha256 | rsa_pss_pss_sha512 |
          rsa_pss_pss_sha384 | rsa_pss_pss_sha256.</pre>

      </div>

<p>Supported in TLS-1.3 and TLS-1.2.</p>
  </section>
</section>
<section class="detail" id="t:sha2/0">

  <div class="detail-header">
    <a href="#t:sha2/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">sha2()</h1>

        <span class="note">(not exported)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L359" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> sha2() :: sha512 | sha384 | sha256.</pre>

      </div>

<p>SHA2 hash algorithms.</p>
  </section>
</section>
<section class="detail" id="t:sign_algo/0">

  <div class="detail-header">
    <a href="#t:sign_algo/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">sign_algo()</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L375" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> sign_algo() :: eddsa | ecdsa | rsa | <a href="#t:legacy_sign_algo/0">legacy_sign_algo</a>().</pre>

      </div>

<p>Signature algorithms.</p>
  </section>
</section>
<section class="detail" id="t:sign_scheme/0">

  <div class="detail-header">
    <a href="#t:sign_scheme/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">sign_scheme()</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L419" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> sign_scheme() ::
          eddsa_ed25519 | eddsa_ed448 | ecdsa_secp521r1_sha512 | ecdsa_secp384r1_sha384 |
          ecdsa_secp256r1_sha256 | ecdsa_brainpoolP512r1tls13_sha512 |
          ecdsa_brainpoolP384r1tls13_sha384 | ecdsa_brainpoolP256r1tls13_sha256 |
          <a href="#t:rsassa_pss_scheme/0">rsassa_pss_scheme</a>() |
          <a href="#t:legacy_sign_scheme/0">legacy_sign_scheme</a>().</pre>

      </div>

<p>Signature schemes, defined by TLS-1.3, and replacing signature algorithms from TLS-1.2.</p><p>Explicitly list acceptable signature schemes in the preferred
order.</p><p>Overrides the algorithms supplied in
<a href="#t:signature_algs/0"><code class="inline">signature_algs</code></a> option for certificates.
In addition to the <code class="inline">signature_algorithms</code> extension from TLS 1.2,
<a href="http://www.ietf.org/rfc/rfc8446.txt#section-4.2.3">TLS 1.3 (RFC 5246 Section 4.2.3)</a>
adds the <code class="inline">signature_algorithms_cert</code> extension which enables having special
requirements on the signatures used in the certificates that differs from the
requirements on digital signatures as a whole. If this is not required this
extension is not needed.</p><p>The client will send a <code class="inline">signature_algorithms_cert</code> extension (in the
client hello message), if TLS version 1.2 (back-ported to TLS 1.2 in
24.1) or later is used, and the signature_algs_cert option is
explicitly specified.  By default, only the
<a href="#t:signature_algs/0">signature_algs</a> extension is sent with the
exception of when signature_algs option is not explicitly specified,
in which case it will append the rsa_pkcs1_sha1 algorithm to the
default value of signature_algs and use it as value for
signature_algs_cert to allow certificates to have this signature but
still disallow sha1 use in the TLS protocol, since 27.0.1 and 26.2.5.2.</p><section role="note" class="admonition info"><h4 class="admonition-title info">Note</h4><p>Note that supported signature schemes for TLS-1.2 are
<a href="#t:legacy_sign_scheme/0"><code class="inline">legacy_sign_scheme()</code></a>
and <a href="#t:rsassa_pss_scheme/0"><code class="inline">rsassa_pss_scheme()</code></a>.</p></section>
  </section>
</section>
<section class="detail" id="t:signature_algs/0">

  <div class="detail-header">
    <a href="#t:signature_algs/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">signature_algs()</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L1374" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> signature_algs() :: [{<a href="#t:hash/0">hash</a>(), <a href="#t:sign_algo/0">sign_algo</a>()} | <a href="#t:sign_scheme/0">sign_scheme</a>()].</pre>

      </div>

<p>Explicitly list acceptable signature algorithms for certificates and handshake
messages in the preferred order.</p><p>The client will send its list as the client hello
<code class="inline">signature_algorithm</code> extension introduced in TLS-1.2; see <a href="http://www.ietf.org/rfc/rfc5246.txt">Section
7.4.1.4.1 in RFC 5246</a>. Before
TLS-1.2, these algorithms where implicitly chosen and partly derived
from the cipher suite.</p><p>In TLS-1.2 a somewhat more explicit negotiation is made possible using a list of
<code class="inline">{HashAlgo, SignAlgo}</code> tuples.</p><p>In TLS-1.3, these algorithm pairs are replaced by <a href="#t:sign_scheme/0">signature
schemes</a> that are completely decoupled from the
cipher suite.</p><p>Signature algorithms used for certificates can be overridden by the
<a href="#t:sign_scheme/0">signature schemes</a> supplied by the
<code class="inline">signature_algs_cert</code> option.</p><p>The TLS-1.2 default is <code class="inline">Default_TLS_12_Alg_Pairs</code> interleaved with
<code class="inline">rsa_pss_schemes</code> since ssl-11.0 (Erlang/OTP 25). <code class="inline">pss_pss</code> is
preferred over <code class="inline">pss_rsae</code>, which in turn is preferred over <code class="inline">rsa</code>.</p><p>The list for <code class="inline">Default_TLS_12_Alg_Pairs</code> is defined as follows:</p><pre><code class="makeup erlang" translate="no"><span class="p" data-group-id="5342842131-1">[</span><span class="w">
</span><span class="p" data-group-id="5342842131-2">{</span><span class="ss">sha512</span><span class="p">,</span><span class="w"> </span><span class="ss">ecdsa</span><span class="p" data-group-id="5342842131-2">}</span><span class="p">,</span><span class="w">
</span><span class="p" data-group-id="5342842131-3">{</span><span class="ss">sha512</span><span class="p">,</span><span class="w"> </span><span class="ss">rsa</span><span class="p" data-group-id="5342842131-3">}</span><span class="p">,</span><span class="w">
</span><span class="p" data-group-id="5342842131-4">{</span><span class="ss">sha384</span><span class="p">,</span><span class="w"> </span><span class="ss">ecdsa</span><span class="p" data-group-id="5342842131-4">}</span><span class="p">,</span><span class="w">
</span><span class="p" data-group-id="5342842131-5">{</span><span class="ss">sha384</span><span class="p">,</span><span class="w"> </span><span class="ss">rsa</span><span class="p" data-group-id="5342842131-5">}</span><span class="p">,</span><span class="w">
</span><span class="p" data-group-id="5342842131-6">{</span><span class="ss">sha256</span><span class="p">,</span><span class="w"> </span><span class="ss">ecdsa</span><span class="p" data-group-id="5342842131-6">}</span><span class="p">,</span><span class="w">
</span><span class="p" data-group-id="5342842131-7">{</span><span class="ss">sha256</span><span class="p">,</span><span class="w"> </span><span class="ss">rsa</span><span class="p" data-group-id="5342842131-7">}</span><span class="w">
</span><span class="p" data-group-id="5342842131-1">]</span></code></pre><section role="note" class="admonition info"><h4 class="admonition-title info">Change</h4><ul><li>Support for <code class="inline">{md5, rsa}</code> was removed from the TLS-1.2 default in
ssl-8.0 (Erlang/OTP 22).</li><li>Support for <code class="inline">{sha, _}</code> (SHA1) and <code class="inline">{sha224, _}</code> was removed
from the TLS-1.2 default in ssl-11.0 (Erlang/OTP 26).</li></ul></section><p>The list for <code class="inline">rsa_pss_schemes</code> is defined as follows:</p><pre><code class="makeup erlang" translate="no"><span class="p" data-group-id="4616648110-1">[</span><span class="ss">rsa_pss_pss_sha512</span><span class="p">,</span><span class="w">
</span><span class="ss">rsa_pss_pss_sha384</span><span class="p">,</span><span class="w">
</span><span class="ss">rsa_pss_pss_sha256</span><span class="p">,</span><span class="w">
</span><span class="ss">rsa_pss_rsae_sha512</span><span class="p">,</span><span class="w">
</span><span class="ss">rsa_pss_rsae_sha384</span><span class="p">,</span><span class="w">
</span><span class="ss">rsa_pss_rsae_sha256</span><span class="p" data-group-id="4616648110-1">]</span></code></pre><p>The list of <code class="inline">TLS_13_Legacy_Schemes</code> is defined as follows:</p><pre><code class="makeup erlang" translate="no"><span class="p" data-group-id="2721578135-1">[</span><span class="w">
</span><span class="c1">%% Legacy algorithms only applicable to certificate signatures</span><span class="w">
</span><span class="ss">rsa_pkcs1_sha512</span><span class="p">,</span><span class="w"> </span><span class="c1">%% Corresponds to {sha512, rsa}</span><span class="w">
</span><span class="ss">rsa_pkcs1_sha384</span><span class="p">,</span><span class="w"> </span><span class="c1">%% Corresponds to {sha384, rsa}</span><span class="w">
</span><span class="ss">rsa_pkcs1_sha256</span><span class="p">,</span><span class="w"> </span><span class="c1">%% Corresponds to {sha256, rsa}</span><span class="w">
</span><span class="p" data-group-id="2721578135-1">]</span></code></pre><p>The list of <code class="inline">Default_TLS_13_Schemes</code> is defined as follows:</p><pre><code class="text">[
%% EDDSA
eddsa_ed25519,
eddsa_ed448

%% ECDSA
ecdsa_secp521r1_sha512,
ecdsa_secp384r1_sha384,
ecdsa_secp256r1_sha256] ++

%% RSASSA-PSS
rsa_pss_schemes()</code></pre><section role="note" class="admonition info"><h4 class="admonition-title info">Change</h4><p>EDDSA was made highest priority in ssl-10.8 (Erlang/OTP 25).</p></section><p>The TLS-1.3 default is <code class="inline">Default_TLS_13_Schemes</code>.</p><p>If both TLS-1.3 and TLS-1.2 are supported the default is:</p><pre><code class="makeup erlang" translate="no"><span class="n">Default_TLS_13_Schemes</span><span class="w"> </span><span class="o">++</span><span class="w"> </span><span class="n">TLS_13_Legacy_Schemes</span><span class="w"> </span><span class="o">++</span><span class="w">
</span><span class="n">Default_TLS_12_Alg_Pairs</span><span class="w"> </span><span class="c1">%% not represented in TLS_13_Legacy_Schemes</span></code></pre><p>to ensure that appropriate algorithms can be chosen for the negotiated
version.</p><section role="note" class="admonition info"><h4 class="admonition-title info">Note</h4><p>TLS-1.2 algorithms will not be negotiated for TLS-1.3, but the TLS-1.3
RSASSA-PSS (<a href="#t:rsassa_pss_scheme/0"><code class="inline">rsassa_pss_scheme()</code></a>)
signature schemes can be negotiated also for TLS-1.2 from Erlang/OTP
24.1 (fully working from Erlang/OTP 24.1.3). However, if both TLS 1.3
and TLS 1.2 are supported using defaults, and TLS 1.3 is negotiated,
the corresponding TLS 1.2 algorithms for TLS 1.3 legacy signature
schemes will be treated as legacy schemes and applied only to
certificate signatures.</p></section>
  </section>
</section>
<section class="detail" id="t:srp_param_type/0">

  <div class="detail-header">
    <a href="#t:srp_param_type/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">srp_param_type()</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L565" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> srp_param_type() :: srp_8192 | srp_6144 | srp_4096 | srp_3072 | srp_2048 | srp_1536 | srp_1024.</pre>

      </div>

<p>SRP cipher suite configuration prior to TLS-1.3.</p>
  </section>
</section>

    </div>
  </section>

  <section id="types-algorithms-legacy" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#types-algorithms-legacy">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Types: Algorithms Legacy</span>
    </h1>
    <div class="types-algorithms-legacy-list">
<section class="detail" id="t:legacy_cipher/0">

  <div class="detail-header">
    <a href="#t:legacy_cipher/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">legacy_cipher()</h1>

        <span class="note">(not exported)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L344" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> legacy_cipher() :: '3des_ede_cbc' | des_cbc | rc4_128.</pre>

      </div>

<p>Cipher algorithms that are no longer supported by default for security reasons.</p>
  </section>
</section>
<section class="detail" id="t:legacy_hash/0">

  <div class="detail-header">
    <a href="#t:legacy_hash/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">legacy_hash()</h1>

        <span class="note">(not exported)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L367" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> legacy_hash() :: sha224 | sha | md5.</pre>

      </div>

<p>Hash algorithms that are no longer supported by default for security reasons.</p>
  </section>
</section>
<section class="detail" id="t:legacy_named_curve/0">

  <div class="detail-header">
    <a href="#t:legacy_named_curve/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">legacy_named_curve()</h1>

        <span class="note">(not exported)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L523" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> legacy_named_curve() ::
          sect571r1 | sect571k1 | sect409k1 | sect409r1 | sect283k1 | sect283r1 | secp256k1 |
          sect239k1 | sect233k1 | sect233r1 | secp224k1 | secp224r1 | sect193r1 | sect193r2 |
          secp192k1 | secp192r1 | sect163k1 | sect163r1 | sect163r2 | secp160k1 | secp160r1 | secp160r2.</pre>

      </div>

<p>Key exchange configuration prior to TLS-1.3.</p><p>These curves have been deprecated by RFC 8422.</p>
  </section>
</section>
<section class="detail" id="t:legacy_sign_algo/0">

  <div class="detail-header">
    <a href="#t:legacy_sign_algo/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">legacy_sign_algo()</h1>

        <span class="note">(not exported)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L384" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> legacy_sign_algo() :: dsa.</pre>

      </div>

<p>Signature algorithms that are no longer supported by default for security reasons.</p>
  </section>
</section>
<section class="detail" id="t:legacy_sign_scheme/0">

  <div class="detail-header">
    <a href="#t:legacy_sign_scheme/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">legacy_sign_scheme()</h1>

        <span class="note">(not exported)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L449" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> legacy_sign_scheme() ::
          rsa_pkcs1_sha512 | rsa_pkcs1_sha384 | rsa_pkcs1_sha256 | ecdsa_sha1 | rsa_pkcs1_sha1.</pre>

      </div>

<p>This is only used for certificate signatures if TLS-1.2 is negotiated,
meaning that the peer only supports TLS-1.2, but we also support
TLS-1.3.</p>
  </section>
</section>
<section class="detail" id="t:old_cipher_suite/0">

  <div class="detail-header">
    <a href="#t:old_cipher_suite/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">old_cipher_suite()</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L499" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> old_cipher_suite() ::
          {<a href="#t:kex_algo/0">kex_algo</a>(), <a href="#t:cipher/0">cipher</a>(), <a href="#t:hash/0">hash</a>()} | {<a href="#t:kex_algo/0">kex_algo</a>(), <a href="#t:cipher/0">cipher</a>(), <a href="#t:hash/0">hash</a>() | aead, <a href="#t:hash/0">hash</a>()}.</pre>

      </div>

<p>For backwards compatibility only; do not use.</p>
  </section>
</section>

    </div>
  </section>

  <section id="types-certificates" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#types-certificates">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Types: Certificates</span>
    </h1>
    <div class="types-certificates-list">
<section class="detail" id="t:anchor_fun/0">

  <div class="detail-header">
    <a href="#t:anchor_fun/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">anchor_fun()</h1>

        <span class="note">(not exported)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L1258" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> anchor_fun() :: fun().</pre>

      </div>

<p>Claim an intermediate CA in the chain as trusted.</p><pre><code class="makeup erlang" translate="no"><span class="nf">fun</span><span class="p" data-group-id="5660138012-1">(</span><span class="n">Chain</span><span class="p">:</span><span class="p">:</span><span class="p" data-group-id="5660138012-2">[</span><span class="nc">public_key</span><span class="p">:</span><span class="nf">der_encoded</span><span class="p" data-group-id="5660138012-3">(</span><span class="p" data-group-id="5660138012-3">)</span><span class="p" data-group-id="5660138012-2">]</span><span class="p" data-group-id="5660138012-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
      </span><span class="p" data-group-id="5660138012-4">{</span><span class="ss">trusted_ca</span><span class="p">,</span><span class="w"> </span><span class="n">DerCert</span><span class="p">:</span><span class="p">:</span><span class="nc">public_key</span><span class="p">:</span><span class="nf">der_encoded</span><span class="p" data-group-id="5660138012-5">(</span><span class="p" data-group-id="5660138012-5">)</span><span class="p" data-group-id="5660138012-4">}</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="ss">unknown_ca</span><span class="p">.</span></code></pre><p>TLS then uses <a href="../../apps/public_key/public_key.html#pkix_path_validation/3"><code class="inline">public_key:pkix_path_validation/3</code></a> with the selected CA
as the trusted anchor and verifies the rest of the chain.</p>
  </section>
</section>
<section class="detail" id="t:cert_key_conf/0">

  <div class="detail-header">
    <a href="#t:cert_key_conf/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">cert_key_conf()</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L1135" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> cert_key_conf() ::
          #{cert => <a href="../../apps/public_key/public_key.html#t:der_encoded/0">public_key:der_encoded</a>() | [<a href="../../apps/public_key/public_key.html#t:der_encoded/0">public_key:der_encoded</a>()],
            key => <a href="#t:key/0">key</a>(),
            certfile => <a href="../../apps/kernel/file.html#t:filename/0">file:filename</a>(),
            keyfile => <a href="../../apps/kernel/file.html#t:filename/0">file:filename</a>(),
            password => <a href="../../apps/erts/erlang.html#t:iodata/0">iodata</a>() | fun(() -> <a href="../../apps/erts/erlang.html#t:iodata/0">iodata</a>())}.</pre>

      </div>

<p>Configuration of the entity certificate and its corresponding key.</p><p>A certificate (or possibly a list including the certificate and its
chain certificates, where the entity certificate must be the first
element in the list or the first entry in the file) and its associated
key. For the PEM file format, there can also be a password associated
with the file containing the key.</p><p>For maximum interoperability, the certificates in the chain should be
in the correct order, as the chain will be sent as-is to the peer. If
chain certificates are not provided, certificates from the configured
trusted CA certificates will be used to construct the chain. See
<a href="#t:client_option_cert/0"><code class="inline">client_option_cert()</code></a> and
<a href="#t:server_option_cert/0"><code class="inline">server_option_cert()</code></a> for more
information.</p>
  </section>
</section>
<section class="detail" id="t:crl_cache_opts/0">

  <div class="detail-header">
    <a href="#t:crl_cache_opts/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">crl_cache_opts()</h1>

        <span class="note">(not exported)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L1242" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> crl_cache_opts() :: {Module :: <a href="../../apps/erts/erlang.html#t:atom/0">atom</a>(), {DbHandle :: internal | <a href="../../apps/erts/erlang.html#t:term/0">term</a>(), Args :: <a href="../../apps/erts/erlang.html#t:list/0">list</a>()}}.</pre>

      </div>

<p>Options for using built-in CRL cache support.</p><p>Specify how to perform lookup and caching of certificate revocation
lists (CRLs). <code class="inline">Module</code> defaults to <a href="ssl_crl_cache.html"><code class="inline">ssl_crl_cache</code></a> with <code class="inline">DbHandle</code>
being <code class="inline">internal</code>, and <code class="inline">Args</code> being <code class="inline">[]</code>.</p><p>There are two implementations available:</p><ul><li><p><strong><code class="inline">ssl_crl_cache</code></strong> - Implementation 1</p><p>This module maintains a cache of CRLs. CRLs can be added to the
cache using <a href="ssl_crl_cache.html#insert/1"><code class="inline">ssl_crl_cache:insert/1</code></a>, and can optionally be
automatically fetched through HTTP if the following argument is
specified:</p></li><li><p><strong><code class="inline">{http, timeout()}</code></strong></p><p>  Enables fetching of CRLs specified as http URIs in <a href="../../apps/public_key/public_key_records.html">X.509 certificate
  extensions</a>. Requires the
  <a href="../../apps/inets/introduction.html">Inets</a> application.</p></li><li><p><strong><code class="inline">ssl_crl_hash_dir</code></strong> - Implementation 2</p><p>This module makes use of a directory where CRLs are
stored in files named by the hash of the issuer name.</p><p>The file names consist of eight hexadecimal digits followed by <code class="inline">.rN</code>, where
<code class="inline">N</code> is an integer, for example <code class="inline">1a2b3c4d.r0</code>. For the first version of the CRL, <code class="inline">N</code>
starts at zero, and for each new version, <code class="inline">N</code> is incremented by one. The
OpenSSL utility <code class="inline">c_rehash</code> creates symlinks according to this pattern.</p><p>For a given hash value, this module finds all consecutive <code class="inline">.r*</code>
files starting from zero, and those files taken together make up the
revocation list. CRL files with <code class="inline">nextUpdate</code> fields in the past or
issued by a different CA that happens to have the same name hash
are excluded.</p><p>The following argument is required:</p><ul><li><strong><code class="inline">{dir, string()}</code></strong></li></ul><p>Specifies the directory in which the CRLs can be found.</p></li></ul>
  </section>
</section>
<section class="detail" id="t:key/0">

  <div class="detail-header">
    <a href="#t:key/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">key()</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L1101" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> key() ::
          {'RSAPrivateKey' | 'DSAPrivateKey' | 'ECPrivateKey' | 'PrivateKeyInfo',
           <a href="../../apps/public_key/public_key.html#t:der_encoded/0">public_key:der_encoded</a>()} |
          #{algorithm := <a href="#t:sign_algo/0">sign_algo</a>(),
            engine := <a href="../../apps/crypto/crypto.html#t:engine_ref/0">crypto:engine_ref</a>(),
            key_id := <a href="../../apps/crypto/crypto.html#t:key_id/0">crypto:key_id</a>(),
            password => <a href="../../apps/crypto/crypto.html#t:password/0">crypto:password</a>()} |
          #{algorithm := <a href="#t:sign_algo/0">sign_algo</a>(),
            sign_fun := fun(),
            sign_opts => <a href="../../apps/erts/erlang.html#t:list/0">list</a>(),
            encrypt_fun => fun(),
            encrypt_opts => <a href="../../apps/erts/erlang.html#t:list/0">list</a>()}.</pre>

      </div>

<p>The user's private key.</p><p>The key can be provided either directly as a DER-encoded entity,
indirectly using a crypto engine/provider (with key reference
information), or as an Erlang fun (with possible custom options).
The latter two options can be used for customized signing with
hardware security modules (HSM) or trusted platform modules (TPM).</p><ul><li>A DER encoded key will need to specify the ASN-1 type used to create the
encoding.</li><li>An engine/provider needs to specify specific information to support this
concept and can optionally be password protected; see also
<a href="../../apps/crypto/crypto.html#engine_load/3">crypto:engine_load/3 </a> and
<a href="../../apps/crypto/engine_load.html">Crypto User's Guide</a>.</li><li>A fun option should include a fun that mimics <a href="../../apps/public_key/public_key.html#sign/4"><code class="inline">public_key:sign/4</code></a> and possibly
<a href="../../apps/public_key/public_key.html#encrypt_private/3">public_key:private_encrypt/4</a> if legacy
versions TLS-1.0 and TLS-1.1 must be supported.</li></ul>
  </section>
</section>

    </div>
  </section>

  <section id="types-client-options" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#types-client-options">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Types: Client Options</span>
    </h1>
    <div class="types-client-options-list">
<section class="detail" id="t:client_option/0">

  <div class="detail-header">
    <a href="#t:client_option/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">client_option()</h1>

        <span class="note">(not exported)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L1398" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> client_option() ::
          <a href="#t:client_option_cert/0">client_option_cert</a>() |
          <a href="#t:common_option_cert/0">common_option_cert</a>() |
          {alpn_advertised_protocols, AppProtocols :: [AppProto :: <a href="../../apps/erts/erlang.html#t:binary/0">binary</a>()]} |
          {max_fragment_length, MaxLen :: undefined | 512 | 1024 | 2048 | 4096} |
          <a href="#t:client_option_tls13/0">client_option_tls13</a>() |
          <a href="#t:common_option_tls13/0">common_option_tls13</a>() |
          <a href="#t:client_option_pre_tls13/0">client_option_pre_tls13</a>() |
          <a href="#t:common_option_pre_tls13/0">common_option_pre_tls13</a>() |
          <a href="#t:common_option_dtls/0">common_option_dtls</a>() |
          <a href="#t:client_option_legacy/0">client_option_legacy</a>() |
          <a href="#t:common_option_legacy/0">common_option_legacy</a>().</pre>

      </div>

<p>The following options are specific to the client side, or have
different semantics for the client and server:</p><ul><li><p><strong><code class="inline">{alpn_advertised_protocols, AppProtocols}</code></strong> - Application layer protocol</p><p>The list of protocols supported by the client to be sent to the server to be
used for an Application-Layer Protocol Negotiation (ALPN). If the server
supports ALPN, it will choose a protocol from this list; otherwise it will
fail the connection with a <code class="inline">no_application_protocol</code> alert. A server that does
not support ALPN will ignore this value. The list of protocols must not contain
an empty binary.</p></li><li><p><strong><code class="inline">{max_fragment_length, MaxLen}</code></strong> - Max fragment length extension</p><p>Specifies the maximum fragment length the client is prepared to accept from the
server. See <a href="http://www.ietf.org/rfc/rfc6066.txt">RFC 6066</a>.</p></li></ul>
  </section>
</section>
<section class="detail" id="t:client_option_cert/0">

  <div class="detail-header">
    <a href="#t:client_option_cert/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">client_option_cert()</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L1513" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> client_option_cert() ::
          {verify, Verify :: verify_peer | verify_none} |
          {cacerts, CACerts :: [<a href="../../apps/public_key/public_key.html#t:der_encoded/0">public_key:der_encoded</a>()] | [<a href="../../apps/public_key/public_key.html#t:combined_cert/0">public_key:combined_cert</a>()]} |
          {cacertfile, CACertFile :: <a href="../../apps/kernel/file.html#t:filename/0">file:filename</a>()} |
          {server_name_indication, SNI :: <a href="../../apps/kernel/inet.html#t:hostname/0">inet:hostname</a>() | disable} |
          {customize_hostname_check, HostNameCheckOpts :: <a href="../../apps/erts/erlang.html#t:list/0">list</a>()} |
          {certificate_authorities, <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>()} |
          {stapling, Stapling :: staple | no_staple | <a href="../../apps/erts/erlang.html#t:map/0">map</a>()}.</pre>

      </div>

<p>Certificate-related options specific to the client side, or with
different semantics for the client and server.</p><ul><li><p><strong><code class="inline">{verify, Verify}</code></strong> - Verification of certificates</p><p>This option specifies whether certificates are to be verified.</p><p>If <code class="inline">Verify</code> is <code class="inline">verify_peer</code>, which is the default, it is required
to also provide one of the options <code class="inline">cacerts</code> or <code class="inline">cacertfile</code> in
order for the certificate verification to succeed. For example, an
HTTPS client can use option <code class="inline">{cacerts, public_key:cacerts_get()}</code> to
use the trusted CA certificates provided by the operating system.</p><p>If <code class="inline">Verify</code> is <code class="inline">verify_none</code>, all X.509-certificate path
validation errors will be ignored.</p><section role="note" class="admonition info"><h4 class="admonition-title info">Change</h4><p>The default for <code class="inline">Verify</code> was changed to <code class="inline">verify_peer</code> in
Erlang/OTP 26.</p></section></li><li><p><strong><code class="inline">{cacerts, CACerts}</code></strong> - Trusted certificates</p><p>The DER-encoded trusted certificates. If this option is supplied it overrides
option <code class="inline">cacertfile</code>.</p><p>Function <a href="../../apps/public_key/public_key.html#cacerts_get/0"><code class="inline">public_key:cacerts_get/0</code></a> can be used to retrieve to the
trusted CA certificates provided by the operating system.</p></li><li><p><strong><code class="inline">{cacertfile, CertFile}</code></strong> - End entity certificate</p><p> Path to a file containing PEM-encoded CA certificates. The CA certificates are
 used during server authentication and when building the client certificate
 chain.</p><section role="note" class="admonition info"><h4 class="admonition-title info">Note</h4><p>When PEM caching is enabled, files provided with this option will be checked
for updates at fixed time intervals specified by the
<a href="ssl_app.html#configuration">ssl_pem_cache_clean</a> environment parameter.</p></section></li><li><p><strong><code class="inline">{server_name_indication, SNI}</code></strong> - Server Name Indication extension</p><p>Specify the hostname to be used in TLS Server Name Indication extension. If not
specified it will default to the <code class="inline">Host</code> argument of
<a href="#connect/3">connect/3,4</a> unless it is of type <a href="../../apps/kernel/inet.html#t:ip_address/0"><code class="inline">inet:ip_address()</code></a>.
The hostname will also be used in the hostname verification of the peer
certificate using <a href="../../apps/public_key/public_key.html#pkix_verify_hostname/2"><code class="inline">public_key:pkix_verify_hostname/2</code></a>.
The special value <code class="inline">disable</code> prevents the Server Name Indication extension from
being sent and disables the hostname verification check.</p></li><li><p><strong><code class="inline">{customize_hostname_check, HostNameCheckOpts}</code></strong> - Customization option</p><p>Customizes the hostname verification of the peer certificate, as various
protocols that use TLS, such as HTTP or LDAP, may require different approaches. For
example, here is how to use standard hostname checking for HTTPS implemented in
<a href="../../apps/public_key/public_key_app.html">Public_Key</a>:</p><pre><code class="makeup erlang" translate="no"><span class="p" data-group-id="2069676620-1">{</span><span class="ss">customize_hostname_check</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="2069676620-2">[</span><span class="p" data-group-id="2069676620-3">{</span><span class="ss">match_fun</span><span class="p">,</span><span class="w"> </span><span class="nc">public_key</span><span class="p">:</span><span class="nf">pkix_verify_hostname_match_fun</span><span class="p" data-group-id="2069676620-4">(</span><span class="ss">https</span><span class="p" data-group-id="2069676620-4">)</span><span class="p" data-group-id="2069676620-3">}</span><span class="p" data-group-id="2069676620-2">]</span><span class="p" data-group-id="2069676620-1">}</span></code></pre><p>For futher description of the customize options, see
<a href="../../apps/public_key/public_key.html#pkix_verify_hostname/3"><code class="inline">public_key:pkix_verify_hostname/3</code></a>.</p></li><li><p><strong><code class="inline">{client_certificate_authorities, UseCertAuth}</code></strong> - Inter-op hint option</p><p>If <code class="inline">UseCertAuth</code> is set to <code class="inline">true</code>, sends the certificate authorities
extension in the TLS-1.3 client hello. The default is <code class="inline">false</code>. Note
that setting <code class="inline">UseCertAuth</code> to <code class="inline">true</code> can result in a significant
overhead if there exists many trusted CA certificates. (Since
Erlang/OTP 24.3.)</p></li><li><p><strong><code class="inline">{stapling, Stapling}</code></strong> - Certificate revocation check option</p><p>If <code class="inline">Stapling</code> is atom <code class="inline">staple</code> or a map, OCSP stapling will be
enabled, meaning that an extension of type &quot;status_request&quot; will be
included in the client hello to indicate the desire to receive
certificate status information.</p><p>If <code class="inline">Stapling</code> is set to <code class="inline">no_staple</code> (the default), OCSP stapling will be disabled.</p><section role="note" class="admonition info"><h4 class="admonition-title info">Note</h4><p>Even if requested by the client, the OCSP response might not be
provided by the server. In such event, SSL will proceed with
the handshake and generate a <code class="inline">{missing, stapling_response}</code> logger
event.</p></section><p>When <code class="inline">Stapling</code> is given as a map, boolean <code class="inline">ocsp_nonce</code> key can
indicate whether an OCSP nonce should be requested by the client
(default is <code class="inline">false</code>).</p><section role="note" class="admonition info"><h4 class="admonition-title info">Note</h4><p>The OCSP response can be provided without a nonce value â€” even if it was requested
by the client. In such cases SSL will proceed with the handshake and generate
a <code class="inline">{missing, ocsp_nonce}</code> logger event.</p></section></li></ul>
  </section>
</section>
<section class="detail" id="t:client_option_legacy/0">

  <div class="detail-header">
    <a href="#t:client_option_legacy/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">client_option_legacy()</h1>

        <span class="note">(not exported)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L1730" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> client_option_legacy() ::
          {client_preferred_next_protocols,
           NextAppProtocols ::
               {Precedence :: server | client, ClientPrefs :: [AppProto :: <a href="../../apps/erts/erlang.html#t:binary/0">binary</a>()]} |
               {Precedence :: server | client,
                ClientPrefs :: [AppProto :: <a href="../../apps/erts/erlang.html#t:binary/0">binary</a>()],
                Default :: (AppProto :: <a href="../../apps/erts/erlang.html#t:binary/0">binary</a>())}}.</pre>

      </div>

<p>Legacy client options.</p><ul><li><p><strong><code class="inline">{client_preferred_next_protocols, NextAppProtocols}</code></strong> - Next Protocol Negotiation</p><p>ALPN (Application-Layer Protocol Negotiation)
deprecates NPN (Next Protocol Negotiation) and this option.</p><p>Indicates that the client wants to perform Next Protocol Negotiation.</p><p>If <code class="inline">Precedence</code> is <code class="inline">server</code>, the negotiated protocol is the first protocol to be
shown on the server advertised list that is also on the client preference
list.</p><p>If <code class="inline">Precedence</code> is <code class="inline">client</code>, the negotiated protocol is the first protocol to be
shown on the client preference list that is also on the server advertised
list.</p><p>If the client does not support any of the server advertised protocols or the
server does not advertise any protocols, the client falls back to the first
protocol in its list or to the default protocol (if a default is supplied). If
the server does not support Next Protocol Negotiation, the connection terminates
if no default protocol is supplied.</p></li></ul>
  </section>
</section>
<section class="detail" id="t:client_option_pre_tls13/0">

  <div class="detail-header">
    <a href="#t:client_option_pre_tls13/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">client_option_pre_tls13()</h1>

        <span class="note">(not exported)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L1657" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> client_option_pre_tls13() ::
          {reuse_session, SessionRef :: <a href="#t:session_id/0">session_id</a>() | {<a href="#t:session_id/0">session_id</a>(), SessionData :: <a href="../../apps/erts/erlang.html#t:binary/0">binary</a>()}} |
          {reuse_sessions, Reuse :: <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>() | save} |
          {psk_identity, PskID :: <a href="../../apps/erts/erlang.html#t:string/0">string</a>()} |
          {srp_identity, SrpID :: {Username :: <a href="../../apps/erts/erlang.html#t:string/0">string</a>(), Password :: <a href="../../apps/erts/erlang.html#t:string/0">string</a>()}} |
          {fallback, LegacyFallback :: <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>()}.</pre>

      </div>

<p>Options only relevant to TLS versions prior to TLS-1.3.</p><ul><li><p><strong><code class="inline">{reuse_session, SessionRef}</code></strong> - Explicit session reuse</p><p>Reuses a specific session.</p><p>Since Erlang/OTP 21.3, if the session was saved earlier using option
<code class="inline">{reuse_sessions, save}</code>, the session can be referred by its session ID.</p><p>Since Erlang/OTP 22.3, the session can be explicitly specified by
its session ID and associated data.</p><p>See also
<a href="using_ssl.html#session-reuse-prior-to-tls-1-3">SSL User's Guide, Session Reuse pre TLS 1.3.</a></p></li><li><p><strong><code class="inline">{reuse_sessions, Reuse}</code></strong> - Enables later session reuse</p><p>When <code class="inline">Reuse</code> is set to <code class="inline">save</code>, a new connection will be negotiated and saved for later
reuse. The session ID can be fetched with <a href="#connection_information/2"><code class="inline">connection_information/2</code></a> and used
with the client option <code class="inline">reuse_session</code>.</p><p>When <code class="inline">Reuse</code> is set to <code class="inline">true</code>, automated session reuse will be
performed, if possible. If a new session is created, and is unique in regard to previous
stored sessions, it will be saved for possible later reuse.</p><p>Since: OTP 21.3.</p></li><li><p><strong><code class="inline">{psk_identity, PskID}</code></strong> - Option for use with PSK cipher suites</p><p>Specifies the identity the client presents to the server. The matching secret is
found by the fun given in the <code class="inline">user_lookup_fun</code> option.</p></li><li><p><strong><code class="inline">{srp_identity, SrpID}</code></strong>  - Option for use SRP cipher suites</p><p>Specifies the username and password to use to authenticate to the server.</p></li><li><p><strong><code class="inline">{fallback, LegacyFallback}</code></strong> - Inter-op legacy client option</p><p>Send special cipher suite TLS_FALLBACK_SCSV to avoid an undesired TLS version
downgrade. Defaults to <code class="inline">false</code>.</p><section role="note" class="admonition warning"><h4 class="admonition-title warning">Warning</h4><p>This option is not needed in normal TLS usage and must not be used to
implement new clients. However, legacy clients that retries connections in the
following manner:</p><p><code class="inline">ssl:connect(Host, Port, [...{versions, ['tlsv2', 'tlsv1.1', 'tlsv1']}])</code></p><p><code class="inline">ssl:connect(Host, Port, [...{versions, [tlsv1.1', 'tlsv1']}, {fallback, true}])</code></p><p><code class="inline">ssl:connect(Host, Port, [...{versions, ['tlsv1']}, {fallback, true}])</code></p><p>can use it to avoid undesired TLS version downgrade. Note that
TLS_FALLBACK_SCSV must also be supported by the server for the prevention to
work.</p></section></li></ul>
  </section>
</section>
<section class="detail" id="t:client_option_tls13/0">

  <div class="detail-header">
    <a href="#t:client_option_tls13/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">client_option_tls13()</h1>

        <span class="note">(not exported)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L1591" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> client_option_tls13() ::
          {session_tickets, SessionTickets :: disabled | manual | auto} |
          {use_ticket, Tickets :: [<a href="../../apps/erts/erlang.html#t:binary/0">binary</a>()]} |
          {early_data, <a href="../../apps/erts/erlang.html#t:binary/0">binary</a>()} |
          {middlebox_comp_mode, MiddleBoxMode :: <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>()}.</pre>

      </div>

<p>Options only relevant for TLS-1.3.</p><ul><li><p><strong><code class="inline">{session_tickets, SessionTickets}</code></strong> - Use of session tickets</p><p>Configures the session ticket functionality. Allowed values are <code class="inline">disabled</code>,
<code class="inline">manual</code>, and <code class="inline">auto</code>. If it is set to <code class="inline">manual</code> the client will send the ticket
information to user process in a 3-tuple:</p><pre><code class="makeup erlang" translate="no"><span class="p" data-group-id="8139804300-1">{</span><span class="ss">ssl</span><span class="p">,</span><span class="w"> </span><span class="ss">session_ticket</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8139804300-2">{</span><span class="n">SNI</span><span class="p">,</span><span class="w"> </span><span class="n">TicketData</span><span class="p" data-group-id="8139804300-2">}</span><span class="p" data-group-id="8139804300-1">}</span></code></pre><p>where <code class="inline">SNI</code> is the ServerNameIndication and <code class="inline">TicketData</code> is the extended ticket
data that can be used in subsequent session resumptions.</p><p>If it is set to <code class="inline">auto</code>, the client automatically handles received tickets and
tries to use them when making new TLS connections (session resumption with
pre-shared keys).</p><p>Ticket lifetime, the number of tickets sent by the server, and the
maximum number of tickets stored by the server in stateful mode are configured
by <a href="ssl_app.html#configuration">application variables</a>.</p><p>See also
<a href="using_ssl.html#session-tickets-and-session-resumption-in-tls-1-3">SSL User's Guide, Session Tickets and Session Resumption in TLS 1.3</a>.</p></li><li><p><strong><code class="inline">{use_ticket, Tickets}</code></strong></p><p>Configures the session tickets to be used for session resumption. It is a
mandatory option in <code class="inline">manual</code> mode (<code class="inline">{session_tickets, manual}</code>).</p><section role="note" class="admonition info"><h4 class="admonition-title info">Note</h4><p>Session tickets are only sent to the user if option <code class="inline">session_tickets</code> is set to
<code class="inline">manual</code></p><p>This option is supported by TLS-1.3. See also
<a href="using_ssl.html#session-tickets-and-session-resumption-in-tls-1-3">SSL User's Guide, Session Tickets and Session Resumption in TLS 1.3</a>.</p></section></li><li><p><strong><code class="inline">{early_data, EarlyData}</code></strong></p><p>Configures the early data to be sent by the client.</p><p>To verify that the server has the intention to process the early
data, the following tuple is sent to the user process:</p><pre><code class="makeup erlang" translate="no"><span class="p" data-group-id="5403090077-1">{</span><span class="ss">ssl</span><span class="p">,</span><span class="w"> </span><span class="n">SslSocket</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5403090077-2">{</span><span class="ss">early_data</span><span class="p">,</span><span class="w"> </span><span class="n">Result</span><span class="p" data-group-id="5403090077-2">}</span><span class="p" data-group-id="5403090077-1">}</span></code></pre><p>where <code class="inline">Result</code> is either <code class="inline">accepted</code> or <code class="inline">rejected</code>.</p><section role="note" class="admonition warning"><h4 class="admonition-title warning">Warning</h4><p>It is the responsibility of the user to handle rejected <code class="inline">EarlyData</code> and to
resend when appropriate.</p></section></li><li><p><strong><code class="inline">{middlebox_comp_mode, MiddleBoxMode}</code></strong></p><p>Configures the middlebox compatibility mode for a TLS-1.3 connection.</p><p>A significant number of middleboxes misbehave when a TLS-1.3
connection is negotiated. Implementations can increase the chance of
making connections through those middleboxes by adapting the TLS-1.3
handshake to resemble that of a TLS-1.2 handshake.</p><p>The middlebox compatibility mode is enabled (<code class="inline">true</code>) by default.</p></li></ul>
  </section>
</section>

    </div>
  </section>

  <section id="types-client-and-server-options" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#types-client-and-server-options">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Types: Client and Server Options</span>
    </h1>
    <div class="types-client-and-server-options-list">
<section class="detail" id="t:common_option/0">

  <div class="detail-header">
    <a href="#t:common_option/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">common_option()</h1>

        <span class="note">(not exported)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L713" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> common_option() ::
          {protocol, tls | dtls} |
          {handshake, hello | full} |
          {ciphers, <a href="#t:cipher_suites/0">cipher_suites</a>()} |
          {signature_algs, <a href="#t:signature_algs/0">signature_algs</a>()} |
          {signature_algs_cert, [<a href="#t:sign_scheme/0">sign_scheme</a>()]} |
          {keep_secrets,
           KeepSecrets ::
               <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>() |
               {keylog_hs, fun((Info :: <a href="#t:keylog_info/0">keylog_info</a>()) -> <a href="../../apps/erts/erlang.html#t:any/0">any</a>())} |
               {keylog, fun((Info :: <a href="#t:keylog_info/0">keylog_info</a>()) -> <a href="../../apps/erts/erlang.html#t:any/0">any</a>())}} |
          {max_handshake_size, HandshakeSize :: <a href="../../apps/erts/erlang.html#t:pos_integer/0">pos_integer</a>()} |
          {versions, [<a href="#t:protocol_version/0">protocol_version</a>()]} |
          {log_level, Level :: <a href="../../apps/kernel/logger.html#t:level/0">logger:level</a>() | none | all} |
          {hibernate_after, HibernateTimeout :: <a href="../../apps/erts/erlang.html#t:timeout/0">timeout</a>()} |
          {receiver_spawn_opts, SpawnOpts :: [<a href="../../apps/erts/erlang.html#t:spawn_opt_option/0">erlang:spawn_opt_option</a>()]} |
          {sender_spawn_opts, SpawnOpts :: [<a href="../../apps/erts/erlang.html#t:spawn_opt_option/0">erlang:spawn_opt_option</a>()]}.</pre>

      </div>

<p>Options common to both client and server side.</p><ul><li><p><strong><code class="inline">{protocol, Protocol}</code></strong> - Choose TLS or DTLS protocol for the transport layer security.</p><p>Defaults to <code class="inline">tls</code>.</p></li><li><p><strong><code class="inline">{handshake, Completion}</code></strong> - Possibly pause handshake at hello stage.</p><p>Defaults to <code class="inline">full</code>. If <code class="inline">hello</code> is specified the handshake will pause
after the hello message, allowing the user to make decisions based
on hello extensions before continuing or aborting the handshake by
calling <a href="#handshake_continue/3"><code class="inline">handshake_continue/3</code></a> or <a href="#handshake_cancel/1"><code class="inline">handshake_cancel/1</code></a>.</p></li><li><p><strong><code class="inline">{keep_secrets, KeepSecrets}</code></strong> - Configures a TLS connection for keylogging.</p><p>In order to be able retrieve all keylog information on a TLS connection, it must be
configured in advance.</p><section role="note" class="admonition warning"><h4 class="admonition-title warning">Warning</h4><p>The keylog information defeats the purpose of the protocol
and enabling it makes the user responsible for the information
not ending up compromising security, it is intended for debugging.</p></section><p>The <code class="inline">keep_secrets</code> functionality is disabled (<code class="inline">false</code>) by default.
If set to legacy value <code class="inline">true</code> keylog information can be retrieved from the connection
using connection_information/2. </p><p>Added in OTP 23.2.</p><section role="note" class="admonition info"><h4 class="admonition-title info">Note</h4><p>Note that having to ask the connection has some drawbacks
as for instance you can not get keylog information for 
failed connections, and other keylog items have
to be retrieved in a polling manner and are not correctly
formatted for key_updates.</p></section><p>Since OTP 27.3.1 you may instead of true provide a callback fun
providing keylog information for either just failing handshakes or
for entire connections, by setting <code class="inline">keep_secrets</code> option to
{keylog_hs, fun()} or {keylog, fun()}.  The fun is of arity one and
will be called with keylog information
<a href="#t:keylog_info/0"><code class="inline">keylog_info()</code></a> as an argument. <code class="inline">keylog_hs fun</code>
will only be called if the handshake fails, and is only relevant for
<code class="inline">TLS-1.3</code> that has encrypted messages before the first handshake is
complete.<code class="inline">keylog fun</code> will be called every time some secrets are
updated and provide keylog for that update that is during the
connection establishment and after that at <code class="inline">renegotiation</code> or <code class="inline">key update</code> (depending on TLS protocol version).  When a fun is used the
connection_information/2 can not be used to retrieve key log
information.  For more information see <a href="using_ssl.html#nss-keylog">NSS
keylog</a>.</p></li><li><p><strong><code class="inline">{max_handshake_size, HandshakeSize}</code></strong> - Limit the acceptable handshake packet size.</p><p>Used to limit the size of valid TLS handshake packets to avoid DoS
attacks.</p><p>Integer (24 bits, unsigned). Defaults to <code class="inline">256*1024</code>.</p></li><li><p><strong><code class="inline">{hibernate_after, HibernateTimeout}</code></strong> - Hibernate inactive connection processes.</p><p>When an integer-value is specified, the TLS/DTLS connection goes into hibernation
after the specified number of milliseconds of inactivity, thus reducing its
memory footprint. When not specified the process never goes into hibernation.</p></li><li><p><strong><code class="inline">{log_level, Level}</code></strong> - Specifies the log level for a TLS/DTLS connection.</p><p>Alerts are logged on <code class="inline">notice</code>
level, which is the default level. The level <code class="inline">debug</code> triggers verbose logging of
TLS/DTLS protocol messages. See also <a href="ssl_app.html">SSL Application</a></p></li><li><p><strong><code class="inline">{receiver|sender_spawn_opts, SpawnOpts}</code></strong> - Configure erlang spawn opts.</p><p>Configures spawn options of TLS sender and receiver processes.</p><p>Setting up garbage collection options can be helpful for trade-offs between CPU
usage and memory usage. See <a href="../../apps/erts/erlang.html#spawn_opt/2"><code class="inline">erlang:spawn_opt/2</code></a>.</p><p>For connections using Erlang distribution, the default sender option
is <code class="inline">[...{priority, max}]</code>; this priority option cannot be changed. For all
connections, <code class="inline">...link</code> is added to receiver and cannot be changed.</p></li></ul>
  </section>
</section>
<section class="detail" id="t:common_option_cert/0">

  <div class="detail-header">
    <a href="#t:common_option_cert/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">common_option_cert()</h1>

        <span class="note">(not exported)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L924" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> common_option_cert() ::
          {certs_keys, CertsKeys :: [<a href="#t:cert_key_conf/0">cert_key_conf</a>()]} |
          {depth, AllowedCertChainLen :: <a href="../../apps/erts/erlang.html#t:pos_integer/0">pos_integer</a>()} |
          {verify_fun, Verify :: {Verifyfun :: fun(), InitialUserState :: <a href="../../apps/erts/erlang.html#t:any/0">any</a>()}} |
          {cert_policy_opts,
           PolicyOpts ::
               [{policy_set, [<a href="../../apps/public_key/public_key.html#t:oid/0">public_key:oid</a>()]} |
                {explicit_policy, <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>()} |
                {inhibit_policy_mapping, <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>()} |
                {inhibit_any_policy, <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>()}]} |
          {allow_any_ca_purpose, Allow :: <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>()} |
          {crl_check, Check :: <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>() | peer | best_effort} |
          {crl_cache, <a href="#t:crl_cache_opts/0">crl_cache_opts</a>()} |
          {partial_chain, <a href="#t:anchor_fun/0">anchor_fun</a>()}.</pre>

      </div>

<p>Common certificate related options to both client and server.</p><ul><li><p><strong><code class="inline">{certs_keys, CertsKeys}</code></strong> - At least one certificate and key pair.</p><p>A list of a certificate (or possible a certificate and its chain)
and the associated key of the certificate that can be used to
authenticate the client or the server. The certificate key pair that
is considered best and matches negotiated parameters for the
connection will be selected.</p><p>The different signature algorithms are prioritized in the following
order: <code class="inline">eddsa</code>, <code class="inline">ecdsa</code>, <code class="inline">rsa_pss_pss</code>, <code class="inline">rsa</code>, and <code class="inline">dsa</code>. If more
than one key is supplied for the same signature algorithm, they will
be prioritized by strength (except for <em>engine keys</em>; see the next
paragraph). This offers flexibility to, for instance, configure a
newer certificate that is expected to be used in most cases, and an
older but acceptable certificate that will only be used to
communicate with legacy systems. Note that there is a trade off
between the induced overhead and the flexibility; thus, alternatives
should be chosen for good reasons.</p><p><em>Engine keys</em> will be favored over other keys. As engine keys cannot
be inspected, supplying more than one engine key makes no sense.</p><p>When this option is specified it overrides all single certificate
and key options. For examples, see the <a href="using_ssl.html">User's Guide</a>.</p><section role="note" class="admonition info"><h4 class="admonition-title info">Note</h4><p><code class="inline">eddsa</code> certificates are only supported by TLS-1.3 implementations that do not support <code class="inline">dsa</code>
certificates. <code class="inline">rsa_pss_pss</code> (RSA certificates using Probabilistic Signature
Scheme) are supported in TLS-1.2 and TLS-1.3, but some TLS-1.2 implementations
do not support <code class="inline">rsa_pss_pss</code>.</p></section></li><li><p><strong><code class="inline">{depth, AllowedCertChainLen}</code></strong> - Limits the accepted number of certificates in the certificate chain.</p><p>Maximum number of non-self-issued intermediate certificates that can follow the
peer certificate in a valid certification path. So, if depth is 0 the PEER must
be signed by the trusted ROOT-CA directly; if 1 the path can be PEER, CA,
ROOT-CA; if 2 the path can be PEER, CA, CA, ROOT-CA, and so on. The default
value is 10. Used to mitigate DoS attack possibilities.</p></li><li><p><strong><code class="inline">{verify_fun, Verify}</code></strong> - Customize certificate path validation</p><p>The verification fun is to be defined as follows:</p><pre><code class="makeup erlang" translate="no"><span class="nf">fun</span><span class="p" data-group-id="2754144009-1">(</span><span class="n">OtpCert</span><span class="w"> </span><span class="p">:</span><span class="p">:</span><span class="w"> </span><span class="o">#</span><span class="ss">&#39;OTPCertificate&#39;</span><span class="p" data-group-id="2754144009-2">{</span><span class="p" data-group-id="2754144009-2">}</span><span class="p">,</span><span class="w">
    </span><span class="n">Event</span><span class="p">,</span><span class="w"> </span><span class="n">InitialUserState</span><span class="w"> </span><span class="p">:</span><span class="p">:</span><span class="w"> </span><span class="nf">term</span><span class="p" data-group-id="2754144009-3">(</span><span class="p" data-group-id="2754144009-3">)</span><span class="p" data-group-id="2754144009-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
  </span><span class="p" data-group-id="2754144009-4">{</span><span class="ss">valid</span><span class="p">,</span><span class="w"> </span><span class="n">UserState</span><span class="w"> </span><span class="p">:</span><span class="p">:</span><span class="w"> </span><span class="nf">term</span><span class="p" data-group-id="2754144009-5">(</span><span class="p" data-group-id="2754144009-5">)</span><span class="p" data-group-id="2754144009-4">}</span><span class="w"> </span><span class="p">|</span><span class="w">
  </span><span class="p" data-group-id="2754144009-6">{</span><span class="ss">fail</span><span class="p">,</span><span class="w"> </span><span class="n">Reason</span><span class="w"> </span><span class="p">:</span><span class="p">:</span><span class="w"> </span><span class="nf">term</span><span class="p" data-group-id="2754144009-7">(</span><span class="p" data-group-id="2754144009-7">)</span><span class="p" data-group-id="2754144009-6">}</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="p" data-group-id="2754144009-8">{</span><span class="ss">unknown</span><span class="p">,</span><span class="w"> </span><span class="n">UserState</span><span class="w"> </span><span class="p">:</span><span class="p">:</span><span class="w"> </span><span class="nf">term</span><span class="p" data-group-id="2754144009-9">(</span><span class="p" data-group-id="2754144009-9">)</span><span class="p" data-group-id="2754144009-8">}</span><span class="p">.</span><span class="w">

</span><span class="nf">fun</span><span class="p" data-group-id="2754144009-10">(</span><span class="n">OtpCert</span><span class="w"> </span><span class="p">:</span><span class="p">:</span><span class="w"> </span><span class="o">#</span><span class="ss">&#39;OTPCertificate&#39;</span><span class="p" data-group-id="2754144009-11">{</span><span class="p" data-group-id="2754144009-11">}</span><span class="p">,</span><span class="w"> </span><span class="n">DerCert</span><span class="w"> </span><span class="p">:</span><span class="p">:</span><span class="w"> </span><span class="nc">public_key</span><span class="p">:</span><span class="nf">der_encoded</span><span class="p" data-group-id="2754144009-12">(</span><span class="p" data-group-id="2754144009-12">)</span><span class="p">,</span><span class="w">
    </span><span class="n">Event</span><span class="p">,</span><span class="w"> </span><span class="n">InitialUserState</span><span class="w"> </span><span class="p">:</span><span class="p">:</span><span class="w"> </span><span class="nf">term</span><span class="p" data-group-id="2754144009-13">(</span><span class="p" data-group-id="2754144009-13">)</span><span class="p" data-group-id="2754144009-10">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
  </span><span class="p" data-group-id="2754144009-14">{</span><span class="ss">valid</span><span class="p">,</span><span class="w"> </span><span class="n">UserState</span><span class="w"> </span><span class="p">:</span><span class="p">:</span><span class="w"> </span><span class="nf">term</span><span class="p" data-group-id="2754144009-15">(</span><span class="p" data-group-id="2754144009-15">)</span><span class="p" data-group-id="2754144009-14">}</span><span class="w"> </span><span class="p">|</span><span class="w">
  </span><span class="p" data-group-id="2754144009-16">{</span><span class="ss">fail</span><span class="p">,</span><span class="w"> </span><span class="n">Reason</span><span class="w"> </span><span class="p">:</span><span class="p">:</span><span class="w"> </span><span class="nf">term</span><span class="p" data-group-id="2754144009-17">(</span><span class="p" data-group-id="2754144009-17">)</span><span class="p" data-group-id="2754144009-16">}</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="p" data-group-id="2754144009-18">{</span><span class="ss">unknown</span><span class="p">,</span><span class="w"> </span><span class="n">UserState</span><span class="w"> </span><span class="p">:</span><span class="p">:</span><span class="w"> </span><span class="nf">term</span><span class="p" data-group-id="2754144009-19">(</span><span class="p" data-group-id="2754144009-19">)</span><span class="p" data-group-id="2754144009-18">}</span><span class="p">.</span><span class="w">

</span><span class="n">Types</span><span class="p">:</span><span class="w">
      </span><span class="n">Event</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="2754144009-20">{</span><span class="ss">bad_cert</span><span class="p">,</span><span class="w"> </span><span class="n">Reason</span><span class="w"> </span><span class="p">:</span><span class="p">:</span><span class="w"> </span><span class="nf">atom</span><span class="p" data-group-id="2754144009-21">(</span><span class="p" data-group-id="2754144009-21">)</span><span class="w"> </span><span class="p">|</span><span class="w">
              </span><span class="p" data-group-id="2754144009-22">{</span><span class="ss">revoked</span><span class="p">,</span><span class="w"> </span><span class="nf">atom</span><span class="p" data-group-id="2754144009-23">(</span><span class="p" data-group-id="2754144009-23">)</span><span class="p" data-group-id="2754144009-22">}</span><span class="p" data-group-id="2754144009-20">}</span><span class="w"> </span><span class="p">|</span><span class="w">
      </span><span class="p" data-group-id="2754144009-24">{</span><span class="ss">extension</span><span class="p">,</span><span class="w"> </span><span class="o">#</span><span class="ss">&#39;Extension&#39;</span><span class="p" data-group-id="2754144009-25">{</span><span class="p" data-group-id="2754144009-25">}</span><span class="p" data-group-id="2754144009-24">}</span><span class="w"> </span><span class="p">|</span><span class="w">
              </span><span class="ss">valid</span><span class="w"> </span><span class="p">|</span><span class="w">
              </span><span class="ss">valid_peer</span></code></pre><p>The verification fun is called during the X.509-path validation when
an error occurs or an extension unknown to the SSL application is
encountered. It is also called when a certificate is considered
valid by the path validation to allow access to each certificate in
the path to the user application. It differentiates between the peer
certificate and the CA certificates by using <code class="inline">valid_peer</code> or <code class="inline">valid</code>
as <code class="inline">Event</code> argument to the verification fun. See the <a href="../../apps/public_key/public_key_records.html">Public_Key
User's Guide</a> for definition
of <code class="inline">#'OTPCertificate'{}</code> and <code class="inline">#'Extension'{}</code>.</p><ul><li>If the verify callback fun returns <code class="inline">{fail, Reason}</code>, the verification process
is immediately stopped, an alert is sent to the peer, and the TLS/DTLS
handshake terminates.</li><li>If the verify callback fun returns <code class="inline">{valid, UserState}</code>, the verification
process continues.</li><li>If the verify callback fun always returns <code class="inline">{valid, UserState}</code>, the TLS/DTLS
handshake does not terminate regardless of verification failures, and the
connection is established.</li><li>If called with an extension unknown to the user application, the fun is to
return <code class="inline">{unknown, UserState}</code>.</li></ul><p>Note that if the fun returns <code class="inline">unknown</code> for an extension marked as critical,
validation will fail.</p><p>Default option <code class="inline">verify_fun</code> in <code class="inline">verify_peer mode</code>:</p><pre><code class="makeup erlang" translate="no"><span class="p" data-group-id="9676956150-1">{</span><span class="nf">fun</span><span class="p" data-group-id="9676956150-2">(</span><span class="p">_</span><span class="p">,</span><span class="w"> </span><span class="p">_</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9676956150-3">{</span><span class="ss">bad_cert</span><span class="p">,</span><span class="w"> </span><span class="p">_</span><span class="p" data-group-id="9676956150-3">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Reason</span><span class="p">,</span><span class="w"> </span><span class="p">_</span><span class="p" data-group-id="9676956150-2">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
   </span><span class="p" data-group-id="9676956150-4">{</span><span class="ss">fail</span><span class="p">,</span><span class="w"> </span><span class="n">Reason</span><span class="p" data-group-id="9676956150-4">}</span><span class="p">;</span><span class="w">
    </span><span class="p" data-group-id="9676956150-5">(</span><span class="p">_</span><span class="p">,</span><span class="w"> </span><span class="p">_</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9676956150-6">{</span><span class="ss">extension</span><span class="p">,</span><span class="w"> </span><span class="p">_</span><span class="p" data-group-id="9676956150-6">}</span><span class="p">,</span><span class="w"> </span><span class="n">UserState</span><span class="p" data-group-id="9676956150-5">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
   </span><span class="p" data-group-id="9676956150-7">{</span><span class="ss">unknown</span><span class="p">,</span><span class="w"> </span><span class="n">UserState</span><span class="p" data-group-id="9676956150-7">}</span><span class="p">;</span><span class="w">
    </span><span class="p" data-group-id="9676956150-8">(</span><span class="p">_</span><span class="p">,</span><span class="w"> </span><span class="p">_</span><span class="p">,</span><span class="w"> </span><span class="ss">valid</span><span class="p">,</span><span class="w"> </span><span class="n">UserState</span><span class="p" data-group-id="9676956150-8">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
   </span><span class="p" data-group-id="9676956150-9">{</span><span class="ss">valid</span><span class="p">,</span><span class="w"> </span><span class="n">UserState</span><span class="p" data-group-id="9676956150-9">}</span><span class="p">;</span><span class="w">
    </span><span class="p" data-group-id="9676956150-10">(</span><span class="p">_</span><span class="p">,</span><span class="w"> </span><span class="p">_</span><span class="p">,</span><span class="w"> </span><span class="ss">valid_peer</span><span class="p">,</span><span class="w"> </span><span class="n">UserState</span><span class="p" data-group-id="9676956150-10">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
       </span><span class="p" data-group-id="9676956150-11">{</span><span class="ss">valid</span><span class="p">,</span><span class="w"> </span><span class="n">UserState</span><span class="p" data-group-id="9676956150-11">}</span><span class="w">
 </span><span class="k">end</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9676956150-12">[</span><span class="p" data-group-id="9676956150-12">]</span><span class="p" data-group-id="9676956150-1">}</span></code></pre><p>Default option <code class="inline">verify_fun</code> in mode <code class="inline">verify_none</code>:</p><pre><code class="makeup erlang" translate="no"><span class="w"> </span><span class="p" data-group-id="9873620446-1">{</span><span class="nf">fun</span><span class="p" data-group-id="9873620446-2">(</span><span class="p">_</span><span class="p">,</span><span class="w"> </span><span class="p">_</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9873620446-3">{</span><span class="ss">bad_cert</span><span class="p">,</span><span class="w"> </span><span class="p">_</span><span class="p" data-group-id="9873620446-3">}</span><span class="p">,</span><span class="w"> </span><span class="n">UserState</span><span class="p" data-group-id="9873620446-2">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
   </span><span class="p" data-group-id="9873620446-4">{</span><span class="ss">valid</span><span class="p">,</span><span class="w"> </span><span class="n">UserState</span><span class="p" data-group-id="9873620446-4">}</span><span class="p">;</span><span class="w">
    </span><span class="p" data-group-id="9873620446-5">(</span><span class="p">_</span><span class="p">,</span><span class="w"> </span><span class="p">_</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9873620446-6">{</span><span class="ss">extension</span><span class="p">,</span><span class="w"> </span><span class="o">#</span><span class="ss">&#39;Extension&#39;</span><span class="p" data-group-id="9873620446-7">{</span><span class="ss">critical</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">true</span><span class="p" data-group-id="9873620446-7">}</span><span class="p" data-group-id="9873620446-6">}</span><span class="p">,</span><span class="w"> </span><span class="n">UserState</span><span class="p" data-group-id="9873620446-5">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
   </span><span class="p" data-group-id="9873620446-8">{</span><span class="ss">valid</span><span class="p">,</span><span class="w"> </span><span class="n">UserState</span><span class="p" data-group-id="9873620446-8">}</span><span class="p">;</span><span class="w">
    </span><span class="p" data-group-id="9873620446-9">(</span><span class="p">_</span><span class="p">,</span><span class="w"> </span><span class="p">_</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9873620446-10">{</span><span class="ss">extension</span><span class="p">,</span><span class="w"> </span><span class="p">_</span><span class="p" data-group-id="9873620446-10">}</span><span class="p">,</span><span class="w"> </span><span class="n">UserState</span><span class="p" data-group-id="9873620446-9">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
   </span><span class="p" data-group-id="9873620446-11">{</span><span class="ss">unknown</span><span class="p">,</span><span class="w"> </span><span class="n">UserState</span><span class="p" data-group-id="9873620446-11">}</span><span class="p">;</span><span class="w">
    </span><span class="p" data-group-id="9873620446-12">(</span><span class="p">_</span><span class="p">,</span><span class="w"> </span><span class="p">_</span><span class="p">,</span><span class="w"> </span><span class="ss">valid</span><span class="p">,</span><span class="w"> </span><span class="n">UserState</span><span class="p" data-group-id="9873620446-12">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
   </span><span class="p" data-group-id="9873620446-13">{</span><span class="ss">valid</span><span class="p">,</span><span class="w"> </span><span class="n">UserState</span><span class="p" data-group-id="9873620446-13">}</span><span class="p">;</span><span class="w">
    </span><span class="p" data-group-id="9873620446-14">(</span><span class="p">_</span><span class="p">,</span><span class="w"> </span><span class="p">_</span><span class="p">,</span><span class="w"> </span><span class="ss">valid_peer</span><span class="p">,</span><span class="w"> </span><span class="n">UserState</span><span class="p" data-group-id="9873620446-14">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
       </span><span class="p" data-group-id="9873620446-15">{</span><span class="ss">valid</span><span class="p">,</span><span class="w"> </span><span class="n">UserState</span><span class="p" data-group-id="9873620446-15">}</span><span class="w">
 </span><span class="k">end</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9873620446-16">[</span><span class="p" data-group-id="9873620446-16">]</span><span class="p" data-group-id="9873620446-1">}</span></code></pre><p>The possible path validation errors are given in the form <code class="inline">{bad_cert, Reason}</code>,
where <code class="inline">Reason</code> is:</p><ul><li><p><strong><code class="inline">unknown_ca</code></strong></p><p>No trusted CA was found in the trusted store. The trusted
CA is normally a so-called ROOT CA, which is a self-signed certificate. Trust
can be claimed for an intermediate CA (the trusted anchor does not have to be
self-signed according to X-509) by using option <code class="inline">partial_chain</code>.</p></li><li><p><strong><code class="inline">selfsigned_peer</code></strong></p><p>The chain consisted only of one self-signed certificate.</p></li><li><p><strong>{invalid_ext_keyusage, [public_key:oid()]} </strong></p></li></ul><p> If the peer certificate specifies the extended keyusage extension and does
 not include the purpose for either being a TLS server (id-kp-ServerAuth) or
 TLS client (id-kp-ClientAuth) depending on the peers role.</p><ul><li><strong>{ca_invalid_ext_keyusage, [public_key:oid()]} </strong></li></ul><p> If a CA certificate specifies the extended keyusage extension and does
 not include the purpose for either being a TLS server
 (id-kp-ServerAuth) or TLS client (id-kp-ClientAuth) depending
 on the role of the peer chained with this CA, or the option allow_any_ca_purpose is set to <code class="inline">true</code>
 but the special any-value (anyExtendedKeyUsage) is not included in the CA cert purposes.</p><ul><li><p><strong><code class="inline">PKIX X-509-path validation error</code></strong></p><p>For possible reasons, see <a href="../../apps/public_key/public_key.html#pkix_path_validation/3"><code class="inline">public_key:pkix_path_validation/3</code></a>.</p></li></ul></li><li><p><strong><code class="inline">{cert_policy_opts, PolicyOpts}</code></strong> - Handle certificate policies.</p><p>Configure X.509 certificate policy handling for the certificate path validation process;
see <a href="../../apps/public_key/public_key.html#pkix_path_validation/3">public_key:pkix_path_validation/3</a> for
more details.</p></li><li><p><strong><code class="inline">{allow_any_ca_purpose, boolean()}</code></strong> - Handle certificate extended key usages extension</p><p>If a CA certificate has an extended key usage extension but it does not want to
restrict the usages of the key it can include a special <code class="inline">anyExtendedKeyUsage</code> purpose.
If this is option is set to <code class="inline">true</code> all key usage purposes is automatically
accepted for a CA that include that purpose, the options default to false.</p></li><li><p><strong><code class="inline">{cerl_check, Check}</code></strong>  - Handle certificate revocation lists.</p><p>Perform CRL (Certificate Revocation List) verification
<a href="../../apps/public_key/public_key.html#pkix_crls_validate/3">(public_key:pkix_crls_validate/3)</a> on all
the certificates during the path validation
<a href="../../apps/public_key/public_key.html#pkix_path_validation/3">(public_key:pkix_path_validation/3) </a>of
the certificate chain. <code class="inline">Check</code> defaults to <code class="inline">false</code>.</p><p>The meaning of <code class="inline">Check</code> is as follows:</p><ul><li><p><strong><code class="inline">false</code></strong></p><p>No checks are performed.</p></li><li><p><strong><code class="inline">peer</code></strong></p><p>Check is only performed on the peer certificate.</p></li><li><p><strong><code class="inline">best_effort</code></strong></p><p>If certificate revocation status cannot be determined it will be accepted as valid.</p><p>The CA certificates specified for the connection will be used to construct the
certificate chain validating the CRLs.</p><p>The CRLs will be fetched from a local or external cache. See
<a href="ssl_crl_cache_api.html"><code class="inline">ssl_crl_cache_api</code></a>.</p></li></ul></li></ul>
  </section>
</section>
<section class="detail" id="t:common_option_dtls/0">

  <div class="detail-header">
    <a href="#t:common_option_dtls/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">common_option_dtls()</h1>

        <span class="note">(not exported)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L1702" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> common_option_dtls() ::
          {use_srtp, UseSrtp :: #{protection_profiles := [<a href="../../apps/erts/erlang.html#t:binary/0">binary</a>()], mki => <a href="../../apps/erts/erlang.html#t:binary/0">binary</a>()}}.</pre>

      </div>

<p>Common options to client and server only valid for DTLS.</p><ul><li><p><strong><code class="inline">{use_srtp, UseSrtp}</code></strong> - Configures the <code class="inline">use_srtp</code> DTLS hello extension.</p><p>In order to negotiate the use of SRTP data protection, clients include an
extension of type &quot;use_srtp&quot; in the DTLS extended client hello. This extension
MUST only be used when the data being transported is RTP or RTCP.</p><p>The value is a map with a mandatory <code class="inline">protection_profiles</code> parameter
and an optional <code class="inline">mki</code> parameter.</p><p><code class="inline">protection_profiles</code> configures the list of the client's acceptable SRTP
Protection Profiles. Each profile is a 2-byte binary. Example:
<code class="inline">#{protection_profiles =&gt; [&lt;&lt;0,2&gt;&gt;, &lt;&lt;0,5&gt;&gt;]}</code></p><p><code class="inline">mki</code> configures the SRTP Master Key Identifier chosen by the client.</p><p>The <code class="inline">srtp_mki</code> field contains the value of the SRTP MKI which is associated with
the SRTP master keys derived from this handshake. Each SRTP session MUST have
exactly one master key that is used to protect packets at any given time. The
client MUST choose the MKI value so that it is distinct from the last MKI value
that was used, and it SHOULD make these values unique for the duration of the
TLS session.</p><section role="note" class="admonition info"><h4 class="admonition-title info">Note</h4><p>OTP does not handle SRTP, so an external implementations of SRTP
encoder/decoder and a packet demultiplexer are needed to make use of the
<code class="inline">use_srtp</code> extension. See also option <a href="#t:transport_option/0">transport_option</a>.</p></section><p>Servers that receive an extended hello containing a &quot;use_srtp&quot; extension can
agree to use SRTP by including an extension of type &quot;use_srtp&quot;, with the chosen
protection profile in the extended server hello. This extension MUST only be
used when the data being transported is RTP or RTCP.</p></li></ul>
  </section>
</section>
<section class="detail" id="t:common_option_legacy/0">

  <div class="detail-header">
    <a href="#t:common_option_legacy/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">common_option_legacy()</h1>

        <span class="note">(not exported)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L1069" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> common_option_legacy() ::
          {cert, Cert :: <a href="../../apps/public_key/public_key.html#t:der_encoded/0">public_key:der_encoded</a>() | [<a href="../../apps/public_key/public_key.html#t:der_encoded/0">public_key:der_encoded</a>()]} |
          {certfile, CertPem :: <a href="../../apps/kernel/file.html#t:filename/0">file:filename</a>()} |
          {key, Key :: <a href="#t:key/0">key</a>()} |
          {keyfile, KeyPem :: <a href="../../apps/kernel/file.html#t:filename/0">file:filename</a>()} |
          {password, KeyPemPasswd :: <a href="../../apps/erts/erlang.html#t:iodata/0">iodata</a>() | fun(() -> <a href="../../apps/erts/erlang.html#t:iodata/0">iodata</a>())} |
          {log_alert, LogAlert :: <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>()} |
          {padding_check, PaddingCheck :: <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>()} |
          {beast_mitigation, one_n_minus_one | zero_n | disabled} |
          {ssl_imp, Imp :: new | old}.</pre>

      </div>

<p>Legacy options considered deprecated in favor of other options,
insecure to use, or plainly not relevant anymore.</p><ul><li><p><strong><code class="inline">{cert, Certs}</code></strong></p><p>Use option <code class="inline">certs_keys</code> instead.</p></li><li><p><strong><code class="inline">{certfile, CertPem}</code></strong></p><p>Use option <code class="inline">certs_keys</code> instead.</p></li><li><p><strong><code class="inline">{keyfile, KeyPem}</code></strong></p><p>Use option <code class="inline">certs_keys</code> instead.</p></li><li><p><strong><code class="inline">{password, KeyPemPasswd}</code></strong></p><p>Use option <code class="inline">certs_keys</code> instead.</p></li><li><p><strong><code class="inline">{log_alert, LogAlert}</code></strong></p><p>If <code class="inline">LogAlert</code> is <code class="inline">false</code>, TLS/DTLS Alert reports are not displayed. Deprecated in OTP
22; use <code class="inline">{log_level, Level}</code> instead.</p></li><li><p><strong><code class="inline">{padding_check, PaddingCheck}</code></strong> - Inter-op trade-off option</p><p>Affects TLS-1.0 connections only. If set to <code class="inline">false</code>, it disables the block
cipher padding check to be able to interoperate with legacy software.</p><section role="note" class="admonition warning"><h4 class="admonition-title warning">Warning</h4><p>Using <code class="inline">{padding_check, false}</code> makes TLS vulnerable to the Poodle attack.</p></section></li><li><p><strong><code class="inline">{beast_mitigation, BeastMitigation}</code></strong>  - Inter-op trade-off option</p><p>Affects TLS-1.0 connections only. Used to change the BEAST mitigation strategy
to interoperate with legacy software. Defaults to <code class="inline">one_n_minus_one</code>.</p><p><code class="inline">one_n_minus_one</code> - Perform <code class="inline">1/n-1</code> BEAST mitigation.</p><p><code class="inline">zero_n</code> - Perform <code class="inline">0/n</code> BEAST mitigation.</p><p><code class="inline">disabled</code> - Disable BEAST mitigation.</p><section role="note" class="admonition warning"><h4 class="admonition-title warning">Warning</h4><p>Using <code class="inline">{beast_mitigation, disabled}</code> makes TLS-1.0 vulnerable to the BEAST
attack.</p></section></li><li><p><strong><code class="inline">{ssl_imp, Imp}</code></strong></p><p>Deprecated since OTP 17; has no effect.</p></li></ul>
  </section>
</section>
<section class="detail" id="t:common_option_pre_tls13/0">

  <div class="detail-header">
    <a href="#t:common_option_pre_tls13/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">common_option_pre_tls13()</h1>

        <span class="note">(not exported)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L980" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> common_option_pre_tls13() ::
          {eccs, NamedCurves :: [<a href="#t:named_curve/0">named_curve</a>()]} |
          {secure_renegotiate, SecureRenegotiate :: <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>()} |
          {user_lookup_fun, {Lookupfun :: fun(), UserState :: <a href="../../apps/erts/erlang.html#t:any/0">any</a>()}}.</pre>

      </div>

<p>Options common to client and server side prior to TLS-1.3.</p><ul><li><p><strong><code class="inline">{eccs, NamedCurves}</code></strong> - Named Elliptic Curves</p><p>Elliptic curves that can be used in pre TLS-1.3 key exchange.</p></li><li><p><strong><code class="inline">{secure_renegotiate, SecureRenegotiate}</code></strong> - Inter-operate trade-off option</p><p>Specifies whether to reject renegotiation attempt that does not live
up to <a href="http://www.ietf.org/rfc/rfc5746.txt">RFC 5746</a>. By default,
<code class="inline">SecureRenegotiate</code> is <code class="inline">true</code>, meaning that secure renegotiation is
enforced. If <code class="inline">SecureRenegotiate</code> is <code class="inline">false</code> secure renegotiation
will still be used if possible, but it falls back to insecure
renegotiation if the peer does not support if <a href="http://www.ietf.org/rfc/rfc5746.txt">RFC
5746</a>.</p></li><li><p><strong><code class="inline">{user_lookup_fun, {LookupFun, UserState}}</code></strong> - PSK/SRP cipher suite option</p><p>The lookup fun is to be defined as follows:</p><pre><code class="makeup erlang" translate="no"><span class="nf">fun</span><span class="p" data-group-id="1396676325-1">(</span><span class="ss">psk</span><span class="p">,</span><span class="w"> </span><span class="n">PSKIdentity</span><span class="w"> </span><span class="p">:</span><span class="p">:</span><span class="w"> </span><span class="nf">binary</span><span class="p" data-group-id="1396676325-2">(</span><span class="p" data-group-id="1396676325-2">)</span><span class="p">,</span><span class="w"> </span><span class="n">UserState</span><span class="w"> </span><span class="p">:</span><span class="p">:</span><span class="w"> </span><span class="nf">term</span><span class="p" data-group-id="1396676325-3">(</span><span class="p" data-group-id="1396676325-3">)</span><span class="p" data-group-id="1396676325-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
  </span><span class="p" data-group-id="1396676325-4">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">SharedSecret</span><span class="w"> </span><span class="p">:</span><span class="p">:</span><span class="w"> </span><span class="nf">binary</span><span class="p" data-group-id="1396676325-5">(</span><span class="p" data-group-id="1396676325-5">)</span><span class="p" data-group-id="1396676325-4">}</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="ss">error</span><span class="p">;</span><span class="w">
</span><span class="nf">fun</span><span class="p" data-group-id="1396676325-6">(</span><span class="ss">srp</span><span class="p">,</span><span class="w"> </span><span class="n">Username</span><span class="w"> </span><span class="p">:</span><span class="p">:</span><span class="w"> </span><span class="nf">binary</span><span class="p" data-group-id="1396676325-7">(</span><span class="p" data-group-id="1396676325-7">)</span><span class="p">,</span><span class="w"> </span><span class="n">UserState</span><span class="w"> </span><span class="p">:</span><span class="p">:</span><span class="w"> </span><span class="nf">term</span><span class="p" data-group-id="1396676325-8">(</span><span class="p" data-group-id="1396676325-8">)</span><span class="p" data-group-id="1396676325-6">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
  </span><span class="p" data-group-id="1396676325-9">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1396676325-10">{</span><span class="n">SRPParams</span><span class="w"> </span><span class="p">:</span><span class="p">:</span><span class="w"> </span><span class="nf">srp_param_type</span><span class="p" data-group-id="1396676325-11">(</span><span class="p" data-group-id="1396676325-11">)</span><span class="p">,</span><span class="w"> </span><span class="n">Salt</span><span class="w"> </span><span class="p">:</span><span class="p">:</span><span class="w"> </span><span class="nf">binary</span><span class="p" data-group-id="1396676325-12">(</span><span class="p" data-group-id="1396676325-12">)</span><span class="p">,</span><span class="w">
        </span><span class="n">DerivedKey</span><span class="w"> </span><span class="p">:</span><span class="p">:</span><span class="w"> </span><span class="nf">binary</span><span class="p" data-group-id="1396676325-13">(</span><span class="p" data-group-id="1396676325-13">)</span><span class="p" data-group-id="1396676325-10">}</span><span class="p" data-group-id="1396676325-9">}</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="ss">error</span><span class="p">.</span></code></pre><p>For Pre-Shared Key (PSK) cipher suites, the lookup fun is called by the client
and server to determine the shared secret. When called by the client,
<code class="inline">PSKIdentity</code> is the hint presented by the server or <code class="inline">undefined</code>. When
called by the server, <code class="inline">PSKIdentity</code> is the identity presented by the client.</p><p>For Secure Remote Password (SRP), the fun is only used by the server to obtain
parameters that it uses to generate its session keys. <code class="inline">DerivedKey</code> is to be
derived according to <a href="http://tools.ietf.org/html/rfc2945#section/3">RFC 2945</a>
and <a href="http://tools.ietf.org/html/rfc5054#section-2.4">RFC 5054</a>:
<code class="inline">crypto:sha([Salt, crypto:sha([Username, &lt;&lt;$:&gt;&gt;, Password])])</code></p></li></ul>
  </section>
</section>
<section class="detail" id="t:common_option_tls13/0">

  <div class="detail-header">
    <a href="#t:common_option_tls13/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">common_option_tls13()</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L1010" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> common_option_tls13() ::
          {supported_groups, [<a href="#t:group/0">group</a>()]} | {key_update_at, KeyUpdateAt :: <a href="../../apps/erts/erlang.html#t:pos_integer/0">pos_integer</a>()}.</pre>

      </div>

<p>Common options to both client and server for TLS-1.3.</p><ul><li><p><strong><code class="inline">{supported_groups, Groups}</code></strong> - Key exchange option</p><p>TLS 1.3 introduces the &quot;supported_groups&quot; extension, which is used for negotiating
the Diffie-Hellman parameters in a TLS 1.3 handshake. Both client and server can
specify a list of parameters that they are willing to use.</p><p>If not specified it will use a default list (<code class="inline">[x25519, x448, secp256r1, secp384r1]</code>) that is filtered based on the installed crypto library version.</p></li><li><p><strong><code class="inline">{key_update_at, KeyUpdateAt}</code></strong> - Session key renewal</p><p>Configures the maximum amount of bytes that can be sent on a TLS 1.3 connection
before an automatic key update is performed.</p><p>There are cryptographic limits on the amount of plaintext which can be safely
encrypted under a given set of keys. The current default ensures that data
integrity will not be breached with probability greater than <code class="inline">1/2^57</code>. For more
information see
<a href="https://eprint.iacr.org/2024/051.pdf">Limits on Authenticated Encryption Use in TLS</a>.</p></li></ul>
  </section>
</section>

    </div>
  </section>

  <section id="types-deprecated" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#types-deprecated">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Types: Deprecated</span>
    </h1>
    <div class="types-deprecated-list">
<section class="detail" id="t:prf_random/0">

  <div class="detail-header">
    <a href="#t:prf_random/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">prf_random()</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L2041" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

    <div class="deprecated">
      This type is deprecated. the type ssl:prf_random() is deprecated; Only used in deprecated function prf/5 and will no longer be needed..
    </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> prf_random() :: client_random | server_random.</pre>

      </div>


  </section>
</section>

    </div>
  </section>

  <section id="types-info" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#types-info">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Types: Info</span>
    </h1>
    <div class="types-info-list">
<section class="detail" id="t:connection_info/0">

  <div class="detail-header">
    <a href="#t:connection_info/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">connection_info()</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L2061" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> connection_info() ::
          [{protocol, <a href="#t:protocol_version/0">protocol_version</a>()} |
           {session_resumption, <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>()} |
           {selected_cipher_suite, <a href="#t:erl_cipher_suite/0">erl_cipher_suite</a>()} |
           {sni_hostname, <a href="../../apps/erts/erlang.html#t:term/0">term</a>()} |
           {ciphers, [<a href="#t:erl_cipher_suite/0">erl_cipher_suite</a>()]}] |
          <a href="#t:connection_info_pre_tls13/0">connection_info_pre_tls13</a>() |
          <a href="#t:security_info/0">security_info</a>().</pre>

      </div>

<p>Key value list convening some information about the established connection.</p>
  </section>
</section>
<section class="detail" id="t:connection_info_keys/0">

  <div class="detail-header">
    <a href="#t:connection_info_keys/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">connection_info_keys()</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L2097" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> connection_info_keys() ::
          [protocol | selected_cipher_suite | sni_hostname | session_resumption | ciphers |
           client_random | server_random | master_secret | keylog | session_id | session_data | ecc |
           srp_username].</pre>

      </div>

<p>TLS connection keys for which information can be retrieved.</p>
  </section>
</section>
<section class="detail" id="t:connection_info_pre_tls13/0">

  <div class="detail-header">
    <a href="#t:connection_info_pre_tls13/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">connection_info_pre_tls13()</h1>

        <span class="note">(not exported)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L2087" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> connection_info_pre_tls13() ::
          [{session_id, <a href="#t:session_id/0">session_id</a>()} |
           {session_data, <a href="../../apps/erts/erlang.html#t:binary/0">binary</a>()} |
           {ecc, {named_curve, <a href="../../apps/erts/erlang.html#t:term/0">term</a>()}} |
           {srp_username, <a href="../../apps/erts/erlang.html#t:term/0">term</a>()}].</pre>

      </div>

<p>TLS connection information relevant prior to TLS-1.3.</p>
  </section>
</section>
<section class="detail" id="t:security_info/0">

  <div class="detail-header">
    <a href="#t:security_info/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">security_info()</h1>

        <span class="note">(not exported)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L2073" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> security_info() ::
          [{client_random, <a href="../../apps/erts/erlang.html#t:binary/0">binary</a>()} |
           {server_random, <a href="../../apps/erts/erlang.html#t:binary/0">binary</a>()} |
           {master_secret, <a href="../../apps/erts/erlang.html#t:binary/0">binary</a>()} |
           {keylog, [<a href="#t:keylog_item/0">keylog_item</a>()]}].</pre>

      </div>

<p>TLS connection information that can be used for NSS key logging.</p>
  </section>
</section>

    </div>
  </section>

  <section id="types-server-options" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#types-server-options">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Types: Server Options</span>
    </h1>
    <div class="types-server-options-list">
<section class="detail" id="t:server_option/0">

  <div class="detail-header">
    <a href="#t:server_option/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">server_option()</h1>

        <span class="note">(not exported)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L1783" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> server_option() ::
          <a href="#t:server_option_cert/0">server_option_cert</a>() |
          <a href="#t:common_option_cert/0">common_option_cert</a>() |
          {alpn_preferred_protocols, AppProtocols :: [<a href="../../apps/erts/erlang.html#t:binary/0">binary</a>()]} |
          {sni_hosts, SNIHosts :: [{<a href="../../apps/kernel/inet.html#t:hostname/0">inet:hostname</a>(), [<a href="#t:server_option/0">server_option</a>() | <a href="#t:common_option/0">common_option</a>()]}]} |
          {sni_fun,
           SNIFun :: fun((<a href="../../apps/erts/erlang.html#t:string/0">string</a>()) -> [<a href="#t:server_option/0">server_option</a>() | <a href="#t:common_option/0">common_option</a>()] | unrecognized | undefined)} |
          <a href="#t:server_option_pre_tls13/0">server_option_pre_tls13</a>() |
          <a href="#t:common_option_pre_tls13/0">common_option_pre_tls13</a>() |
          <a href="#t:server_option_tls13/0">server_option_tls13</a>() |
          <a href="#t:common_option_tls13/0">common_option_tls13</a>() |
          <a href="#t:common_option_dtls/0">common_option_dtls</a>() |
          <a href="#t:server_option_legacy/0">server_option_legacy</a>() |
          <a href="#t:common_option_legacy/0">common_option_legacy</a>().</pre>

      </div>

<p>Options specific to the server side, or with different semantics for the client and server.</p><ul><li><p><strong><code class="inline">{alpn_preferred_protocols, AppProtocols}</code></strong> - Application Layer Protocol Negotiation</p><p>Indicates that the server will try to perform Application-Layer
Protocol Negotiation (ALPN).</p><p>The list of protocols is in order of preference. The protocol negotiated will be
the first in the list that matches one of the protocols advertised by the
client. If no protocol matches, the server will fail the connection with a
<code class="inline">no_application_protocol</code> alert.</p><p>The negotiated protocol can be retrieved using the
<a href="#negotiated_protocol/1"><code class="inline">negotiated_protocol/1</code></a> function.</p></li><li><p><strong><code class="inline">{sni_fun, SNIFun}</code></strong></p><p>If the server receives a SNI (Server Name Indication) from the
client, the given fun <code class="inline">SNIFun</code> will be called to retrieve
<a href="#t:server_option/0"><code class="inline">server_option()</code></a> for the indicated
server. These options will override previously specified server options.
The sni_fun can indicate that it does not recognize the server name by
returning <code class="inline">unrecognized</code> in which case the connection will be closed with an
<code class="inline">unrecognized_name</code> alert. If the
sni_fun returns <code class="inline">undefined</code> the connection will be attempted with the default
options supplied to <a href="#listen/2"><code class="inline">listen/2</code></a> or  <a href="#handshake/2"><code class="inline">handshake/2,3</code></a>.</p><section role="note" class="admonition info"><h4 class="admonition-title info">Note</h4><p>The options <code class="inline">sni_fun</code> and <code class="inline">sni_hosts</code> are mutually exclusive.</p></section></li><li><p><strong><code class="inline">{sni_hosts, SNIHosts}</code></strong></p><p>If the server receives a SNI (Server Name Indication) from the client matching a
host listed in the <code class="inline">sni_hosts</code> option, the specific options for that host will
override previously specified options. If no match is found it behaves as
option sni_fun that returns <code class="inline">undefined</code>.</p><section role="note" class="admonition info"><h4 class="admonition-title info">Note</h4><p>The options <code class="inline">sni_fun</code> and <code class="inline">sni_hosts</code> are mutually exclusive.</p></section></li></ul>
  </section>
</section>
<section class="detail" id="t:server_option_cert/0">

  <div class="detail-header">
    <a href="#t:server_option_cert/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">server_option_cert()</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L1839" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> server_option_cert() ::
          {cacerts, CACerts :: [<a href="../../apps/public_key/public_key.html#t:der_encoded/0">public_key:der_encoded</a>()] | [<a href="../../apps/public_key/public_key.html#t:combined_cert/0">public_key:combined_cert</a>()]} |
          {cacertfile, CACertFile :: <a href="../../apps/kernel/file.html#t:filename/0">file:filename</a>()} |
          {verify, Verify :: verify_none | verify_peer} |
          {fail_if_no_peer_cert, FailNoPeerCert :: <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>()} |
          {certificate_authorities, ServerCertAuth :: <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>()}.</pre>

      </div>

<p>Certificate related options for a server.</p><ul><li><p><strong><code class="inline">{cacerts, CACerts}</code></strong> - Trusted certificates.</p><p>The DER-encoded trusted certificates. If this option is supplied, it overrides
the <code class="inline">cacertfile</code> option.</p></li><li><p><strong><code class="inline">{verify, Verify}</code></strong> - Verify certificates.</p><p>Client certificates are an optional part of the TLS protocol. A server performs
X.509 certificate path validation only in <code class="inline">verify_peer</code> mode. By default the server
is in <code class="inline">verify_none</code> mode and, hence, will not send an certificate request to the
client. When using <code class="inline">verify_peer</code> you may also want to specify the options
<code class="inline">fail_if_no_peer_cert</code> and <code class="inline">certificate_authorities</code>.</p></li><li><p><strong><code class="inline">{fail_if_no_peer_cert, FailNoPeerCert}</code></strong> - Legacy trade-off option</p><p>Used together with <code class="inline">{verify, verify_peer}</code> by an TLS/DTLS server. If set to
<code class="inline">true</code>, the server fails if the client does not have a certificate to send, that
is, sends an empty certificate. If set to <code class="inline">false</code>, it fails only if the client
sends an invalid certificate (an empty certificate is considered valid).
Defaults to <code class="inline">false</code>.</p></li><li><p><strong><code class="inline">{certificate_authorities, ServerCertAuth}</code></strong> - Inter-operate hint option</p><p>Determines whether a TLS-1.3 server should include the authorities extension in its
certificate request message that is sent when the option <code class="inline">verify</code> is set to
<code class="inline">verify_peer</code>. Defaults to <code class="inline">true</code>.</p><p>If set to <code class="inline">false</code> for older TLS versions its corresponding certificate authorities
definition in its certificate request will be set to the empty list instead of
including the appropriate certificate authorities. This has the same affect
as excluding the TLS-1.3 extension.</p><p>A reason to exclude the extension would be if the server wants to communicate
with clients incapable of sending complete certificate chains that adhere to the
extension, but the server still has the capability to recreate a chain that it
can verify.</p></li></ul>
  </section>
</section>
<section class="detail" id="t:server_option_legacy/0">

  <div class="detail-header">
    <a href="#t:server_option_legacy/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">server_option_legacy()</h1>

        <span class="note">(not exported)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L2035" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> server_option_legacy() :: {next_protocols_advertised, NextAppProtocols :: [<a href="../../apps/erts/erlang.html#t:binary/0">binary</a>()]}.</pre>

      </div>

<p>Legacy server options.</p><ul><li><p><strong><code class="inline">{next_protocols_advertised, NextAppProtocols}</code></strong></p><p>ALPN (Application-Layer Protocol Negotiation)
deprecates NPN (Next Protocol Negotiation) described here.</p><p>List of protocols to send to the client if the client indicates that it supports
the Next Protocol extension. The client can select a protocol that is not on
this list. The list of protocols must not contain an empty binary. If the server
negotiates a Next Protocol, it can be accessed using the
<a href="#negotiated_protocol/1"><code class="inline">negotiated_protocol/1</code></a> method.</p></li></ul>
  </section>
</section>
<section class="detail" id="t:server_option_pre_tls13/0">

  <div class="detail-header">
    <a href="#t:server_option_pre_tls13/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">server_option_pre_tls13()</h1>

        <span class="note">(not exported)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L1906" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> server_option_pre_tls13() ::
          {client_renegotiation, ClientRengotiation :: <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>()} |
          {reuse_sessions, ReuseSessions :: <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>()} |
          {reuse_session, ReuseSession :: fun()} |
          {honor_cipher_order, HonorServerCipherOrder :: <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>()} |
          {honor_ecc_order, HonorServerECCOrder :: <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>()} |
          {dh, DHDer :: <a href="../../apps/public_key/public_key.html#t:der_encoded/0">public_key:der_encoded</a>()} |
          {dhfile, DhFile :: <a href="../../apps/kernel/file.html#t:filename/0">file:filename</a>()} |
          {psk_identity, PSKHint :: <a href="../../apps/erts/erlang.html#t:string/0">string</a>()}.</pre>

      </div>

<p>Options only relevant to TLS versions prior to TLS-1.3.</p><ul><li><p><strong><code class="inline">{client_renegotiation, ClientRengotiation}</code></strong> - DoS attack avoidance option</p><p>In protocols that support client-initiated renegotiation, the resource cost
of such an operation is higher for the server than the client. This can act as a
vector for denial-of-service (DoS) attacks. The SSL application already takes measures
to counter-act such attempts, but client-initiated renegotiation can be completely
disabled by setting this option to <code class="inline">false</code>. The default value is <code class="inline">true</code>. Note
that disabling renegotiation can result in long-lived connections becoming
unusable due to limits on the number of messages the underlying cipher suite can
encipher.</p></li><li><p><strong><code class="inline">{reuse_sessions, ReuseSessions}</code></strong> - Enable session reuse</p><p>The boolean value <code class="inline">true</code> specifies that the server will agree to reuse sessions.
Setting it to <code class="inline">false</code> will result in an empty session table, meaning that no sessions
will be reused.</p></li><li><p><strong><code class="inline">{reuse_session, ReuseSession}</code></strong> - Local server reuse policy</p><p>Enables the TLS/DTLS server to have a local policy for deciding whether a session
is to be reused. Meaningful only if <code class="inline">reuse_sessions</code> is set to <code class="inline">true</code>.</p><p><code class="inline">ReuseSession</code> should be a fun:</p><p> <code class="inline">fun(SuggestedSessionId, PeerCert, Compression, CipherSuite)</code></p><p><code class="inline">SuggestedSessionId</code> is a <a href="../../apps/erts/erlang.html#t:binary/0"><code class="inline">binary()</code></a>,
<code class="inline">PeerCert</code> is a DER-encoded certificate,
<code class="inline">Compression</code> is an enumeration integer, and <code class="inline">CipherSuite</code> is of type
<a href="#t:erl_cipher_suite/0"><code class="inline">erl_cipher_suite()</code></a>.</p></li><li><p><strong><code class="inline">{psk_identity, PSKHint}</code></strong> - Inter-operate hint option</p><p>Specifies the server identity hint that the server presents to the client.</p></li><li><p><strong><code class="inline">{honor_cipher_order, HonorServerCipherOrder}</code></strong> - Trade-off option alters protocol defined behavior</p><p>If <code class="inline">true</code>, use the server's preference for ECC curve selection. If <code class="inline">false</code> (the
default), use the client's preference.</p></li><li><p><strong><code class="inline">{honor_ecc_order, HonorServerECCOrder}</code></strong> - Trade-off option alters protocol defined behavior</p><p>If <code class="inline">true</code>, use the server's preference for ECC curve selection. If <code class="inline">false</code> (the
default), use the client's preference.</p></li><li><p><strong><code class="inline">{dh, DHder}</code></strong> - Affects DH key exchange cipher suites</p><p>The DER-encoded Diffie-Hellman parameters. If specified, it overrides option
<code class="inline">dhfile</code>.</p></li><li><p><strong><code class="inline">{dh_file, DHfile}</code></strong> - Affects DH key exchange cipher suites</p><p>Path to a file containing PEM-encoded Diffie Hellman parameters to be used by
the server if a cipher suite using Diffie Hellman key exchange is negotiated. If
not specified, default parameters are used.</p></li></ul>
  </section>
</section>
<section class="detail" id="t:server_option_tls13/0">

  <div class="detail-header">
    <a href="#t:server_option_tls13/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">server_option_tls13()</h1>

        <span class="note">(not exported)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L2010" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> server_option_tls13() ::
          {session_tickets,
           SessionTickets :: disabled | stateful | stateless | stateful_with_cert | stateless_with_cert} |
          {stateless_tickets_seed, TicketSeed :: <a href="../../apps/erts/erlang.html#t:binary/0">binary</a>()} |
          {anti_replay,
           '10k' | '100k' |
           {BloomFilterWindowSize :: <a href="../../apps/erts/erlang.html#t:pos_integer/0">pos_integer</a>(),
            BloomFilterHashFunctions :: <a href="../../apps/erts/erlang.html#t:pos_integer/0">pos_integer</a>(),
            BloomFilterBits :: <a href="../../apps/erts/erlang.html#t:pos_integer/0">pos_integer</a>()}} |
          {cookie, Cookie :: <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>()} |
          {early_data, EarlyData :: enabled | disabled}.</pre>

      </div>

<p>Options only relevant for TLS-1.3.</p><ul><li><p><strong><code class="inline">{session_tickets, SessionTickets}</code></strong></p><p>Configures the session ticket functionality. Allowed values for <code class="inline">SessionTickets</code> are:</p><ul><li><code class="inline">disabled</code></li><li><code class="inline">stateful</code></li><li><code class="inline">stateless</code></li><li><code class="inline">stateful_with_cert</code></li><li><code class="inline">stateless_with_cert</code></li></ul><p>If <code class="inline">SessionTickets</code> is not set to <code class="inline">disabled</code>, session resumption with pre-shared
keys is enabled and the server will send stateful or stateless session tickets to the
client after successful connections.</p><section role="note" class="admonition info"><h4 class="admonition-title info">Note</h4><p>In pre-shared key session ticket resumption, there is no certificate
exchange involved. Therefore, <a href="#peercert/1"><code class="inline">ssl:peercert/1</code></a> will not return the
peer certificate, as it is only communicated during the initial
handshake. To associate the client certificate from the original
handshake with the tickets it issues, the server options
<code class="inline">stateful_with_cert</code> or <code class="inline">stateless_with_cert</code> can be used.</p></section><p>A stateful session ticket is a database reference to internal state information.
A stateless session ticket is a self-encrypted binary that contains both
cryptographic keying material and state data.</p><section role="note" class="admonition warning"><h4 class="admonition-title warning">Warning</h4><p>When <code class="inline">SessionTickets</code> is set to <code class="inline">stateful_with_cert</code>, the client
certificate is stored along with the internal state information,
leading to increased memory consumption. Conversely, when it is set
to <code class="inline">stateless_with_cert</code>, the client certificate is encoded in the
self-encrypted binary sent to the client, resulting in an increase
in payload size.</p></section><p>See also <a href="using_ssl.html#session-tickets-and-session-resumption-in-tls-1-3">SSL User's Guide, Session Tickets and Session Resumption in TLS 1.3</a>.</p></li><li><p><strong><code class="inline">{stateless_tickets_seed, TicketSeed}</code></strong> - Option for statless tickets</p><p>Configures the seed used for the encryption of stateless session tickets.
Allowed values are any randomly generated <a href="../../apps/erts/erlang.html#t:binary/0"><code class="inline">binary/0</code></a>. If this option is not
configured, an encryption seed will be randomly generated.</p><section role="note" class="admonition warning"><h4 class="admonition-title warning">Warning</h4><p>Reusing the ticket encryption seed between multiple server instances enables
stateless session tickets to work across multiple server instances, but it
breaks anti-replay protection across instances.</p><p>Inaccurate time synchronization between server instances can also affect
session ticket freshness checks, potentially causing false negatives as well
as false positives.</p></section></li><li><p><strong><code class="inline">{anti_replay, AntiReplay}</code></strong> - Option for statless tickets</p><p>Configures the server's built-in anti replay feature based on Bloom filters.</p><p>Allowed values for <code class="inline">AntiReplay</code> are the pre-defined <code class="inline">'10k'</code>,
<code class="inline">'100k'</code>, or a custom 3-tuple that defines the properties of the
bloom filters:
<code class="inline">{WindowSize, HashFunctions, Bits}</code>. <code class="inline">WindowSize</code> is the number of seconds after
the current Bloom filter is rotated and also the window size used for freshness
checks of ClientHello. <code class="inline">HashFunctions</code> is the number hash functions and <code class="inline">Bits</code>
is the number of bits in the bit vector. <code class="inline">'10k'</code> and <code class="inline">'100k'</code> are simple
defaults with the following properties:</p><ul><li><code class="inline">'10k'</code>: Bloom filters can hold 10000 elements with 3% probability of false
positives. <code class="inline">WindowSize</code>: 10, <code class="inline">HashFunctions</code>: 5, <code class="inline">Bits:</code> 72985 (8.91 KiB).</li><li><code class="inline">'100k'</code>: Bloom filters can hold 100000 elements with 3% probability of false
positives. <code class="inline">WindowSize</code>: 10, <code class="inline">HashFunctions</code>: 5, <code class="inline">Bits</code>: 729845 (89.09 KiB).</li></ul><p>See also <a href="using_ssl.html#anti-replay-protection-in-tls-1-3">SSL User's Guide, Anti-Replay Protection in TLS
1.3</a>.</p></li><li><p><strong><code class="inline">{cookie, Cookie}</code></strong> - Option for <code class="inline">HelloRetryRequest</code> behavior</p><p>If <code class="inline">Cookie</code> is <code class="inline">true</code>, which is the default, the server sends a
cookie extension in its <code class="inline">HelloRetryRequest</code> messages.</p><p>The cookie extension has two main purposes. It allows the server to force the
client to demonstrate reachability at their apparent network address (thus
providing a measure of DoS protection). This is primarily useful for
non-connection-oriented transports. It also allows offloading the server's
state to the client. The cookie extension is enabled by default as it is a
mandatory extension in RFC8446.</p></li><li><p><strong><code class="inline">{early_data, EarlyData}</code></strong> - Option for accepting or rejecting Early Data</p><p>Configures if the server accepts (<code class="inline">enabled</code>) or rejects (<code class="inline">disabled</code>) early data
sent by a client. The default value is <code class="inline">disabled</code>.</p></li></ul>
  </section>
</section>

    </div>
  </section>

  <section id="types-socket" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#types-socket">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Types: Socket</span>
    </h1>
    <div class="types-socket-list">
<section class="detail" id="t:active_msgs/0">

  <div class="detail-header">
    <a href="#t:active_msgs/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">active_msgs()</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L254" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> active_msgs() ::
          {ssl, <a href="#t:sslsocket/0">sslsocket</a>(), Data :: <a href="../../apps/erts/erlang.html#t:binary/0">binary</a>() | <a href="../../apps/erts/erlang.html#t:list/0">list</a>()} |
          {ssl_closed, <a href="#t:sslsocket/0">sslsocket</a>()} |
          {ssl_error, <a href="#t:sslsocket/0">sslsocket</a>(), Alert :: <a href="#t:error_alert/0">error_alert</a>() | (Reason :: <a href="../../apps/erts/erlang.html#t:any/0">any</a>())} |
          {ssl_passive, <a href="#t:sslsocket/0">sslsocket</a>()}.</pre>

      </div>

<p>The type for the messages that are delivered to the owner of a
TLS/DTLS socket in active mode.</p><p>The <code class="inline">ssl_error</code> reason may convey a TLS protocol alert if such an event occurs
after the connection has been established. The most common case when this will
happen is on the client side when a TLS-1.3 server requests a client certificate
and the provided certificate is not accepted by the server, as it will be
verified after the server has sent its last handshake message.</p><p>The <code class="inline">ssl_passive</code> message is sent only when the socket is in <code class="inline">{active, N}</code> mode
and the counter has dropped to 0. It indicates that the socket has transitioned
to passive (<code class="inline">{active, false}</code>) mode.</p>
  </section>
</section>
<section class="detail" id="t:dtls_legacy_version/0">

  <div class="detail-header">
    <a href="#t:dtls_legacy_version/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">dtls_legacy_version()</h1>

        <span class="note">(not exported)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L324" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> dtls_legacy_version() :: dtlsv1.</pre>

      </div>

<p>A DTLS protocol version that are no longer supported by default for security reasons.</p>
  </section>
</section>
<section class="detail" id="t:dtls_version/0">

  <div class="detail-header">
    <a href="#t:dtls_version/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">dtls_version()</h1>

        <span class="note">(not exported)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L312" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> dtls_version() :: 'dtlsv1.2' | <a href="#t:dtls_legacy_version/0">dtls_legacy_version</a>().</pre>

      </div>

<p>DTLS protocol version.</p>
  </section>
</section>
<section class="detail" id="t:error_alert/0">

  <div class="detail-header">
    <a href="#t:error_alert/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">error_alert()</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L580" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> error_alert() :: {tls_alert, {<a href="#t:tls_alert/0">tls_alert</a>(), Description :: <a href="../../apps/erts/erlang.html#t:string/0">string</a>()}}.</pre>

      </div>

<p>If a TLS connection fails a TLS protocol ALERT will be sent/received.</p><p>An atom reflecting the raised alert, according to the TLS protocol, and a description string
with some further details will be returned.</p>
  </section>
</section>
<section class="detail" id="t:host/0">

  <div class="detail-header">
    <a href="#t:host/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">host()</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L286" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> host() :: <a href="../../apps/kernel/inet.html#t:hostname/0">inet:hostname</a>() | <a href="../../apps/kernel/inet.html#t:ip_address/0">inet:ip_address</a>().</pre>

      </div>

<p>A name or address to a host.</p>
  </section>
</section>
<section class="detail" id="t:protocol_extensions/0">

  <div class="detail-header">
    <a href="#t:protocol_extensions/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">protocol_extensions()</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L2047" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> protocol_extensions() ::
          #{renegotiation_info => <a href="../../apps/erts/erlang.html#t:binary/0">binary</a>(),
            signature_algs => <a href="#t:signature_algs/0">signature_algs</a>(),
            alpn => <a href="../../apps/erts/erlang.html#t:binary/0">binary</a>(),
            srp => <a href="../../apps/erts/erlang.html#t:binary/0">binary</a>(),
            next_protocol => <a href="../../apps/erts/erlang.html#t:binary/0">binary</a>(),
            max_frag_enum => 1..4,
            ec_point_formats => [0..2],
            elliptic_curves => [<a href="../../apps/public_key/public_key.html#t:oid/0">public_key:oid</a>()],
            sni => <a href="../../apps/kernel/inet.html#t:hostname/0">inet:hostname</a>()}.</pre>

      </div>

<p>Client hello extensions.</p>
  </section>
</section>
<section class="detail" id="t:protocol_version/0">

  <div class="detail-header">
    <a href="#t:protocol_version/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">protocol_version()</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L300" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> protocol_version() :: <a href="#t:tls_version/0">tls_version</a>() | <a href="#t:dtls_version/0">dtls_version</a>().</pre>

      </div>

<p>TLS or DTLS protocol version.</p>
  </section>
</section>
<section class="detail" id="t:reason/0">

  <div class="detail-header">
    <a href="#t:reason/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">reason()</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L623" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> reason() :: <a href="../../apps/erts/erlang.html#t:term/0">term</a>().</pre>

      </div>

<p>Error reason for debug purposes.</p><p>Not to be matched.</p>
  </section>
</section>
<section class="detail" id="t:session_id/0">

  <div class="detail-header">
    <a href="#t:session_id/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">session_id()</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L293" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> session_id() :: <a href="../../apps/erts/erlang.html#t:binary/0">binary</a>().</pre>

      </div>

<p>Identifies a TLS session prior to TLS-1.3.</p>
  </section>
</section>
<section class="detail" id="t:socket/0">

  <div class="detail-header">
    <a href="#t:socket/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">socket()</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L197" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> socket() :: <a href="../../apps/kernel/gen_tcp.html#t:socket/0">gen_tcp:socket</a>() | <a href="../../apps/kernel/socket.html#t:socket/0">socket:socket</a>().</pre>

      </div>

<p>A socket that can be used to perform a so-called &quot;START-TLS&quot;, which
means using an already connected socket previously used for plain TCP
traffic and upgrading it to use TLS.</p><p>Both sides needs to agree on the upgrade.</p>
  </section>
</section>
<section class="detail" id="t:socket_option/0">

  <div class="detail-header">
    <a href="#t:socket_option/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">socket_option()</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L210" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> socket_option() :: <a href="../../apps/kernel/gen_tcp.html#t:connect_option/0">gen_tcp:connect_option</a>() | <a href="../../apps/kernel/gen_tcp.html#t:listen_option/0">gen_tcp:listen_option</a>() | <a href="../../apps/kernel/gen_udp.html#t:option/0">gen_udp:option</a>().</pre>

      </div>

<p>Options for the transport socket.</p><p>The default socket options are
<code class="inline">[{mode, list}, {packet, 0}, {header, 0}, {active, true}]</code>.</p><p>For valid options, see <a href="../../apps/kernel/inet.html"><code class="inline">inet</code></a>, <a href="../../apps/kernel/gen_tcp.html"><code class="inline">gen_tcp</code></a>, and <a href="../../apps/kernel/gen_udp.html"><code class="inline">gen_udp</code></a>
in Kernel. Note that stream-oriented options such as <code class="inline">packet</code> are
only relevant for TLS and not DTLS.</p>
  </section>
</section>
<section class="detail" id="t:sslsocket/0">

  <div class="detail-header">
    <a href="#t:sslsocket/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">sslsocket()</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L218" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> sslsocket() :: <a href="../../apps/erts/erlang.html#t:any/0">any</a>().</pre>

      </div>

<p>An opaque reference to the TLS/DTLS connection.</p><p>Note that despite being opaque, matching <code class="inline">sslsocket()</code> instances is allowed.</p>
  </section>
</section>
<section class="detail" id="t:tls_alert/0">

  <div class="detail-header">
    <a href="#t:tls_alert/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">tls_alert()</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L586" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> tls_alert() ::
          close_notify | unexpected_message | bad_record_mac | record_overflow | handshake_failure |
          bad_certificate | unsupported_certificate | certificate_revoked | certificate_expired |
          certificate_unknown | illegal_parameter | unknown_ca | access_denied | decode_error |
          decrypt_error | export_restriction | protocol_version | insufficient_security |
          internal_error | inappropriate_fallback | user_canceled | no_renegotiation |
          unsupported_extension | certificate_unobtainable | unrecognized_name |
          bad_certificate_status_response | bad_certificate_hash_value | unknown_psk_identity |
          no_application_protocol.</pre>

      </div>

<p>TLS Alert Protocol reasons.</p>
  </section>
</section>
<section class="detail" id="t:tls_client_option/0">

  <div class="detail-header">
    <a href="#t:tls_client_option/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">tls_client_option()</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L231" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> tls_client_option() :: <a href="#t:client_option/0">client_option</a>() | <a href="#t:common_option/0">common_option</a>() | <a href="#t:socket_option/0">socket_option</a>() | <a href="#t:transport_option/0">transport_option</a>().</pre>

      </div>

<p>An option that can be supplied to a TLS client.</p>
  </section>
</section>
<section class="detail" id="t:tls_legacy_version/0">

  <div class="detail-header">
    <a href="#t:tls_legacy_version/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">tls_legacy_version()</h1>

        <span class="note">(not exported)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L318" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> tls_legacy_version() :: tlsv1 | 'tlsv1.1'.</pre>

      </div>

<p>A TLS protocol version that are no longer supported by default for security reasons.</p>
  </section>
</section>
<section class="detail" id="t:tls_option/0">

  <div class="detail-header">
    <a href="#t:tls_option/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">tls_option()</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L225" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> tls_option() :: <a href="#t:tls_client_option/0">tls_client_option</a>() | <a href="#t:tls_server_option/0">tls_server_option</a>().</pre>

      </div>

<p>An option related to the TLS/DTLS protocol.</p>
  </section>
</section>
<section class="detail" id="t:tls_server_option/0">

  <div class="detail-header">
    <a href="#t:tls_server_option/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">tls_server_option()</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L237" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> tls_server_option() :: <a href="#t:server_option/0">server_option</a>() | <a href="#t:common_option/0">common_option</a>() | <a href="#t:socket_option/0">socket_option</a>() | <a href="#t:transport_option/0">transport_option</a>().</pre>

      </div>

<p>An option that can be supplied to a TLS server.</p>
  </section>
</section>
<section class="detail" id="t:tls_version/0">

  <div class="detail-header">
    <a href="#t:tls_version/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">tls_version()</h1>

        <span class="note">(not exported)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L306" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> tls_version() :: 'tlsv1.2' | 'tlsv1.3' | <a href="#t:tls_legacy_version/0">tls_legacy_version</a>().</pre>

      </div>

<p>TLS protocol version.</p>
  </section>
</section>
<section class="detail" id="t:transport_option/0">

  <div class="detail-header">
    <a href="#t:transport_option/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">transport_option()</h1>

        <span class="note">(not exported)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L278" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> transport_option() ::
          {cb_info,
           {CallbackModule :: <a href="../../apps/erts/erlang.html#t:atom/0">atom</a>(), DataTag :: <a href="../../apps/erts/erlang.html#t:atom/0">atom</a>(), ClosedTag :: <a href="../../apps/erts/erlang.html#t:atom/0">atom</a>(), ErrTag :: <a href="../../apps/erts/erlang.html#t:atom/0">atom</a>()}} |
          {cb_info,
           {CallbackModule :: <a href="../../apps/erts/erlang.html#t:atom/0">atom</a>(),
            DataTag :: <a href="../../apps/erts/erlang.html#t:atom/0">atom</a>(),
            ClosedTag :: <a href="../../apps/erts/erlang.html#t:atom/0">atom</a>(),
            ErrTag :: <a href="../../apps/erts/erlang.html#t:atom/0">atom</a>(),
            PassiveTag :: <a href="../../apps/erts/erlang.html#t:atom/0">atom</a>()}}.</pre>

      </div>

<p>Transport option defines a callback module and message tags to handle the underlying transport socket.</p><p>Can be used to customize the transport layer. The tag
values should be the values used by the underlying transport in its active mode
messages.</p><p>Defaults to <code class="inline">{gen_tcp, tcp, tcp_closed, tcp_error, tcp_passive}</code> for TLS.</p><section role="note" class="admonition info"><h4 class="admonition-title info">Note</h4><p>For backward compatibility a tuple of size four will be converted to a
tuple of size five, where <code class="inline">PassiveTag</code> is the <code class="inline">DataTag</code> element with
<code class="inline">_passive</code> appended.</p></section><p>For TLS the callback module must implement a reliable transport
protocol, behave as <a href="../../apps/kernel/gen_tcp.html"><code class="inline">gen_tcp</code></a>, and have functions corresponding to
<a href="../../apps/kernel/inet.html#setopts/2"><code class="inline">inet:setopts/2</code></a>, <a href="../../apps/kernel/inet.html#getopts/2"><code class="inline">inet:getopts/2</code></a>, <a href="../../apps/kernel/inet.html#peername/1"><code class="inline">inet:peername/1</code></a>, <a href="../../apps/kernel/inet.html#sockname/1"><code class="inline">inet:sockname/1</code></a>, and
<a href="../../apps/kernel/inet.html#port/1"><code class="inline">inet:port/1</code></a>. The callback <a href="../../apps/kernel/gen_tcp.html"><code class="inline">gen_tcp</code></a> is treated specially and calls <a href="../../apps/kernel/inet.html"><code class="inline">inet</code></a>
directly. For DTLS this feature is considered experimental.</p>
  </section>
</section>

    </div>
  </section>

  <section id="types" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#types">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Types</span>
    </h1>
    <div class="types-list">
<section class="detail" id="t:keylog_info/0">

  <div class="detail-header">
    <a href="#t:keylog_info/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">keylog_info()</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L2080" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> keylog_info() :: #{items => [<a href="#t:keylog_item/0">keylog_item</a>()], client_random => <a href="../../apps/erts/erlang.html#t:binary/0">binary</a>()}.</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:keylog_item/0">

  <div class="detail-header">
    <a href="#t:keylog_item/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">keylog_item()</h1>

        <span class="note">(not exported)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L2078" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> keylog_item() :: <a href="../../apps/stdlib/unicode.html#t:chardata/0">unicode:chardata</a>().</pre>

      </div>


  </section>
</section>

    </div>
  </section>

  <section id="client-api" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#client-api">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Client API</span>
    </h1>
    <div class="client-api-list">
<section class="detail" id="connect/2">

  <div class="detail-header">
    <a href="#connect/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">connect(TCPSocket, TLSOptions)</h1>

        <span class="note">(since OTP R14B)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L2162" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> connect(TCPSocket, TLSOptions) -> {ok, <a href="#t:sslsocket/0">sslsocket</a>()} | {error, Reason}
                 when
                     TCPSocket :: <a href="#t:socket/0">socket</a>(),
                     TLSOptions :: [<a href="#t:tls_client_option/0">tls_client_option</a>()],
                     Reason :: closed | {options, <a href="../../apps/erts/erlang.html#t:any/0">any</a>()} | <a href="#t:error_alert/0">error_alert</a>() | <a href="#t:reason/0">reason</a>().</pre>

      </div>

<p>Equivalent to <a href="#connect/3"><code class="inline">connect(TCPSocket, TLSOptions, infinity)</code></a>.</p>
  </section>
</section>
<section class="detail" id="connect/3">

  <div class="detail-header">
    <a href="#connect/3" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">connect(TCPSocketOrHost, TLSOptionsOrPort, TimeoutOrTLSOptions)</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L2199" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> connect(TCPSocketOrHost, TLSOptionsOrPort, TimeoutOrTLSOptions) ->
                 {ok, <a href="#t:sslsocket/0">sslsocket</a>()} | {ok, <a href="#t:sslsocket/0">sslsocket</a>(), Ext :: <a href="#t:protocol_extensions/0">protocol_extensions</a>()} | {error, Reason}
                 when
                     TCPSocketOrHost :: <a href="#t:socket/0">socket</a>() | <a href="#t:host/0">host</a>(),
                     TLSOptionsOrPort :: [<a href="#t:tls_client_option/0">tls_client_option</a>()] | <a href="../../apps/kernel/inet.html#t:port_number/0">inet:port_number</a>(),
                     TimeoutOrTLSOptions :: [<a href="#t:tls_client_option/0">tls_client_option</a>()] | <a href="../../apps/erts/erlang.html#t:timeout/0">timeout</a>(),
                     Reason :: closed | timeout | {options, <a href="../../apps/erts/erlang.html#t:any/0">any</a>()} | <a href="#t:error_alert/0">error_alert</a>() | <a href="#t:reason/0">reason</a>().</pre>

      </div>

<p>Opens a TLS/DTLS connection.</p><pre><code class="makeup erlang" translate="no"><span class="nf">connect</span><span class="p" data-group-id="1840299317-1">(</span><span class="n">TCPSocket</span><span class="p">,</span><span class="w"> </span><span class="n">TLSOptions</span><span class="p">,</span><span class="w"> </span><span class="n">Timeout</span><span class="p" data-group-id="1840299317-1">)</span><span class="p">.</span></code></pre><p>Upgrades a <code class="inline">gen_tcp</code> (or equivalent) connected socket to a TLS socket by
performing the client-side TLS handshake.</p><pre><code class="makeup erlang" translate="no"><span class="nf">connect</span><span class="p" data-group-id="0826437462-1">(</span><span class="n">Host</span><span class="p">,</span><span class="w"> </span><span class="n">Port</span><span class="p">,</span><span class="w"> </span><span class="n">TLSOptions</span><span class="p" data-group-id="0826437462-1">)</span><span class="p">.</span></code></pre><p>Opens a TLS/DTLS connection to <code class="inline">Host</code>, <code class="inline">Port</code>. This call is equivalent to:</p><pre><code class="makeup erlang" translate="no"><span class="nf">connect</span><span class="p" data-group-id="5945472154-1">(</span><span class="n">Host</span><span class="p">,</span><span class="w"> </span><span class="n">Port</span><span class="p">,</span><span class="w"> </span><span class="n">TLSOptions</span><span class="p">,</span><span class="w"> </span><span class="ss">infinity</span><span class="p" data-group-id="5945472154-1">)</span><span class="p">.</span></code></pre>
  </section>
</section>
<section class="detail" id="connect/4">

  <div class="detail-header">
    <a href="#connect/4" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">connect(Host, Port, TLSOptions, Timeout)</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L2261" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> connect(Host, Port, TLSOptions, Timeout) ->
                 {ok, <a href="#t:sslsocket/0">sslsocket</a>()} | {ok, <a href="#t:sslsocket/0">sslsocket</a>(), Ext :: <a href="#t:protocol_extensions/0">protocol_extensions</a>()} | {error, Reason}
                 when
                     Host :: <a href="#t:host/0">host</a>(),
                     Port :: <a href="../../apps/kernel/inet.html#t:port_number/0">inet:port_number</a>(),
                     TLSOptions :: [<a href="#t:tls_client_option/0">tls_client_option</a>()],
                     Timeout :: <a href="../../apps/erts/erlang.html#t:timeout/0">timeout</a>(),
                     Reason :: closed | timeout | {options, <a href="../../apps/erts/erlang.html#t:any/0">any</a>()} | <a href="#t:error_alert/0">error_alert</a>() | <a href="#t:reason/0">reason</a>().</pre>

      </div>

<p>Opens a TLS/DTLS connection to <code class="inline">Host</code>, <code class="inline">Port</code>.</p><p>When the <code class="inline">verify</code> option is set to <code class="inline">verify_peer</code>, the
<a href="../../apps/public_key/public_key.html#pkix_verify_hostname/2"><code class="inline">public_key:pkix_verify_hostname/2</code></a> check will be performed in addition to the usual
X.509-path validation checks. If the check fails, the error <code class="inline">{bad_cert, hostname_check_failed}</code> will be propagated to the path validation fun,
where it is possible to do customized checks
by using the full possibilities of the <a href="../../apps/public_key/public_key.html#pkix_verify_hostname/3"><code class="inline">public_key:pkix_verify_hostname/3</code></a> API.
When the <code class="inline">server_name_indication</code> option is provided, its value (the DNS name)
will be used as <code class="inline">ReferenceID</code> to <a href="../../apps/public_key/public_key.html#pkix_verify_hostname/2"><code class="inline">public_key:pkix_verify_hostname/2</code></a>. When no
<code class="inline">server_name_indication</code> option is given, the <code class="inline">Host</code> argument will be used as
Server Name Indication extension. The <code class="inline">Host</code> argument will also be used for the
<a href="../../apps/public_key/public_key.html#pkix_verify_hostname/2"><code class="inline">public_key:pkix_verify_hostname/2</code></a> check. If the <code class="inline">Host</code> argument is an
<a href="../../apps/kernel/inet.html#t:ip_address/0"><code class="inline">inet:ip_address()</code></a> the <code class="inline">ReferenceID</code> used for the
check will be <code class="inline">{ip, Host}</code>; otherwise <code class="inline">dns_id</code> will be assumed with a fallback to
<code class="inline">ip</code> if that fails.</p><section role="note" class="admonition info"><h4 class="admonition-title info">Note</h4><p>According to good practices, certificates should not use IP addresses as
&quot;server names&quot;, especially outside a closed network.</p></section><p>If the <code class="inline">{handshake, hello}</code> option is used, the handshake is paused after
receiving the server hello message and the success response is
<code class="inline">{ok, SslSocket, Ext}</code> instead of <code class="inline">{ok, SslSocket}</code>. Thereafter the handshake is
continued or canceled by calling <a href="#handshake_continue/3"><code class="inline">handshake_continue/3</code></a> or <a href="#handshake_cancel/1"><code class="inline">handshake_cancel/1</code></a>.</p><p>If the <code class="inline">active</code> option is set to <code class="inline">once</code>, <code class="inline">true</code>, or an integer value, the process
owning the SSL socket will receive messages of type
<a href="#t:active_msgs/0"><code class="inline">active_msgs()</code></a>.</p>
  </section>
</section>

    </div>
  </section>

  <section id="client-and-server-api" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#client-and-server-api">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Client and Server API</span>
    </h1>
    <div class="client-and-server-api-list">
<section class="detail" id="close/1">

  <div class="detail-header">
    <a href="#close/1" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">close(SslSocket)</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L2533" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> close(SslSocket) -> ok | {error, Reason} when SslSocket :: <a href="#t:sslsocket/0">sslsocket</a>(), Reason :: <a href="../../apps/erts/erlang.html#t:any/0">any</a>().</pre>

      </div>

<p>Closes a TLS/DTLS connection.</p>
  </section>
</section>
<section class="detail" id="close/2">

  <div class="detail-header">
    <a href="#close/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">close(SslSocket, How)</h1>

        <span class="note">(since OTP 18.1)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L2565" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> close(SslSocket, How) -> ok | {ok, <a href="../../apps/erts/erlang.html#t:port/0">port</a>()} | {ok, <a href="../../apps/erts/erlang.html#t:port/0">port</a>(), Data} | {error, Reason}
               when
                   SslSocket :: <a href="#t:sslsocket/0">sslsocket</a>(),
                   How :: <a href="../../apps/erts/erlang.html#t:timeout/0">timeout</a>() | {NewController :: <a href="../../apps/erts/erlang.html#t:pid/0">pid</a>(), <a href="../../apps/erts/erlang.html#t:timeout/0">timeout</a>()},
                   Data :: <a href="../../apps/erts/erlang.html#t:binary/0">binary</a>(),
                   Reason :: <a href="../../apps/erts/erlang.html#t:any/0">any</a>().</pre>

      </div>

<p>Closes or downgrades a TLS connection.</p><p>In the latter case the transport connection will be handed over to the
<code class="inline">NewController</code> process after receiving the TLS close alert from the
peer. The returned transport socket will have the following options
set: <code class="inline">[{active, false}, {packet, 0}, {mode, binary}]</code>.</p><p>In case of downgrade, the close function might return some binary data that
should be treated by the user as the first bytes received on the downgraded
connection.</p>
  </section>
</section>
<section class="detail" id="controlling_process/2">

  <div class="detail-header">
    <a href="#controlling_process/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">controlling_process(SslSocket, NewController)</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L2682" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> controlling_process(SslSocket, NewController) -> ok | {error, Reason}
                             when SslSocket :: <a href="#t:sslsocket/0">sslsocket</a>(), NewController :: <a href="../../apps/erts/erlang.html#t:pid/0">pid</a>(), Reason :: <a href="../../apps/erts/erlang.html#t:any/0">any</a>().</pre>

      </div>

<p>Assigns a new controlling process to the SSL socket.</p><p>A controlling process is the owner of an SSL socket and receives all
messages from the socket.</p>
  </section>
</section>
<section class="detail" id="handshake_cancel/1">

  <div class="detail-header">
    <a href="#handshake_cancel/1" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">handshake_cancel(Socket)</h1>

        <span class="note">(since OTP 21.0)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L2523" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> handshake_cancel(#sslsocket{socket_handle :: <a href="../../apps/erts/erlang.html#t:term/0">term</a>(),
                                  connection_handler :: <a href="../../apps/erts/erlang.html#t:term/0">term</a>(),
                                  payload_sender :: <a href="../../apps/erts/erlang.html#t:term/0">term</a>(),
                                  transport_cb :: <a href="../../apps/erts/erlang.html#t:term/0">term</a>(),
                                  connection_cb :: <a href="../../apps/erts/erlang.html#t:term/0">term</a>(),
                                  tab :: <a href="../../apps/erts/erlang.html#t:term/0">term</a>(),
                                  listener_config :: <a href="../../apps/erts/erlang.html#t:term/0">term</a>()}) ->
                          <a href="../../apps/erts/erlang.html#t:any/0">any</a>().</pre>

      </div>

<p>Cancel the handshake with a fatal <code class="inline">USER_CANCELED</code> alert.</p>
  </section>
</section>
<section class="detail" id="handshake_continue/2">

  <div class="detail-header">
    <a href="#handshake_continue/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">handshake_continue(HsSocket, Options)</h1>

        <span class="note">(since OTP 21.0)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L2498" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> handshake_continue(HsSocket, Options) -> {ok, SslSocket} | {error, Reason}
                            when
                                HsSocket :: <a href="#t:sslsocket/0">sslsocket</a>(),
                                Options :: [<a href="#t:client_option/0">client_option</a>() | <a href="#t:server_option/0">server_option</a>() | <a href="#t:common_option/0">common_option</a>()],
                                SslSocket :: <a href="#t:sslsocket/0">sslsocket</a>(),
                                Reason :: closed | timeout | <a href="#t:error_alert/0">error_alert</a>().</pre>

      </div>

<p>Equivalent to <a href="#handshake_continue/3"><code class="inline">handshake_continue(HsSocket, Options, infinity)</code></a>.</p>
  </section>
</section>
<section class="detail" id="handshake_continue/3">

  <div class="detail-header">
    <a href="#handshake_continue/3" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">handshake_continue(HsSocket, Options, Timeout)</h1>

        <span class="note">(since OTP 21.0)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L2513" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> handshake_continue(HsSocket, Options, Timeout) -> {ok, SslSocket} | {error, Reason}
                            when
                                HsSocket :: <a href="#t:sslsocket/0">sslsocket</a>(),
                                Options :: [<a href="#t:client_option/0">client_option</a>() | <a href="#t:server_option/0">server_option</a>() | <a href="#t:common_option/0">common_option</a>()],
                                Timeout :: <a href="../../apps/erts/erlang.html#t:timeout/0">timeout</a>(),
                                SslSocket :: <a href="#t:sslsocket/0">sslsocket</a>(),
                                Reason :: closed | timeout | <a href="#t:error_alert/0">error_alert</a>().</pre>

      </div>

<p>Continue the TLS handshake, possibly with new, additional, or changed options.</p>
  </section>
</section>
<section class="detail" id="recv/2">

  <div class="detail-header">
    <a href="#recv/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">recv(SslSocket, Length)</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L2630" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> recv(SslSocket, Length) -> {ok, Data} | {error, <a href="#t:reason/0">reason</a>()}
              when
                  SslSocket :: <a href="#t:sslsocket/0">sslsocket</a>(),
                  Length :: <a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>(),
                  Data :: <a href="../../apps/erts/erlang.html#t:binary/0">binary</a>() | <a href="../../apps/erts/erlang.html#t:list/0">list</a>() | HttpPacket,
                  HttpPacket :: <a href="../../apps/erts/erlang.html#t:any/0">any</a>().</pre>

      </div>

<p>Equivalent to <a href="#recv/3"><code class="inline">recv(Socket, Length, infinity)</code></a>.</p>
  </section>
</section>
<section class="detail" id="recv/3">

  <div class="detail-header">
    <a href="#recv/3" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">recv(SslSocket, Length, Timeout)</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L2656" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> recv(SslSocket, Length, Timeout) -> {ok, Data} | {error, <a href="#t:reason/0">reason</a>()}
              when
                  SslSocket :: <a href="#t:sslsocket/0">sslsocket</a>(),
                  Length :: <a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>(),
                  Data :: <a href="../../apps/erts/erlang.html#t:binary/0">binary</a>() | <a href="../../apps/erts/erlang.html#t:list/0">list</a>() | HttpPacket,
                  Timeout :: <a href="../../apps/erts/erlang.html#t:timeout/0">timeout</a>(),
                  HttpPacket :: <a href="../../apps/erts/erlang.html#t:any/0">any</a>().</pre>

      </div>

<p>Receives a packet from a socket in passive mode.</p><p>A closed socket is indicated by return value <code class="inline">{error, closed}</code>.
Argument <code class="inline">Length</code> is meaningful only when the socket is in mode <code class="inline">raw</code>
and denotes the number of bytes to read. If <code class="inline">Length</code> is zero, all
available bytes are returned. If <code class="inline">Length</code> is greater than zero,
exactly <code class="inline">Length</code> bytes are returned, or an error; possibly discarding
less than <code class="inline">Length</code> bytes of data when the socket gets closed from
the other side.</p><p>Optional argument <code class="inline">Timeout</code> specifies a time-out in milliseconds. The default
value is <code class="inline">infinity</code>.</p>
  </section>
</section>
<section class="detail" id="send/2">

  <div class="detail-header">
    <a href="#send/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">send(SslSocket, Data)</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L2598" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> send(SslSocket, Data) -> ok | {error, <a href="#t:reason/0">reason</a>()} when SslSocket :: <a href="#t:sslsocket/0">sslsocket</a>(), Data :: <a href="../../apps/erts/erlang.html#t:iodata/0">iodata</a>().</pre>

      </div>

<p>Writes <code class="inline">Data</code> to <code class="inline">SslSocket</code>.</p><p>A notable return value is <code class="inline">{error, closed}</code> indicating that the socket is
closed.</p>
  </section>
</section>
<section class="detail" id="setopts/2">

  <div class="detail-header">
    <a href="#setopts/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">setopts(SslSocket, Options)</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L3189" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> setopts(SslSocket, Options) -> ok | {error, <a href="#t:reason/0">reason</a>()}
                 when SslSocket :: <a href="#t:sslsocket/0">sslsocket</a>(), Options :: [<a href="../../apps/kernel/gen_tcp.html#t:option/0">gen_tcp:option</a>()].</pre>

      </div>

<p>Sets options according to <code class="inline">Options</code> for socket <code class="inline">SslSocket</code>.</p>
  </section>
</section>
<section class="detail" id="shutdown/2">

  <div class="detail-header">
    <a href="#shutdown/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">shutdown(SslSocket, How)</h1>

        <span class="note">(since OTP R14B)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L3300" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> shutdown(SslSocket, How) -> ok | {error, <a href="#t:reason/0">reason</a>()}
                  when SslSocket :: <a href="#t:sslsocket/0">sslsocket</a>(), How :: read | write | read_write.</pre>

      </div>

<p>Immediately closes a socket in one or two directions.</p><p><code class="inline">How == write</code> means closing the socket for writing, but reading from
it is still possible.</p><p>To handle siutations where the peer has performed a shutdown on the
write side, option <code class="inline">{exit_on_close, false}</code> is useful.</p>
  </section>
</section>

    </div>
  </section>

  <section id="deprecated-api" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#deprecated-api">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Deprecated API</span>
    </h1>
    <div class="deprecated-api-list">
<section class="detail" id="prf/5">

  <div class="detail-header">
    <a href="#prf/5" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">prf(SslSocket, Secret, Label, Seed, WantedLength)</h1>

        <span class="note">(since OTP R15B01)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L3573" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

    <div class="deprecated">
      This function is deprecated. ssl:prf/5 is deprecated; Use export_key_materials/4 instead. Note that in OTP 28 the 'testing' way of calling this function will no longer be supported..
    </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> prf(SslSocket, Secret, Label, Seed, WantedLength) -> {ok, <a href="../../apps/erts/erlang.html#t:binary/0">binary</a>()} | {error, <a href="#t:reason/0">reason</a>()}
             when
                 SslSocket :: <a href="#t:sslsocket/0">sslsocket</a>(),
                 Secret :: <a href="../../apps/erts/erlang.html#t:binary/0">binary</a>() | master_secret,
                 Label :: <a href="../../apps/erts/erlang.html#t:binary/0">binary</a>(),
                 Seed :: [<a href="../../apps/erts/erlang.html#t:binary/0">binary</a>() | <a href="#t:prf_random/0">prf_random</a>()],
                 WantedLength :: <a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>().</pre>

      </div>

<p>Uses the Pseudo-Random Function (PRF) of a TLS session to generate extra key
material.</p><p>It either takes user-generated values for <code class="inline">Secret</code> and <code class="inline">Seed</code> or atoms
directing it to use a specific value from the session security parameters.</p><section role="note" class="admonition info"><h4 class="admonition-title info">Note</h4></section><p>This function is replaced by <a href="#export_key_materials/4"><code class="inline">export_key_materials/4</code></a>, the officially
documented API function since OTP 27, which is equivalent to
<a href="#prf/5"><code class="inline">prf(TLSSocket, master_secret, Label, [client_random, server_random, Context], WantedLength)</code></a>. Other ways of calling this
function were for testing purposes only and has no use case. When
called in a TLS-1.3 context it will now behave as
<a href="#export_key_materials/4"><code class="inline">export_key_materials(TLSSocket, [Label], [Context], [WantedLength])</code></a>.</p>
  </section>
</section>

    </div>
  </section>

  <section id="pre-tls-1-3-api" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#pre-tls-1-3-api">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Pre TLS-1.3 API</span>
    </h1>
    <div class="pre-tls-1-3-api-list">
<section class="detail" id="eccs/0">

  <div class="detail-header">
    <a href="#eccs/0" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">eccs()</h1>

        <span class="note">(since OTP 19.2)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L3084" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> eccs() -> NamedCurves when NamedCurves :: [<a href="#t:named_curve/0">named_curve</a>()].</pre>

      </div>

<p>Returns a list of all supported elliptic curves, including legacy
curves, for all TLS/DTLS versions prior to TLS-1.3.</p>
  </section>
</section>
<section class="detail" id="eccs/1">

  <div class="detail-header">
    <a href="#eccs/1" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">eccs(Version)</h1>

        <span class="note">(since OTP 19.2)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L3099" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> eccs(Version) -> NamedCurves
              when
                  Version :: 'tlsv1.2' | 'tlsv1.1' | tlsv1 | 'dtlsv1.2' | dtlsv1,
                  NamedCurves :: [<a href="#t:named_curve/0">named_curve</a>()].</pre>

      </div>

<p>Returns the elliptic curves supported by default for <code class="inline">Version</code>.</p><p>This is a subset of what <a href="#eccs/0"><code class="inline">eccs/0</code></a> returns.</p>
  </section>
</section>
<section class="detail" id="renegotiate/1">

  <div class="detail-header">
    <a href="#renegotiate/1" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">renegotiate(SslSocket)</h1>

        <span class="note">(since OTP R14B)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L3431" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> renegotiate(SslSocket) -> ok | {error, <a href="#t:reason/0">reason</a>()} when SslSocket :: <a href="#t:sslsocket/0">sslsocket</a>().</pre>

      </div>

<p>Initiates a new handshake.</p><p>A notable return value is <code class="inline">{error, renegotiation_rejected}</code> indicating
that the peer refused to go through with the renegotiation, but the
connection is still active using the previously negotiated session.</p><p>TLS-1.3 has removed the renegotiation feature from earlier TLS
versions and instead adds a new feature called key update, which
replaces the most important part of renegotiation: the refreshing of
session keys. This is triggered automatically after reaching a
plaintext limit and can be configured using the <code class="inline">key_update_at</code> option
in <a href="#t:common_option_tls13/0"><code class="inline">common_option_tls13/0</code></a>.</p>
  </section>
</section>

    </div>
  </section>

  <section id="server-api" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#server-api">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Server API</span>
    </h1>
    <div class="server-api-list">
<section class="detail" id="handshake/1">

  <div class="detail-header">
    <a href="#handshake/1" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">handshake(HsSocket)</h1>

        <span class="note">(since OTP 21.0)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L2358" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> handshake(HsSocket) -> {ok, SslSocket} | {ok, SslSocket, Ext} | {error, Reason}
                   when
                       HsSocket :: <a href="#t:sslsocket/0">sslsocket</a>(),
                       SslSocket :: <a href="#t:sslsocket/0">sslsocket</a>(),
                       Ext :: <a href="#t:protocol_extensions/0">protocol_extensions</a>(),
                       Reason :: closed | timeout | <a href="#t:error_alert/0">error_alert</a>().</pre>

      </div>

<p>Equivalent to <a href="#handshake/2"><code class="inline">handshake(HsSocket, infinity)</code></a>.</p>
  </section>
</section>
<section class="detail" id="handshake/2">

  <div class="detail-header">
    <a href="#handshake/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">handshake(HsSocket, OptionsOrTimeout)</h1>

        <span class="note">(since OTP 21.0)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L2398" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> handshake(HsSocket, OptionsOrTimeout) -> {ok, SslSocket} | {ok, SslSocket, Ext} | {error, Reason}
                   when
                       HsSocket :: <a href="#t:sslsocket/0">sslsocket</a>(),
                       OptionsOrTimeout :: <a href="../../apps/erts/erlang.html#t:timeout/0">timeout</a>() | [<a href="#t:server_option/0">server_option</a>()],
                       SslSocket :: <a href="#t:sslsocket/0">sslsocket</a>(),
                       Ext :: <a href="#t:protocol_extensions/0">protocol_extensions</a>(),
                       Reason :: closed | timeout | <a href="#t:error_alert/0">error_alert</a>().</pre>

      </div>

<p>Performs the TLS/DTLS server-side handshake.</p><p>If the second argument is a timeout value:</p><pre><code class="makeup erlang" translate="no"><span class="nf">handshake</span><span class="p" data-group-id="1643318796-1">(</span><span class="n">HsSocket</span><span class="p">,</span><span class="w"> </span><span class="n">Timeout</span><span class="p" data-group-id="1643318796-1">)</span><span class="p">.</span></code></pre><p>this call is equivalent to:</p><pre><code class="makeup erlang" translate="no"><span class="nf">handshake</span><span class="p" data-group-id="6517121774-1">(</span><span class="n">HsSocket</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="6517121774-2">[</span><span class="p" data-group-id="6517121774-2">]</span><span class="p">,</span><span class="w"> </span><span class="n">Timeout</span><span class="p" data-group-id="6517121774-1">)</span><span class="p">.</span></code></pre><p>Otherwise, if the second argument is a list of options:</p><pre><code class="makeup erlang" translate="no"><span class="nf">handshake</span><span class="p" data-group-id="7936202172-1">(</span><span class="n">HsSocket</span><span class="p">,</span><span class="w"> </span><span class="n">Options</span><span class="p" data-group-id="7936202172-1">)</span><span class="p">.</span></code></pre><p>this call is equivalent to:</p><pre><code class="makeup erlang" translate="no"><span class="nf">handshake</span><span class="p" data-group-id="3858342274-1">(</span><span class="n">HsSocket</span><span class="p">,</span><span class="w"> </span><span class="n">Options</span><span class="p">,</span><span class="w"> </span><span class="ss">infinity</span><span class="p" data-group-id="3858342274-1">)</span><span class="p">.</span></code></pre>
  </section>
</section>
<section class="detail" id="handshake/3">

  <div class="detail-header">
    <a href="#handshake/3" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">handshake(Socket, Options, Timeout)</h1>

        <span class="note">(since OTP 21.0)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L2451" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> handshake(Socket, Options, Timeout) -> {ok, SslSocket} | {ok, SslSocket, Ext} | {error, Reason}
                   when
                       Socket :: <a href="#t:socket/0">socket</a>() | <a href="#t:sslsocket/0">sslsocket</a>(),
                       SslSocket :: <a href="#t:sslsocket/0">sslsocket</a>(),
                       Options :: [<a href="#t:server_option/0">server_option</a>() | <a href="#t:common_option/0">common_option</a>()],
                       Timeout :: <a href="../../apps/erts/erlang.html#t:timeout/0">timeout</a>(),
                       Ext :: <a href="#t:protocol_extensions/0">protocol_extensions</a>(),
                       Reason :: closed | timeout | {options, <a href="../../apps/erts/erlang.html#t:any/0">any</a>()} | <a href="#t:error_alert/0">error_alert</a>().</pre>

      </div>

<p>Performs the TLS/DTLS server-side handshake.</p><p>Returns a new TLS/DTLS socket if the handshake is successful.</p><p>If <code class="inline">Socket</code> is a ordinary <a href="#t:socket/0"><code class="inline">socket()</code></a>, upgrades a
<code class="inline">gen_tcp</code> or equivalent socket to an SSL socket by performing the
TLS server-side handshake and returning a TLS socket.</p><section role="note" class="admonition info"><h4 class="admonition-title info">Note</h4><p>The ordinary <code class="inline">Socket</code> must be in passive mode (<code class="inline">{active, false}</code>)
before calling this function and before the client tries to connect
with TLS; otherwise, the behavior of this function is undefined. The
best way to ensure this is to create the ordinary listen socket in
passive mode.</p></section><p>If <code class="inline">Socket</code> is an <a href="#t:sslsocket/0"><code class="inline">sslsocket()</code></a>, provides extra
TLS/DTLS options to those specified in <a href="#listen/2"><code class="inline">listen/2</code></a> and then performs
the TLS/DTLS handshake. Returns a new TLS/DTLS socket if the handshake
is successful.</p><section role="note" class="admonition warning"><h4 class="admonition-title warning">Warning</h4><p>Not setting the timeout makes the server more vulnerable to Denial of
Service (DoS) attacks.</p></section><p>If option <code class="inline">{handshake, hello}</code> is specified the handshake is paused after
receiving the client hello message and the success response is
<code class="inline">{ok, SslSocket, Ext}</code> instead of <code class="inline">{ok, SslSocket}</code>. Thereafter the handshake is
continued or canceled by calling <a href="#handshake_continue/3"><code class="inline">handshake_continue/3</code></a> or <a href="#handshake_cancel/1"><code class="inline">handshake_cancel/1</code></a>.</p><p>If option <code class="inline">active</code> is set to <code class="inline">once</code>, <code class="inline">true</code>, or an integer value, the process
owning the <a href="#t:sslsocket/0"><code class="inline">sslsocket()</code></a> will receive messages of type
<a href="#t:active_msgs/0"><code class="inline">active_msgs()</code></a>.</p>
  </section>
</section>
<section class="detail" id="listen/2">

  <div class="detail-header">
    <a href="#listen/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">listen(Port, Options)</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L2288" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> listen(Port, Options) -> {ok, ListenSocket} | {error, Reason}
                when
                    Port :: <a href="../../apps/kernel/inet.html#t:port_number/0">inet:port_number</a>(),
                    Options :: [<a href="#t:tls_server_option/0">tls_server_option</a>()],
                    ListenSocket :: <a href="#t:sslsocket/0">sslsocket</a>(),
                    Reason :: {options, <a href="../../apps/erts/erlang.html#t:any/0">any</a>()} | <a href="#t:reason/0">reason</a>().</pre>

      </div>

<p>Creates an SSL listen socket.</p>
  </section>
</section>
<section class="detail" id="transport_accept/1">

  <div class="detail-header">
    <a href="#transport_accept/1" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">transport_accept(ListenSocket)</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L2309" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> transport_accept(ListenSocket) -> {ok, SslSocket} | {error, Reason}
                          when ListenSocket :: <a href="#t:sslsocket/0">sslsocket</a>(), SslSocket :: <a href="#t:sslsocket/0">sslsocket</a>(), Reason :: <a href="#t:reason/0">reason</a>().</pre>

      </div>

<p>Equivalent to <a href="#transport_accept/2"><code class="inline">transport_accept(ListenSocket, infinity)</code></a>.</p>
  </section>
</section>
<section class="detail" id="transport_accept/2">

  <div class="detail-header">
    <a href="#transport_accept/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">transport_accept(ListenSocket, Timeout)</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L2338" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> transport_accept(ListenSocket, Timeout) -> {ok, SslSocket} | {error, Reason}
                          when
                              ListenSocket :: <a href="#t:sslsocket/0">sslsocket</a>(),
                              Timeout :: <a href="../../apps/erts/erlang.html#t:timeout/0">timeout</a>(),
                              SslSocket :: <a href="#t:sslsocket/0">sslsocket</a>(),
                              Reason :: <a href="#t:reason/0">reason</a>().</pre>

      </div>

<p>Accepts an incoming connection request on a listen socket.</p><p><code class="inline">ListenSocket</code> must be a socket returned from <a href="#listen/2"><code class="inline">listen/2</code></a>. The socket
returned is to be passed to <a href="#handshake/3"><code class="inline">handshake/1,2,3</code></a> to
complete the handshake and establish the TLS/DTLS connection.</p><section role="note" class="admonition warning"><h4 class="admonition-title warning">Warning</h4><p>Most API functions require that the TLS/DTLS connection is established to work
as expected.</p></section><p>The accepted socket inherits the options set for <code class="inline">ListenSocket</code> in <a href="#listen/2"><code class="inline">listen/2</code></a>.</p><p>The default value for <code class="inline">Timeout</code> is <code class="inline">infinity</code>. If <code class="inline">Timeout</code> is specified and no
connection is accepted within the given time, <code class="inline">{error, timeout}</code> is returned.</p>
  </section>
</section>

    </div>
  </section>

  <section id="tls-1-3-only-api" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#tls-1-3-only-api">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">TLS-1.3 Only API</span>
    </h1>
    <div class="tls-1-3-only-api-list">
<section class="detail" id="groups/0">

  <div class="detail-header">
    <a href="#groups/0" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">groups()</h1>

        <span class="note">(since OTP 27.0)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L3122" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> groups() -> [<a href="#t:group/0">group</a>()].</pre>

      </div>

<p>Returns all supported groups in TLS 1.3.</p><p>Existed since OTP 22.0; documented as of OTP 27.</p>
  </section>
</section>
<section class="detail" id="groups/1">

  <div class="detail-header">
    <a href="#groups/1" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">groups(Description)</h1>

        <span class="note">(since OTP 27.0)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L3137" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> groups(Description) -> [<a href="#t:group/0">group</a>()] when Description :: default.</pre>

      </div>

<p>Returns default supported groups in TLS 1.3.</p><p>Existed since OTP 22.0; documented as of OTP 27.</p>
  </section>
</section>
<section class="detail" id="update_keys/2">

  <div class="detail-header">
    <a href="#update_keys/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">update_keys(SslSocket, Type)</h1>

        <span class="note">(since OTP 22.3)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L3474" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> update_keys(SslSocket, Type) -> ok | {error, <a href="#t:reason/0">reason</a>()}
                     when SslSocket :: <a href="#t:sslsocket/0">sslsocket</a>(), Type :: write | read_write.</pre>

      </div>

<p>Create new session keys.</p><p>There are cryptographic limits on the amount of plaintext which can be safely
encrypted under a given set of keys. If the amount of data surpasses those
limits, a key update is triggered and a new set of keys are installed. See also
the <code class="inline">key_update_at</code> option in <a href="#t:common_option_tls13/0"><code class="inline">common_option_tls13/0</code></a>.</p><p>This function can be used to explicitly start a key update on a TLS-1.3
connection. There are two types of key updates: if <code class="inline">Type</code> is <code class="inline">write</code>,
only the writing key is updated; if <code class="inline">Type</code> is <code class="inline">read_write</code>, both the
reading and writing keys are updated.</p>
  </section>
</section>

    </div>
  </section>

  <section id="utility-functions" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#utility-functions">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Utility Functions</span>
    </h1>
    <div class="utility-functions-list">
<section class="detail" id="append_cipher_suites/2">

  <div class="detail-header">
    <a href="#append_cipher_suites/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">append_cipher_suites(Deferred, Suites)</h1>

        <span class="note">(since OTP 20.3)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L2982" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> append_cipher_suites(Deferred, Suites) -> <a href="#t:ciphers/0">ciphers</a>()
                              when Deferred :: <a href="#t:ciphers/0">ciphers</a>() | <a href="#t:cipher_filters/0">cipher_filters</a>(), Suites :: <a href="#t:ciphers/0">ciphers</a>().</pre>

      </div>

<p>Make <code class="inline">Deferred</code> suites become the least preferred suites.</p><p>The <code class="inline">Deferred</code> suites will be put at the end of the cipher suite list
<code class="inline">Suites</code> after removing them from <code class="inline">Suites</code> if present. <code class="inline">Deferred</code> can
be a list of cipher suites or a list of filters in which case the
filters are used on <code class="inline">Suites</code> to extract the deferred cipher list.</p>
  </section>
</section>
<section class="detail" id="cipher_suites/2">

  <div class="detail-header">
    <a href="#cipher_suites/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">cipher_suites(Description, Version)</h1>

        <span class="note">(since OTP 20.3)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L2862" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> cipher_suites(Description, Version) -> <a href="#t:ciphers/0">ciphers</a>()
                       when
                           Description :: default | all | exclusive | anonymous | exclusive_anonymous,
                           Version :: <a href="#t:protocol_version/0">protocol_version</a>().</pre>

      </div>

<p>Lists all available cipher suites corresponding to <code class="inline">Description</code>.</p><p>The <code class="inline">exclusive</code> and <code class="inline">exclusive_anonymous</code> option will exclusively
list cipher suites first supported in <code class="inline">Version</code>, whereas the other options are
inclusive from the lowest possible version to <code class="inline">Version</code>. The <code class="inline">all</code> option
includes all suites except anonymous suites. No anonymous suites are supported
by default.</p><section role="note" class="admonition info"><h4 class="admonition-title info">Note</h4><p>TLS-1.3 has no overlapping cipher suites with previous TLS versions, meaning that
the result of <a href="#cipher_suites/2"><code class="inline">cipher_suites(all, 'tlsv1.3')</code></a> contains a separate
set of suites that can be used with TLS-1.3 and another set that can be used if a lower
version is negotiated. The so-called <code class="inline">PSK</code> and <code class="inline">SRP</code> suites (prior to TLS-1.3)
need extra configuration to work; namely the option <code class="inline">user_lookup_function</code>. No
anonymous suites are supported by TLS-1.3.</p><p>Also note that the cipher suites returned by this function are the cipher
suites that the OTP SSL application can support provided that they are
supported by the crypto library linked with the OTP Crypto application. Use
<a href="#filter_cipher_suites/2"><code class="inline">ssl:filter_cipher_suites(Suites, [])</code></a> to filter
the list for the current crypto library. Note that cipher suites may be filtered
out because they are too old or too new depending on the crypto library.</p></section>
  </section>
</section>
<section class="detail" id="cipher_suites/3">

  <div class="detail-header">
    <a href="#cipher_suites/3" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">cipher_suites(Description, Version, StringType)</h1>

        <span class="note">(since OTP 22.0)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L2886" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> cipher_suites(Description, Version, StringType) -> [<a href="../../apps/erts/erlang.html#t:string/0">string</a>()]
                       when
                           Description :: default | all | exclusive | anonymous,
                           Version :: <a href="#t:protocol_version/0">protocol_version</a>(),
                           StringType :: rfc | openssl.</pre>

      </div>

<p>Equivalent to <a href="#cipher_suites/2"><code class="inline">cipher_suites/2</code></a>, but lists RFC or OpenSSL string names instead of
<a href="#t:erl_cipher_suite/0"><code class="inline">erl_cipher_suite()</code></a>.</p>
  </section>
</section>
<section class="detail" id="clear_pem_cache/0">

  <div class="detail-header">
    <a href="#clear_pem_cache/0" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">clear_pem_cache()</h1>

        <span class="note">(since OTP 17.5)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L3613" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> clear_pem_cache() -> ok.</pre>

      </div>

<p>Clears the PEM cache.</p><p>PEM files, used by SSL API-functions, are cached for performance
reasons. The cache is automatically checked at regular intervals to
determine whether any cache entries should be invalidated.</p><p>This function provides a way to unconditionally clear the entire cache, thereby
forcing a reload of previously cached PEM files.</p>
  </section>
</section>
<section class="detail" id="connection_information/1">

  <div class="detail-header">
    <a href="#connection_information/1" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">connection_information(SslSocket)</h1>

        <span class="note">(since OTP 18.0)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L2717" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> connection_information(SslSocket) -> {ok, Result} | {error, <a href="#t:reason/0">reason</a>()}
                                when SslSocket :: <a href="#t:sslsocket/0">sslsocket</a>(), Result :: <a href="#t:connection_info/0">connection_info</a>().</pre>

      </div>

<p>Returns the most relevant information about the connection.</p><p>Some items that are undefined will be filtered out. No values
that affect the security of the connection will be returned.</p><section role="note" class="admonition info"><h4 class="admonition-title info">Note</h4><p>The legacy <code class="inline">cipher_suite</code> item was removed in OTP 23. Previously it returned
the cipher suite in its (undocumented) legacy format. It is replaced by
<code class="inline">selected_cipher_suite</code>.</p></section>
  </section>
</section>
<section class="detail" id="connection_information/2">

  <div class="detail-header">
    <a href="#connection_information/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">connection_information(SslSocket, Items)</h1>

        <span class="note">(since OTP 18.0)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L2750" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> connection_information(SslSocket, Items) -> {ok, Result} | {error, <a href="#t:reason/0">reason</a>()}
                                when
                                    SslSocket :: <a href="#t:sslsocket/0">sslsocket</a>(),
                                    Items :: <a href="#t:connection_info_keys/0">connection_info_keys</a>(),
                                    Result :: <a href="#t:connection_info/0">connection_info</a>().</pre>

      </div>

<p>Returns the requested information items about the connection if they are
defined.</p><p>Note that the values for <code class="inline">client_random</code>, <code class="inline">server_random</code>, <code class="inline">master_secret</code>, and <code class="inline">keylog</code>
affect the security of connection.</p><p>In order to retrieve <code class="inline">keylog</code> information from a TLS
connection, the <code class="inline">keep_secrets</code> option must be configured in advance.</p><section role="note" class="admonition info"><h4 class="admonition-title info">Note</h4><p>If only undefined options are requested the resulting list can be empty.</p></section>
  </section>
</section>
<section class="detail" id="export_key_materials/4">

  <div class="detail-header">
    <a href="#export_key_materials/4" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">export_key_materials(SslSocket, Labels, Contexts, WantedLengths)</h1>

        <span class="note">(since OTP 27.0)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L3501" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> export_key_materials(SslSocket, Labels, Contexts, WantedLengths) ->
                              {ok, ExportKeyMaterials} | {error, <a href="#t:reason/0">reason</a>()}
                              when
                                  SslSocket :: <a href="#t:sslsocket/0">sslsocket</a>(),
                                  Labels :: [<a href="../../apps/erts/erlang.html#t:binary/0">binary</a>()],
                                  Contexts :: [<a href="../../apps/erts/erlang.html#t:binary/0">binary</a>() | no_context],
                                  WantedLengths :: [<a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>()],
                                  ExportKeyMaterials :: [<a href="../../apps/erts/erlang.html#t:binary/0">binary</a>()].</pre>

      </div>

<p>Equivalent to <a href="#export_key_materials/5"><code class="inline">export_key_materials(TLSSocket, Labels, Contexts, WantedLengths, true)</code></a>.</p>
  </section>
</section>
<section class="detail" id="export_key_materials/5">

  <div class="detail-header">
    <a href="#export_key_materials/5" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">export_key_materials(SslSocket, Labels, Contexts, WantedLengths, ConsumeSecret)</h1>

        <span class="note">(since OTP 27.0)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L3534" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> export_key_materials(SslSocket, Labels, Contexts, WantedLengths, ConsumeSecret) ->
                              {ok, ExportKeyMaterials} |
                              {error, exporter_master_secret_already_consumed | bad_input}
                              when
                                  SslSocket :: <a href="#t:sslsocket/0">sslsocket</a>(),
                                  Labels :: [<a href="../../apps/erts/erlang.html#t:binary/0">binary</a>()],
                                  Contexts :: [<a href="../../apps/erts/erlang.html#t:binary/0">binary</a>() | no_context],
                                  WantedLengths :: [<a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>()],
                                  ConsumeSecret :: <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>(),
                                  ExportKeyMaterials :: [<a href="../../apps/erts/erlang.html#t:binary/0">binary</a>()].</pre>

      </div>

<p>Uses a Pseudo-Random Function (PRF prior to TLS-1.3) or a Key
Derivation Function (HKDF in TLS-1.3) for a TLS connection to
generate and export keying materials.</p><p>In TLS-1.3, using <code class="inline">no_context</code> is equivalent to specifying an empty
context (an empty binary). Prior to TLS-1.3, <code class="inline">no_context</code> and an empty
context will produce different results.</p><p>The <code class="inline">ConsumeSecret</code> argument is relevant only in TLS-1.3, causing the
TLS-1.3 <code class="inline">exporter_master_secret</code> to be consumed, thereby making it
unavailable and increasing security. Further attempts to call this
function will fail.</p>
  </section>
</section>
<section class="detail" id="filter_cipher_suites/2">

  <div class="detail-header">
    <a href="#filter_cipher_suites/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">filter_cipher_suites(Suites, Filters)</h1>

        <span class="note">(since OTP 20.3)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L2921" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> filter_cipher_suites(Suites, Filters) -> Ciphers
                              when
                                  Suites :: <a href="#t:ciphers/0">ciphers</a>(), Filters :: <a href="#t:cipher_filters/0">cipher_filters</a>(), Ciphers :: <a href="#t:ciphers/0">ciphers</a>().</pre>

      </div>

<p>Removes cipher suites if any of the filter functions returns <code class="inline">false</code> for any part
of the cipher suite.</p><p>If no filter function is supplied for some part, the default behavior
treats it as a filter function that returns <code class="inline">true</code>. For
examples, see <a href="using_ssl.html#customizing-cipher-suites">Customizing cipher suites
</a>. Additionally, this function
also filters the cipher suites to exclude cipher suites not supported
by the crypto library used by the OTP Crypto application, meaning that
<a href="#filter_cipher_suites/2"><code class="inline">ssl:filter_cipher_suites(Suites, [])</code></a>
is equivalent to applying only the filters for crypto library support.</p>
  </section>
</section>
<section class="detail" id="format_error/1">

  <div class="detail-header">
    <a href="#format_error/1" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">format_error(Error)</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L3625" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> format_error(Error) -> ReasonStr when Error :: {error, <a href="#t:reason/0">reason</a>()} | <a href="#t:reason/0">reason</a>(), ReasonStr :: <a href="../../apps/erts/erlang.html#t:string/0">string</a>().</pre>

      </div>

<p>Presents the error returned by an SSL function as a printable string.</p>
  </section>
</section>
<section class="detail" id="getopts/2">

  <div class="detail-header">
    <a href="#getopts/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">getopts(SslSocket, OptionNames)</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L3150" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> getopts(SslSocket, OptionNames) -> {ok, [<a href="../../apps/kernel/gen_tcp.html#t:option/0">gen_tcp:option</a>()]} | {error, <a href="#t:reason/0">reason</a>()}
                 when SslSocket :: <a href="#t:sslsocket/0">sslsocket</a>(), OptionNames :: [<a href="../../apps/kernel/gen_tcp.html#t:option_name/0">gen_tcp:option_name</a>()].</pre>

      </div>

<p>Gets the values of the specified socket options.</p>
  </section>
</section>
<section class="detail" id="getstat/1">

  <div class="detail-header">
    <a href="#getstat/1" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">getstat(SslSocket)</h1>

        <span class="note">(since OTP 19.0)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L3242" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> getstat(SslSocket) -> {ok, OptionValues} | {error, <a href="../../apps/kernel/inet.html#t:posix/0">inet:posix</a>()}
                 when SslSocket :: <a href="#t:sslsocket/0">sslsocket</a>(), OptionValues :: [{<a href="../../apps/kernel/inet.html#t:stat_option/0">inet:stat_option</a>(), <a href="../../apps/erts/erlang.html#t:integer/0">integer</a>()}].</pre>

      </div>

<p>Get statistics for the underlying socket.</p>
  </section>
</section>
<section class="detail" id="getstat/2">

  <div class="detail-header">
    <a href="#getstat/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">getstat(SslSocket, Options)</h1>

        <span class="note">(since OTP 19.0)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L3260" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> getstat(SslSocket, Options) -> {ok, OptionValues} | {error, <a href="../../apps/kernel/inet.html#t:posix/0">inet:posix</a>()}
                 when
                     SslSocket :: <a href="#t:sslsocket/0">sslsocket</a>(),
                     Options :: [<a href="../../apps/kernel/inet.html#t:stat_option/0">inet:stat_option</a>()],
                     OptionValues :: [{<a href="../../apps/kernel/inet.html#t:stat_option/0">inet:stat_option</a>(), <a href="../../apps/erts/erlang.html#t:integer/0">integer</a>()}].</pre>

      </div>

<p>Get one or more statistic values for the underlying socket.</p><p>See <a href="../../apps/kernel/inet.html#getstat/2"><code class="inline">inet:getstat/2</code></a> for further details.</p>
  </section>
</section>
<section class="detail" id="negotiated_protocol/1">

  <div class="detail-header">
    <a href="#negotiated_protocol/1" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">negotiated_protocol(SslSocket)</h1>

        <span class="note">(since OTP 18.0)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L2827" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> negotiated_protocol(SslSocket) -> {ok, Protocol} | {error, Reason}
                             when
                                 SslSocket :: <a href="#t:sslsocket/0">sslsocket</a>(),
                                 Protocol :: <a href="../../apps/erts/erlang.html#t:binary/0">binary</a>(),
                                 Reason :: protocol_not_negotiated | closed.</pre>

      </div>

<p>Returns the protocol negotiated through ALPN or NPN extensions.</p>
  </section>
</section>
<section class="detail" id="peercert/1">

  <div class="detail-header">
    <a href="#peercert/1" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">peercert(SslSocket)</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L2805" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> peercert(SslSocket) -> {ok, Cert} | {error, <a href="#t:reason/0">reason</a>()}
                  when SslSocket :: <a href="#t:sslsocket/0">sslsocket</a>(), Cert :: <a href="../../apps/public_key/public_key.html#t:der_encoded/0">public_key:der_encoded</a>().</pre>

      </div>

<p>The peer certificate is returned as a DER-encoded binary.</p><p>The certificate can be
decoded with <a href="../../apps/public_key/public_key.html#pkix_decode_cert/2"><code class="inline">public_key:pkix_decode_cert/2</code></a>. Suggested further reading about
certificates is <a href="../../apps/public_key/public_key_records.html">Public_Key User's Guide</a>
and <a href="standards_compliance.html">SSL User's Guide</a>.</p>
  </section>
</section>
<section class="detail" id="peername/1">

  <div class="detail-header">
    <a href="#peername/1" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">peername(SslSocket)</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L2771" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> peername(SslSocket) -> {ok, {Address, Port}} | {error, <a href="#t:reason/0">reason</a>()}
                  when
                      SslSocket :: <a href="#t:sslsocket/0">sslsocket</a>(), Address :: <a href="../../apps/kernel/inet.html#t:ip_address/0">inet:ip_address</a>(), Port :: <a href="../../apps/kernel/inet.html#t:port_number/0">inet:port_number</a>().</pre>

      </div>

<p>Returns the address and port number of the peer.</p>
  </section>
</section>
<section class="detail" id="prepend_cipher_suites/2">

  <div class="detail-header">
    <a href="#prepend_cipher_suites/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">prepend_cipher_suites(Preferred, Suites)</h1>

        <span class="note">(since OTP 20.3)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L2955" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> prepend_cipher_suites(Preferred, Suites) -> <a href="#t:ciphers/0">ciphers</a>()
                               when Preferred :: <a href="#t:ciphers/0">ciphers</a>() | <a href="#t:cipher_filters/0">cipher_filters</a>(), Suites :: <a href="#t:ciphers/0">ciphers</a>().</pre>

      </div>

<p>Make <code class="inline">Preferred</code> suites become the most preferred suites.</p><p>The <code class="inline">Preferred</code> suites will be put at the head of the cipher suite
list <code class="inline">Suites</code> after removing them from <code class="inline">Suites</code> if
present. <code class="inline">Preferred</code> can be a list of cipher suites or a list of
filters in which case the filters are used on <code class="inline">Suites</code> to extract the
preferred cipher list.</p>
  </section>
</section>
<section class="detail" id="signature_algs/2">

  <div class="detail-header">
    <a href="#signature_algs/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">signature_algs(Description, Version)</h1>

        <span class="note">(since OTP 26.0)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L3047" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> signature_algs(Description, Version) -> <a href="#t:signature_algs/0">signature_algs</a>()
                        when Description :: default | all | exclusive, Version :: <a href="#t:protocol_version/0">protocol_version</a>().</pre>

      </div>

<p>Lists all available signature algorithms corresponding to <code class="inline">Description</code>.</p><p>The <code class="inline">exclusive</code> option will exclusively list algorithms or algorithm schemes for
that protocol version, whereas the <code class="inline">default</code> and <code class="inline">all</code> options lists the
combined list to support the range of protocols from (D)TLS-1.2, the first
version to support configuration of the signature algorithms, to <code class="inline">Version</code>.</p><p>Example:</p><pre><code class="makeup erlang" translate="no"><span class="gp unselectable">1&gt; </span><span class="nc">ssl</span><span class="p">:</span><span class="nf">signature_algs</span><span class="p" data-group-id="6313824784-1">(</span><span class="ss">default</span><span class="p">,</span><span class="w"> </span><span class="ss">&#39;tlsv1.3&#39;</span><span class="p" data-group-id="6313824784-1">)</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="6313824784-2">[</span><span class="ss">eddsa_ed25519</span><span class="p">,</span><span class="ss">eddsa_ed448</span><span class="p">,</span><span class="ss">ecdsa_secp521r1_sha512</span><span class="p">,</span><span class="w">
</span><span class="ss">ecdsa_secp384r1_sha384</span><span class="p">,</span><span class="ss">ecdsa_secp256r1_sha256</span><span class="p">,</span><span class="w">
</span><span class="ss">rsa_pss_pss_sha512</span><span class="p">,</span><span class="ss">rsa_pss_pss_sha384</span><span class="p">,</span><span class="ss">rsa_pss_pss_sha256</span><span class="p">,</span><span class="w">
</span><span class="ss">rsa_pss_rsae_sha512</span><span class="p">,</span><span class="ss">rsa_pss_rsae_sha384</span><span class="p">,</span><span class="ss">rsa_pss_rsae_sha256</span><span class="p">,</span><span class="w">
</span><span class="ss">rsa_pkcs1_sha512</span><span class="p">,</span><span class="ss">rsa_pkcs1_sha384</span><span class="p">,</span><span class="ss">rsa_pkcs1_sha256</span><span class="p">,</span><span class="w">
</span><span class="p" data-group-id="6313824784-3">{</span><span class="ss">sha512</span><span class="p">,</span><span class="ss">ecdsa</span><span class="p" data-group-id="6313824784-3">}</span><span class="p">,</span><span class="w">
</span><span class="p" data-group-id="6313824784-4">{</span><span class="ss">sha384</span><span class="p">,</span><span class="ss">ecdsa</span><span class="p" data-group-id="6313824784-4">}</span><span class="p">,</span><span class="w">
</span><span class="p" data-group-id="6313824784-5">{</span><span class="ss">sha256</span><span class="p">,</span><span class="ss">ecdsa</span><span class="p" data-group-id="6313824784-5">}</span><span class="p" data-group-id="6313824784-2">]</span><span class="w">

</span><span class="mi">2</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">ssl</span><span class="p">:</span><span class="nf">signature_algs</span><span class="p" data-group-id="6313824784-6">(</span><span class="ss">all</span><span class="p">,</span><span class="w"> </span><span class="ss">&#39;tlsv1.3&#39;</span><span class="p" data-group-id="6313824784-6">)</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="6313824784-7">[</span><span class="ss">eddsa_ed25519</span><span class="p">,</span><span class="ss">eddsa_ed448</span><span class="p">,</span><span class="ss">ecdsa_secp521r1_sha512</span><span class="p">,</span><span class="w">
</span><span class="ss">ecdsa_secp384r1_sha384</span><span class="p">,</span><span class="ss">ecdsa_secp256r1_sha256</span><span class="p">,</span><span class="w">
</span><span class="ss">rsa_pss_pss_sha512</span><span class="p">,</span><span class="ss">rsa_pss_pss_sha384</span><span class="p">,</span><span class="ss">rsa_pss_pss_sha256</span><span class="p">,</span><span class="w">
</span><span class="ss">rsa_pss_rsae_sha512</span><span class="p">,</span><span class="ss">rsa_pss_rsae_sha384</span><span class="p">,</span><span class="ss">rsa_pss_rsae_sha256</span><span class="p">,</span><span class="w">
</span><span class="ss">rsa_pkcs1_sha512</span><span class="p">,</span><span class="ss">rsa_pkcs1_sha384</span><span class="p">,</span><span class="ss">rsa_pkcs1_sha256</span><span class="p">,</span><span class="w">
</span><span class="p" data-group-id="6313824784-8">{</span><span class="ss">sha512</span><span class="p">,</span><span class="ss">ecdsa</span><span class="p" data-group-id="6313824784-8">}</span><span class="p">,</span><span class="w">
</span><span class="p" data-group-id="6313824784-9">{</span><span class="ss">sha384</span><span class="p">,</span><span class="ss">ecdsa</span><span class="p" data-group-id="6313824784-9">}</span><span class="p">,</span><span class="w">
</span><span class="p" data-group-id="6313824784-10">{</span><span class="ss">sha256</span><span class="p">,</span><span class="ss">ecdsa</span><span class="p" data-group-id="6313824784-10">}</span><span class="p">,</span><span class="w">
</span><span class="p" data-group-id="6313824784-11">{</span><span class="ss">sha224</span><span class="p">,</span><span class="ss">ecdsa</span><span class="p" data-group-id="6313824784-11">}</span><span class="p">,</span><span class="w">
</span><span class="p" data-group-id="6313824784-12">{</span><span class="ss">sha224</span><span class="p">,</span><span class="ss">rsa</span><span class="p" data-group-id="6313824784-12">}</span><span class="p">,</span><span class="w">
</span><span class="p" data-group-id="6313824784-13">{</span><span class="ss">sha</span><span class="p">,</span><span class="ss">rsa</span><span class="p" data-group-id="6313824784-13">}</span><span class="p">,</span><span class="w">
</span><span class="p" data-group-id="6313824784-14">{</span><span class="ss">sha</span><span class="p">,</span><span class="ss">dsa</span><span class="p" data-group-id="6313824784-14">}</span><span class="p" data-group-id="6313824784-7">]</span><span class="w">

</span><span class="mi">3</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">ssl</span><span class="p">:</span><span class="nf">signature_algs</span><span class="p" data-group-id="6313824784-15">(</span><span class="ss">exclusive</span><span class="p">,</span><span class="w"> </span><span class="ss">&#39;tlsv1.3&#39;</span><span class="p" data-group-id="6313824784-15">)</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="6313824784-16">[</span><span class="ss">eddsa_ed25519</span><span class="p">,</span><span class="ss">eddsa_ed448</span><span class="p">,</span><span class="ss">ecdsa_secp521r1_sha512</span><span class="p">,</span><span class="w">
</span><span class="ss">ecdsa_secp384r1_sha384</span><span class="p">,</span><span class="ss">ecdsa_secp256r1_sha256</span><span class="p">,</span><span class="w">
</span><span class="ss">rsa_pss_pss_sha512</span><span class="p">,</span><span class="ss">rsa_pss_pss_sha384</span><span class="p">,</span><span class="ss">rsa_pss_pss_sha256</span><span class="p">,</span><span class="w">
</span><span class="ss">rsa_pss_rsae_sha512</span><span class="p">,</span><span class="ss">rsa_pss_rsae_sha384</span><span class="p">,</span><span class="ss">rsa_pss_rsae_sha256</span><span class="p" data-group-id="6313824784-16">]</span></code></pre><section role="note" class="admonition info"><h4 class="admonition-title info">Note</h4><p>Some TLS-1-3 scheme names overlap with TLS-1.2 algorithm-tuple-pair-names and
then TLS-1.3 names will be used, for example <code class="inline">rsa_pkcs1_sha256</code> instead of
<code class="inline">{sha256, rsa}</code>. These are legacy algorithms in TLS-1.3 that apply only to
certificate signatures in this version of the protocol.</p></section>
  </section>
</section>
<section class="detail" id="sockname/1">

  <div class="detail-header">
    <a href="#sockname/1" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">sockname(SslSocket)</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L3327" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> sockname(SslSocket) -> {ok, {Address, Port}} | {error, <a href="#t:reason/0">reason</a>()}
                  when
                      SslSocket :: <a href="#t:sslsocket/0">sslsocket</a>(), Address :: <a href="../../apps/kernel/inet.html#t:ip_address/0">inet:ip_address</a>(), Port :: <a href="../../apps/kernel/inet.html#t:port_number/0">inet:port_number</a>().</pre>

      </div>

<p>Returns the local address and port number of socket <code class="inline">SslSocket</code>.</p>
  </section>
</section>
<section class="detail" id="start/0">

  <div class="detail-header">
    <a href="#start/0" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">start()</h1>

        <span class="note">(since OTP R14B)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L2124" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> start() -> ok | {error, <a href="#t:reason/0">reason</a>()}.</pre>

      </div>

<p>Equivalent to <a href="#start/1"><code class="inline">start(temporary)</code></a>.</p>
  </section>
</section>
<section class="detail" id="start/1">

  <div class="detail-header">
    <a href="#start/1" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">start(Type)</h1>

        <span class="note">(since OTP R14B)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L2132" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> start(permanent | transient | temporary) -> ok | {error, <a href="#t:reason/0">reason</a>()}.</pre>

      </div>

<p>Starts the SSL application.</p>
  </section>
</section>
<section class="detail" id="stop/0">

  <div class="detail-header">
    <a href="#stop/0" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">stop()</h1>

        <span class="note">(since OTP R14B)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L2148" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> stop() -> ok.</pre>

      </div>

<p>Stops the SSL application.</p>
  </section>
</section>
<section class="detail" id="str_to_suite/1">

  <div class="detail-header">
    <a href="#str_to_suite/1" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">str_to_suite(CipherSuiteName)</h1>

        <span class="note">(since OTP 22.0)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L3672" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> str_to_suite(CipherSuiteName) -> <a href="#t:erl_cipher_suite/0">erl_cipher_suite</a>() | {error, {not_recognized, CipherSuiteName}}
                      when CipherSuiteName :: <a href="../../apps/erts/erlang.html#t:string/0">string</a>().</pre>

      </div>

<p>Converts an RFC or OpenSSL name string to an <a href="#t:erl_cipher_suite/0"><code class="inline">erl_cipher_suite/0</code></a></p><p>Returns an error if the cipher suite is not supported or the name is
not a valid cipher suite name.</p>
  </section>
</section>
<section class="detail" id="suite_to_openssl_str/1">

  <div class="detail-header">
    <a href="#suite_to_openssl_str/1" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">suite_to_openssl_str(CipherSuite)</h1>

        <span class="note">(since OTP 22.0)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L3656" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> suite_to_openssl_str(CipherSuite) -> <a href="../../apps/erts/erlang.html#t:string/0">string</a>() when CipherSuite :: <a href="#t:erl_cipher_suite/0">erl_cipher_suite</a>().</pre>

      </div>

<p>Converts an <a href="#t:erl_cipher_suite/0"><code class="inline">erl_cipher_suite()</code></a> value to
an OpenSSL name string.</p><p>PRE TLS-1.3 these names differ for RFC names</p>
  </section>
</section>
<section class="detail" id="suite_to_str/1">

  <div class="detail-header">
    <a href="#suite_to_str/1" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">suite_to_str(CipherSuite)</h1>

        <span class="note">(since OTP 21.0)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L3640" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> suite_to_str(CipherSuite) -> <a href="../../apps/erts/erlang.html#t:string/0">string</a>() when CipherSuite :: <a href="#t:erl_cipher_suite/0">erl_cipher_suite</a>().</pre>

      </div>

<p>Converts an <a href="#t:erl_cipher_suite/0"><code class="inline">erl_cipher_suite()</code></a> value to an RFC
name string.</p>
  </section>
</section>
<section class="detail" id="versions/0">

  <div class="detail-header">
    <a href="#versions/0" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">versions()</h1>

        <span class="note">(since OTP R14B)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/ssl/src/ssl.erl#L3383" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> versions() -> [VersionInfo]
                  when
                      VersionInfo ::
                          {ssl_app, <a href="../../apps/erts/erlang.html#t:string/0">string</a>()} |
                          {supported | available | implemented, [<a href="#t:tls_version/0">tls_version</a>()]} |
                          {supported_dtls | available_dtls | implemented_dtls, [<a href="#t:dtls_version/0">dtls_version</a>()]}.</pre>

      </div>

<p>Lists information, mainly concerning TLS/DTLS versions, in runtime for debugging
and testing purposes.</p><ul><li><p><strong><code class="inline">app_vsn</code></strong> - The application version of the SSL application.</p></li><li><p><strong><code class="inline">supported</code></strong> - TLS versions supported with current application environment
and crypto library configuration. Overridden by a version option on
<a href="#connect/2"><code class="inline">connect/2,3,4</code></a>, <a href="#listen/2"><code class="inline">listen/2</code></a>, and
<a href="#handshake/2"><code class="inline">handshake/2,3</code></a>. For the negotiated TLS version, see
<a href="#connection_information/1"><code class="inline">connection_information/1</code></a>.</p></li><li><p><strong><code class="inline">supported_dtls</code></strong> - DTLS versions supported with current application
environment and crypto library configuration. Overridden by a version option
on <a href="#connect/2"><code class="inline">connect/2,3,4</code></a>, <a href="#listen/2"><code class="inline">listen/2</code></a>, and
<a href="#handshake/2"><code class="inline">handshake/2,3</code></a>. For the negotiated DTLS version, see
<a href="#connection_information/1"><code class="inline">connection_information/1</code></a>.</p></li><li><p><strong><code class="inline">available</code></strong> - All TLS versions supported with the linked crypto library.</p></li><li><p><strong><code class="inline">available_dtls</code></strong> - All DTLS versions supported with the linked crypto
library.</p></li><li><p><strong><code class="inline">implemented</code></strong> - All TLS versions supported by the SSL application if
linked with a crypto library with the necessary support.</p></li><li><p><strong><code class="inline">implemented_dtls</code></strong> - All DTLS versions supported by the SSL application if
linked with a crypto library with the necessary support.</p></li></ul>
  </section>
</section>

    </div>
  </section>

    <footer class="footer">
      <p>

        <span class="line">
          <button class="a-main footer-button display-quick-switch" title="Search HexDocs packages">
            Search HexDocs
          </button>

            <a href="ssl.epub" title="ePub version">
              Download ePub version
            </a>

        </span>
      </p>

      <p class="built-using">
        Built using
        <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.38.1) for the

          <a href="https://erlang.org" title="Erlang" target="_blank" translate="no">Erlang programming language</a>

      </p>
<p>Copyright Â© 1996-2025 <a href="https://www.ericsson.com">Ericsson AB</a></p>
    </footer>
  </div>
</main>
</div>
  <script defer src="https://cdn.jsdelivr.net/npm/mermaid@11.4.1/dist/mermaid.min.js"></script>
  <script>
  let initialized = false;

  window.addEventListener("exdoc:loaded", () => {
      if (!initialized) {
      mermaid.initialize({
          startOnLoad: false,
          theme: document.body.className.includes("dark") ? "dark" : "default"
      });
      initialized = true;
      }

      let id = 0;
      for (const codeEl of document.querySelectorAll("pre code.mermaid")) {
      const preEl = codeEl.parentElement;
      const graphDefinition = codeEl.textContent;
      const graphEl = document.createElement("div");
      const graphId = "mermaid-graph-" + id++;
      mermaid.render(graphId, graphDefinition).then(({svg, bindFunctions}) => {
          graphEl.innerHTML = svg;
          bindFunctions?.(graphEl);
          preEl.insertAdjacentElement("afterend", graphEl);
          preEl.remove();
      });
      }
  });
  </script>

  </body>
</html>
