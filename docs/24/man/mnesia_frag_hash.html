<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html xmlns:erl="http://erlang.org" xmlns:fn="http://www.w3.org/2005/02/xpath-functions">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta charset="utf-8">
<link rel="stylesheet" href="../otp_doc.css" type="text/css">
<title>Erlang -- mnesia_frag_hash</title>
</head>
<body>
<div id="container">
<script id="js" type="text/javascript" language="JavaScript" src="../js/flipmenu/flipmenu.js"></script><script id="js2" type="text/javascript" src="../js/erlresolvelinks.js"></script><script id="js3" type="text/javascript" src="../../../../doc/js/topbar.js"></script><script language="JavaScript" type="text/javascript">
            <!--
              function setscrollpos() {
                var objf = document.getElementById('loadscrollpos');
                if (objf) {
                  document.getElementById("leftnav").firstChild.scrollTop = objf.offsetTop - 10;
                }
              }

              function addEvent(obj, evType, fn){
                if (obj.addEventListener){
                obj.addEventListener(evType, fn, true);
                return true;
              } else if (obj.attachEvent){
                var r = obj.attachEvent("on"+evType, fn);
                return r;
              } else {
                return false;
              }
             }

             addEvent(window, 'load', setscrollpos);

             //-->
</script><div class="topbar">
<div class="topbar-expand "><button onclick="toggleDisplay();"><svg xmlns="http://www.w3.org/2000/svg" version="1.1" id="Capa_1" viewBox="0 0 54 54" width="24" height="24"><g><path style="fill:#000000;" d="M27,54c-0.552,0-1-0.448-1-1V8c0-0.552,0.448-1,1-1s1,0.448,1,1v45C28,53.552,27.552,54,27,54z"></path><path style="fill:#000000;" d="M11,25c-0.256,0-0.512-0.098-0.707-0.293c-0.391-0.391-0.391-1.023,0-1.414l16-16                                      c0.391-0.391,1.023-0.391,1.414,0s0.391,1.023,0,1.414l-16,16C11.512,24.902,11.256,25,11,25z"></path><path style="fill:#000000;" d="M43,25c-0.256,0-0.512-0.098-0.707-0.293l-16-16c-0.391-0.391-0.391-1.023,0-1.414                                      s1.023-0.391,1.414,0l16,16c0.391,0.391,0.391,1.023,0,1.414C43.512,24.902,43.256,25,43,25z"></path><path style="fill:#000000;" d="M43,2H11c-0.552,0-1-0.448-1-1s0.448-1,1-1h32c0.552,0,1,0.448,1,1S43.552,2,43,2z"></path></g></svg></button></div>
<div class="topbar-title"><h1 id="mnesia_frag_hash">mnesia_frag_hash</h1></div>
<div class="search-expand "></div>
</div>
<aside class="hide-mobile" id="leftnav"><nav class="leftnav-tube"><div class="erlang-logo-wrapper"><a href="../index.html"><img alt="Erlang Logo" src="../erlang-logo.png" class="erlang-logo"></a></div>
<p class="section-title">Mnesia</p>
<p class="section-subtitle">Reference Manual</p>
<p class="section-version">Version 4.20</p>
<ul class="panel-sections">
<li><a href="../apps/mnesia/users_guide.html">User's Guide</a></li>
<li><a href="../apps/mnesia/index.html">Reference Manual</a></li>
<li><a href="../apps/mnesia/notes.html">Release Notes</a></li>
<li><a href="../apps/mnesia/mnesia.pdf">PDF</a></li>
<li><a href="../index.html">Top</a></li>
</ul>
<ul class="expand-collapse-items">
<li><a href="javascript:openAllFlips()">Expand All</a></li>
<li><a href="javascript:closeAllFlips()">Contract All</a></li>
</ul>
<h3 id="toc">Table of Contents</h3>
<ul class="flipMenu">
<li id="no" title="mnesia " expanded="false">mnesia<ul>
<li><a href="mnesia.html">
                  Top of manual page
                </a></li>
    <li title="abort-1"><a href="mnesia.html#abort-1">abort/1</a></li>
    <li title="activate_checkpoint-1"><a href="mnesia.html#activate_checkpoint-1">activate_checkpoint/1</a></li>
    <li title="activity-2"><a href="mnesia.html#activity-2">activity/2</a></li>
    <li title="activity-4"><a href="mnesia.html#activity-4">activity/4</a></li>
    <li title="add_table_copy-3"><a href="mnesia.html#add_table_copy-3">add_table_copy/3</a></li>
    <li title="add_table_index-2"><a href="mnesia.html#add_table_index-2">add_table_index/2</a></li>
    <li title="all_keys-1"><a href="mnesia.html#all_keys-1">all_keys/1</a></li>
    <li title="async_dirty-1"><a href="mnesia.html#async_dirty-1">async_dirty/1</a></li>
    <li title="async_dirty-2"><a href="mnesia.html#async_dirty-2">async_dirty/2</a></li>
    <li title="backup-1"><a href="mnesia.html#backup-1">backup/1</a></li>
    <li title="backup-2"><a href="mnesia.html#backup-2">backup/2</a></li>
    <li title="backup_checkpoint-2"><a href="mnesia.html#backup_checkpoint-2">backup_checkpoint/2</a></li>
    <li title="backup_checkpoint-3"><a href="mnesia.html#backup_checkpoint-3">backup_checkpoint/3</a></li>
    <li title="change_config-2"><a href="mnesia.html#change_config-2">change_config/2</a></li>
    <li title="change_table_access_mode-2"><a href="mnesia.html#change_table_access_mode-2">change_table_access_mode/2</a></li>
    <li title="change_table_copy_type-3"><a href="mnesia.html#change_table_copy_type-3">change_table_copy_type/3</a></li>
    <li title="change_table_load_order-2"><a href="mnesia.html#change_table_load_order-2">change_table_load_order/2</a></li>
    <li title="change_table_majority-2"><a href="mnesia.html#change_table_majority-2">change_table_majority/2</a></li>
    <li title="clear_table-1"><a href="mnesia.html#clear_table-1">clear_table/1</a></li>
    <li title="create_schema-1"><a href="mnesia.html#create_schema-1">create_schema/1</a></li>
    <li title="create_table-2"><a href="mnesia.html#create_table-2">create_table/2</a></li>
    <li title="deactivate_checkpoint-1"><a href="mnesia.html#deactivate_checkpoint-1">deactivate_checkpoint/1</a></li>
    <li title="del_table_copy-2"><a href="mnesia.html#del_table_copy-2">del_table_copy/2</a></li>
    <li title="del_table_index-2"><a href="mnesia.html#del_table_index-2">del_table_index/2</a></li>
    <li title="delete-1"><a href="mnesia.html#delete-1">delete/1</a></li>
    <li title="delete-3"><a href="mnesia.html#delete-3">delete/3</a></li>
    <li title="delete_object-1"><a href="mnesia.html#delete_object-1">delete_object/1</a></li>
    <li title="delete_object-3"><a href="mnesia.html#delete_object-3">delete_object/3</a></li>
    <li title="delete_schema-1"><a href="mnesia.html#delete_schema-1">delete_schema/1</a></li>
    <li title="delete_table-1"><a href="mnesia.html#delete_table-1">delete_table/1</a></li>
    <li title="dirty_all_keys-1"><a href="mnesia.html#dirty_all_keys-1">dirty_all_keys/1</a></li>
    <li title="dirty_delete-1"><a href="mnesia.html#dirty_delete-1">dirty_delete/1</a></li>
    <li title="dirty_delete-2"><a href="mnesia.html#dirty_delete-2">dirty_delete/2</a></li>
    <li title="dirty_delete_object-1"><a href="mnesia.html#dirty_delete_object-1">dirty_delete_object/1</a></li>
    <li title="dirty_delete_object-2"><a href="mnesia.html#dirty_delete_object-2">dirty_delete_object/2</a></li>
    <li title="dirty_first-1"><a href="mnesia.html#dirty_first-1">dirty_first/1</a></li>
    <li title="dirty_index_match_object-2"><a href="mnesia.html#dirty_index_match_object-2">dirty_index_match_object/2</a></li>
    <li title="dirty_index_match_object-3"><a href="mnesia.html#dirty_index_match_object-3">dirty_index_match_object/3</a></li>
    <li title="dirty_index_read-3"><a href="mnesia.html#dirty_index_read-3">dirty_index_read/3</a></li>
    <li title="dirty_last-1"><a href="mnesia.html#dirty_last-1">dirty_last/1</a></li>
    <li title="dirty_match_object-1"><a href="mnesia.html#dirty_match_object-1">dirty_match_object/1</a></li>
    <li title="dirty_match_object-2"><a href="mnesia.html#dirty_match_object-2">dirty_match_object/2</a></li>
    <li title="dirty_next-2"><a href="mnesia.html#dirty_next-2">dirty_next/2</a></li>
    <li title="dirty_prev-2"><a href="mnesia.html#dirty_prev-2">dirty_prev/2</a></li>
    <li title="dirty_read-1"><a href="mnesia.html#dirty_read-1">dirty_read/1</a></li>
    <li title="dirty_read-2"><a href="mnesia.html#dirty_read-2">dirty_read/2</a></li>
    <li title="dirty_select-2"><a href="mnesia.html#dirty_select-2">dirty_select/2</a></li>
    <li title="dirty_update_counter-2"><a href="mnesia.html#dirty_update_counter-2">dirty_update_counter/2</a></li>
    <li title="dirty_update_counter-3"><a href="mnesia.html#dirty_update_counter-3">dirty_update_counter/3</a></li>
    <li title="dirty_write-1"><a href="mnesia.html#dirty_write-1">dirty_write/1</a></li>
    <li title="dirty_write-2"><a href="mnesia.html#dirty_write-2">dirty_write/2</a></li>
    <li title="dump_log-0"><a href="mnesia.html#dump_log-0">dump_log/0</a></li>
    <li title="dump_tables-1"><a href="mnesia.html#dump_tables-1">dump_tables/1</a></li>
    <li title="dump_to_textfile-1"><a href="mnesia.html#dump_to_textfile-1">dump_to_textfile/1</a></li>
    <li title="error_description-1"><a href="mnesia.html#error_description-1">error_description/1</a></li>
    <li title="ets-1"><a href="mnesia.html#ets-1">ets/1</a></li>
    <li title="ets-2"><a href="mnesia.html#ets-2">ets/2</a></li>
    <li title="first-1"><a href="mnesia.html#first-1">first/1</a></li>
    <li title="foldl-3"><a href="mnesia.html#foldl-3">foldl/3</a></li>
    <li title="foldr-3"><a href="mnesia.html#foldr-3">foldr/3</a></li>
    <li title="force_load_table-1"><a href="mnesia.html#force_load_table-1">force_load_table/1</a></li>
    <li title="index_match_object-2"><a href="mnesia.html#index_match_object-2">index_match_object/2</a></li>
    <li title="index_match_object-4"><a href="mnesia.html#index_match_object-4">index_match_object/4</a></li>
    <li title="index_read-3"><a href="mnesia.html#index_read-3">index_read/3</a></li>
    <li title="info-0"><a href="mnesia.html#info-0">info/0</a></li>
    <li title="install_fallback-1"><a href="mnesia.html#install_fallback-1">install_fallback/1</a></li>
    <li title="install_fallback-2"><a href="mnesia.html#install_fallback-2">install_fallback/2</a></li>
    <li title="is_transaction-0"><a href="mnesia.html#is_transaction-0">is_transaction/0</a></li>
    <li title="last-1"><a href="mnesia.html#last-1">last/1</a></li>
    <li title="load_textfile-1"><a href="mnesia.html#load_textfile-1">load_textfile/1</a></li>
    <li title="lock-2"><a href="mnesia.html#lock-2">lock/2</a></li>
    <li title="match_object-1"><a href="mnesia.html#match_object-1">match_object/1</a></li>
    <li title="match_object-3"><a href="mnesia.html#match_object-3">match_object/3</a></li>
    <li title="move_table_copy-3"><a href="mnesia.html#move_table_copy-3">move_table_copy/3</a></li>
    <li title="next-2"><a href="mnesia.html#next-2">next/2</a></li>
    <li title="prev-2"><a href="mnesia.html#prev-2">prev/2</a></li>
    <li title="read-1"><a href="mnesia.html#read-1">read/1</a></li>
    <li title="read-2"><a href="mnesia.html#read-2">read/2</a></li>
    <li title="read-3"><a href="mnesia.html#read-3">read/3</a></li>
    <li title="read_lock_table-1"><a href="mnesia.html#read_lock_table-1">read_lock_table/1</a></li>
    <li title="report_event-1"><a href="mnesia.html#report_event-1">report_event/1</a></li>
    <li title="restore-2"><a href="mnesia.html#restore-2">restore/2</a></li>
    <li title="s_delete-1"><a href="mnesia.html#s_delete-1">s_delete/1</a></li>
    <li title="s_delete_object-1"><a href="mnesia.html#s_delete_object-1">s_delete_object/1</a></li>
    <li title="s_write-1"><a href="mnesia.html#s_write-1">s_write/1</a></li>
    <li title="schema-0"><a href="mnesia.html#schema-0">schema/0</a></li>
    <li title="schema-1"><a href="mnesia.html#schema-1">schema/1</a></li>
    <li title="select-2"><a href="mnesia.html#select-2">select/2</a></li>
    <li title="select-3"><a href="mnesia.html#select-3">select/3</a></li>
    <li title="select-4"><a href="mnesia.html#select-4">select/4</a></li>
    <li title="select-1"><a href="mnesia.html#select-1">select/1</a></li>
    <li title="set_debug_level-1"><a href="mnesia.html#set_debug_level-1">set_debug_level/1</a></li>
    <li title="set_master_nodes-1"><a href="mnesia.html#set_master_nodes-1">set_master_nodes/1</a></li>
    <li title="set_master_nodes-2"><a href="mnesia.html#set_master_nodes-2">set_master_nodes/2</a></li>
    <li title="snmp_close_table-1"><a href="mnesia.html#snmp_close_table-1">snmp_close_table/1</a></li>
    <li title="snmp_get_mnesia_key-2"><a href="mnesia.html#snmp_get_mnesia_key-2">snmp_get_mnesia_key/2</a></li>
    <li title="snmp_get_next_index-2"><a href="mnesia.html#snmp_get_next_index-2">snmp_get_next_index/2</a></li>
    <li title="snmp_get_row-2"><a href="mnesia.html#snmp_get_row-2">snmp_get_row/2</a></li>
    <li title="snmp_open_table-2"><a href="mnesia.html#snmp_open_table-2">snmp_open_table/2</a></li>
    <li title="start-0"><a href="mnesia.html#start-0">start/0</a></li>
    <li title="stop-0"><a href="mnesia.html#stop-0">stop/0</a></li>
    <li title="subscribe-1"><a href="mnesia.html#subscribe-1">subscribe/1</a></li>
    <li title="sync_dirty-1"><a href="mnesia.html#sync_dirty-1">sync_dirty/1</a></li>
    <li title="sync_dirty-2"><a href="mnesia.html#sync_dirty-2">sync_dirty/2</a></li>
    <li title="sync_log-0"><a href="mnesia.html#sync_log-0">sync_log/0</a></li>
    <li title="sync_transaction-1"><a href="mnesia.html#sync_transaction-1">sync_transaction/1</a></li>
    <li title="sync_transaction-2"><a href="mnesia.html#sync_transaction-2">sync_transaction/2</a></li>
    <li title="sync_transaction-3"><a href="mnesia.html#sync_transaction-3">sync_transaction/3</a></li>
    <li title="system_info-1"><a href="mnesia.html#system_info-1">system_info/1</a></li>
    <li title="table-1"><a href="mnesia.html#table-1">table/1</a></li>
    <li title="table-2"><a href="mnesia.html#table-2">table/2</a></li>
    <li title="table_info-2"><a href="mnesia.html#table_info-2">table_info/2</a></li>
    <li title="transaction-1"><a href="mnesia.html#transaction-1">transaction/1</a></li>
    <li title="transaction-2"><a href="mnesia.html#transaction-2">transaction/2</a></li>
    <li title="transaction-3"><a href="mnesia.html#transaction-3">transaction/3</a></li>
    <li title="transform_table-4"><a href="mnesia.html#transform_table-4">transform_table/4</a></li>
    <li title="transform_table-3"><a href="mnesia.html#transform_table-3">transform_table/3</a></li>
    <li title="traverse_backup-4"><a href="mnesia.html#traverse_backup-4">traverse_backup/4</a></li>
    <li title="traverse_backup-6"><a href="mnesia.html#traverse_backup-6">traverse_backup/6</a></li>
    <li title="uninstall_fallback-0"><a href="mnesia.html#uninstall_fallback-0">uninstall_fallback/0</a></li>
    <li title="uninstall_fallback-1"><a href="mnesia.html#uninstall_fallback-1">uninstall_fallback/1</a></li>
    <li title="unsubscribe-1"><a href="mnesia.html#unsubscribe-1">unsubscribe/1</a></li>
    <li title="wait_for_tables-2"><a href="mnesia.html#wait_for_tables-2">wait_for_tables/2</a></li>
    <li title="wread-1"><a href="mnesia.html#wread-1">wread/1</a></li>
    <li title="write-1"><a href="mnesia.html#write-1">write/1</a></li>
    <li title="write-3"><a href="mnesia.html#write-3">write/3</a></li>
    <li title="write_lock_table-1"><a href="mnesia.html#write_lock_table-1">write_lock_table/1</a></li>
    </ul>
</li>
<li id="loadscrollpos" title="mnesia_frag_hash " expanded="true">mnesia_frag_hash<ul>
<li><a href="mnesia_frag_hash.html">
                  Top of manual page
                </a></li>
    <li title="add_frag-1"><a href="mnesia_frag_hash.html#add_frag-1">add_frag/1</a></li>
    <li title="del_frag-1"><a href="mnesia_frag_hash.html#del_frag-1">del_frag/1</a></li>
    <li title="init_state-2"><a href="mnesia_frag_hash.html#init_state-2">init_state/2</a></li>
    <li title="key_to_frag_number-2"><a href="mnesia_frag_hash.html#key_to_frag_number-2">key_to_frag_number/2</a></li>
    <li title="match_spec_to_frag_numbers-2"><a href="mnesia_frag_hash.html#match_spec_to_frag_numbers-2">match_spec_to_frag_numbers/2</a></li>
    </ul>
</li>
<li id="no" title="mnesia_registry " expanded="false">mnesia_registry<ul>
<li><a href="mnesia_registry.html">
                  Top of manual page
                </a></li>
    <li title="create_table-1"><a href="mnesia_registry.html#create_table-1">create_table/1</a></li>
    <li title="create_table-2"><a href="mnesia_registry.html#create_table-2">create_table/2</a></li>
    </ul>
</li>
</ul></nav></aside><div id="content">
<div class="innertube"></div>
<!-- refpage --><div class="innertube"><center><h1>mnesia_frag_hash</h1></center></div>
  
  <div class="innertube">
<h4 id="module" class="title-link" onMouseOver="document.getElementById('ghlink-module-idm5170').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-module-idm5170').style.visibility = 'hidden';">
<div class="title-name">Module</div>
<div class="title-anchors"><span id="ghlink-module-idm5170" class="ghlink-after"><a href="#module" title="Link to this place!"><span class="paperclip-after"></span></a></span></div>
</h4>
<div class="REFBODY module-body">mnesia_frag_hash</div>
</div>
  <div class="innertube">
<h4 id="module-summary" class="title-link" onMouseOver="document.getElementById('ghlink-module-summary-idm5171').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-module-summary-idm5171').style.visibility = 'hidden';">
<div class="title-name">Module Summary</div>
<div class="title-anchors"><span id="ghlink-module-summary-idm5171" class="ghlink-after"><a href="#module-summary" title="Link to this place!"><span class="paperclip-after"></span></a></span></div>
</h4>
<div class="REFBODY module-summary-body">Defines mnesia_frag_hash callback behavior</div>
</div>
  <section class="description"><div class="innertube">
<h4 id="description" class="title-link" onMouseOver="document.getElementById('ghlink-description-idm5172').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-description-idm5172').style.visibility = 'hidden';">
<div class="title-name">Description</div>
<div class="title-anchors"><span id="ghlink-description-idm5172" class="ghlink-after"><a href="#description" title="Link to this place!"><span class="paperclip-after"></span></a><a href="https://github.com/erlang/otp/edit/maint/lib/mnesia/doc/src/mnesia_frag_hash.xml#L39" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil-after"></span></a></span></div>
</h4>
<div class="REFBODY description-body"><p>
    <p>This module defines a callback behavior for user-defined hash
      functions of fragmented tables.</p>
    <p>Which module that is selected to implement the <span class="code">mnesia_frag_hash</span>
      behavior for a particular fragmented table is specified together
      with the other <span class="code">frag_properties</span>. The <span class="code">hash_module</span> defines
      the module name. The <span class="code">hash_state</span> defines the initial hash state.</p>
    <p>This module implements dynamic hashing, which is a kind of hashing
      that grows nicely when new fragments are added. It is well
      suited for scalable hash tables.</p>
  </p></div>
</div></section>

  <div class="innertube"><h4 id="exports" class="title-link" onMouseOver="document.getElementById('ghlink-exports-idm5180').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-exports-idm5180').style.visibility = 'hidden';">
<div class="title-name">Exports</div>
<div class="title-anchors"><span id="ghlink-exports-idm5180" class="ghlink-after"><a href="#exports" title="Link to this place!"><span class="paperclip-after"></span></a></span></div>
</h4></div>
<div class="exports-body">
<article class="func"><div class="bold_code func-head"><h4 id="init_state-2" class="title-link" onMouseOver="document.getElementById('ghlink-init_state-2-idm5182').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-init_state-2-idm5182').style.visibility = 'hidden';">
<div class="title-anchors"><span id="ghlink-init_state-2-idm5182" class="ghlink-before"><a href="#init_state-2" title="Link to this place!"><span class="paperclip-before"></span></a><a href="https://github.com/erlang/otp/edit/maint/lib/mnesia/doc/src/mnesia_frag_hash.xml#L52" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil-before"></span></a></span></div>
<div class="title-name">init_state(Tab, State) -&gt; NewState | abort(Reason)</div>
</h4></div>
<div class="exports-tube">
<div class="REFBODY rb-5">
<h3 id="types" class="func-types-title">Types</h3>
        <div class="REFTYPES rt-4">
<span class="bold_code fun-param-type">Tab = atom()</span><br>
</div>
        <div class="REFTYPES rt-4">
<span class="bold_code fun-param-type">State = term()</span><br>
</div>
        <div class="REFTYPES rt-4">
<span class="bold_code fun-param-type">NewState = term()</span><br>
</div>
        <div class="REFTYPES rt-4">
<span class="bold_code fun-param-type">Reason = term()</span><br>
</div>
      </div>
<div class="REFBODY rb-7">
        <p>Starts when a fragmented table is
          created with the function <span class="code">mnesia:create_table/2</span> or
          when a normal (unfragmented) table is converted to be a
          fragmented table with <span class="code">mnesia:change_table_frag/2</span>.</p>
        <p>Notice that the function <span class="code">add_frag/2</span> is started
          one time for each of the other fragments (except number 1)
          as a part of the table creation procedure.</p>
        <p><span class="code">State</span> is the initial value of the <span class="code">hash_state</span>
          <span class="code">frag_property</span>. <span class="code">NewState</span> is stored as
          <span class="code">hash_state</span> among the other <span class="code">frag_properties</span>.</p>
      </div>
</div></article><article class="func"><div class="bold_code func-head"><h4 id="add_frag-1" class="title-link" onMouseOver="document.getElementById('ghlink-add_frag-1-idm5203').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-add_frag-1-idm5203').style.visibility = 'hidden';">
<div class="title-anchors"><span id="ghlink-add_frag-1-idm5203" class="ghlink-before"><a href="#add_frag-1" title="Link to this place!"><span class="paperclip-before"></span></a><a href="https://github.com/erlang/otp/edit/maint/lib/mnesia/doc/src/mnesia_frag_hash.xml#L74" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil-before"></span></a></span></div>
<div class="title-name">add_frag(State) -&gt; {NewState, IterFrags, AdditionalLockFrags} | abort(Reason)</div>
</h4></div>
<div class="exports-tube">
<div class="REFBODY rb-5">
<h3 id="types" class="func-types-title">Types</h3>
        <div class="REFTYPES rt-4">
<span class="bold_code fun-param-type">State = term()</span><br>
</div>
        <div class="REFTYPES rt-4">
<span class="bold_code fun-param-type">NewState = term()</span><br>
</div>
        <div class="REFTYPES rt-4">
<span class="bold_code fun-param-type">IterFrags = [integer()]</span><br>
</div>
        <div class="REFTYPES rt-4">
<span class="bold_code fun-param-type">AdditionalLockFrags = [integer()]</span><br>
</div>
        <div class="REFTYPES rt-4">
<span class="bold_code fun-param-type">Reason = term()</span><br>
</div>
      </div>
<div class="REFBODY rb-7">
        <p>To scale well, it is a good idea to ensure that the
          records are evenly distributed over all fragments, including
          the new one.</p>
        <p><span class="code">NewState</span> is stored as <span class="code">hash_state</span> among the
          other <span class="code">frag_properties</span>.</p>
        <p>As a part of the <span class="code">add_frag</span> procedure, Mnesia iterates
          over all fragments corresponding to the <span class="code">IterFrags</span> numbers
          and starts <span class="code">key_to_frag_number(NewState,RecordKey)</span> for
          each record. If the new fragment differs from the old
          fragment, the record is moved to the new fragment.</p>
        <p>As the <span class="code">add_frag</span> procedure is a part of a schema
          transaction, Mnesia acquires write locks on the
          affected tables. That is, both the fragments corresponding
          to <span class="code">IterFrags</span> and those corresponding to
          <span class="code">AdditionalLockFrags</span>.</p>
      </div>
</div></article><article class="func"><div class="bold_code func-head"><h4 id="del_frag-1" class="title-link" onMouseOver="document.getElementById('ghlink-del_frag-1-idm5226').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-del_frag-1-idm5226').style.visibility = 'hidden';">
<div class="title-anchors"><span id="ghlink-del_frag-1-idm5226" class="ghlink-before"><a href="#del_frag-1" title="Link to this place!"><span class="paperclip-before"></span></a><a href="https://github.com/erlang/otp/edit/maint/lib/mnesia/doc/src/mnesia_frag_hash.xml#L102" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil-before"></span></a></span></div>
<div class="title-name">del_frag(State) -&gt;  {NewState, IterFrags, AdditionalLockFrags} | abort(Reason)</div>
</h4></div>
<div class="exports-tube">
<div class="REFBODY rb-5">
<h3 id="types" class="func-types-title">Types</h3>
        <div class="REFTYPES rt-4">
<span class="bold_code fun-param-type">State = term()</span><br>
</div>
        <div class="REFTYPES rt-4">
<span class="bold_code fun-param-type">NewState = term()</span><br>
</div>
        <div class="REFTYPES rt-4">
<span class="bold_code fun-param-type">IterFrags = [integer()]</span><br>
</div>
        <div class="REFTYPES rt-4">
<span class="bold_code fun-param-type">AdditionalLockFrags = [integer()]</span><br>
</div>
        <div class="REFTYPES rt-4">
<span class="bold_code fun-param-type">Reason = term()</span><br>
</div>
      </div>
<div class="REFBODY rb-7">
        <p><span class="code">NewState</span> is stored as <span class="code">hash_state</span> among the
          other <span class="code">frag_properties</span>.</p>
        <p>As a part of the <span class="code">del_frag</span> procedure, Mnesia iterates
          over all fragments corresponding to the <span class="code">IterFrags</span> numbers
          and starts <span class="code">key_to_frag_number(NewState,RecordKey)</span> for
          each record. If the new fragment differs from the old
          fragment, the record is moved to the new fragment.</p>
        <p>Notice that all records in the last fragment must be moved to
          another fragment, as the entire fragment is deleted.</p>
        <p>As the <span class="code">del_frag</span> procedure is a part of a schema
          transaction, Mnesia acquires write locks on the
          affected tables. That is, both the fragments corresponding
          to <span class="code">IterFrags</span> and those corresponding to
          <span class="code">AdditionalLockFrags</span>.</p>
      </div>
</div></article><article class="func"><div class="bold_code func-head"><h4 id="key_to_frag_number-2" class="title-link" onMouseOver="document.getElementById('ghlink-key_to_frag_number-2-idm5249').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-key_to_frag_number-2-idm5249').style.visibility = 'hidden';">
<div class="title-anchors"><span id="ghlink-key_to_frag_number-2-idm5249" class="ghlink-before"><a href="#key_to_frag_number-2" title="Link to this place!"><span class="paperclip-before"></span></a><a href="https://github.com/erlang/otp/edit/maint/lib/mnesia/doc/src/mnesia_frag_hash.xml#L129" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil-before"></span></a></span></div>
<div class="title-name">key_to_frag_number(State, Key) -&gt; FragNum | abort(Reason)</div>
</h4></div>
<div class="exports-tube">
<div class="REFBODY rb-5">
<h3 id="types" class="func-types-title">Types</h3>
        <div class="REFTYPES rt-4">
<span class="bold_code fun-param-type">FragNum = integer()</span><br>
</div>
        <div class="REFTYPES rt-4">
<span class="bold_code fun-param-type">Reason = term()</span><br>
</div>
      </div>
<div class="REFBODY rb-7">
        <p>Starts whenever Mnesia needs to determine
          which fragment a certain record belongs to. It is typically
          started at <span class="code">read</span>, <span class="code">write</span>, and <span class="code">delete</span>.</p>
      </div>
</div></article><article class="func"><div class="bold_code func-head"><h4 id="match_spec_to_frag_numbers-2" class="title-link" onMouseOver="document.getElementById('ghlink-match_spec_to_frag_numbers-2-idm5260').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-match_spec_to_frag_numbers-2-idm5260').style.visibility = 'hidden';">
<div class="title-anchors"><span id="ghlink-match_spec_to_frag_numbers-2-idm5260" class="ghlink-before"><a href="#match_spec_to_frag_numbers-2" title="Link to this place!"><span class="paperclip-before"></span></a><a href="https://github.com/erlang/otp/edit/maint/lib/mnesia/doc/src/mnesia_frag_hash.xml#L142" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil-before"></span></a></span></div>
<div class="title-name">match_spec_to_frag_numbers(State, MatchSpec) -&gt; FragNums | abort(Reason)</div>
</h4></div>
<div class="exports-tube">
<div class="REFBODY rb-5">
<h3 id="types" class="func-types-title">Types</h3>
        <div class="REFTYPES rt-4">
<span class="bold_code fun-param-type">MatcSpec = ets_select_match_spec()</span><br>
</div>
        <div class="REFTYPES rt-4">
<span class="bold_code fun-param-type">FragNums = [FragNum]</span><br>
</div>
        <div class="REFTYPES rt-4">
<span class="bold_code fun-param-type">FragNum = integer()</span><br>
</div>
        <div class="REFTYPES rt-4">
<span class="bold_code fun-param-type">Reason = term()</span><br>
</div>
      </div>
<div class="REFBODY rb-7">
        <p>This function is called whenever Mnesia needs to determine
          which fragments that need to be searched for a <span class="code">MatchSpec</span>.
          It is typically called by <span class="code">select</span> and
          <span class="code">match_object</span>.</p>
      </div>
</div></article>
</div>

  <section class="innertube"><h3 id="see-also" class="title-link" onMouseOver="document.getElementById('ghlink-see-also-idm5273').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-see-also-idm5273').style.visibility = 'hidden';">
<div class="title-name">See Also</div>
<div class="title-anchors"><span id="ghlink-see-also-idm5273" class="ghlink-after"><a href="#see-also" title="Link to this place!"><span class="paperclip-after"></span></a><a href="https://github.com/erlang/otp/edit/maint/lib/mnesia/doc/src/mnesia_frag_hash.xml#L160" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil-after"></span></a></span></div>
</h3>
<div class="REFBODY rb-3">
    
    <p><span class="bold_code bc-18"><a href="mnesia.html">mnesia(3)</a></span></p>
  </div></section>
  
<div class="footer">
<hr>
<p>Copyright Â© 1997-2021 Ericsson AB. All Rights Reserved.</p>
</div>
</div>
</div>
<script type="text/javascript">window.__otpTopDocDir = '../js/';</script><script type="text/javascript" src="../js/highlight.js"></script>
</body>
</html>
