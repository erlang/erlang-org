<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.38.1">
    <meta name="project" content="megaco v4.8.1">


<meta name="major-vsn" content="28">
<meta name="exdoc:full-text-search-url" content="/doc/search.html?v=28&q=">
<link rel="canonical" href="https://www.erlang.org/doc/apps/megaco/megaco_performance.html" />
    <title>Performance comparison — megaco v4.8.1</title>

    <link rel="stylesheet" href="dist/html-erlang-ZK43ZOAC.css" />

    <script defer src="dist/sidebar_items-3F7928BC.js"></script>
    <script defer src="docs_config.js"></script>
    <script defer src="dist/html-DPJLHKSM.js"></script>

  </head>
  <body>
    <script>(()=>{var t="ex_doc:settings",e="dark";var o="dark",s="light";var E="sidebar_state",n="closed";var r="sidebar_width";var a="sidebar-open";var i=new URLSearchParams(window.location.search),S=i.get("theme")||JSON.parse(localStorage.getItem(t)||"{}").theme;(S===o||S!==s&&window.matchMedia("(prefers-color-scheme: dark)").matches)&&document.body.classList.add(e);var d=sessionStorage.getItem(E),A=d!==n&&!window.matchMedia(`screen and (max-width: ${768}px)`).matches;document.body.classList.toggle(a,A);var c=sessionStorage.getItem(r);c&&document.body.style.setProperty("--sidebarWidth",`${c}px`);var p=/(Macintosh|iPhone|iPad|iPod)/.test(window.navigator.userAgent);document.documentElement.classList.toggle("apple-os",p);})();
</script>

<div class="body-wrapper">

<button id="sidebar-menu" class="sidebar-button sidebar-toggle" aria-label="toggle sidebar" aria-controls="sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<nav id="sidebar" class="sidebar">

  <div class="sidebar-header">
    <div class="sidebar-projectInfo">

        <a href="../../index.html" class="sidebar-projectImage">
          <img src="assets/logo.png" alt="megaco" />
        </a>

      <div>
        <a href="../../index.html" class="sidebar-projectName" translate="no">
megaco
        </a>
        <div class="sidebar-projectVersion" translate="no">
          v4.8.1
        </div>
      </div>
    </div>
    <ul id="sidebar-list-nav" class="sidebar-list-nav" role="tablist" data-extras=""></ul>
  </div>
</nav>

<output role="status" id="toast"></output>

<main class="content page-extra" id="main" data-type="extras">
  <div id="content" class="content-inner">
    <div class="top-search">
      <div class="search-settings">
        <form class="search-bar" action="search.html">
          <label class="search-label">
            <span class="sr-only">Search documentation of megaco</span>
            <input name="q" type="text" class="search-input" placeholder="Press / to search" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
          </label>
          <button type="submit" class="search-button" aria-label="Submit Search" tabindex="-1">
            <i class="ri-search-2-line ri-lg" aria-hidden="true"></i>
          </button>
          <button type="button" tabindex="-1" class="search-close-button" aria-hidden="true">
            <i class="ri-close-line ri-lg" title="Cancel search"></i>
          </button>
        </form>
        <div class="autocomplete">
        </div>
        <button class="icon-settings display-settings">
          <i class="ri-settings-3-line"></i>
          <span class="sr-only">Settings</span>
        </button>
      </div>
    </div>

<div id="top-content">
  <div class="heading-with-actions top-heading">
    <h1>Performance comparison</h1>


      <a href="https://github.com/erlang/otp/blob/OTP-28.2/lib/megaco/doc/guides/megaco_performance.md#L1" title="View Source" class="icon-action" rel="help">
        <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        <span class="sr-only">View Source</span>
      </a>

  </div>


<h2 id="comparison-of-encoder-decoders" class="section-heading"><a href="#comparison-of-encoder-decoders" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Comparison of encoder/decoders</span></h2><p>The Megaco/H.248 standard defines both a plain text encoding and a binary
encoding (ASN.1 BER) and we have implemented encoders and decoders for both. We
do supply a bunch of different encoding/decoding modules and the user may in
fact implement their own (like our erl_dist module). Using a non-standard
encoding format has its obvious drawbacks, but may be useful in some
configurations.</p><p>We have made four different measurements of our Erlang/OTP implementation of the
Megaco/H.248 protocol stack, in order to compare our different
encoders/decoders. The result of each one is summarized in the table below.</p><table><thead><tr><th style="text-align: left;">Codec and config</th><th style="text-align: left;">Size</th><th style="text-align: left;">Encode</th><th style="text-align: left;">Decode</th><th style="text-align: left;">Total</th></tr></thead><tbody><tr><td style="text-align: left;">pretty</td><td style="text-align: left;">336</td><td style="text-align: left;">5</td><td style="text-align: left;">12</td><td style="text-align: left;">17</td></tr><tr><td style="text-align: left;">pretty [flex]</td><td style="text-align: left;">336</td><td style="text-align: left;">5</td><td style="text-align: left;">11</td><td style="text-align: left;">16</td></tr><tr><td style="text-align: left;">compact</td><td style="text-align: left;">181</td><td style="text-align: left;">4</td><td style="text-align: left;">10</td><td style="text-align: left;">14</td></tr><tr><td style="text-align: left;">compact [flex]</td><td style="text-align: left;">181</td><td style="text-align: left;">4</td><td style="text-align: left;">9</td><td style="text-align: left;">13</td></tr><tr><td style="text-align: left;">per bin</td><td style="text-align: left;">91</td><td style="text-align: left;">6</td><td style="text-align: left;">6</td><td style="text-align: left;">12</td></tr><tr><td style="text-align: left;">per bin [native]</td><td style="text-align: left;">91</td><td style="text-align: left;">4</td><td style="text-align: left;">3</td><td style="text-align: left;">7</td></tr><tr><td style="text-align: left;">ber bin</td><td style="text-align: left;">165</td><td style="text-align: left;">6</td><td style="text-align: left;">6</td><td style="text-align: left;">12</td></tr><tr><td style="text-align: left;">ber bin [native]</td><td style="text-align: left;">165</td><td style="text-align: left;">4</td><td style="text-align: left;">3</td><td style="text-align: left;">7</td></tr><tr><td style="text-align: left;">erl_dist</td><td style="text-align: left;">875</td><td style="text-align: left;">2</td><td style="text-align: left;">5</td><td style="text-align: left;">7</td></tr><tr><td style="text-align: left;">erl_dist [megaco_compressed]</td><td style="text-align: left;">405</td><td style="text-align: left;">1</td><td style="text-align: left;">2</td><td style="text-align: left;">3</td></tr><tr><td style="text-align: left;">erl_dist [compressed]</td><td style="text-align: left;">345</td><td style="text-align: left;">15</td><td style="text-align: left;">9</td><td style="text-align: left;">24</td></tr><tr><td style="text-align: left;">erl_dist [megaco_compressed,compressed]</td><td style="text-align: left;">200</td><td style="text-align: left;">11</td><td style="text-align: left;">4</td><td style="text-align: left;">15</td></tr></tbody></table><p><em>Table: Codec performance</em></p><h2 id="description-of-encoders-decoders" class="section-heading"><a href="#description-of-encoders-decoders" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Description of encoders/decoders</span></h2><p>In Appendix A of the Megaco/H.248 specification (RFC 3525), there are about 30
messages that shows a representative call flow. We have also added a few extra
version 1, version 2 and version 3 messages. We have used these messages as
basis for our measurements. Our figures have not been weighted in regard to how
frequent the different kinds of messages that are sent between the media gateway
and its controller.</p><p>The test compares the following encoder/decoders:</p><ul><li><em>pretty</em> - pretty printed text. In the text encoding, the protocol stack
implementors have the choice of using a mix of short and long keywords. It is
also possible to add white spaces to improve readability. The pretty text
encoding utilizes long keywords and an indentation style like the text
examples in the Megaco/H.248 specification.</li><li><em>compact</em> - the compact text encoding uses the shortest possible keywords and
no optional white spaces.</li><li><em>ber</em> - ASN.1 BER.</li><li><em>per</em> - ASN.1 PER. Not standardized as a valid Megaco/H.248 encoding, but
included for the matter of completeness as its encoding is extremely compact.</li><li><em>erl_dist</em> - Erlang's native distribution format. Not standardized as a valid
Megaco/H.248 encoding, but included as a reference due to its well known
performance characteristics. Erlang is a dynamically typed language and any
Erlang data structure may be serialized to the erl_dist format by using
built-in functions.</li></ul><p>The actual encoded messages have been collected in one directory per encoding
type, containing one file per encoded message.</p><p>Here follows an example of a text message to give a feeling of the difference
between the pretty and compact versions of text messages. First the pretty
printed, well indented version with long keywords:</p><pre><code class="makeup c" translate="no"><span class="no">MEGACO</span><span class="o">/</span><span class="mi">1</span><span class="w"> </span><span class="p" data-group-id="9606294817-1">[</span><span class="mf">124.124</span><span class="p">.</span><span class="mf">124.222</span><span class="p" data-group-id="9606294817-1">]</span><span class="w">
  </span><span class="no">Transaction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">9998</span><span class="w"> </span><span class="p" data-group-id="9606294817-2">{</span><span class="w">
    </span><span class="no">Context</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p" data-group-id="9606294817-3">{</span><span class="w">
      </span><span class="no">ServiceChange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">ROOT</span><span class="w"> </span><span class="p" data-group-id="9606294817-4">{</span><span class="w">
        </span><span class="no">Services</span><span class="w"> </span><span class="p" data-group-id="9606294817-5">{</span><span class="w">
          </span><span class="no">Method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">Restart</span><span class="p">,</span><span class="w">
          </span><span class="no">ServiceChangeAddress</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">55555</span><span class="p">,</span><span class="w">
          </span><span class="no">Profile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">ResGW</span><span class="o">/</span><span class="mi">1</span><span class="p">,</span><span class="w">
          </span><span class="no">Reason</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;901 MG Cold Boot&quot;</span><span class="w">
        </span><span class="p" data-group-id="9606294817-5">}</span><span class="w">
      </span><span class="p" data-group-id="9606294817-4">}</span><span class="w">
    </span><span class="p" data-group-id="9606294817-3">}</span><span class="w">
  </span><span class="p" data-group-id="9606294817-2">}</span></code></pre><p>Then the compact text version without indentation and with short keywords:</p><pre><code class="text">!/1 [124.124.124.222] T=9998{
  C=-{SC=ROOT{SV{MT=RS,AD=55555,PF=ResGW/1,RE=&quot;901 MG Cold Boot&quot;}}}}</code></pre><h2 id="setup" class="section-heading"><a href="#setup" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Setup</span></h2><p>The measurements has been performed on a Dell Precision 5550 Laptop with a
Intel(R) Core(TM) i7-10875H CPU @ 2.30GHz, with 40 GB memory and running Ubuntu
20.04 x86_64, kernel 5.4.0-91-generic. Software versions was open source OTP
24.2 (megaco-4.2).</p><h2 id="summary" class="section-heading"><a href="#summary" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Summary</span></h2><p>In our measurements we have seen that there are no significant differences in
message sizes between ASN.1 BER and the compact text format. Some care should be
taken when using the pretty text style (which is used in all the examples
included in the protocol specification and preferred during debugging sessions)
since the messages can then be quite large. If the message size really is a
serious issue, our per encoder should be used, as the ASN.1 PER format is much
more compact than all the other alternatives. Its major drawback is that it is
has not been approved as a valid Megaco/H.248 message encoding.</p><p>When it comes to pure encode/decode performance, it turns out that:</p><ul><li>our fastest binary encoder (ber) is about equal to our fastest text encoder
(compact).</li><li>our fastest binary decoder (ber) is about 66% faster than our fastest text
decoder (compact).</li></ul><p>If the pure encode/decode performance really is a serious issue, our erl_dist
encoder could be used, as the encoding/decoding of the erlang distribution
format is much faster than all the other alternatives. Its major drawback is
that it is has not been approved as a valid Megaco/H.248 message encoding.</p><p>There is no performance advantage of building (and using) a non-reentrant flex
scanner over a reentrant flex scanner (if flex supports building such a
scanner).</p><section role="note" class="admonition info"><h4 class="admonition-title info">Note</h4><p>Please, observe that these performance figures are related to our
implementation in Erlang/OTP. Measurements of other implementations using
other tools and techniques may of course result in other figures.</p></section>

</div>

<div class="bottom-actions" id="bottom-actions">
  <div class="bottom-actions-item">

      <a href="megaco_mib.html" class="bottom-actions-button" rel="prev">
        <span class="subheader">
          ← Previous Page
        </span>
        <span class="title">
Megaco mib
        </span>
      </a>

  </div>
  <div class="bottom-actions-item">

      <a href="megaco_debug.html" class="bottom-actions-button" rel="next">
        <span class="subheader">
          Next Page →
        </span>
        <span class="title">
Testing and tools
        </span>
      </a>

  </div>
</div>
    <footer class="footer">
      <p>

        <span class="line">
          <button class="a-main footer-button display-quick-switch" title="Search HexDocs packages">
            Search HexDocs
          </button>

            <a href="megaco.epub" title="ePub version">
              Download ePub version
            </a>

        </span>
      </p>

      <p class="built-using">
        Built using
        <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.38.1) for the

          <a href="https://erlang.org" title="Erlang" target="_blank" translate="no">Erlang programming language</a>

      </p>
<p>Copyright © 1996-2025 <a href="https://www.ericsson.com">Ericsson AB</a></p>
    </footer>
  </div>
</main>
</div>
  <script defer src="https://cdn.jsdelivr.net/npm/mermaid@11.4.1/dist/mermaid.min.js"></script>
  <script>
  let initialized = false;

  window.addEventListener("exdoc:loaded", () => {
      if (!initialized) {
      mermaid.initialize({
          startOnLoad: false,
          theme: document.body.className.includes("dark") ? "dark" : "default"
      });
      initialized = true;
      }

      let id = 0;
      for (const codeEl of document.querySelectorAll("pre code.mermaid")) {
      const preEl = codeEl.parentElement;
      const graphDefinition = codeEl.textContent;
      const graphEl = document.createElement("div");
      const graphId = "mermaid-graph-" + id++;
      mermaid.render(graphId, graphDefinition).then(({svg, bindFunctions}) => {
          graphEl.innerHTML = svg;
          bindFunctions?.(graphEl);
          preEl.insertAdjacentElement("afterend", graphEl);
          preEl.remove();
      });
      }
  });
  </script>

  </body>
</html>
