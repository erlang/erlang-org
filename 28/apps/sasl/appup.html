<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.38.1">
    <meta name="project" content="sasl v4.3">


<meta name="exdoc:full-text-search-url" content="/doc/search.html?v=28&q=">
<meta name="major-vsn" content="28">
<link rel="canonical" href="https://www.erlang.org/doc/apps/sasl/appup.html" />
    <title>appup — sasl v4.3</title>

    <link rel="stylesheet" href="dist/html-erlang-ZK43ZOAC.css" />

    <script defer src="dist/sidebar_items-9352BC19.js"></script>
    <script defer src="docs_config.js"></script>
    <script defer src="dist/html-DPJLHKSM.js"></script>

  </head>
  <body>
    <script>(()=>{var t="ex_doc:settings",e="dark";var o="dark",s="light";var E="sidebar_state",n="closed";var r="sidebar_width";var a="sidebar-open";var i=new URLSearchParams(window.location.search),S=i.get("theme")||JSON.parse(localStorage.getItem(t)||"{}").theme;(S===o||S!==s&&window.matchMedia("(prefers-color-scheme: dark)").matches)&&document.body.classList.add(e);var d=sessionStorage.getItem(E),A=d!==n&&!window.matchMedia(`screen and (max-width: ${768}px)`).matches;document.body.classList.toggle(a,A);var c=sessionStorage.getItem(r);c&&document.body.style.setProperty("--sidebarWidth",`${c}px`);var p=/(Macintosh|iPhone|iPad|iPod)/.test(window.navigator.userAgent);document.documentElement.classList.toggle("apple-os",p);})();
</script>

<div class="body-wrapper">

<button id="sidebar-menu" class="sidebar-button sidebar-toggle" aria-label="toggle sidebar" aria-controls="sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<nav id="sidebar" class="sidebar">

  <div class="sidebar-header">
    <div class="sidebar-projectInfo">

        <a href="../../index.html" class="sidebar-projectImage">
          <img src="assets/logo.png" alt="sasl" />
        </a>

      <div>
        <a href="../../index.html" class="sidebar-projectName" translate="no">
sasl
        </a>
        <div class="sidebar-projectVersion" translate="no">
          v4.3
        </div>
      </div>
    </div>
    <ul id="sidebar-list-nav" class="sidebar-list-nav" role="tablist" data-extras=""></ul>
  </div>
</nav>

<output role="status" id="toast"></output>

<main class="content page-extra" id="main" data-type="extras">
  <div id="content" class="content-inner">
    <div class="top-search">
      <div class="search-settings">
        <form class="search-bar" action="search.html">
          <label class="search-label">
            <span class="sr-only">Search documentation of sasl</span>
            <input name="q" type="text" class="search-input" placeholder="Press / to search" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
          </label>
          <button type="submit" class="search-button" aria-label="Submit Search" tabindex="-1">
            <i class="ri-search-2-line ri-lg" aria-hidden="true"></i>
          </button>
          <button type="button" tabindex="-1" class="search-close-button" aria-hidden="true">
            <i class="ri-close-line ri-lg" title="Cancel search"></i>
          </button>
        </form>
        <div class="autocomplete">
        </div>
        <button class="icon-settings display-settings">
          <i class="ri-settings-3-line"></i>
          <span class="sr-only">Settings</span>
        </button>
      </div>
    </div>

<div id="top-content">
  <div class="heading-with-actions top-heading">
    <h1>appup</h1>


      <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/sasl/doc/references/appup.md#L1" title="View Source" class="icon-action" rel="help">
        <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        <span class="sr-only">View Source</span>
      </a>

  </div>


<p>Application upgrade file</p><h2 id="description" class="section-heading"><a href="#description" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Description</span></h2><p>The <em>application upgrade file</em> defines how an application is upgraded or
downgraded in a running system.</p><p>This file is used by the functions in <a href="systools.html"><code class="inline">systools</code></a> when generating a release
upgrade file <code class="inline">relup</code>.</p><h2 id="file-syntax" class="section-heading"><a href="#file-syntax" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">File Syntax</span></h2><p>The application upgrade file is to be called <code class="inline">Application.appup</code>, where
<code class="inline">Application</code> is the application name. The file is to be located in the <code class="inline">ebin</code>
directory for the application.</p><p>The <code class="inline">.appup</code> file contains one single Erlang term, which defines the
instructions used to upgrade or downgrade the application. The file has the
following syntax:</p><pre><code class="makeup c" translate="no"><span class="p" data-group-id="4045852455-1">{</span><span class="no">Vsn</span><span class="p">,</span><span class="w">
  </span><span class="p" data-group-id="4045852455-2">[</span><span class="p" data-group-id="4045852455-3">{</span><span class="no">UpFromVsn</span><span class="p">,</span><span class="w"> </span><span class="no">Instructions</span><span class="p" data-group-id="4045852455-3">}</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="p">.</span><span class="p">.</span><span class="p" data-group-id="4045852455-2">]</span><span class="p">,</span><span class="w">
  </span><span class="p" data-group-id="4045852455-4">[</span><span class="p" data-group-id="4045852455-5">{</span><span class="no">DownToVsn</span><span class="p">,</span><span class="w"> </span><span class="no">Instructions</span><span class="p" data-group-id="4045852455-5">}</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="p">.</span><span class="p">.</span><span class="p" data-group-id="4045852455-4">]</span><span class="p" data-group-id="4045852455-1">}</span><span class="p">.</span></code></pre><ul><li><p><strong><code class="inline">Vsn = string()</code></strong> - Current application version.</p></li><li><p><strong><code class="inline">UpFromVsn = string() | binary()</code></strong> - An earlier application version to
upgrade from. If it is a string, it is interpreted as a specific version
number. If it is a binary, it is interpreted as a regular expression that can
match multiple version numbers.</p></li><li><p><strong><code class="inline">DownToVsn = string() | binary()</code></strong> - An earlier application version to
downgrade to. If it is a string, it is interpreted as a specific version
number. If it is a binary, it is interpreted as a regular expression that can
match multiple version numbers.</p></li><li><p><strong><code class="inline">Instructions</code></strong> - A list of <em>release upgrade instructions</em>, see
<a href="appup.html#release-upgrade-instructions">Release Upgrade Instructions</a>. It
is recommended to use high-level instructions only. These are automatically
translated to low-level instructions by <code class="inline">systools</code> when creating the <code class="inline">relup</code>
file.</p></li></ul><p>To avoid duplication of upgrade instructions, it is allowed to use regular
expressions to specify <code class="inline">UpFromVsn</code> and <code class="inline">DownToVsn</code>. To be considered a regular
expression, the version identifier must be specified as a binary. For example,
the following match all versions <code class="inline">2.1.x</code>, where <code class="inline">x</code> is any number:</p><pre><code class="text">&lt;&lt;&quot;2\\.1\\.[0-9]+&quot;&gt;&gt;</code></pre><p>Notice that the regular expression must match the complete version string, so
this example works for, for example, <code class="inline">2.1.1</code>, but not for <code class="inline">2.1.1.1</code>.</p><h2 id="release-upgrade-instructions" class="section-heading"><a href="#release-upgrade-instructions" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Release Upgrade Instructions</span></h2><p>Release upgrade instructions are interpreted by the release handler when an
upgrade or downgrade is made. For more information, see
<a href="../../system/release_handling.html"><em>Release Handling</em> in <em>OTP Design Principles</em></a>.</p><p>A process is said to <em>use</em> a module <code class="inline">Mod</code> if <code class="inline">Mod</code> is listed in the <code class="inline">Modules</code>
part of the child specification used to start the process, see <a href="../../apps/stdlib/supervisor.html"><code class="inline">supervisor</code></a>.
In the case of <a href="../../apps/stdlib/gen_event.html"><code class="inline">gen_event</code></a>, an event manager process is said to use <code class="inline">Mod</code> if
<code class="inline">Mod</code> is an installed event handler.</p><h3 id="high-level-instructions" class="section-heading"><a href="#high-level-instructions" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">High-Level Instructions</span></h3><pre><code class="text">{update, Mod}
{update, Mod, supervisor}
{update, Mod, Change}
{update, Mod, DepMods}
{update, Mod, Change, DepMods}
{update, Mod, Change, PrePurge, PostPurge, DepMods}
{update, Mod, Timeout, Change, PrePurge, PostPurge, DepMods}
{update, Mod, ModType, Timeout, Change, PrePurge, PostPurge, DepMods}
  Mod = atom()
  ModType = static | dynamic
  Timeout = int()&gt;0 | default | infinity
  Change = soft | {advanced,Extra}
    Extra = term()
  PrePurge = PostPurge = soft_purge | brutal_purge
  DepMods = [Mod]</code></pre><p>Synchronized code replacement of processes using module <code class="inline">Mod</code>.</p><p>All those processes are suspended using <a href="../../apps/stdlib/sys.html#suspend/1"><code class="inline">sys:suspend</code></a>, the
new module version is loaded, and then the processes are resumed using
<a href="../../apps/stdlib/sys.html#resume/1"><code class="inline">sys:resume</code></a>.</p><ul><li><p><strong><code class="inline">Change</code></strong> - Defaults to <code class="inline">soft</code> and defines the type of code change. If it
is set to <code class="inline">{advanced,Extra}</code>, implemented processes using <a href="../../apps/stdlib/gen_server.html"><code class="inline">gen_server</code></a>,
<a href="../../apps/stdlib/gen_fsm.html"><code class="inline">gen_fsm</code></a>, <a href="../../apps/stdlib/gen_statem.html"><code class="inline">gen_statem</code></a>, or <a href="../../apps/stdlib/gen_event.html"><code class="inline">gen_event</code></a> transform their internal state
by calling the callback function <code class="inline">code_change</code>. Special processes call the
callback function <code class="inline">system_code_change/4</code>. In both cases, the term <code class="inline">Extra</code> is
passed as an argument to the callback function.</p></li><li><p><strong><code class="inline">PrePurge</code></strong> - Defaults to <code class="inline">brutal_purge</code>. It controls what action to take
with processes executing old code before loading the new module version. If
the value is <code class="inline">brutal_purge</code>, the processes are killed. If the value is
<code class="inline">soft_purge</code>, <a href="release_handler.html#install_release/1"><code class="inline">release_handler:install_release/1</code></a> returns
<code class="inline">{error,{old_processes,Mod}}</code>.</p></li><li><p><strong><code class="inline">PostPurge</code></strong> - Defaults to <code class="inline">brutal_purge</code>. It controls what action to take
with processes that are executing old code when the new module version has
been loaded. If the value is <code class="inline">brutal_purge</code>, the code is purged when the
release is made permanent and the processes are killed. If the value is
<code class="inline">soft_purge</code>, the release handler purges the old code when no remaining
processes execute the code.</p></li><li><p><strong><code class="inline">DepMods</code></strong> - Defaults to <code class="inline">[]</code> and defines other modules that <code class="inline">Mod</code> is
dependent on. In the <code class="inline">relup</code> file, instructions for suspending processes using
<code class="inline">Mod</code> come before instructions for suspending processes using modules in
<code class="inline">DepMods</code> when upgrading, and conversely when downgrading. In case of circular
dependencies, the order of the instructions in the <code class="inline">appup</code> file is kept.</p></li><li><p><strong><code class="inline">Timeout</code></strong> - Defines the time-out when suspending processes. If no value or
<code class="inline">default</code> is specified, the default value for <a href="../../apps/stdlib/sys.html#suspend/1"><code class="inline">sys:suspend</code></a>
is used.</p></li><li><p><strong><code class="inline">ModType</code></strong> - Defaults to <code class="inline">dynamic</code>. It specifies if the code is &quot;dynamic&quot;,
that is, if a process using the module spontaneously switches to new code, or
if it is &quot;static&quot;. When doing an advanced update and upgrade, the new version
of a dynamic module is loaded before the process is asked to change code. When
downgrading, the process is asked to change code before loading the new
version. For static modules, the new version is loaded before the process is
asked to change code, both in the case of upgrading and downgrading. Callback
modules are dynamic.</p></li></ul><p><code class="inline">update</code> with argument <code class="inline">supervisor</code> is used when changing the start
specification of a supervisor.</p><pre><code class="makeup erlang" translate="no"><span class="p" data-group-id="8522300396-1">{</span><span class="nb">load_module</span><span class="p">,</span><span class="w"> </span><span class="n">Mod</span><span class="p" data-group-id="8522300396-1">}</span><span class="w">
</span><span class="p" data-group-id="8522300396-2">{</span><span class="nb">load_module</span><span class="p">,</span><span class="w"> </span><span class="n">Mod</span><span class="p">,</span><span class="w"> </span><span class="n">DepMods</span><span class="p" data-group-id="8522300396-2">}</span><span class="w">
</span><span class="p" data-group-id="8522300396-3">{</span><span class="nb">load_module</span><span class="p">,</span><span class="w"> </span><span class="n">Mod</span><span class="p">,</span><span class="w"> </span><span class="n">PrePurge</span><span class="p">,</span><span class="w"> </span><span class="n">PostPurge</span><span class="p">,</span><span class="w"> </span><span class="n">DepMods</span><span class="p" data-group-id="8522300396-3">}</span><span class="w">
  </span><span class="n">Mod</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">atom</span><span class="p" data-group-id="8522300396-4">(</span><span class="p" data-group-id="8522300396-4">)</span><span class="w">
  </span><span class="n">PrePurge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PostPurge</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">soft_purge</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="ss">brutal_purge</span><span class="w">
  </span><span class="n">DepMods</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="8522300396-5">[</span><span class="n">Mod</span><span class="p" data-group-id="8522300396-5">]</span></code></pre><p>Simple code replacement of the module <code class="inline">Mod</code>.</p><p>For a description of <code class="inline">PrePurge</code> and <code class="inline">PostPurge</code>, see <code class="inline">update</code> above.</p><p><code class="inline">DepMods</code> defaults to <code class="inline">[]</code> and defines which other modules <code class="inline">Mod</code> is dependent
on. In the <code class="inline">relup</code> file, instructions for loading these modules come before the
instruction for loading <code class="inline">Mod</code> when upgrading, and conversely when downgrading.</p><pre><code class="makeup erlang" translate="no"><span class="p" data-group-id="7590216228-1">{</span><span class="ss">add_module</span><span class="p">,</span><span class="w"> </span><span class="n">Mod</span><span class="p" data-group-id="7590216228-1">}</span><span class="w">
</span><span class="p" data-group-id="7590216228-2">{</span><span class="ss">add_module</span><span class="p">,</span><span class="w"> </span><span class="n">Mod</span><span class="p">,</span><span class="w"> </span><span class="n">DepMods</span><span class="p" data-group-id="7590216228-2">}</span><span class="w">
  </span><span class="n">Mod</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">atom</span><span class="p" data-group-id="7590216228-3">(</span><span class="p" data-group-id="7590216228-3">)</span><span class="w">
  </span><span class="n">DepMods</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="7590216228-4">[</span><span class="n">Mod</span><span class="p" data-group-id="7590216228-4">]</span></code></pre><p>Loads a new module <code class="inline">Mod</code>.</p><p><code class="inline">DepMods</code> defaults to <code class="inline">[]</code> and defines which other modules <code class="inline">Mod</code> is dependent
on. In the <code class="inline">relup</code> file, instructions related to these modules come before the
instruction for loading <code class="inline">Mod</code> when upgrading, and conversely when downgrading.</p><pre><code class="makeup erlang" translate="no"><span class="p" data-group-id="0081061937-1">{</span><span class="nb">delete_module</span><span class="p">,</span><span class="w"> </span><span class="n">Mod</span><span class="p" data-group-id="0081061937-1">}</span><span class="w">
</span><span class="p" data-group-id="0081061937-2">{</span><span class="nb">delete_module</span><span class="p">,</span><span class="w"> </span><span class="n">Mod</span><span class="p">,</span><span class="w"> </span><span class="n">DepMods</span><span class="p" data-group-id="0081061937-2">}</span><span class="w">
  </span><span class="n">Mod</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">atom</span><span class="p" data-group-id="0081061937-3">(</span><span class="p" data-group-id="0081061937-3">)</span></code></pre><p>Deletes a module <code class="inline">Mod</code> using the low-level instructions <code class="inline">remove</code> and <code class="inline">purge</code>.</p><p><code class="inline">DepMods</code> defaults to <code class="inline">[]</code> and defines which other modules <code class="inline">Mod</code> is dependent
on. In the <code class="inline">relup</code> file, instructions related to these modules come before the
instruction for removing <code class="inline">Mod</code> when upgrading, and conversely when downgrading.</p><pre><code class="text">{add_application, Application}
{add_application, Application, Type}
  Application = atom()
  Type = permanent | transient | temporary | load | none</code></pre><p>Adding an application means that the modules defined by the <code class="inline">modules</code> key in the
<code class="inline">.app</code> file are loaded using <code class="inline">add_module</code>.</p><p><code class="inline">Type</code> defaults to <code class="inline">permanent</code> and specifies the start type of the application.
If <code class="inline">Type = permanent | transient | temporary</code>, the application is loaded and
started in the corresponding way, see <a href="../../apps/kernel/application.html"><code class="inline">application</code></a>. If <code class="inline">Type = load</code>, the
application is only loaded. If <code class="inline">Type = none</code>, the application is not loaded and
not started, although the code for its modules is loaded.</p><pre><code class="text">{remove_application, Application}
  Application = atom()</code></pre><p>Removing an application means that the application is stopped, the modules are
unloaded using <code class="inline">delete_module</code>, and then the application specification is
unloaded from the application controller.</p><pre><code class="text">{restart_application, Application}
  Application = atom()</code></pre><p>Restarting an application means that the application is stopped and then started
again, similar to using the instructions <code class="inline">remove_application</code> and
<code class="inline">add_application</code> in sequence. Note that, even if the application has been
started before the release upgrade is performed, <code class="inline">restart_application</code> may only
<code class="inline">load</code> it rather than <code class="inline">start</code> it, depending on the application's <code class="inline">start type</code>:
If <code class="inline">Type = load</code>, the application is only loaded. If <code class="inline">Type = none</code>, the
application is not loaded and not started, although the code for its modules is
loaded.</p><h3 id="low-level-instructions" class="section-heading"><a href="#low-level-instructions" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Low-Level Instructions</span></h3><pre><code class="makeup erlang" translate="no"><span class="p" data-group-id="9605591856-1">{</span><span class="ss">load_object_code</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9605591856-2">{</span><span class="n">App</span><span class="p">,</span><span class="w"> </span><span class="n">Vsn</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9605591856-3">[</span><span class="n">Mod</span><span class="p" data-group-id="9605591856-3">]</span><span class="p" data-group-id="9605591856-2">}</span><span class="p" data-group-id="9605591856-1">}</span><span class="w">
  </span><span class="n">App</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Mod</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">atom</span><span class="p" data-group-id="9605591856-4">(</span><span class="p" data-group-id="9605591856-4">)</span><span class="w">
  </span><span class="n">Vsn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">string</span><span class="p" data-group-id="9605591856-5">(</span><span class="p" data-group-id="9605591856-5">)</span></code></pre><p>Reads each <code class="inline">Mod</code> from directory <code class="inline">App-Vsn/ebin</code> as a binary. It does not load the
modules. The instruction is to be placed first in the script to read all new
code from the file to make the suspend-load-resume cycle less time-consuming.</p><pre><code class="text">point_of_no_return</code></pre><p>If a crash occurs after this instruction, the system cannot recover and is
restarted from the old release version. The instruction must only occur once in
a script. It is to be placed after all <code class="inline">load_object_code</code> instructions.</p><pre><code class="text">{load, {Mod, PrePurge, PostPurge}}
  Mod = atom()
  PrePurge = PostPurge = soft_purge | brutal_purge</code></pre><p>Before this instruction occurs, <code class="inline">Mod</code> must have been loaded using
<code class="inline">load_object_code</code>. This instruction loads the module. <code class="inline">PrePurge</code> is ignored.
For a description of <code class="inline">PostPurge</code>, see the high-level instruction <code class="inline">update</code>
earlier.</p><pre><code class="text">{remove, {Mod, PrePurge, PostPurge}}
  Mod = atom()
  PrePurge = PostPurge = soft_purge | brutal_purge</code></pre><p>Makes the current version of <code class="inline">Mod</code> old. <code class="inline">PrePurge</code> is ignored. For a description
of <code class="inline">PostPurge</code>, see the high-level instruction <code class="inline">update</code> earlier.</p><pre><code class="text">{purge, [Mod]}
  Mod = atom()</code></pre><p>Purges each module <code class="inline">Mod</code>, that is, removes the old code. Notice that any process
executing purged code is killed.</p><pre><code class="makeup erlang" translate="no"><span class="p" data-group-id="0565215190-1">{</span><span class="ss">suspend</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0565215190-2">[</span><span class="n">Mod</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="p" data-group-id="0565215190-3">{</span><span class="n">Mod</span><span class="p">,</span><span class="w"> </span><span class="n">Timeout</span><span class="p" data-group-id="0565215190-3">}</span><span class="p" data-group-id="0565215190-2">]</span><span class="p" data-group-id="0565215190-1">}</span><span class="w">
  </span><span class="n">Mod</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">atom</span><span class="p" data-group-id="0565215190-4">(</span><span class="p" data-group-id="0565215190-4">)</span><span class="w">
  </span><span class="n">Timeout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">int</span><span class="p" data-group-id="0565215190-5">(</span><span class="p" data-group-id="0565215190-5">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="ss">default</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="ss">infinity</span></code></pre><p>Tries to suspend all processes using a module <code class="inline">Mod</code>. If a process does not
respond, it is ignored. This can cause the process to die, either because it
crashes when it spontaneously switches to new code, or as a result of a purge
operation. If no <code class="inline">Timeout</code> is specified or <code class="inline">default</code> is specified, the default
value for <a href="../../apps/stdlib/sys.html#suspend/1"><code class="inline">sys:suspend</code></a> is used.</p><pre><code class="text">{resume, [Mod]}
  Mod = atom()</code></pre><p>Resumes all suspended processes using a module <code class="inline">Mod</code>.</p><pre><code class="makeup erlang" translate="no"><span class="p" data-group-id="6838525361-1">{</span><span class="ss">code_change</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="6838525361-2">[</span><span class="p" data-group-id="6838525361-3">{</span><span class="n">Mod</span><span class="p">,</span><span class="w"> </span><span class="n">Extra</span><span class="p" data-group-id="6838525361-3">}</span><span class="p" data-group-id="6838525361-2">]</span><span class="p" data-group-id="6838525361-1">}</span><span class="w">
</span><span class="p" data-group-id="6838525361-4">{</span><span class="ss">code_change</span><span class="p">,</span><span class="w"> </span><span class="n">Mode</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="6838525361-5">[</span><span class="p" data-group-id="6838525361-6">{</span><span class="n">Mod</span><span class="p">,</span><span class="w"> </span><span class="n">Extra</span><span class="p" data-group-id="6838525361-6">}</span><span class="p" data-group-id="6838525361-5">]</span><span class="p" data-group-id="6838525361-4">}</span><span class="w">
  </span><span class="n">Mod</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">atom</span><span class="p" data-group-id="6838525361-7">(</span><span class="p" data-group-id="6838525361-7">)</span><span class="w">
  </span><span class="n">Mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">up</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="ss">down</span><span class="w">
  </span><span class="n">Extra</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">term</span><span class="p" data-group-id="6838525361-8">(</span><span class="p" data-group-id="6838525361-8">)</span></code></pre><p><code class="inline">Mode</code> defaults to <code class="inline">up</code> and specifies if it is an upgrade or downgrade. This
instruction sends a <code class="inline">code_change</code> system message to all processes using a module
<code class="inline">Mod</code> by calling function <a href="../../apps/stdlib/sys.html#change_code/4"><code class="inline">sys:change_code</code></a>, passing term
<code class="inline">Extra</code> as argument.</p><pre><code class="text">{stop, [Mod]}
  Mod = atom()</code></pre><p>Stops all processes using a module <code class="inline">Mod</code> by calling
<a href="../../apps/stdlib/supervisor.html#terminate_child/2"><code class="inline">supervisor:terminate_child/2</code></a>. This instruction is useful when the simplest way
to change code is to stop and restart the processes that run the code.</p><pre><code class="makeup erlang" translate="no"><span class="p" data-group-id="2449300516-1">{</span><span class="ss">start</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="2449300516-2">[</span><span class="n">Mod</span><span class="p" data-group-id="2449300516-2">]</span><span class="p" data-group-id="2449300516-1">}</span><span class="w">
  </span><span class="n">Mod</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">atom</span><span class="p" data-group-id="2449300516-3">(</span><span class="p" data-group-id="2449300516-3">)</span></code></pre><p>Starts all stopped processes using a module <code class="inline">Mod</code> by calling
<a href="../../apps/stdlib/supervisor.html#restart_child/2"><code class="inline">supervisor:restart_child/2</code></a>.</p><pre><code class="makeup erlang" translate="no"><span class="p" data-group-id="0351205618-1">{</span><span class="ss">sync_nodes</span><span class="p">,</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0351205618-2">[</span><span class="n">Node</span><span class="p" data-group-id="0351205618-2">]</span><span class="p" data-group-id="0351205618-1">}</span><span class="w">
</span><span class="p" data-group-id="0351205618-3">{</span><span class="ss">sync_nodes</span><span class="p">,</span><span class="w"> </span><span class="n">Id</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0351205618-4">{</span><span class="n">M</span><span class="p">,</span><span class="w"> </span><span class="n">F</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p" data-group-id="0351205618-4">}</span><span class="p" data-group-id="0351205618-3">}</span><span class="w">
  </span><span class="n">Id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">term</span><span class="p" data-group-id="0351205618-5">(</span><span class="p" data-group-id="0351205618-5">)</span><span class="w">
  </span><span class="n">Node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">node</span><span class="p" data-group-id="0351205618-6">(</span><span class="p" data-group-id="0351205618-6">)</span><span class="w">
  </span><span class="n">M</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">F</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">atom</span><span class="p" data-group-id="0351205618-7">(</span><span class="p" data-group-id="0351205618-7">)</span><span class="w">
  </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="0351205618-8">[</span><span class="nf">term</span><span class="p" data-group-id="0351205618-9">(</span><span class="p" data-group-id="0351205618-9">)</span><span class="p" data-group-id="0351205618-8">]</span></code></pre><p><a href="../../apps/erts/erlang.html#apply/3"><code class="inline">apply(M, F, A)</code></a> must return a list of nodes.</p><p>This instruction synchronizes the release installation with other nodes. Each
<code class="inline">Node</code> must evaluate this command with the same <code class="inline">Id</code>. The local node waits for
all other nodes to evaluate the instruction before execution continues. If a
node goes down, it is considered to be an unrecoverable error, and the local
node is restarted from the old release. There is no time-out for this
instruction, which means that it can hang forever.</p><pre><code class="makeup erlang" translate="no"><span class="p" data-group-id="9030380226-1">{</span><span class="nb">apply</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="9030380226-2">{</span><span class="n">M</span><span class="p">,</span><span class="w"> </span><span class="n">F</span><span class="p">,</span><span class="w"> </span><span class="n">A</span><span class="p" data-group-id="9030380226-2">}</span><span class="p" data-group-id="9030380226-1">}</span><span class="w">
  </span><span class="n">M</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">F</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">atom</span><span class="p" data-group-id="9030380226-3">(</span><span class="p" data-group-id="9030380226-3">)</span><span class="w">
  </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="9030380226-4">[</span><span class="nf">term</span><span class="p" data-group-id="9030380226-5">(</span><span class="p" data-group-id="9030380226-5">)</span><span class="p" data-group-id="9030380226-4">]</span></code></pre><p>Evaluates <a href="../../apps/erts/erlang.html#apply/3"><code class="inline">apply(M, F, A)</code></a>.</p><p>If the instruction appears before instruction <code class="inline">point_of_no_return</code>, a failure is
caught. <a href="release_handler.html#install_release/1"><code class="inline">release_handler:install_release/1</code></a> then returns
<code class="inline">{error,{'EXIT',Reason}}</code>, unless <code class="inline">{error,Error}</code> is thrown or returned. Then it
returns <code class="inline">{error,Error}</code>.</p><p>If the instruction appears after instruction <code class="inline">point_of_no_return</code> and the
function call fails, the system is restarted.</p><pre><code class="text">restart_new_emulator</code></pre><p>This instruction is used when the application ERTS, Kernel, STDLIB, or SASL is
upgraded. It shuts down the current emulator and starts a new one. All processes
are terminated gracefully, and the new version of ERTS, Kernel, STDLIB, and SASL
are used when the emulator restarts. Only one <code class="inline">restart_new_emulator</code> instruction
is allowed in the <code class="inline">relup</code> file, and it must be placed first.
<a href="systools.html#make_relup/3"><code class="inline">systools:make_relup/3,4</code></a> ensures this when the
<code class="inline">relup</code> file is generated. The rest of the instructions in the <code class="inline">relup</code> file is
executed after the restart as a part of the boot script.</p><p>An info report is written when the upgrade is completed. To programmatically
determine if the upgrade is complete, call
<a href="release_handler.html#which_releases/0"><code class="inline">release_handler:which_releases/0,1</code></a> and
check if the expected release has status <code class="inline">current</code>.</p><p>The new release must still be made permanent after the upgrade is completed,
otherwise the old emulator is started if there is an emulator restart.</p><section role="note" class="admonition warning"><h4 class="admonition-title warning">Warning</h4><p>As stated earlier, instruction <code class="inline">restart_new_emulator</code> causes the emulator to
be restarted with new versions of ERTS, Kernel, STDLIB, and SASL. However, all
other applications do at startup run their old versions in this new emulator.
This is usually no problem, but every now and then incompatible changes occur
to the core applications, which can cause trouble in this setting. Such
incompatible changes (when functions are removed) are normally preceded by a
deprecation over two major releases. To ensure that your application is not
crashed by an incompatible change, always remove any call to deprecated
functions as soon as possible.</p></section><pre><code class="text">restart_emulator</code></pre><p>This instruction is similar to <code class="inline">restart_new_emulator</code>, except it must be placed
at the end of the <code class="inline">relup</code> file. It is not related to an upgrade of the emulator
or the core applications, but can be used by any application when a complete
reboot of the system is required.</p><p>When generating the <code class="inline">relup</code> file,
<a href="systools.html#make_relup/3"><code class="inline">systools:make_relup/3,4</code></a> ensures that there is only
one <code class="inline">restart_emulator</code> instruction and that it is the last instruction in the
<code class="inline">relup</code> file.</p><h2 id="see-also" class="section-heading"><a href="#see-also" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">See Also</span></h2><p><a href="release_handler.html"><code class="inline">release_handler</code></a>, <a href="relup.html"><code class="inline">relup(4)</code></a>, <a href="../../apps/stdlib/supervisor.html"><code class="inline">supervisor</code></a>, <a href="systools.html"><code class="inline">systools</code></a></p>

</div>

<div class="bottom-actions" id="bottom-actions">
  <div class="bottom-actions-item">

      <a href="error_logging.html" class="bottom-actions-button" rel="prev">
        <span class="subheader">
          ← Previous Page
        </span>
        <span class="title">
SASL Error Logging
        </span>
      </a>

  </div>
  <div class="bottom-actions-item">

      <a href="rel.html" class="bottom-actions-button" rel="next">
        <span class="subheader">
          Next Page →
        </span>
        <span class="title">
rel
        </span>
      </a>

  </div>
</div>
    <footer class="footer">
      <p>

        <span class="line">
          <button class="a-main footer-button display-quick-switch" title="Search HexDocs packages">
            Search HexDocs
          </button>

            <a href="sasl.epub" title="ePub version">
              Download ePub version
            </a>

        </span>
      </p>

      <p class="built-using">
        Built using
        <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.38.1) for the

          <a href="https://erlang.org" title="Erlang" target="_blank" translate="no">Erlang programming language</a>

      </p>
<p>Copyright © 1996-2025 <a href="https://www.ericsson.com">Ericsson AB</a></p>
    </footer>
  </div>
</main>
</div>
  <script defer src="https://cdn.jsdelivr.net/npm/mermaid@11.4.1/dist/mermaid.min.js"></script>
  <script>
  let initialized = false;

  window.addEventListener("exdoc:loaded", () => {
      if (!initialized) {
      mermaid.initialize({
          startOnLoad: false,
          theme: document.body.className.includes("dark") ? "dark" : "default"
      });
      initialized = true;
      }

      let id = 0;
      for (const codeEl of document.querySelectorAll("pre code.mermaid")) {
      const preEl = codeEl.parentElement;
      const graphDefinition = codeEl.textContent;
      const graphEl = document.createElement("div");
      const graphId = "mermaid-graph-" + id++;
      mermaid.render(graphId, graphDefinition).then(({svg, bindFunctions}) => {
          graphEl.innerHTML = svg;
          bindFunctions?.(graphEl);
          preEl.insertAdjacentElement("afterend", graphEl);
          preEl.remove();
      });
      }
  });
  </script>

  </body>
</html>
