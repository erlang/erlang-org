<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.38.1">
    <meta name="project" content="common_test v1.28">


<meta name="exdoc:full-text-search-url" content="/doc/search.html?v=28&q=">
<meta name="major-vsn" content="28">
<link rel="canonical" href="https://www.erlang.org/doc/apps/common_test/write_test_chapter.html" />
    <title>Writing Test Suites — common_test v1.28</title>

    <link rel="stylesheet" href="dist/html-erlang-ZK43ZOAC.css" />

    <script defer src="dist/sidebar_items-39261B45.js"></script>
    <script defer src="docs_config.js"></script>
    <script defer src="dist/html-DPJLHKSM.js"></script>

  </head>
  <body>
    <script>(()=>{var t="ex_doc:settings",e="dark";var o="dark",s="light";var E="sidebar_state",n="closed";var r="sidebar_width";var a="sidebar-open";var i=new URLSearchParams(window.location.search),S=i.get("theme")||JSON.parse(localStorage.getItem(t)||"{}").theme;(S===o||S!==s&&window.matchMedia("(prefers-color-scheme: dark)").matches)&&document.body.classList.add(e);var d=sessionStorage.getItem(E),A=d!==n&&!window.matchMedia(`screen and (max-width: ${768}px)`).matches;document.body.classList.toggle(a,A);var c=sessionStorage.getItem(r);c&&document.body.style.setProperty("--sidebarWidth",`${c}px`);var p=/(Macintosh|iPhone|iPad|iPod)/.test(window.navigator.userAgent);document.documentElement.classList.toggle("apple-os",p);})();
</script>

<div class="body-wrapper">

<button id="sidebar-menu" class="sidebar-button sidebar-toggle" aria-label="toggle sidebar" aria-controls="sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<nav id="sidebar" class="sidebar">

  <div class="sidebar-header">
    <div class="sidebar-projectInfo">

        <a href="../../index.html" class="sidebar-projectImage">
          <img src="assets/logo.png" alt="common_test" />
        </a>

      <div>
        <a href="../../index.html" class="sidebar-projectName" translate="no">
common_test
        </a>
        <div class="sidebar-projectVersion" translate="no">
          v1.28
        </div>
      </div>
    </div>
    <ul id="sidebar-list-nav" class="sidebar-list-nav" role="tablist" data-extras=""></ul>
  </div>
</nav>

<output role="status" id="toast"></output>

<main class="content page-extra" id="main" data-type="extras">
  <div id="content" class="content-inner">
    <div class="top-search">
      <div class="search-settings">
        <form class="search-bar" action="search.html">
          <label class="search-label">
            <span class="sr-only">Search documentation of common_test</span>
            <input name="q" type="text" class="search-input" placeholder="Press / to search" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
          </label>
          <button type="submit" class="search-button" aria-label="Submit Search" tabindex="-1">
            <i class="ri-search-2-line ri-lg" aria-hidden="true"></i>
          </button>
          <button type="button" tabindex="-1" class="search-close-button" aria-hidden="true">
            <i class="ri-close-line ri-lg" title="Cancel search"></i>
          </button>
        </form>
        <div class="autocomplete">
        </div>
        <button class="icon-settings display-settings">
          <i class="ri-settings-3-line"></i>
          <span class="sr-only">Settings</span>
        </button>
      </div>
    </div>

<div id="top-content">
  <div class="heading-with-actions top-heading">
    <h1>Writing Test Suites</h1>


      <a href="https://github.com/erlang/otp/blob/OTP-28.0.1/lib/common_test/doc/guides/write_test_chapter.md#L1" title="View Source" class="icon-action" rel="help">
        <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        <span class="sr-only">View Source</span>
      </a>

  </div>


<p><a href="" id="intro"></a></p><h2 id="support-for-test-suite-authors" class="section-heading"><a href="#support-for-test-suite-authors" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Support for Test Suite Authors</span></h2><p>The <a href="ct.html"><code class="inline">ct</code></a> module provides the main interface for writing test cases. This
includes for example, the following:</p><ul><li>Functions for printing and logging</li><li>Functions for reading configuration data</li><li>Function for terminating a test case with error reason</li><li>Function for adding comments to the HTML overview page</li></ul><p>For details about these functions, see module <a href="ct.html"><code class="inline">ct</code></a>.</p><p>The <code class="inline">Common Test</code> application also includes other modules named
<code class="inline">ct_&lt;component&gt;</code>, which provide various support, mainly simplified use of
communication protocols such as RPC, SNMP, FTP, Telnet, and others.</p><h2 id="test-suites" class="section-heading"><a href="#test-suites" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Test Suites</span></h2><p>A test suite is an ordinary Erlang module that contains test cases. It is
recommended that the module has a name of the form <code class="inline">*_SUITE.erl</code>. Otherwise, the
directory and auto compilation function in <code class="inline">Common Test</code> cannot locate it (at
least not by default).</p><p>It is also recommended that the <code class="inline">ct.hrl</code> header file is included in all test
suite modules.</p><p>Each test suite module must export function <a href="ct_suite.html#c:all/0"><code class="inline">all/0</code></a>, which
returns the list of all test case groups and test cases to be executed in that
module.</p><p>The callback functions to be implemented by the test suite are all listed in
module <a href="ct_suite.html">ct_suite </a>. They are also described in more detail later
in this User's Guide.</p><h2 id="init-and-end-per-suite" class="section-heading"><a href="#init-and-end-per-suite" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Init and End per Suite</span></h2><p>Each test suite module can contain the optional configuration functions
<a href="ct_suite.html#c:init_per_suite/1"><code class="inline">init_per_suite/1</code></a> and
<a href="ct_suite.html#c:end_per_suite/1"><code class="inline">end_per_suite/1</code></a>. If the init function is
defined, so must the end function be.</p><p>If <code class="inline">init_per_suite</code> exists, it is called initially before the test cases are
executed. It typically contains initializations common for all test cases in the
suite, which are only to be performed once. <code class="inline">init_per_suite</code> is recommended for
setting up and verifying state and environment on the System Under Test (SUT) or
the <code class="inline">Common Test</code> host node, or both, so that the test cases in the suite
executes correctly. The following are examples of initial configuration
operations:</p><ul><li>Opening a connection to the SUT</li><li>Initializing a database</li><li>Running an installation script</li></ul><p><code class="inline">end_per_suite</code> is called as the final stage of the test suite execution (after
the last test case has finished). The function is meant to be used for cleaning
up after <code class="inline">init_per_suite</code>.</p><p><code class="inline">init_per_suite</code> and <code class="inline">end_per_suite</code> execute on dedicated Erlang processes, just
like the test cases do. The result of these functions is however not included in
the test run statistics of successful, failed, and skipped cases.</p><p>The argument to <code class="inline">init_per_suite</code> is <code class="inline">Config</code>, that is, the same key-value list
of runtime configuration data that each test case takes as input argument.
<code class="inline">init_per_suite</code> can modify this parameter with information that the test cases
need. The possibly modified <code class="inline">Config</code> list is the return value of the function.</p><p>If <code class="inline">init_per_suite</code> fails, all test cases in the test suite are skipped
automatically (so called <em>auto skipped</em>), including <code class="inline">end_per_suite</code>.</p><p>Notice that if <code class="inline">init_per_suite</code> and <code class="inline">end_per_suite</code> do not exist in the suite,
<code class="inline">Common Test</code> calls dummy functions (with the same names) instead, so that
output generated by hook functions can be saved to the log files for these
dummies. For details, see <a href="ct_hooks_chapter.html#manipulating">Common Test Hooks</a>.</p><p><a href="" id="per_testcase"></a></p><h2 id="init-and-end-per-test-case" class="section-heading"><a href="#init-and-end-per-test-case" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Init and End per Test Case</span></h2><p>Each test suite module can contain the optional configuration functions
<a href="ct_suite.html#c:init_per_testcase/2"><code class="inline">init_per_testcase/2</code></a> and
<a href="ct_suite.html#c:end_per_testcase/2"><code class="inline">end_per_testcase/2</code></a>. If the init function is
defined, so must the end function be.</p><p>If <code class="inline">init_per_testcase</code> exists, it is called before each test case in the suite.
It typically contains initialization that must be done for each test case
(analog to <code class="inline">init_per_suite</code> for the suite).</p><p><code class="inline">end_per_testcase/2</code> is called after each test case has finished, enabling
cleanup after <code class="inline">init_per_testcase</code>.</p><section role="note" class="admonition info"><h4 class="admonition-title info">Note</h4><p>If <code class="inline">end_per_testcase</code> crashes, however, test results are unaffected. At the
same time, this occurrence is reported in the test execution logs.</p></section><p>The first argument to these functions is the name of the test case. This value
can be used with pattern matching in function clauses or conditional expressions
to choose different initialization and cleanup routines for different test
cases, or perform the same routine for many, or all, test cases.</p><p>The second argument is the <code class="inline">Config</code> key-value list of runtime configuration
data, which has the same value as the list returned by <code class="inline">init_per_suite</code>.
<code class="inline">init_per_testcase/2</code> can modify this parameter or return it &quot;as is&quot;. The return
value of <code class="inline">init_per_testcase/2</code> is passed as parameter <code class="inline">Config</code> to the test case
itself.</p><p>The return value of <code class="inline">end_per_testcase/2</code> is ignored by the test server, with
exception of the <a href="dependencies_chapter.html#save_config"><code class="inline">save_config</code></a> and <code class="inline">fail</code>
tuple.</p><p><code class="inline">end_per_testcase</code> can check if the test case was successful. (which in turn can
determine how cleanup is to be performed). This is done by reading the value
tagged with <code class="inline">tc_status</code> from <code class="inline">Config</code>. The value is one of the following:</p><ul><li><p><code class="inline">ok</code></p></li><li><p><code class="inline">{failed,Reason}</code></p><p>where <code class="inline">Reason</code> is <code class="inline">timetrap_timeout</code>, information from <a href="../../apps/erts/erlang.html#exit/1"><code class="inline">exit/1</code></a>,
or details of a runtime error</p></li><li><p><code class="inline">{skipped,Reason}</code></p><p>where <code class="inline">Reason</code> is a user-specific term</p></li></ul><p>Function <code class="inline">end_per_testcase/2</code> is even called if a test case terminates because
of a call to <a href="ct.html#abort_current_testcase/1"><code class="inline">ct:abort_current_testcase/1</code></a>, or after a timetrap time-out.
However, <code class="inline">end_per_testcase</code> then executes on a different process than the test
case function. In this situation, <code class="inline">end_per_testcase</code> cannot change the reason
for test case termination by returning <code class="inline">{fail,Reason}</code> or save data with
<code class="inline">{save_config,Data}</code>.</p><p>The test case is skipped in the following two cases:</p><ul><li>If <code class="inline">init_per_testcase</code> crashes (called <em>auto skipped</em>).</li><li>If <code class="inline">init_per_testcase</code> returns a tuple <code class="inline">{skip,Reason}</code> (called <em>user
skipped</em>).</li></ul><p>The test case can also be marked as failed without executing it by returning a
tuple <code class="inline">{fail,Reason}</code> from <code class="inline">init_per_testcase</code>.</p><section role="note" class="admonition info"><h4 class="admonition-title info">Note</h4><p>If <code class="inline">init_per_testcase</code> crashes, or returns <code class="inline">{skip,Reason}</code> or <code class="inline">{fail,Reason}</code>,
function <code class="inline">end_per_testcase</code> is not called.</p></section><p>If it is determined during execution of <code class="inline">end_per_testcase</code> that the status of a
successful test case is to be changed to failed, <code class="inline">end_per_testcase</code> can return
the tuple <code class="inline">{fail,Reason}</code> (where <code class="inline">Reason</code> describes why the test case fails).</p><p>As <code class="inline">init_per_testcase</code> and <code class="inline">end_per_testcase</code> execute on the same Erlang process
as the test case, printouts from these configuration functions are included in
the test case log file.</p><p><a href="" id="test_cases"></a></p><h2 id="test-cases" class="section-heading"><a href="#test-cases" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Test Cases</span></h2><p>The smallest unit that the test server is concerned with is a test case. Each
test case can test many things, for example, make several calls to the same
interface function with different parameters.</p><p>The author can choose to put many or few tests into each test case. Some things
to keep in mind follows:</p><ul><li>Many small test cases tend to result in extra, and possibly duplicated code,
as well as slow test execution because of large overhead for initializations
and cleanups. Avoid duplicated code, for example, by using common help
functions. Otherwise, the resulting suite becomes difficult to read and
understand, and expensive to maintain.</li><li>Larger test cases make it harder to tell what went wrong if it fails. Also,
large portions of test code risk being skipped when errors occur.</li><li>Readability and maintainability suffer when test cases become too large and
extensive. It is not certain that the resulting log files reflect very well
the number of tests performed.</li></ul><p>The test case function takes one argument, <code class="inline">Config</code>, which contains
configuration information such as <code class="inline">data_dir</code> and <code class="inline">priv_dir</code>. (For details about
these, see section
<a href="write_test_chapter.html#data_priv_dir">Data and Private Directories</a>. The value
of <code class="inline">Config</code> at the time of the call, is the same as the return value from
<code class="inline">init_per_testcase</code>, mentioned earlier.</p><section role="note" class="admonition info"><h4 class="admonition-title info">Note</h4><p>The test case function argument <code class="inline">Config</code> is not to be confused with the
information that can be retrieved from the configuration files (using
<a href="ct.html#get_config/1"><code class="inline">ct:get_config/1/2</code></a>). The test case argument <code class="inline">Config</code> is
to be used for runtime configuration of the test suite and the test cases,
while configuration files are to contain data related to the SUT. These two
types of configuration data are handled differently.</p></section><p>As parameter <code class="inline">Config</code> is a list of key-value tuples, that is, a data type called
a property list, it can be handled by the <a href="../../apps/stdlib/proplists.html"><code class="inline">proplists</code></a> module. A value can, for
example, be searched for and returned with function <a href="../../apps/stdlib/proplists.html#get_value/2"><code class="inline">proplists:get_value/2</code></a>.
Also, or alternatively, the general <a href="../../apps/stdlib/lists.html"><code class="inline">lists</code></a> module contains useful functions.
Normally, the only operations performed on <code class="inline">Config</code> are insertion (adding a
tuple to the head of the list) and lookup. To look up a value in the config,
<code class="inline">proplists:get_value</code> can be used. For example:
<code class="inline">PrivDir = proplists:get_value(priv_dir, Config)</code>.</p><p>The test case result can be customized in several ways. See the manual for
<a href="ct_suite.html#c:Testcase/1"><code class="inline">Module:Testcase/1</code></a> in the <a href="ct_suite.html"><code class="inline">ct_suite</code></a> module for
details.</p><p><a href="" id="info_function"></a></p><h2 id="test-case-information-function" class="section-heading"><a href="#test-case-information-function" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Test Case Information Function</span></h2><p>For each test case function there can be an extra function with the same name
but without arguments. This is the test case information function. It is
expected to return a list of tagged tuples that specifies various properties
regarding the test case.</p><p>The following tags have special meaning:</p><ul><li><p><strong><code class="inline">timetrap</code></strong> - Sets the maximum time the test case is allowed to execute. If
this time is exceeded, the test case fails with reason <code class="inline">timetrap_timeout</code>.
Notice that <code class="inline">init_per_testcase</code> and <code class="inline">end_per_testcase</code> are included in the
timetrap time. For details, see section
<a href="write_test_chapter.html#timetraps">Timetrap Time-Outs</a>.</p></li><li><p><strong><code class="inline">userdata</code></strong> - Specifies any data related to the test case. This data can be
retrieved at any time using the <a href="ct.html#userdata/3"><code class="inline">ct:userdata/3</code></a> utility function.</p></li><li><p><strong><code class="inline">silent_connections</code></strong> - For details, see section
<a href="run_test_chapter.html#silent_connections">Silent Connections</a>.</p></li><li><p><strong><code class="inline">require</code></strong> - Specifies configuration variables required by the test case.
If the required configuration variables are not found in any of the test
system configuration files, the test case is skipped.</p><p>A required variable can also be given a default value to be used if the
variable is not found in any configuration file. To specify a default value,
add a tuple of the form <code class="inline">{default_config,ConfigVariableName,Value}</code> to the
test case information list (the position in the list is irrelevant).</p><p><em>Examples:</em></p><pre><code class="makeup erlang" translate="no"><span class="nf">testcase1</span><span class="p" data-group-id="6103032582-1">(</span><span class="p" data-group-id="6103032582-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="p" data-group-id="6103032582-2">[</span><span class="p" data-group-id="6103032582-3">{</span><span class="ss">require</span><span class="p">,</span><span class="w"> </span><span class="ss">ftp</span><span class="p" data-group-id="6103032582-3">}</span><span class="p">,</span><span class="w">
     </span><span class="p" data-group-id="6103032582-4">{</span><span class="ss">default_config</span><span class="p">,</span><span class="w"> </span><span class="ss">ftp</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="6103032582-5">[</span><span class="p" data-group-id="6103032582-6">{</span><span class="ss">ftp</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;my_ftp_host&quot;</span><span class="p" data-group-id="6103032582-6">}</span><span class="p">,</span><span class="w">
                            </span><span class="p" data-group-id="6103032582-7">{</span><span class="ss">username</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;aladdin&quot;</span><span class="p" data-group-id="6103032582-7">}</span><span class="p">,</span><span class="w">
                            </span><span class="p" data-group-id="6103032582-8">{</span><span class="ss">password</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;sesame&quot;</span><span class="p" data-group-id="6103032582-8">}</span><span class="p" data-group-id="6103032582-5">]</span><span class="p" data-group-id="6103032582-4">}</span><span class="p">}</span><span class="p" data-group-id="6103032582-2">]</span><span class="p">.</span></code></pre><pre><code class="makeup erlang" translate="no"><span class="nf">testcase2</span><span class="p" data-group-id="2143809858-1">(</span><span class="p" data-group-id="2143809858-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="p" data-group-id="2143809858-2">[</span><span class="p" data-group-id="2143809858-3">{</span><span class="ss">require</span><span class="p">,</span><span class="w"> </span><span class="ss">unix_telnet</span><span class="p">,</span><span class="w"> </span><span class="ss">unix</span><span class="p" data-group-id="2143809858-3">}</span><span class="p">,</span><span class="w">
     </span><span class="p" data-group-id="2143809858-4">{</span><span class="ss">require</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="2143809858-5">{</span><span class="ss">unix</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="2143809858-6">[</span><span class="ss">telnet</span><span class="p">,</span><span class="w"> </span><span class="ss">username</span><span class="p">,</span><span class="w"> </span><span class="ss">password</span><span class="p" data-group-id="2143809858-6">]</span><span class="p" data-group-id="2143809858-5">}</span><span class="p" data-group-id="2143809858-4">}</span><span class="p">,</span><span class="w">
     </span><span class="p" data-group-id="2143809858-7">{</span><span class="ss">default_config</span><span class="p">,</span><span class="w"> </span><span class="ss">unix</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="2143809858-8">[</span><span class="p" data-group-id="2143809858-9">{</span><span class="ss">telnet</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;my_telnet_host&quot;</span><span class="p" data-group-id="2143809858-9">}</span><span class="p">,</span><span class="w">
                             </span><span class="p" data-group-id="2143809858-10">{</span><span class="ss">username</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;aladdin&quot;</span><span class="p" data-group-id="2143809858-10">}</span><span class="p">,</span><span class="w">
                             </span><span class="p" data-group-id="2143809858-11">{</span><span class="ss">password</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;sesame&quot;</span><span class="p" data-group-id="2143809858-11">}</span><span class="p" data-group-id="2143809858-8">]</span><span class="p" data-group-id="2143809858-7">}</span><span class="p">}</span><span class="p" data-group-id="2143809858-2">]</span><span class="p">.</span></code></pre></li></ul><p>For more information about <code class="inline">require</code>, see section
<a href="config_file_chapter.html#require_config_data">Requiring and Reading Configuration Data</a>
in section External Configuration Data and function
<a href="ct.html#require/1"><code class="inline">ct:require/1/2</code></a>.</p><section role="note" class="admonition info"><h4 class="admonition-title info">Note</h4><p>Specifying a default value for a required variable can result in a test case
always getting executed. This might not be a desired behavior.</p></section><p>If <code class="inline">timetrap</code> or <code class="inline">require</code>, or both, is not set specifically for a particular
test case, default values specified by function
<a href="ct_suite.html#c:suite/0"><code class="inline">suite/0</code></a> are used.</p><p>Tags other than the earlier mentioned are ignored by the test server.</p><p>An example of a test case information function follows:</p><pre><code class="makeup erlang" translate="no"><span class="nf">reboot_node</span><span class="p" data-group-id="5980700658-1">(</span><span class="p" data-group-id="5980700658-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="p" data-group-id="5980700658-2">[</span><span class="w">
     </span><span class="p" data-group-id="5980700658-3">{</span><span class="ss">timetrap</span><span class="p">,</span><span class="p" data-group-id="5980700658-4">{</span><span class="ss">seconds</span><span class="p">,</span><span class="mi">60</span><span class="p" data-group-id="5980700658-4">}</span><span class="p" data-group-id="5980700658-3">}</span><span class="p">,</span><span class="w">
     </span><span class="p" data-group-id="5980700658-5">{</span><span class="ss">require</span><span class="p">,</span><span class="ss">interfaces</span><span class="p" data-group-id="5980700658-5">}</span><span class="p">,</span><span class="w">
     </span><span class="p" data-group-id="5980700658-6">{</span><span class="ss">userdata</span><span class="p">,</span><span class="w">
         </span><span class="p" data-group-id="5980700658-7">[</span><span class="p" data-group-id="5980700658-8">{</span><span class="ss">description</span><span class="p">,</span><span class="s">&quot;System Upgrade: RpuAddition Normal RebootNode&quot;</span><span class="p" data-group-id="5980700658-8">}</span><span class="p">,</span><span class="w">
          </span><span class="p" data-group-id="5980700658-9">{</span><span class="ss">fts</span><span class="p">,</span><span class="s">&quot;http://someserver.ericsson.se/test_doc4711.pdf&quot;</span><span class="p" data-group-id="5980700658-9">}</span><span class="p" data-group-id="5980700658-7">]</span><span class="p" data-group-id="5980700658-6">}</span><span class="w">
    </span><span class="p" data-group-id="5980700658-2">]</span><span class="p">.</span></code></pre><p><a href="" id="suite"></a></p><h2 id="test-suite-information-function" class="section-heading"><a href="#test-suite-information-function" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Test Suite Information Function</span></h2><p>Function <a href="ct_suite.html#c:suite/0"><code class="inline">suite/0</code></a> can, for example, be used in a test
suite module to set a default <code class="inline">timetrap</code> value and to <code class="inline">require</code> external
configuration data. If a test case, or a group information function also
specifies any of the information tags, it overrides the default values set by
<code class="inline">suite/0</code>. For details, see
<a href="write_test_chapter.html#info_function">Test Case Information Function</a> and
<a href="write_test_chapter.html#test_case_groups">Test Case Groups</a>.</p><p>The following options can also be specified with the suite information list:</p><ul><li><code class="inline">stylesheet</code>, see <a href="run_test_chapter.html#html_stylesheet">HTML Style Sheets</a></li><li><code class="inline">userdata</code>, see
<a href="write_test_chapter.html#info_function">Test Case Information Function</a></li><li><code class="inline">silent_connections</code>, see
<a href="run_test_chapter.html#silent_connections">Silent Connections</a></li></ul><p>An example of the suite information function follows:</p><pre><code class="makeup erlang" translate="no"><span class="nf">suite</span><span class="p" data-group-id="9962947167-1">(</span><span class="p" data-group-id="9962947167-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="p" data-group-id="9962947167-2">[</span><span class="w">
     </span><span class="p" data-group-id="9962947167-3">{</span><span class="ss">timetrap</span><span class="p">,</span><span class="p" data-group-id="9962947167-4">{</span><span class="ss">minutes</span><span class="p">,</span><span class="mi">10</span><span class="p" data-group-id="9962947167-4">}</span><span class="p" data-group-id="9962947167-3">}</span><span class="p">,</span><span class="w">
     </span><span class="p" data-group-id="9962947167-5">{</span><span class="ss">require</span><span class="p">,</span><span class="ss">global_names</span><span class="p" data-group-id="9962947167-5">}</span><span class="p">,</span><span class="w">
     </span><span class="p" data-group-id="9962947167-6">{</span><span class="ss">userdata</span><span class="p">,</span><span class="p" data-group-id="9962947167-7">[</span><span class="p" data-group-id="9962947167-8">{</span><span class="ss">info</span><span class="p">,</span><span class="s">&quot;This suite tests database transactions.&quot;</span><span class="p" data-group-id="9962947167-8">}</span><span class="p" data-group-id="9962947167-7">]</span><span class="p" data-group-id="9962947167-6">}</span><span class="p">,</span><span class="w">
     </span><span class="p" data-group-id="9962947167-9">{</span><span class="ss">silent_connections</span><span class="p">,</span><span class="p" data-group-id="9962947167-10">[</span><span class="ss">telnet</span><span class="p" data-group-id="9962947167-10">]</span><span class="p" data-group-id="9962947167-9">}</span><span class="p">,</span><span class="w">
     </span><span class="p" data-group-id="9962947167-11">{</span><span class="ss">stylesheet</span><span class="p">,</span><span class="s">&quot;db_testing.css&quot;</span><span class="p" data-group-id="9962947167-11">}</span><span class="w">
    </span><span class="p" data-group-id="9962947167-2">]</span><span class="p">.</span></code></pre><p><a href="" id="test_case_groups"></a></p><h2 id="test-case-groups" class="section-heading"><a href="#test-case-groups" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Test Case Groups</span></h2><p>A test case group is a set of test cases sharing configuration functions and
execution properties. Test case groups are defined by function
<a href="ct_suite.html#c:groups/0"><code class="inline">groups/0</code></a> that should return a term having the
following syntax:</p><pre><code class="text">groups() -&gt; GroupDefs

Types:

GroupDefs = [GroupDef]
GroupDef = {GroupName,Properties,GroupsAndTestCases}
GroupName = atom()
GroupsAndTestCases = [GroupDef | {group,GroupName} | TestCase |
                     {testcase,TestCase,TCRepeatProps}]
TestCase = atom()
TCRepeatProps = [{repeat,N} | {repeat_until_ok,N} | {repeat_until_fail,N}]</code></pre><p><code class="inline">GroupName</code> is the name of the group and must be unique within the test suite
module. Groups can be nested, by including a group definition within the
<code class="inline">GroupsAndTestCases</code> list of another group. <code class="inline">Properties</code> is the list of
execution properties for the group. The possible values are as follows:</p><pre><code class="makeup erlang" translate="no"><span class="n">Properties</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5579936138-1">[</span><span class="ss">parallel</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="ss">sequence</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="n">Shuffle</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="p" data-group-id="5579936138-2">{</span><span class="n">GroupRepeatType</span><span class="p">,</span><span class="n">N</span><span class="p" data-group-id="5579936138-2">}</span><span class="p" data-group-id="5579936138-1">]</span><span class="w">
</span><span class="n">Shuffle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">shuffle</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="p" data-group-id="5579936138-3">{</span><span class="ss">shuffle</span><span class="p">,</span><span class="n">Seed</span><span class="p" data-group-id="5579936138-3">}</span><span class="w">
</span><span class="n">Seed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5579936138-4">{</span><span class="nf">integer</span><span class="p" data-group-id="5579936138-5">(</span><span class="p" data-group-id="5579936138-5">)</span><span class="p">,</span><span class="nf">integer</span><span class="p" data-group-id="5579936138-6">(</span><span class="p" data-group-id="5579936138-6">)</span><span class="p">,</span><span class="nf">integer</span><span class="p" data-group-id="5579936138-7">(</span><span class="p" data-group-id="5579936138-7">)</span><span class="p" data-group-id="5579936138-4">}</span><span class="w">
</span><span class="n">GroupRepeatType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">repeat</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="ss">repeat_until_all_ok</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="ss">repeat_until_all_fail</span><span class="w"> </span><span class="p">|</span><span class="w">
                  </span><span class="ss">repeat_until_any_ok</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="ss">repeat_until_any_fail</span><span class="w">
</span><span class="n">N</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">integer</span><span class="p" data-group-id="5579936138-8">(</span><span class="p" data-group-id="5579936138-8">)</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="ss">forever</span></code></pre><p><em>Explanations:</em></p><ul><li><p><strong><code class="inline">parallel</code></strong> - <code class="inline">Common Test</code> executes all test cases in the group in
parallel.</p></li><li><p><strong><code class="inline">sequence</code></strong> - The cases are executed in a sequence as described in section
<a href="dependencies_chapter.html#sequences">Sequences</a> in section Dependencies Between
Test Cases and Suites.</p></li><li><p><strong><code class="inline">shuffle</code></strong> - The cases in the group are executed in random order.</p></li><li><p><strong><code class="inline">repeat, repeat_until_*</code></strong> - Orders <code class="inline">Common Test</code> to repeat execution of all
the cases in the group a given number of times, or until any, or all, cases
fail or succeed.</p></li></ul><p><em>Example:</em></p><pre><code class="makeup erlang" translate="no"><span class="nf">groups</span><span class="p" data-group-id="5538381722-1">(</span><span class="p" data-group-id="5538381722-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="p" data-group-id="5538381722-2">[</span><span class="p" data-group-id="5538381722-3">{</span><span class="ss">group1</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5538381722-4">[</span><span class="ss">parallel</span><span class="p" data-group-id="5538381722-4">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5538381722-5">[</span><span class="ss">test1a</span><span class="p">,</span><span class="ss">test1b</span><span class="p" data-group-id="5538381722-5">]</span><span class="p" data-group-id="5538381722-3">}</span><span class="p">,</span><span class="w">
             </span><span class="p" data-group-id="5538381722-6">{</span><span class="ss">group2</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5538381722-7">[</span><span class="ss">shuffle</span><span class="p">,</span><span class="ss">sequence</span><span class="p" data-group-id="5538381722-7">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5538381722-8">[</span><span class="ss">test2a</span><span class="p">,</span><span class="ss">test2b</span><span class="p">,</span><span class="ss">test2c</span><span class="p" data-group-id="5538381722-8">]</span><span class="p" data-group-id="5538381722-6">}</span><span class="p" data-group-id="5538381722-2">]</span><span class="p">.</span></code></pre><p>To specify in which order groups are to be executed (also with respect to test
cases that are not part of any group), add tuples on the form
<code class="inline">{group,GroupName}</code> to the <code class="inline">all/0</code> list.</p><p><em>Example:</em></p><pre><code class="makeup erlang" translate="no"><span class="nf">all</span><span class="p" data-group-id="5268977106-1">(</span><span class="p" data-group-id="5268977106-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="p" data-group-id="5268977106-2">[</span><span class="ss">testcase1</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5268977106-3">{</span><span class="ss">group</span><span class="p">,</span><span class="ss">group1</span><span class="p" data-group-id="5268977106-3">}</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5268977106-4">{</span><span class="ss">testcase</span><span class="p">,</span><span class="ss">testcase2</span><span class="p">,</span><span class="p" data-group-id="5268977106-5">[</span><span class="p" data-group-id="5268977106-6">{</span><span class="ss">repeat</span><span class="p">,</span><span class="mi">10</span><span class="p" data-group-id="5268977106-6">}</span><span class="p" data-group-id="5268977106-5">]</span><span class="p" data-group-id="5268977106-4">}</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5268977106-7">{</span><span class="ss">group</span><span class="p">,</span><span class="ss">group2</span><span class="p" data-group-id="5268977106-7">}</span><span class="p" data-group-id="5268977106-2">]</span><span class="p">.</span></code></pre><p>Execution properties with a group tuple in <code class="inline">all/0</code>:
<code class="inline">{group,GroupName,Properties}</code> can also be specified. These properties override
those specified in the group definition (see <code class="inline">groups/0</code> earlier). This way, the
same set of tests can be run, but with different properties, without having to
make copies of the group definition in question.</p><p>If a group contains subgroups, the execution properties for these can also be
specified in the group tuple: <code class="inline">{group,GroupName,Properties,SubGroups}</code> Where,
<code class="inline">SubGroups</code> is a list of tuples, <code class="inline">{GroupName,Properties}</code> or
<code class="inline">{GroupName,Properties,SubGroups}</code> representing the subgroups. Any subgroups
defined in <code class="inline">groups/0</code> for a group, that are not specified in the <code class="inline">SubGroups</code>
list, executes with their predefined properties.</p><p><em>Example:</em></p><pre><code class="makeup erlang" translate="no"><span class="nf">groups</span><span class="p" data-group-id="5990437318-1">(</span><span class="p" data-group-id="5990437318-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="p" data-group-id="5990437318-2">[</span><span class="p" data-group-id="5990437318-3">{</span><span class="ss">tests1</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5990437318-4">[</span><span class="p" data-group-id="5990437318-4">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5990437318-5">[</span><span class="p" data-group-id="5990437318-6">{</span><span class="ss">tests2</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5990437318-7">[</span><span class="p" data-group-id="5990437318-7">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5990437318-8">[</span><span class="ss">t2a</span><span class="p">,</span><span class="ss">t2b</span><span class="p" data-group-id="5990437318-8">]</span><span class="p" data-group-id="5990437318-6">}</span><span class="p">,</span><span class="w">
                          </span><span class="p" data-group-id="5990437318-9">{</span><span class="ss">tests3</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5990437318-10">[</span><span class="p" data-group-id="5990437318-10">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5990437318-11">[</span><span class="ss">t31</span><span class="p">,</span><span class="ss">t3b</span><span class="p" data-group-id="5990437318-11">]</span><span class="p" data-group-id="5990437318-9">}</span><span class="p" data-group-id="5990437318-5">]</span><span class="p" data-group-id="5990437318-3">}</span><span class="p" data-group-id="5990437318-2">]</span><span class="p">.</span></code></pre><p>To execute group <code class="inline">tests1</code> twice with different properties for <code class="inline">tests2</code> each
time:</p><pre><code class="makeup erlang" translate="no"><span class="nf">all</span><span class="p" data-group-id="1482441898-1">(</span><span class="p" data-group-id="1482441898-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
   </span><span class="p" data-group-id="1482441898-2">[</span><span class="p" data-group-id="1482441898-3">{</span><span class="ss">group</span><span class="p">,</span><span class="w"> </span><span class="ss">tests1</span><span class="p">,</span><span class="w"> </span><span class="ss">default</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1482441898-4">[</span><span class="p" data-group-id="1482441898-5">{</span><span class="ss">tests2</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1482441898-6">[</span><span class="ss">parallel</span><span class="p" data-group-id="1482441898-6">]</span><span class="p" data-group-id="1482441898-5">}</span><span class="p" data-group-id="1482441898-4">]</span><span class="p" data-group-id="1482441898-3">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="1482441898-7">{</span><span class="ss">group</span><span class="p">,</span><span class="w"> </span><span class="ss">tests1</span><span class="p">,</span><span class="w"> </span><span class="ss">default</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1482441898-8">[</span><span class="p" data-group-id="1482441898-9">{</span><span class="ss">tests2</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1482441898-10">[</span><span class="ss">shuffle</span><span class="p">,</span><span class="p" data-group-id="1482441898-11">{</span><span class="ss">repeat</span><span class="p">,</span><span class="mi">10</span><span class="p" data-group-id="1482441898-11">}</span><span class="p" data-group-id="1482441898-10">]</span><span class="p" data-group-id="1482441898-9">}</span><span class="p" data-group-id="1482441898-8">]</span><span class="p" data-group-id="1482441898-7">}</span><span class="p" data-group-id="1482441898-2">]</span><span class="p">.</span></code></pre><p>This is equivalent to the following specification:</p><pre><code class="makeup erlang" translate="no"><span class="nf">all</span><span class="p" data-group-id="1039316575-1">(</span><span class="p" data-group-id="1039316575-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
   </span><span class="p" data-group-id="1039316575-2">[</span><span class="p" data-group-id="1039316575-3">{</span><span class="ss">group</span><span class="p">,</span><span class="w"> </span><span class="ss">tests1</span><span class="p">,</span><span class="w"> </span><span class="ss">default</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1039316575-4">[</span><span class="p" data-group-id="1039316575-5">{</span><span class="ss">tests2</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1039316575-6">[</span><span class="ss">parallel</span><span class="p" data-group-id="1039316575-6">]</span><span class="p" data-group-id="1039316575-5">}</span><span class="p">,</span><span class="w">
                              </span><span class="p" data-group-id="1039316575-7">{</span><span class="ss">tests3</span><span class="p">,</span><span class="w"> </span><span class="ss">default</span><span class="p" data-group-id="1039316575-7">}</span><span class="p" data-group-id="1039316575-4">]</span><span class="p" data-group-id="1039316575-3">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="1039316575-8">{</span><span class="ss">group</span><span class="p">,</span><span class="w"> </span><span class="ss">tests1</span><span class="p">,</span><span class="w"> </span><span class="ss">default</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1039316575-9">[</span><span class="p" data-group-id="1039316575-10">{</span><span class="ss">tests2</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1039316575-11">[</span><span class="ss">shuffle</span><span class="p">,</span><span class="p" data-group-id="1039316575-12">{</span><span class="ss">repeat</span><span class="p">,</span><span class="mi">10</span><span class="p" data-group-id="1039316575-12">}</span><span class="p" data-group-id="1039316575-11">]</span><span class="p" data-group-id="1039316575-10">}</span><span class="p">,</span><span class="w">
                              </span><span class="p" data-group-id="1039316575-13">{</span><span class="ss">tests3</span><span class="p">,</span><span class="w"> </span><span class="ss">default</span><span class="p" data-group-id="1039316575-13">}</span><span class="p" data-group-id="1039316575-9">]</span><span class="p" data-group-id="1039316575-8">}</span><span class="p" data-group-id="1039316575-2">]</span><span class="p">.</span></code></pre><p>Value <code class="inline">default</code> states that the predefined properties are to be used.</p><p>The following example shows how to override properties in a scenario with deeply
nested groups:</p><pre><code class="makeup erlang" translate="no"><span class="nf">groups</span><span class="p" data-group-id="5984202267-1">(</span><span class="p" data-group-id="5984202267-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
   </span><span class="p" data-group-id="5984202267-2">[</span><span class="p" data-group-id="5984202267-3">{</span><span class="ss">tests1</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5984202267-4">[</span><span class="p" data-group-id="5984202267-4">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5984202267-5">[</span><span class="p" data-group-id="5984202267-6">{</span><span class="ss">group</span><span class="p">,</span><span class="w"> </span><span class="ss">tests2</span><span class="p" data-group-id="5984202267-6">}</span><span class="p" data-group-id="5984202267-5">]</span><span class="p" data-group-id="5984202267-3">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="5984202267-7">{</span><span class="ss">tests2</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5984202267-8">[</span><span class="p" data-group-id="5984202267-8">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5984202267-9">[</span><span class="p" data-group-id="5984202267-10">{</span><span class="ss">group</span><span class="p">,</span><span class="w"> </span><span class="ss">tests3</span><span class="p" data-group-id="5984202267-10">}</span><span class="p" data-group-id="5984202267-9">]</span><span class="p" data-group-id="5984202267-7">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="5984202267-11">{</span><span class="ss">tests3</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5984202267-12">[</span><span class="p" data-group-id="5984202267-13">{</span><span class="ss">repeat</span><span class="p">,</span><span class="mi">2</span><span class="p" data-group-id="5984202267-13">}</span><span class="p" data-group-id="5984202267-12">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5984202267-14">[</span><span class="ss">t3a</span><span class="p">,</span><span class="ss">t3b</span><span class="p">,</span><span class="ss">t3c</span><span class="p" data-group-id="5984202267-14">]</span><span class="p" data-group-id="5984202267-11">}</span><span class="p" data-group-id="5984202267-2">]</span><span class="p">.</span><span class="w">

</span><span class="nf">all</span><span class="p" data-group-id="5984202267-15">(</span><span class="p" data-group-id="5984202267-15">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
   </span><span class="p" data-group-id="5984202267-16">[</span><span class="p" data-group-id="5984202267-17">{</span><span class="ss">group</span><span class="p">,</span><span class="w"> </span><span class="ss">tests1</span><span class="p">,</span><span class="w"> </span><span class="ss">default</span><span class="p">,</span><span class="w">
     </span><span class="p" data-group-id="5984202267-18">[</span><span class="p" data-group-id="5984202267-19">{</span><span class="ss">tests2</span><span class="p">,</span><span class="w"> </span><span class="ss">default</span><span class="p">,</span><span class="w">
       </span><span class="p" data-group-id="5984202267-20">[</span><span class="p" data-group-id="5984202267-21">{</span><span class="ss">tests3</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5984202267-22">[</span><span class="ss">parallel</span><span class="p">,</span><span class="p" data-group-id="5984202267-23">{</span><span class="ss">repeat</span><span class="p">,</span><span class="mi">100</span><span class="p" data-group-id="5984202267-23">}</span><span class="p" data-group-id="5984202267-22">]</span><span class="p" data-group-id="5984202267-21">}</span><span class="p" data-group-id="5984202267-20">]</span><span class="p" data-group-id="5984202267-19">}</span><span class="p" data-group-id="5984202267-18">]</span><span class="p" data-group-id="5984202267-17">}</span><span class="p" data-group-id="5984202267-16">]</span><span class="p">.</span></code></pre><p>For ease of readability, all syntax definitions can be replaced by a function
call whose return value should match the expected syntax case.</p><p><em>Example:</em></p><pre><code class="makeup erlang" translate="no"><span class="nf">all</span><span class="p" data-group-id="7639945474-1">(</span><span class="p" data-group-id="7639945474-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
   </span><span class="p" data-group-id="7639945474-2">[</span><span class="p" data-group-id="7639945474-3">{</span><span class="ss">group</span><span class="p">,</span><span class="w"> </span><span class="ss">tests1</span><span class="p">,</span><span class="w"> </span><span class="ss">default</span><span class="p">,</span><span class="w"> </span><span class="nf">test_cases</span><span class="p" data-group-id="7639945474-4">(</span><span class="p" data-group-id="7639945474-4">)</span><span class="p" data-group-id="7639945474-3">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="7639945474-5">{</span><span class="ss">group</span><span class="p">,</span><span class="w"> </span><span class="ss">tests1</span><span class="p">,</span><span class="w"> </span><span class="ss">default</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="7639945474-6">[</span><span class="nf">shuffle_test</span><span class="p" data-group-id="7639945474-7">(</span><span class="p" data-group-id="7639945474-7">)</span><span class="p">,</span><span class="w">
                              </span><span class="p" data-group-id="7639945474-8">{</span><span class="ss">tests3</span><span class="p">,</span><span class="w"> </span><span class="ss">default</span><span class="p" data-group-id="7639945474-8">}</span><span class="p" data-group-id="7639945474-6">]</span><span class="p" data-group-id="7639945474-5">}</span><span class="p" data-group-id="7639945474-2">]</span><span class="p">.</span><span class="w">
</span><span class="nf">test_cases</span><span class="p" data-group-id="7639945474-9">(</span><span class="p" data-group-id="7639945474-9">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
   </span><span class="p" data-group-id="7639945474-10">[</span><span class="p" data-group-id="7639945474-11">{</span><span class="ss">tests2</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="7639945474-12">[</span><span class="ss">parallel</span><span class="p" data-group-id="7639945474-12">]</span><span class="p" data-group-id="7639945474-11">}</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="7639945474-13">{</span><span class="ss">tests3</span><span class="p">,</span><span class="w"> </span><span class="ss">default</span><span class="p" data-group-id="7639945474-13">}</span><span class="p" data-group-id="7639945474-10">]</span><span class="p">.</span><span class="w">

</span><span class="nf">shuffle_test</span><span class="p" data-group-id="7639945474-14">(</span><span class="p" data-group-id="7639945474-14">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
   </span><span class="p" data-group-id="7639945474-15">{</span><span class="ss">tests2</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="7639945474-16">[</span><span class="ss">shuffle</span><span class="p">,</span><span class="p" data-group-id="7639945474-17">{</span><span class="ss">repeat</span><span class="p">,</span><span class="mi">10</span><span class="p" data-group-id="7639945474-17">}</span><span class="p" data-group-id="7639945474-16">]</span><span class="p" data-group-id="7639945474-15">}</span><span class="p">.</span></code></pre><p>The described syntax can also be used in test specifications to change group
properties at the time of execution, without having to edit the test suite. For
more information, see section
<a href="run_test_chapter.html#test_specifications">Test Specifications</a> in section
Running Tests and Analyzing Results.</p><p>As illustrated, properties can be combined. If, for example, <code class="inline">shuffle</code>,
<code class="inline">repeat_until_any_fail</code>, and <code class="inline">sequence</code> are all specified, the test cases in the
group are executed repeatedly, and in random order, until a test case fails.
Then execution is immediately stopped and the remaining cases are skipped.</p><p>Before execution of a group begins, the configuration function
<a href="ct_suite.html#c:init_per_group/2"><code class="inline">init_per_group(GroupName, Config)</code></a> is called.
The list of tuples returned from this function is passed to the test cases in
the usual manner by argument <code class="inline">Config</code>. <code class="inline">init_per_group/2</code> is meant to be used
for initializations common for the test cases in the group. After execution of
the group is finished, function
<a href="ct_suite.html#c:end_per_group/2"><code class="inline">end_per_group(GroupName, Config)</code></a> is called.
This function is meant to be used for cleaning up after <code class="inline">init_per_group/2</code>. If
the init function is defined, so must the end function be.</p><p>Whenever a group is executed, if <code class="inline">init_per_group</code> and <code class="inline">end_per_group</code> do not
exist in the suite, <code class="inline">Common Test</code> calls dummy functions (with the same names)
instead. Output generated by hook functions are saved to the log files for these
dummies. For more information, see section
<a href="ct_hooks_chapter.html#manipulating">Manipulating Tests</a> in section Common Test
Hooks.</p><section role="note" class="admonition info"><h4 class="admonition-title info">Note</h4><p><code class="inline">init_per_testcase/2</code> and <code class="inline">end_per_testcase/2</code> are always called for each
individual test case, no matter if the case belongs to a group or not.</p></section><p>The properties for a group are always printed in the top of the HTML log for
<code class="inline">init_per_group/2</code>. The total execution time for a group is included at the
bottom of the log for <code class="inline">end_per_group/2</code>.</p><p>Test case groups can be nested so sets of groups can be configured with the same
<code class="inline">init_per_group/2</code> and <code class="inline">end_per_group/2</code> functions. Nested groups can be defined
by including a group definition, or a group name reference, in the test case
list of another group.</p><p><em>Example:</em></p><pre><code class="makeup erlang" translate="no"><span class="nf">groups</span><span class="p" data-group-id="3021065305-1">(</span><span class="p" data-group-id="3021065305-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="p" data-group-id="3021065305-2">[</span><span class="p" data-group-id="3021065305-3">{</span><span class="ss">group1</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3021065305-4">[</span><span class="ss">shuffle</span><span class="p" data-group-id="3021065305-4">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3021065305-5">[</span><span class="ss">test1a</span><span class="p">,</span><span class="w">
                                  </span><span class="p" data-group-id="3021065305-6">{</span><span class="ss">group2</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3021065305-7">[</span><span class="p" data-group-id="3021065305-7">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3021065305-8">[</span><span class="ss">test2a</span><span class="p">,</span><span class="ss">test2b</span><span class="p" data-group-id="3021065305-8">]</span><span class="p" data-group-id="3021065305-6">}</span><span class="p">,</span><span class="w">
                                  </span><span class="ss">test1b</span><span class="p" data-group-id="3021065305-5">]</span><span class="p" data-group-id="3021065305-3">}</span><span class="p">,</span><span class="w">
             </span><span class="p" data-group-id="3021065305-9">{</span><span class="ss">group3</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3021065305-10">[</span><span class="p" data-group-id="3021065305-10">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3021065305-11">[</span><span class="p" data-group-id="3021065305-12">{</span><span class="ss">group</span><span class="p">,</span><span class="ss">group4</span><span class="p" data-group-id="3021065305-12">}</span><span class="p">,</span><span class="w">
                           </span><span class="p" data-group-id="3021065305-13">{</span><span class="ss">group</span><span class="p">,</span><span class="ss">group5</span><span class="p" data-group-id="3021065305-13">}</span><span class="p" data-group-id="3021065305-11">]</span><span class="p" data-group-id="3021065305-9">}</span><span class="p">,</span><span class="w">
             </span><span class="p" data-group-id="3021065305-14">{</span><span class="ss">group4</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3021065305-15">[</span><span class="ss">parallel</span><span class="p" data-group-id="3021065305-15">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3021065305-16">[</span><span class="ss">test4a</span><span class="p">,</span><span class="ss">test4b</span><span class="p" data-group-id="3021065305-16">]</span><span class="p" data-group-id="3021065305-14">}</span><span class="p">,</span><span class="w">
             </span><span class="p" data-group-id="3021065305-17">{</span><span class="ss">group5</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3021065305-18">[</span><span class="ss">sequence</span><span class="p" data-group-id="3021065305-18">]</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3021065305-19">[</span><span class="ss">test5a</span><span class="p">,</span><span class="ss">test5b</span><span class="p">,</span><span class="ss">test5c</span><span class="p" data-group-id="3021065305-19">]</span><span class="p" data-group-id="3021065305-17">}</span><span class="p" data-group-id="3021065305-2">]</span><span class="p">.</span></code></pre><p>In the previous example, if <code class="inline">all/0</code> returns group name references in the order
<code class="inline">[{group,group1},{group,group3}]</code>, the order of the configuration functions and
test cases becomes the following (notice that <code class="inline">init_per_testcase/2</code> and
<code class="inline">end_per_testcase/2:</code> are also always called, but not included in this example
for simplification):</p><pre><code class="text">init_per_group(group1, Config) -&gt; Config1  (*)
     test1a(Config1)
     init_per_group(group2, Config1) -&gt; Config2
          test2a(Config2), test2b(Config2)
     end_per_group(group2, Config2)
     test1b(Config1)
end_per_group(group1, Config1)
init_per_group(group3, Config) -&gt; Config3
     init_per_group(group4, Config3) -&gt; Config4
          test4a(Config4), test4b(Config4)  (**)
     end_per_group(group4, Config4)
     init_per_group(group5, Config3) -&gt; Config5
          test5a(Config5), test5b(Config5), test5c(Config5)
     end_per_group(group5, Config5)
end_per_group(group3, Config3)</code></pre><p>(*) The order of test case <code class="inline">test1a</code>, <code class="inline">test1b</code>, and <code class="inline">group2</code> is undefined, as
<code class="inline">group1</code> has a shuffle property.</p><p>(**) These cases are not executed in order, but in parallel.</p><p>Properties are not inherited from top-level groups to nested subgroups. For
instance, in the previous example, the test cases in <code class="inline">group2</code> are not executed
in random order (which is the property of <code class="inline">group1</code>).</p><h2 id="parallel-property-and-nested-groups" class="section-heading"><a href="#parallel-property-and-nested-groups" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Parallel Property and Nested Groups</span></h2><p>If a group has a parallel property, its test cases are spawned simultaneously
and get executed in parallel. However, a test case is not allowed to execute in
parallel with <code class="inline">end_per_group/2</code>, which means that the time to execute a parallel
group is equal to the execution time of the slowest test case in the group. A
negative side effect of running test cases in parallel is that the HTML summary
pages are not updated with links to the individual test case logs until function
<code class="inline">end_per_group/2</code> for the group has finished.</p><p>A group nested under a parallel group starts executing in parallel with previous
(parallel) test cases (no matter what properties the nested group has). However,
as test cases are never executed in parallel with <code class="inline">init_per_group/2</code> or
<code class="inline">end_per_group/2</code> of the same group, it is only after a nested group has
finished that remaining parallel cases in the previous group become spawned.</p><h2 id="parallel-test-cases-and-i-o" class="section-heading"><a href="#parallel-test-cases-and-i-o" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Parallel Test Cases and I/O</span></h2><p>A parallel test case has a private I/O server as its group leader. (For a
description of the group leader concept, see <a href="../../apps/erts/index.html">ERTS</a>). The
central I/O server process, which handles the output from regular test cases and
configuration functions, does not respond to I/O messages during execution of
parallel groups. This is important to understand to avoid certain traps, like
the following:</p><p>If a process, <code class="inline">P</code>, is spawned during execution of, for example,
<code class="inline">init_per_suite/1</code>, it inherits the group leader of the <code class="inline">init_per_suite</code>
process. This group leader is the central I/O server process mentioned earlier.
If, at a later time, <em>during parallel test case execution</em>, some event triggers
process <code class="inline">P</code> to call <a href="../../apps/stdlib/io.html#format/1"><code class="inline">io:format/1/2</code></a>, that call never returns
(as the group leader is in a non-responsive state) and causes <code class="inline">P</code> to hang.</p><h2 id="repeated-groups" class="section-heading"><a href="#repeated-groups" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Repeated Groups</span></h2><p><a href="" id="repeated_groups"></a></p><p>A test case group can be repeated a certain number of times (specified by an
integer) or indefinitely (specified by <code class="inline">forever</code>). The repetition can also be
stopped too early if any or all cases fail or succeed, that is, if any of the
properties <code class="inline">repeat_until_any_fail</code>, <code class="inline">repeat_until_any_ok</code>,
<code class="inline">repeat_until_all_fail</code>, or <code class="inline">repeat_until_all_ok</code> is used. If the basic <code class="inline">repeat</code>
property is used, status of test cases is irrelevant for the repeat operation.</p><p>The status of a subgroup can be returned (<code class="inline">ok</code> or <code class="inline">failed</code>), to affect the
execution of the group on the level above. This is accomplished by, in
<code class="inline">end_per_group/2</code>, looking up the value of <code class="inline">tc_group_properties</code> in the <code class="inline">Config</code>
list and checking the result of the test cases in the group. If status <code class="inline">failed</code>
is to be returned from the group as a result, <code class="inline">end_per_group/2</code> is to return the
value <code class="inline">{return_group_result,failed}</code>. The status of a subgroup is taken into
account by <code class="inline">Common Test</code> when evaluating if execution of a group is to be
repeated or not (unless the basic <code class="inline">repeat</code> property is used).</p><p>The value of <code class="inline">tc_group_properties</code> is a list of status tuples, each with the key
<code class="inline">ok</code>, <code class="inline">skipped</code>, and <code class="inline">failed</code>. The value of a status tuple is a list with names
of test cases that have been executed with the corresponding status as result.</p><p>The following is an example of how to return the status from a group:</p><pre><code class="makeup erlang" translate="no"><span class="nf">end_per_group</span><span class="p" data-group-id="2913912484-1">(</span><span class="p">_</span><span class="n">Group</span><span class="p">,</span><span class="w"> </span><span class="n">Config</span><span class="p" data-group-id="2913912484-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="n">Status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">proplists</span><span class="p">:</span><span class="nf">get_value</span><span class="p" data-group-id="2913912484-2">(</span><span class="ss">tc_group_result</span><span class="p">,</span><span class="w"> </span><span class="n">Config</span><span class="p" data-group-id="2913912484-2">)</span><span class="p">,</span><span class="w">
    </span><span class="k">case</span><span class="w"> </span><span class="nc">proplists</span><span class="p">:</span><span class="nf">get_value</span><span class="p" data-group-id="2913912484-3">(</span><span class="ss">failed</span><span class="p">,</span><span class="w"> </span><span class="n">Status</span><span class="p" data-group-id="2913912484-3">)</span><span class="w"> </span><span class="k">of</span><span class="w">
        </span><span class="p" data-group-id="2913912484-4">[</span><span class="p" data-group-id="2913912484-4">]</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">                                   </span><span class="c1">% no failed cases</span><span class="w">
            </span><span class="p" data-group-id="2913912484-5">{</span><span class="ss">return_group_result</span><span class="p">,</span><span class="ss">ok</span><span class="p" data-group-id="2913912484-5">}</span><span class="p">;</span><span class="w">
        </span><span class="p">_</span><span class="n">Failed</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">                              </span><span class="c1">% one or more failed</span><span class="w">
            </span><span class="p" data-group-id="2913912484-6">{</span><span class="ss">return_group_result</span><span class="p">,</span><span class="ss">failed</span><span class="p" data-group-id="2913912484-6">}</span><span class="w">
    </span><span class="k">end</span><span class="p">.</span></code></pre><p>It is also possible, in <code class="inline">end_per_group/2</code>, to check the status of a subgroup
(maybe to determine what status the current group is to return). This is as
simple as illustrated in the previous example, only the group name is stored in
a tuple <code class="inline">{group_result,GroupName}</code>, which can be searched for in the status
lists.</p><p><em>Example:</em></p><pre><code class="makeup erlang" translate="no"><span class="nf">end_per_group</span><span class="p" data-group-id="8659181937-1">(</span><span class="ss">group1</span><span class="p">,</span><span class="w"> </span><span class="n">Config</span><span class="p" data-group-id="8659181937-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="n">Status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">proplists</span><span class="p">:</span><span class="nf">get_value</span><span class="p" data-group-id="8659181937-2">(</span><span class="ss">tc_group_result</span><span class="p">,</span><span class="w"> </span><span class="n">Config</span><span class="p" data-group-id="8659181937-2">)</span><span class="p">,</span><span class="w">
    </span><span class="n">Failed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">proplists</span><span class="p">:</span><span class="nf">get_value</span><span class="p" data-group-id="8659181937-3">(</span><span class="ss">failed</span><span class="p">,</span><span class="w"> </span><span class="n">Status</span><span class="p" data-group-id="8659181937-3">)</span><span class="p">,</span><span class="w">
    </span><span class="k">case</span><span class="w"> </span><span class="nc">lists</span><span class="p">:</span><span class="nf">member</span><span class="p" data-group-id="8659181937-4">(</span><span class="p" data-group-id="8659181937-5">{</span><span class="ss">group_result</span><span class="p">,</span><span class="ss">group2</span><span class="p" data-group-id="8659181937-5">}</span><span class="p">,</span><span class="w"> </span><span class="n">Failed</span><span class="p" data-group-id="8659181937-4">)</span><span class="w"> </span><span class="k">of</span><span class="w">
          </span><span class="ss">true</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
              </span><span class="p" data-group-id="8659181937-6">{</span><span class="ss">return_group_result</span><span class="p">,</span><span class="ss">failed</span><span class="p" data-group-id="8659181937-6">}</span><span class="p">;</span><span class="w">
          </span><span class="ss">false</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
              </span><span class="p" data-group-id="8659181937-7">{</span><span class="ss">return_group_result</span><span class="p">,</span><span class="ss">ok</span><span class="p" data-group-id="8659181937-7">}</span><span class="w">
    </span><span class="k">end</span><span class="p">;</span><span class="w">
</span><span class="p">.</span><span class="p">.</span><span class="p">.</span></code></pre><section role="note" class="admonition info"><h4 class="admonition-title info">Note</h4><p>When a test case group is repeated, the configuration functions
<code class="inline">init_per_group/2</code> and <code class="inline">end_per_group/2</code> are also always called with each
repetition.</p></section><h2 id="shuffled-test-case-order" class="section-heading"><a href="#shuffled-test-case-order" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Shuffled Test Case Order</span></h2><p>The order in which test cases in a group are executed is under normal
circumstances the same as the order specified in the test case list in the group
definition. With property <code class="inline">shuffle</code> set, however, <code class="inline">Common Test</code> instead executes
the test cases in random order.</p><p>You can provide a seed value (a tuple of three integers) with the shuffle
property <code class="inline">{shuffle,Seed}</code>. This way, the same shuffling order can be created
every time the group is executed. If no seed value is specified, <code class="inline">Common Test</code>
creates a &quot;random&quot; seed for the shuffling operation (using the return value of
<a href="../../apps/erts/erlang.html#timestamp/0"><code class="inline">erlang:timestamp/0</code></a>). The seed value is always printed to the
<code class="inline">init_per_group/2</code> log file so that it can be used to recreate the same
execution order in a subsequent test run.</p><section role="note" class="admonition info"><h4 class="admonition-title info">Note</h4><p>If a shuffled test case group is repeated, the seed is not reset between
turns.</p></section><p>If a subgroup is specified in a group with a <code class="inline">shuffle</code> property, the execution
order of this subgroup in relation to the test cases (and other subgroups) in
the group, is random. The order of the test cases in the subgroup is however not
random (unless the subgroup has a <code class="inline">shuffle</code> property).</p><p><a href="" id="group_info"></a></p><h2 id="group-information-function" class="section-heading"><a href="#group-information-function" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Group Information Function</span></h2><p>The test case group information function, <code class="inline">group(GroupName)</code>, serves the same
purpose as the suite- and test case information functions previously described.
However, the scope for the group information function, is all test cases and
subgroups in the group in question (<code class="inline">GroupName</code>).</p><p><em>Example:</em></p><pre><code class="makeup erlang" translate="no"><span class="nf">group</span><span class="p" data-group-id="6046349987-1">(</span><span class="ss">connection_tests</span><span class="p" data-group-id="6046349987-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
   </span><span class="p" data-group-id="6046349987-2">[</span><span class="p" data-group-id="6046349987-3">{</span><span class="ss">require</span><span class="p">,</span><span class="ss">login_data</span><span class="p" data-group-id="6046349987-3">}</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="6046349987-4">{</span><span class="ss">timetrap</span><span class="p">,</span><span class="mi">1000</span><span class="p" data-group-id="6046349987-4">}</span><span class="p" data-group-id="6046349987-2">]</span><span class="p">.</span></code></pre><p>The group information properties override those set with the suite information
function, and can in turn be overridden by test case information properties. For
a list of valid information properties and more general information, see the
<a href="write_test_chapter.html#info_function">Test Case Information Function</a>.</p><h2 id="information-functions-for-init-and-end-configuration" class="section-heading"><a href="#information-functions-for-init-and-end-configuration" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Information Functions for Init- and End-Configuration</span></h2><p>Information functions can also be used for functions <code class="inline">init_per_suite</code>,
<code class="inline">end_per_suite</code>, <code class="inline">init_per_group</code>, and <code class="inline">end_per_group</code>, and they work the same
way as with the
<a href="write_test_chapter.html#info_function">Test Case Information Function</a>. This is
useful, for example, for setting timetraps and requiring external configuration
data relevant only for the configuration function in question (without affecting
properties set for groups and test cases in the suite).</p><p>The information function <code class="inline">init/end_per_suite()</code> is called for
<code class="inline">init/end_per_suite(Config)</code>, and information function
<code class="inline">init/end_per_group(GroupName)</code> is called for
<code class="inline">init/end_per_group(GroupName,Config)</code>. However, information functions cannot be
used with <code class="inline">init/end_per_testcase(TestCase, Config)</code>, as these configuration
functions execute on the test case process and use the same properties as the
test case (that is, the properties set by the test case information function,
<code class="inline">TestCase()</code>). For a list of valid information properties and more general
information, see the
<a href="write_test_chapter.html#info_function">Test Case Information Function</a>.</p><p><a href="" id="data_priv_dir"></a></p><h2 id="data-and-private-directories" class="section-heading"><a href="#data-and-private-directories" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Data and Private Directories</span></h2><p>In the data directory, <code class="inline">data_dir</code>, the test module has its own files needed for
the testing. The name of <code class="inline">data_dir</code> is the name of the test suite followed by
<code class="inline">&quot;_data&quot;</code>. For example, <code class="inline">&quot;some_path/foo_SUITE.beam&quot;</code> has the data directory
<code class="inline">&quot;some_path/foo_SUITE_data/&quot;</code>. Use this directory for portability, that is, to
avoid hardcoding directory names in your suite. As the data directory is stored
in the same directory as your test suite, you can rely on its existence at
runtime, even if the path to your test suite directory has changed between test
suite implementation and execution.</p><p><code class="inline">priv_dir</code> is the private directory for the test cases. This directory can be
used whenever a test case (or configuration function) needs to write something
to file. The name of the private directory is generated by <code class="inline">Common Test</code>, which
also creates the directory.</p><p>By default, <code class="inline">Common Test</code> creates one central private directory per test run,
shared by all test cases. This is not always suitable. Especially if the same
test cases are executed multiple times during a test run (that is, if they
belong to a test case group with property <code class="inline">repeat</code>) and there is a risk that
files in the private directory get overwritten. Under these circumstances,
<code class="inline">Common Test</code> can be configured to create one dedicated private directory per
test case and execution instead. This is accomplished with the flag/option
<code class="inline">create_priv_dir</code> (to be used with the <a href="ct_run_cmd.html"><code class="inline">ct_run</code></a> program, the
<a href="ct.html#run_test/1"><code class="inline">ct:run_test/1</code></a> function, or as test specification term). There are three
possible values for this option as follows:</p><ul><li><code class="inline">auto_per_run</code></li><li><code class="inline">auto_per_tc</code></li><li><code class="inline">manual_per_tc</code></li></ul><p>The first value indicates the default <code class="inline">priv_dir</code> behavior, that is, one private
directory created per test run. The two latter values tell <code class="inline">Common Test</code> to
generate a unique test directory name per test case and execution. If the auto
version is used, <em>all</em> private directories are created automatically. This can
become very inefficient for test runs with many test cases or repetitions, or
both. Therefore, if the manual version is used instead, the test case must tell
<code class="inline">Common Test</code> to create <code class="inline">priv_dir</code> when it needs it. It does this by calling the
function <a href="ct.html#make_priv_dir/0"><code class="inline">ct:make_priv_dir/0</code></a>.</p><section role="note" class="admonition info"><h4 class="admonition-title info">Note</h4><p>Do not depend on the current working directory for reading and writing data
files, as this is not portable. All scratch files are to be written in the
<code class="inline">priv_dir</code> and all data files are to be located in <code class="inline">data_dir</code>. Also, the
<code class="inline">Common Test</code> server sets the current working directory to the test case log
directory at the start of every case.</p></section><h2 id="execution-environment" class="section-heading"><a href="#execution-environment" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Execution Environment</span></h2><p>Each test case is executed by a dedicated Erlang process. The process is spawned
when the test case starts, and terminated when the test case is finished. The
configuration functions <code class="inline">init_per_testcase</code> and <code class="inline">end_per_testcase</code> execute on
the same process as the test case.</p><p>The configuration functions <code class="inline">init_per_suite</code> and <code class="inline">end_per_suite</code> execute, like
test cases, on dedicated Erlang processes.</p><p><a href="" id="timetraps"></a></p><h2 id="timetrap-time-outs" class="section-heading"><a href="#timetrap-time-outs" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Timetrap Time-Outs</span></h2><p>The default time limit for a test case is 30 minutes, unless a <code class="inline">timetrap</code> is
specified either by the suite-, group-, or test case information function. The
timetrap time-out value defined by <code class="inline">suite/0</code> is the value that is used for each
test case in the suite (and for the configuration functions <code class="inline">init_per_suite/1</code>,
<code class="inline">end_per_suite/1</code>, <code class="inline">init_per_group/2</code>, and <code class="inline">end_per_group/2</code>). A timetrap value
defined by <code class="inline">group(GroupName)</code> overrides one defined by <code class="inline">suite()</code> and is used for
each test case in group <code class="inline">GroupName</code>, and any of its subgroups. If a timetrap
value is defined by <code class="inline">group/1</code> for a subgroup, it overrides that of its higher
level groups. Timetrap values set by individual test cases (by the test case
information function) override both group- and suite- level timetraps.</p><p>A timetrap can also be set or reset dynamically during the execution of a test
case, or configuration function. This is done by calling <a href="ct.html#timetrap/1"><code class="inline">ct:timetrap/1</code></a>. This
function cancels the current timetrap and starts a new one (that stays active
until time-out, or end of the current function).</p><p>Timetrap values can be extended with a multiplier value specified at startup
with option <code class="inline">multiply_timetraps</code>. It is also possible to let the test server
decide to scale up timetrap time-out values automatically. That is, if tools
such as <code class="inline">cover</code> or <code class="inline">trace</code> are running during the test. This feature is disabled
by default and can be enabled with start option <code class="inline">scale_timetraps</code>.</p><p>If a test case needs to suspend itself for a time that also gets multiplied by
<code class="inline">multiply_timetraps</code> (and possibly also scaled up if <code class="inline">scale_timetraps</code> is
enabled), the function <a href="ct.html#sleep/1"><code class="inline">ct:sleep/1</code></a> can be used (instead of, for example,
<a href="../../apps/stdlib/timer.html#sleep/1"><code class="inline">timer:sleep/1</code></a>).</p><p>A function (<code class="inline">fun/0</code> or <code class="inline">{Mod,Func,Args}</code> (MFA) tuple) can be specified as
timetrap value in the suite-, group- and test case information function, and as
argument to function <a href="ct.html#timetrap/1"><code class="inline">ct:timetrap/1</code></a>.</p><p><em>Examples:</em></p><p><code class="inline">{timetrap,{my_test_utils,timetrap,[?MODULE,system_start]}}</code></p><p><code class="inline">ct:timetrap(fun() -&gt; my_timetrap(TestCaseName, Config) end)</code></p><p>The user timetrap function can be used for two things as follows:</p><ul><li>To act as a timetrap. The time-out is triggered when the function returns.</li><li>To return a timetrap time value (other than a function).</li></ul><p>Before execution of the timetrap function (which is performed on a parallel,
dedicated timetrap process), <code class="inline">Common Test</code> cancels any previously set timer for
the test case or configuration function. When the timetrap function returns, the
time-out is triggered, <em>unless</em> the return value is a valid timetrap time, such
as an integer, or a <code class="inline">{SecMinOrHourTag,Time}</code> tuple (for details, see module
<a href="ct_suite.html"><code class="inline">ct_suite</code></a>). If a time value is returned, a new timetrap is started to
generate a time-out after the specified time.</p><p>The user timetrap function can return a time value after a delay. The effective
timetrap time is then the delay time <em>plus</em> the returned time.</p><p><a href="" id="logging"></a></p><h2 id="logging-categories-and-verbosity-levels" class="section-heading"><a href="#logging-categories-and-verbosity-levels" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Logging - Categories and Verbosity Levels</span></h2><p><code class="inline">Common Test</code> provides the following three main functions for printing strings:</p><ul><li><code class="inline">ct:log(Category, Importance, Format, FormatArgs, Opts)</code></li><li><code class="inline">ct:print(Category, Importance, Format, FormatArgs)</code></li><li><code class="inline">ct:pal(Category, Importance, Format, FormatArgs)</code></li></ul><p>The <a href="ct.html#log/1"><code class="inline">log/1,2,3,4,5</code></a> function prints a string to the test case log
file. The <a href="ct.html#print/1"><code class="inline">print/1,2,3,4</code></a> function prints the string to screen.
The <a href="ct.html#pal/1"><code class="inline">pal/1,2,3,4</code></a> function prints the same string both to file and
screen. The functions are described in module <a href="ct.html"><code class="inline">ct</code></a>.</p><p>The optional <code class="inline">Category</code> argument can be used to categorize the log printout.
Categories can be used for two things as follows:</p><ul><li>To compare the importance of the printout to a specific verbosity level.</li><li>To format the printout according to a user-specific HTML Style Sheet (CSS).</li></ul><p>Argument <code class="inline">Importance</code> specifies a level of importance that, compared to a
verbosity level (general and/or set per category), determines if the printout is
to be visible. <code class="inline">Importance</code> is any integer in the range 0..99. Predefined
constants exist in the <code class="inline">ct.hrl</code> header file. The default importance level,
<code class="inline">?STD_IMPORTANCE</code> (used if argument <code class="inline">Importance</code> is not provided), is 50. This
is also the importance used for standard I/O, for example, from printouts made
with <a href="../../apps/stdlib/io.html#format/2"><code class="inline">io:format/2</code></a>, <a href="../../apps/stdlib/io.html#put_chars/1"><code class="inline">io:put_chars/1</code></a>, and so on.</p><p><code class="inline">Importance</code> is compared to a verbosity level set by the <code class="inline">verbosity</code> start
flag/option. The level can be set per category or generally, or both. If
<code class="inline">verbosity</code> is not set by the user, a level of 100 (<code class="inline">?MAX_VERBOSITY</code> = all
printouts visible) is used as default value. <code class="inline">Common Test</code> performs the
following test:</p><pre><code class="text">Importance &gt;= (100-VerbosityLevel)</code></pre><p>The constant <code class="inline">?STD_VERBOSITY</code> has value 50 (see <code class="inline">ct.hrl</code>). At this level, all
standard I/O gets printed. If a lower verbosity level is set, standard I/O
printouts are ignored. Verbosity level 0 effectively turns all logging off
(except from printouts made by <code class="inline">Common Test</code> itself).</p><p>The general verbosity level is not associated with any particular category. This
level sets the threshold for the standard I/O printouts, uncategorized
<code class="inline">ct:log/print/pal</code> printouts, and printouts for categories with undefined
verbosity level.</p><p><em>Examples:</em></p><p>Some printouts during test case execution:</p><pre><code class="makeup erlang" translate="no"><span class="nc">io</span><span class="p">:</span><span class="nf">format</span><span class="p" data-group-id="1337299337-1">(</span><span class="s">&quot;1. Standard IO, importance = </span><span class="si">~w</span><span class="si">~n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1337299337-2">[</span><span class="o">?</span><span class="n">STD_IMPORTANCE</span><span class="p" data-group-id="1337299337-2">]</span><span class="p" data-group-id="1337299337-1">)</span><span class="p">,</span><span class="w">
</span><span class="nc">ct</span><span class="p">:</span><span class="nf">log</span><span class="p" data-group-id="1337299337-3">(</span><span class="s">&quot;2. Uncategorized, importance = </span><span class="si">~w</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1337299337-4">[</span><span class="o">?</span><span class="n">STD_IMPORTANCE</span><span class="p" data-group-id="1337299337-4">]</span><span class="p" data-group-id="1337299337-3">)</span><span class="p">,</span><span class="w">
 </span><span class="nc">ct</span><span class="p">:</span><span class="nf">log</span><span class="p" data-group-id="1337299337-5">(</span><span class="ss">info</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;3. Categorized info, importance = </span><span class="si">~w</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1337299337-6">[</span><span class="o">?</span><span class="n">STD_IMPORTANCE</span><span class="p" data-group-id="1337299337-6">]</span><span class="p" data-group-id="1337299337-5">)</span><span class="p">,</span><span class="w">
 </span><span class="nc">ct</span><span class="p">:</span><span class="nf">log</span><span class="p" data-group-id="1337299337-7">(</span><span class="ss">info</span><span class="p">,</span><span class="w"> </span><span class="o">?</span><span class="n">LOW_IMPORTANCE</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;4. Categorized info, importance = </span><span class="si">~w</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1337299337-8">[</span><span class="o">?</span><span class="n">LOW_IMPORTANCE</span><span class="p" data-group-id="1337299337-8">]</span><span class="p" data-group-id="1337299337-7">)</span><span class="p">,</span><span class="w">
 </span><span class="nc">ct</span><span class="p">:</span><span class="nf">log</span><span class="p" data-group-id="1337299337-9">(</span><span class="ss">error</span><span class="p">,</span><span class="w"> </span><span class="o">?</span><span class="n">HI_IMPORTANCE</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;5. Categorized error, importance = </span><span class="si">~w</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1337299337-10">[</span><span class="o">?</span><span class="n">HI_IMPORTANCE</span><span class="p" data-group-id="1337299337-10">]</span><span class="p" data-group-id="1337299337-9">)</span><span class="p">,</span><span class="w">
 </span><span class="nc">ct</span><span class="p">:</span><span class="nf">log</span><span class="p" data-group-id="1337299337-11">(</span><span class="ss">error</span><span class="p">,</span><span class="w"> </span><span class="o">?</span><span class="n">MAX_IMPORTANCE</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;6. Categorized error, importance = </span><span class="si">~w</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1337299337-12">[</span><span class="o">?</span><span class="n">MAX_IMPORTANCE</span><span class="p" data-group-id="1337299337-12">]</span><span class="p" data-group-id="1337299337-11">)</span><span class="p">,</span></code></pre><p>If starting the test with a general verbosity level of 50 (<code class="inline">?STD_VERBOSITY</code>):</p><pre><code class="text">$ ct_run -verbosity 50</code></pre><p>the following is printed:</p><pre><code class="text">1. Standard IO, importance = 50
2. Uncategorized, importance = 50
3. Categorized info, importance = 50
5. Categorized error, importance = 75
6. Categorized error, importance = 99</code></pre><p>If starting the test with:</p><pre><code class="text">$ ct_run -verbosity 1 and info 75</code></pre><p>the following is printed:</p><pre><code class="makeup erlang" translate="no"><span class="mi">3</span><span class="p">.</span><span class="w"> </span><span class="n">Categorized</span><span class="w"> </span><span class="ss">info</span><span class="p">,</span><span class="w"> </span><span class="ss">importance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">50</span><span class="w">
</span><span class="mi">4</span><span class="p">.</span><span class="w"> </span><span class="n">Categorized</span><span class="w"> </span><span class="ss">info</span><span class="p">,</span><span class="w"> </span><span class="ss">importance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">25</span><span class="w">
</span><span class="mi">6</span><span class="p">.</span><span class="w"> </span><span class="n">Categorized</span><span class="w"> </span><span class="ss">error</span><span class="p">,</span><span class="w"> </span><span class="ss">importance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">99</span></code></pre><p>Note that the category argument is not required in order to only specify the
importance of a printout. Example:</p><pre><code class="makeup erlang" translate="no"><span class="nc">ct</span><span class="p">:</span><span class="nf">pal</span><span class="p" data-group-id="2752330519-1">(</span><span class="o">?</span><span class="n">LOW_IMPORTANCE</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Info report: </span><span class="si">~p</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="2752330519-2">[</span><span class="n">Info</span><span class="p" data-group-id="2752330519-2">]</span><span class="p" data-group-id="2752330519-1">)</span></code></pre><p>Or perhaps in combination with constants:</p><pre><code class="makeup erlang" translate="no"><span class="p">-</span><span class="na">define</span><span class="p" data-group-id="5428119226-1">(</span><span class="n">INFO</span><span class="p">,</span><span class="w"> </span><span class="o">?</span><span class="n">LOW_IMPORTANCE</span><span class="p" data-group-id="5428119226-1">)</span><span class="p">.</span><span class="w">
</span><span class="p">-</span><span class="na">define</span><span class="p" data-group-id="5428119226-2">(</span><span class="n">ERROR</span><span class="p">,</span><span class="w"> </span><span class="o">?</span><span class="n">HI_IMPORTANCE</span><span class="p" data-group-id="5428119226-2">)</span><span class="p">.</span><span class="w">

</span><span class="nc">ct</span><span class="p">:</span><span class="nf">log</span><span class="p" data-group-id="5428119226-3">(</span><span class="o">?</span><span class="n">INFO</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Info report: </span><span class="si">~p</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5428119226-4">[</span><span class="n">Info</span><span class="p" data-group-id="5428119226-4">]</span><span class="p" data-group-id="5428119226-3">)</span><span class="w">
</span><span class="nc">ct</span><span class="p">:</span><span class="nf">pal</span><span class="p" data-group-id="5428119226-5">(</span><span class="o">?</span><span class="n">ERROR</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Error report: </span><span class="si">~p</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="5428119226-6">[</span><span class="n">Error</span><span class="p" data-group-id="5428119226-6">]</span><span class="p" data-group-id="5428119226-5">)</span></code></pre><p>The functions <a href="ct.html#set_verbosity/2"><code class="inline">ct:set_verbosity/2</code></a> and <a href="ct.html#get_verbosity/1"><code class="inline">ct:get_verbosity/1</code></a> may be used to
modify and read verbosity levels during test execution.</p><p>The arguments <code class="inline">Format</code> and <code class="inline">FormatArgs</code> in <code class="inline">ct:log/print/pal</code> are always passed
on to the STDLIB function <a href="../../apps/stdlib/io.html#format/3"><code class="inline">io:format/3</code></a> (For details, see the <a href="../../apps/stdlib/io.html"><code class="inline">io</code></a> manual
page).</p><p><a href="ct.html#pal/4"><code class="inline">ct:pal/4</code></a> and <a href="ct.html#log/5"><code class="inline">ct:log/5</code></a> add headers to strings being printed to the log file.
The strings are also wrapped in div tags with a CSS class attribute, so that
stylesheet formatting can be applied. To disable this feature for a printout
(i.e. to get a result similar to using <a href="../../apps/stdlib/io.html#format/2"><code class="inline">io:format/2</code></a>), call <a href="ct.html#log/5"><code class="inline">ct:log/5</code></a> with the
<code class="inline">no_css</code> option.</p><p>How categories can be mapped to CSS tags is documented in section
<a href="run_test_chapter.html#html_stylesheet">HTML Style Sheets</a> in section Running
Tests and Analyzing Results.</p><p>Common Test will escape special HTML characters (&lt;, &gt; and &amp;) in printouts to the
log file made with <a href="ct.html#pal/4"><code class="inline">ct:pal/4</code></a> and <a href="../../apps/stdlib/io.html#format/2"><code class="inline">io:format/2</code></a>. In order to print strings with
HTML tags to the log, use the <code class="inline">ct:log/3,4,5</code> function. The character escaping
feature is per default disabled for <code class="inline">ct:log/3,4,5</code> but can be enabled with the
<code class="inline">esc_chars</code> option in the <code class="inline">Opts</code> list, see <a href="ct.html#log/5"><code class="inline">ct:log/3,4,5</code></a>.</p><p>If the character escaping feature needs to be disabled (typically for backwards
compatibility reasons), use the <code class="inline">ct_run</code> start flag <code class="inline">-no_esc_chars</code>, or the
<a href="ct.html#run_test/1"><code class="inline">ct:run_test/1</code></a> start option <code class="inline">{esc_chars,Bool}</code> (this start option is also
supported in test specifications).</p><p>For more information about log files, see section
<a href="run_test_chapter.html#log_files">Log Files</a> in section Running Tests and
Analyzing Results.</p><h2 id="illegal-dependencies" class="section-heading"><a href="#illegal-dependencies" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Illegal Dependencies</span></h2><p>Even though it is highly efficient to write test suites with the <code class="inline">Common Test</code>
framework, mistakes can be made, mainly because of illegal dependencies. Some of
the more frequent mistakes from our own experience with running the Erlang/OTP
test suites follows:</p><ul><li><p>Depending on current directory, and writing there:</p><p>This is a common error in test suites. It is assumed that the current
directory is the same as the author used as current directory when the test
case was developed. Many test cases even try to write scratch files to this
directory. Instead <code class="inline">data_dir</code> and <code class="inline">priv_dir</code> are to be used to locate data and
for writing scratch files.</p></li><li><p>Depending on execution order:</p><p>During development of test suites, make no assumptions on the execution order
of the test cases or suites. For example, a test case must not assume that a
server it depends on is already started by a previous test case. Reasons for
this follows:</p><ul><li>The user/operator can specify the order at will, and maybe a different
execution order is sometimes more relevant or efficient.</li><li>If the user specifies a whole directory of test suites for the test, the
execution order of the suites depends on how the files are listed by the
operating system, which varies between systems.</li><li>If a user wants to run only a subset of a test suite, there is no way one
test case could successfully depend on another.</li></ul></li><li><p>Depending on Unix:</p><p>Running Unix commands through <code class="inline">os:cmd</code> are likely not to work on non-Unix
platforms.</p></li><li><p>Nested test cases:</p><p>Starting a test case from another not only tests the same thing twice, but
also makes it harder to follow what is being tested. Also, if the called test
case fails for some reason, so do the caller. This way, one error gives cause
to several error reports, which is to be avoided.</p><p>Functionality common for many test case functions can be implemented in common
help functions. If these functions are useful for test cases across suites,
put the help functions into common help modules.</p></li><li><p>Failure to crash or exit when things go wrong:</p><p>Making requests without checking that the return value indicates success can
be OK if the test case fails later, but it is never acceptable just to print
an error message (into the log file) and return successfully. Such test cases
do harm, as they create a false sense of security when overviewing the test
results.</p></li><li><p>Messing up for subsequent test cases:</p><p>Test cases are to restore as much of the execution environment as possible, so
that subsequent test cases do not crash because of their execution order. The
function <a href="ct_suite.html#c:end_per_testcase/2"><code class="inline">end_per_testcase</code></a> is suitable for
this.</p></li></ul>

</div>

<div class="bottom-actions" id="bottom-actions">
  <div class="bottom-actions-item">

      <a href="install_chapter.html" class="bottom-actions-button" rel="prev">
        <span class="subheader">
          ← Previous Page
        </span>
        <span class="title">
Installation
        </span>
      </a>

  </div>
  <div class="bottom-actions-item">

      <a href="test_structure_chapter.html" class="bottom-actions-button" rel="next">
        <span class="subheader">
          Next Page →
        </span>
        <span class="title">
Test Structure
        </span>
      </a>

  </div>
</div>
    <footer class="footer">
      <p>

        <span class="line">
          <button class="a-main footer-button display-quick-switch" title="Search HexDocs packages">
            Search HexDocs
          </button>

            <a href="common_test.epub" title="ePub version">
              Download ePub version
            </a>

        </span>
      </p>

      <p class="built-using">
        Built using
        <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.38.1) for the

          <a href="https://erlang.org" title="Erlang" target="_blank" translate="no">Erlang programming language</a>

      </p>
<p>Copyright © 1996-2025 <a href="https://www.ericsson.com">Ericsson AB</a></p>
    </footer>
  </div>
</main>
</div>
  <script defer src="https://cdn.jsdelivr.net/npm/mermaid@11.4.1/dist/mermaid.min.js"></script>
  <script>
  let initialized = false;

  window.addEventListener("exdoc:loaded", () => {
      if (!initialized) {
      mermaid.initialize({
          startOnLoad: false,
          theme: document.body.className.includes("dark") ? "dark" : "default"
      });
      initialized = true;
      }

      let id = 0;
      for (const codeEl of document.querySelectorAll("pre code.mermaid")) {
      const preEl = codeEl.parentElement;
      const graphDefinition = codeEl.textContent;
      const graphEl = document.createElement("div");
      const graphId = "mermaid-graph-" + id++;
      mermaid.render(graphId, graphDefinition).then(({svg, bindFunctions}) => {
          graphEl.innerHTML = svg;
          bindFunctions?.(graphEl);
          preEl.insertAdjacentElement("afterend", graphEl);
          preEl.remove();
      });
      }
  });
  </script>

  </body>
</html>
