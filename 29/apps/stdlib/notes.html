<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.38.1">
    <meta name="project" content="stdlib v7.1-rc0">


<meta name="major-vsn" content="29">
<meta name="exdoc:full-text-search-url" content="/doc/search.html?v=29&q=">
<link rel="canonical" href="https://www.erlang.org/doc/apps/stdlib/notes.html" />
    <title>STDLIB Release Notes — stdlib v7.1-rc0</title>

    <link rel="stylesheet" href="dist/html-erlang-ZK43ZOAC.css" />

    <script defer src="dist/sidebar_items-4F7E9F36.js"></script>
    <script defer src="docs_config.js"></script>
    <script defer src="dist/html-DPJLHKSM.js"></script>

  </head>
  <body>
    <script>(()=>{var t="ex_doc:settings",e="dark";var o="dark",s="light";var E="sidebar_state",n="closed";var r="sidebar_width";var a="sidebar-open";var i=new URLSearchParams(window.location.search),S=i.get("theme")||JSON.parse(localStorage.getItem(t)||"{}").theme;(S===o||S!==s&&window.matchMedia("(prefers-color-scheme: dark)").matches)&&document.body.classList.add(e);var d=sessionStorage.getItem(E),A=d!==n&&!window.matchMedia(`screen and (max-width: ${768}px)`).matches;document.body.classList.toggle(a,A);var c=sessionStorage.getItem(r);c&&document.body.style.setProperty("--sidebarWidth",`${c}px`);var p=/(Macintosh|iPhone|iPad|iPod)/.test(window.navigator.userAgent);document.documentElement.classList.toggle("apple-os",p);})();
</script>

<div class="body-wrapper">

<button id="sidebar-menu" class="sidebar-button sidebar-toggle" aria-label="toggle sidebar" aria-controls="sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<nav id="sidebar" class="sidebar">

  <div class="sidebar-header">
    <div class="sidebar-projectInfo">

        <a href="../../index.html" class="sidebar-projectImage">
          <img src="assets/logo.png" alt="stdlib" />
        </a>

      <div>
        <a href="../../index.html" class="sidebar-projectName" translate="no">
stdlib
        </a>
        <div class="sidebar-projectVersion" translate="no">
          v7.1-rc0
        </div>
      </div>
    </div>
    <ul id="sidebar-list-nav" class="sidebar-list-nav" role="tablist" data-extras=""></ul>
  </div>
</nav>

<output role="status" id="toast"></output>

<main class="content page-extra" id="main" data-type="extras">
  <div id="content" class="content-inner">
    <div class="top-search">
      <div class="search-settings">
        <form class="search-bar" action="search.html">
          <label class="search-label">
            <span class="sr-only">Search documentation of stdlib</span>
            <input name="q" type="text" class="search-input" placeholder="Press / to search" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
          </label>
          <button type="submit" class="search-button" aria-label="Submit Search" tabindex="-1">
            <i class="ri-search-2-line ri-lg" aria-hidden="true"></i>
          </button>
          <button type="button" tabindex="-1" class="search-close-button" aria-hidden="true">
            <i class="ri-close-line ri-lg" title="Cancel search"></i>
          </button>
        </form>
        <div class="autocomplete">
        </div>
        <button class="icon-settings display-settings">
          <i class="ri-settings-3-line"></i>
          <span class="sr-only">Settings</span>
        </button>
      </div>
    </div>

<div id="top-content">
  <div class="heading-with-actions top-heading">
    <h1>STDLIB Release Notes</h1>


      <a href="https://github.com/erlang/otp/blob/master/lib/stdlib/doc/notes.md#L1" title="View Source" class="icon-action" rel="help">
        <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        <span class="sr-only">View Source</span>
      </a>

  </div>


<p>This document describes the changes made to the STDLIB application.</p><h2 id="stdlib-7-1" class="section-heading"><a href="#stdlib-7-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 7.1</span></h2><h3 id="fixed-bugs-and-malfunctions" class="section-heading"><a href="#fixed-bugs-and-malfunctions" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>The <code class="inline">save_module/1</code> command in the shell now saves both the locally defined records and the imported records using the <code class="inline">rr/1</code> command.</p><p>Own Id: OTP-19647 Aux Id: <a href="https://github.com/erlang/otp/issues/9816" title="">GH-9816</a>, <a href="https://github.com/erlang/otp/pull/9897" title="">PR-9897</a></p></li><li><p>It's now possible to write <code class="inline">lists:map(fun is_atom/1, [])</code> or <code class="inline">lists:map(fun my_func/1, [])</code> in the shell, instead of <code class="inline">lists:map(fun erlang:is_atom/1, [])</code> or <code class="inline">lists:map(fun shell_default:my_func/1, [])</code>.</p><p>Own Id: OTP-19649 Aux Id: <a href="https://github.com/erlang/otp/issues/9771" title="">GH-9771</a>, <a href="https://github.com/erlang/otp/pull/9898" title="">PR-9898</a></p></li><li><p>The shell no longer crashes when requesting to auto-complete map keys containing non-atoms.</p><p>Own Id: OTP-19659 Aux Id: <a href="https://github.com/erlang/otp/pull/9896" title="">PR-9896</a></p></li><li><p>A remote shell can now exit by closing the input stream, without terminating the remote node.</p><p>Own Id: OTP-19667 Aux Id: <a href="https://github.com/erlang/otp/pull/9912" title="">PR-9912</a></p></li><li><p>Fixed guard check for <a href="../../apps/erts/erlang.html#is_record/2"><code class="inline">is_record/2</code></a> in the linter.</p><p>Own Id: OTP-19704 Aux Id: <a href="https://github.com/erlang/otp/issues/10020" title="">GH-10020</a>, <a href="https://github.com/erlang/otp/pull/10034" title="">PR-10034</a></p></li></ul><h3 id="improvements-and-new-features" class="section-heading"><a href="#improvements-and-new-features" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>Added a flag option <code class="inline">shell_hints</code> and function <a href="shell.html#hints/1"><code class="inline">shell:hints/1</code></a>. You can now disable the warning in the shell when a command is taking longer than 5 seconds.</p><p>Own Id: OTP-19759 Aux Id: <a href="https://github.com/erlang/otp/pull/10121" title="">PR-10121</a></p></li></ul><h2 id="stdlib-7-0-3" class="section-heading"><a href="#stdlib-7-0-3" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 7.0.3</span></h2><h3 id="fixed-bugs-and-malfunctions-1" class="section-heading"><a href="#fixed-bugs-and-malfunctions-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Update PCRE2 from 10.45 to 10.46. Fixes potential buffer read overflow on regular expressions with <code class="inline">(*scs:)</code> and <code class="inline">(*ACCEPT)</code> syntax combined.</p><p>Own Id: OTP-19755 Aux Id: <a href="https://nvd.nist.gov/vuln/detail/2025-58050" title="">CVE-2025-58050</a></p></li></ul><h2 id="stdlib-7-0-2" class="section-heading"><a href="#stdlib-7-0-2" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 7.0.2</span></h2><h3 id="fixed-bugs-and-malfunctions-2" class="section-heading"><a href="#fixed-bugs-and-malfunctions-2" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>A set of small bugs in sort stability for `lists:sort/1` and `lists:keysort/1` has been fixed. The bug happened for only some, seemingly random, element sequences. Most sorts were stable.</p><p>Sort stability for `lists:sort/1` is only possible to observe when sorting lists with floating point and integer numbers of the same value.</p><p>For `lists:keysort/1` the list had to start with two tuples where the keys or the whole tuples compared equal.</p><p>Own Id: OTP-19673 Aux Id: ERIERL-1240</p></li><li><p>Fixed bug in <a href="io_lib.html#bformat/2"><code class="inline">io_lib:bformat/2</code></a> which crashed if format string contained unicode characters.</p><p>Own Id: OTP-19680 Aux Id: <a href="https://github.com/erlang/otp/pull/9952" title="">PR-9952</a></p></li></ul><h2 id="stdlib-7-0-1" class="section-heading"><a href="#stdlib-7-0-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 7.0.1</span></h2><h3 id="fixed-bugs-and-malfunctions-3" class="section-heading"><a href="#fixed-bugs-and-malfunctions-3" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Properly strip the leading <code class="inline">/</code> and drive letter from filepaths when zipping and unzipping archives.</p><p>Thanks to Wander Nauta for finding and responsibly disclosing this vulnerability to the Erlang/OTP project.</p><p>Own Id: OTP-19653 Aux Id: <a href="https://nvd.nist.gov/vuln/detail/2025-4748" title="">CVE-2025-4748</a>, <a href="https://github.com/erlang/otp/pull/9941" title="">PR-9941</a></p></li></ul><h2 id="stdlib-7-0" class="section-heading"><a href="#stdlib-7-0" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 7.0</span></h2><h3 id="fixed-bugs-and-malfunctions-4" class="section-heading"><a href="#fixed-bugs-and-malfunctions-4" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Shell help now orders the commands in alphabetical order.</p><p>Own Id: OTP-19161 Aux Id: <a href="https://github.com/erlang/otp/pull/8573" title="">PR-8573</a></p></li><li><p><a href="proc_lib.html#stop/3"><code class="inline">proc_lib:stop/1,3</code></a> (and in extension <a href="gen_server.html#stop/3"><code class="inline">gen_server:stop/3</code></a>, <a href="gen_statem.html#stop/3"><code class="inline">gen_statem:stop/3</code></a> and so on) have been updated to not throw an error if the process to be stopped exits with the same reason as given to <a href="proc_lib.html#stop/3"><code class="inline">proc_lib:stop/3</code></a>.</p><p><strong><em> POTENTIAL INCOMPATIBILITY </em></strong></p><p>Own Id: OTP-19233 Aux Id: <a href="https://github.com/erlang/otp/pull/8772" title="">PR-8772</a></p></li><li><p>The size of an atom in the Erlang source code was limited to 255 bytes in previous releases, meaning that an atom containing only emojis could contain only 63 emojis.</p><p>While atoms are still only allowed to contain 255 characters, the number of bytes is no longer limited.</p><p>External tools that parse the <code class="inline">AtU8</code> chunk of a BEAM file directly need to be updated. Tools that use <a href="beam_lib.html#chunks/2"><code class="inline">beam_lib:chunks(Beam, [atoms])</code></a> to read the atom table will continue to work.</p><p><strong><em> POTENTIAL INCOMPATIBILITY </em></strong></p><p>Own Id: OTP-19285 Aux Id: <a href="https://github.com/erlang/otp/pull/8913" title="">PR-8913</a></p></li><li><p><a href="argparse.html#help/1"><code class="inline">argparse:help/1</code></a> now accepts <a href="unicode.html#t:chardata/0"><code class="inline">unicode:chardata/0</code></a>.</p><p>Own Id: OTP-19303 Aux Id: <a href="https://github.com/erlang/otp/pull/8932" title="">PR-8932</a></p></li><li><p>The literals chunk in BEAM is no longer compressed, resulting in slightly smaller BEAM files when a BEAM file is stripped using <a href="beam_lib.html#strip_files/1"><code class="inline">beam_lib:strip_files/1</code></a>.</p><p>This is a potential incompatibility for tools that read and interpret the contents of the literal chunk. One way to update such tools to work with the new format is to retrieve the chunk using <a href="beam_lib.html#chunks/2"><code class="inline">beam_lib:chunks(Beam, [literals])</code></a>.</p><p><strong><em> POTENTIAL INCOMPATIBILITY </em></strong></p><p>Own Id: OTP-19323 Aux Id: <a href="https://github.com/erlang/otp/issues/8967" title="">GH-8967</a>, <a href="https://github.com/erlang/otp/pull/8988" title="">PR-8988</a></p></li><li><p>The previous <a href="digraph_utils.html#preorder/1"><code class="inline">digraph_utils:preorder/1</code></a> and <a href="digraph_utils.html#postorder/1"><code class="inline">digraph_utils:postorder/1</code></a> did not start the traversal from root nodes. This fix makes both traversals only start or restart from a root node in one of the components, or an arbitrary node if no root node can be visited.</p><p>Own Id: OTP-19393 Aux Id: <a href="https://github.com/erlang/otp/pull/9171" title="">PR-9171</a></p></li><li><p>Auto-completion in the shell is now significantly faster for function parameters that uses complex custom types.</p><p>Own Id: OTP-19413 Aux Id: <a href="https://github.com/erlang/otp/pull/9271" title="">PR-9271</a></p></li><li><p>Stringfying a non-latin1 atom will now produce a readable string instead of encoding each character using <code class="inline">\x{...}</code> escape sequences. Example:</p><pre><code class="makeup erlang" translate="no"><span class="p">-</span><span class="na">define</span><span class="p" data-group-id="8232557371-1">(</span><span class="n">S</span><span class="p" data-group-id="8232557371-2">(</span><span class="n">T</span><span class="p" data-group-id="8232557371-2">)</span><span class="p">,</span><span class="w"> </span><span class="o">?</span><span class="o">?</span><span class="n">T</span><span class="p" data-group-id="8232557371-1">)</span><span class="p">.</span><span class="w">

</span><span class="nf">atom</span><span class="p" data-group-id="8232557371-3">(</span><span class="p" data-group-id="8232557371-3">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="o">?</span><span class="n">S</span><span class="p" data-group-id="8232557371-4">(</span><span class="ss">&#39;атом&#39;</span><span class="p" data-group-id="8232557371-4">)</span><span class="p">.</span></code></pre><p>The <code class="inline">atom/0</code> function now returns <code class="inline">&quot;'атом'&quot;</code> instead of <code class="inline">&quot;'\\x{430}\\x{442}\\x{43E}\\x{43C}'&quot;</code>.</p><p>Own Id: OTP-19421 Aux Id: <a href="https://github.com/erlang/otp/issues/9173" title="">GH-9173</a>, <a href="https://github.com/erlang/otp/pull/9276" title="">PR-9276</a></p></li><li><p>A few minor issues were corrected in <code class="inline">m:syntax_tools</code>, as well in the <a href="erl_anno.html"><code class="inline">erl_anno</code></a> module.</p><p>Own Id: OTP-19422 Aux Id: <a href="https://github.com/erlang/otp/pull/9253" title="">PR-9253</a></p></li><li><p><a href="dets.html"><code class="inline">dets</code></a> could print error messages to standard output when repairing DETS files. This has been changed to send the messages to <a href="../../apps/kernel/logger.html"><code class="inline">logger</code></a>.</p><p><code class="inline">ets:fun2ms</code> would print an error message to standard output as well as returning an error tuple. The printing of the message has been removed.</p><p>Own Id: OTP-19427 Aux Id: <a href="https://github.com/erlang/otp/pull/9232" title="">PR-9232</a>, <a href="https://github.com/erlang/otp/pull/9446" title="">PR-9446</a></p></li><li><p>The functions for converting to and from the RFC1339 date and time format would not properly handle fractional seconds for negative times.</p><p>Own Id: OTP-19441 Aux Id: <a href="https://github.com/erlang/otp/issues/9279" title="">GH-9279</a>, <a href="https://github.com/erlang/otp/pull/9280" title="">PR-9280</a></p></li><li><p>Replaced calls to deprecated <code class="inline">crypto:start()</code> with <code class="inline">application:start(crypto)</code>.</p><p>Own Id: OTP-19485 Aux Id: <a href="https://github.com/erlang/otp/pull/8592" title="">PR-8592</a></p></li><li><p>Fixed a bug when calling shell completion on a reserved word followed by a <em>(</em> would crash the shell.</p><p>Own Id: OTP-19511 Aux Id: <a href="https://github.com/erlang/otp/issues/9470" title="">GH-9470</a></p></li><li><p>Corrected the spec of <a href="ets.html#update_element/4"><code class="inline">ets:update_element/4</code></a>.</p><p>Own Id: OTP-19514 Aux Id: <a href="https://github.com/erlang/otp/pull/9504" title="">PR-9504</a></p></li><li><p>Corrected the spec for <a href="ets.html#info/1"><code class="inline">ets:info/1</code></a>.</p><p>Own Id: OTP-19515 Aux Id: <a href="https://github.com/erlang/otp/pull/9514" title="">PR-9514</a></p></li><li><p>Fixed crash when defining records with a string field in the shell</p><p>Own Id: OTP-19533 Aux Id: <a href="https://github.com/erlang/otp/issues/9557" title="">GH-9557</a></p></li><li><p>Details in the hibernation implementation and time-out handling has been improved for <code class="inline">gen_statem</code>.  In particular to avoid selective receive when cancelling a time-out.</p><p>Own Id: OTP-19540 Aux Id: <a href="https://github.com/erlang/otp/pull/9579" title="">PR-9579</a></p></li><li><p>Fixed a bug when getting help on a module compiled without debug_info.</p><p>Own Id: OTP-19583 Aux Id: <a href="https://github.com/erlang/otp/pull/9654" title="">PR-9654</a></p></li><li><p>Fix <a href="zip.html"><code class="inline">zip</code></a> extraction to wrap invalid DOS timestamps to their correct value instead of returning the actual value. Before this fix the timestamp returned could have a second greater than 59. The bug has been present since Erlang/OTP 27.1.</p><p>Own Id: OTP-19593 Aux Id: <a href="https://github.com/erlang/otp/pull/9537" title="">PR-9537</a>, <a href="https://github.com/erlang/otp/issues/9536" title="">GH-9536</a></p></li><li><p>Enhance specs of timeout for improving documentation and dialyzer analysis.</p><p>Own Id: OTP-19604 Aux Id: <a href="https://github.com/erlang/otp/pull/9574" title="">PR-9574</a></p></li></ul><h3 id="improvements-and-new-features-1" class="section-heading"><a href="#improvements-and-new-features-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>Singleton type variables in an union type do not make sense from Dialyzer's point of view. The following example is ill-typed:</p><pre><code class="makeup erlang" translate="no"><span class="p">-</span><span class="na">spec</span><span class="w"> </span><span class="nf">run_test</span><span class="p" data-group-id="4007759279-1">(</span><span class="n">Opts</span><span class="p" data-group-id="4007759279-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nf">term</span><span class="p" data-group-id="4007759279-2">(</span><span class="p" data-group-id="4007759279-2">)</span><span class="w">
      </span><span class="k">when</span><span class="w"> </span><span class="n">Opts</span><span class="w"> </span><span class="p">:</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="4007759279-3">{</span><span class="ss">join_specs</span><span class="p">,</span><span class="w"> </span><span class="n">Bool</span><span class="p" data-group-id="4007759279-3">}</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="p" data-group-id="4007759279-4">{</span><span class="ss">test</span><span class="p">,</span><span class="w"> </span><span class="n">Bool</span><span class="p" data-group-id="4007759279-4">}</span><span class="p">.</span></code></pre><p>This used to be reported as a warning. In OTP-28, this is an error</p><p>Own Id: OTP-19125 Aux Id: <a href="https://github.com/erlang/otp/pull/8556" title="">PR-8556</a></p></li><li><p>By default, sets created by the <a href="sets.html"><code class="inline">sets</code></a> module will now be represented as maps.</p><p>Own Id: OTP-19127 Aux Id: <a href="https://github.com/erlang/otp/pull/8429" title="">PR-8429</a></p></li><li><p>For various error types, the compiler now tries to suggest potential fixes by adding &quot;did you mean ...?&quot; at the end of error messages.</p><p>When a function is used with wrong arity, the compiler will try to suggest a defined function with the same name but a different arity. For example, given the following module:</p><pre><code class="makeup erlang" translate="no"><span class="p">-</span><span class="na">module</span><span class="p" data-group-id="3791275037-1">(</span><span class="ss">typos</span><span class="p" data-group-id="3791275037-1">)</span><span class="p">.</span><span class="w">
</span><span class="p">-</span><span class="na">export</span><span class="p" data-group-id="3791275037-2">(</span><span class="p" data-group-id="3791275037-3">[</span><span class="ss">t</span><span class="p">/</span><span class="mi">0</span><span class="p" data-group-id="3791275037-3">]</span><span class="p" data-group-id="3791275037-2">)</span><span class="p">.</span><span class="w">
</span><span class="nf">bar</span><span class="p" data-group-id="3791275037-4">(</span><span class="n">A</span><span class="p" data-group-id="3791275037-4">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="n">A</span><span class="p">.</span><span class="w">
</span><span class="nf">bar</span><span class="p" data-group-id="3791275037-5">(</span><span class="n">A</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">A</span><span class="p" data-group-id="3791275037-5">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="n">A</span><span class="p">.</span><span class="w">
</span><span class="nf">bar</span><span class="p" data-group-id="3791275037-6">(</span><span class="n">A</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">A</span><span class="p" data-group-id="3791275037-6">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="n">A</span><span class="p">.</span><span class="w">
</span><span class="nf">t</span><span class="p" data-group-id="3791275037-7">(</span><span class="p" data-group-id="3791275037-7">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="nf">bar</span><span class="p" data-group-id="3791275037-8">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="3791275037-8">)</span><span class="p">.</span></code></pre><p>The compiler will emit the following message:</p><pre><code class="makeup erlang" translate="no"><span class="ss">typo</span><span class="p">.</span><span class="nc">erl</span><span class="p">:</span><span class="mi">6</span><span class="p">:</span><span class="mi">12</span><span class="p">:</span><span class="w"> </span><span class="ss">function</span><span class="w"> </span><span class="ss">bar</span><span class="p">/</span><span class="mi">2</span><span class="w"> </span><span class="ss">undefined</span><span class="p">,</span><span class="w"> </span><span class="ss">did</span><span class="w"> </span><span class="ss">you</span><span class="w"> </span><span class="ss">mean</span><span class="w"> </span><span class="ss">bar</span><span class="p">/</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="o">?</span><span class="w">
</span><span class="c1">%   6|     t() -&gt; bar(0, 0).</span><span class="w">
</span><span class="c1">%    |            ^</span></code></pre><p>For compiler errors that can easily be caused by typos, the compiler will try to suggest what the correct variable or function name, could be. For example, given the following module:</p><pre><code class="makeup erlang" translate="no"><span class="p">-</span><span class="na">module</span><span class="p" data-group-id="6836866844-1">(</span><span class="ss">typos</span><span class="p" data-group-id="6836866844-1">)</span><span class="p">.</span><span class="w">
</span><span class="p">-</span><span class="na">export</span><span class="p" data-group-id="6836866844-2">(</span><span class="p" data-group-id="6836866844-3">[</span><span class="ss">bar</span><span class="p">/</span><span class="mi">2</span><span class="p" data-group-id="6836866844-3">]</span><span class="p" data-group-id="6836866844-2">)</span><span class="p">.</span><span class="w">

</span><span class="nf">bar</span><span class="p" data-group-id="6836866844-4">(</span><span class="n">A0</span><span class="p">,</span><span class="w"> </span><span class="n">B0</span><span class="p" data-group-id="6836866844-4">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="n">A</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">B</span><span class="p">.</span></code></pre><p>the compiler will emit the following error messages:</p><pre><code class="makeup erlang" translate="no"><span class="ss">typos</span><span class="p">.</span><span class="nc">erl</span><span class="p">:</span><span class="mi">5</span><span class="p">:</span><span class="mi">5</span><span class="p">:</span><span class="w"> </span><span class="ss">variable</span><span class="w"> </span><span class="ss">&#39;A&#39;</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="ss">unbound</span><span class="p">,</span><span class="w"> </span><span class="ss">did</span><span class="w"> </span><span class="ss">you</span><span class="w"> </span><span class="ss">mean</span><span class="w"> </span><span class="ss">&#39;A0&#39;</span><span class="o">?</span><span class="w">
</span><span class="c1">%    5|     A + B.</span><span class="w">
</span><span class="c1">%     |     ^</span><span class="w">

</span><span class="ss">typos</span><span class="p">.</span><span class="nc">erl</span><span class="p">:</span><span class="mi">5</span><span class="p">:</span><span class="mi">9</span><span class="p">:</span><span class="w"> </span><span class="ss">variable</span><span class="w"> </span><span class="ss">&#39;B&#39;</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="ss">unbound</span><span class="p">,</span><span class="w"> </span><span class="ss">did</span><span class="w"> </span><span class="ss">you</span><span class="w"> </span><span class="ss">mean</span><span class="w"> </span><span class="ss">&#39;B0&#39;</span><span class="o">?</span><span class="w">
</span><span class="c1">%    5|     A + B.</span><span class="w">
</span><span class="c1">%     |         ^</span></code></pre><p>Error types that now suggest correct arities: <code class="inline">bad_inline</code>, <code class="inline">undefined_nif</code>, <code class="inline">bad_nowarn_unused_function</code>, <code class="inline">bad_nowarn_bif_clash</code>, <code class="inline">undefined_function</code>.</p><p>Error types that now suggest correct names: <code class="inline">bad_inline</code>, <code class="inline">undefined_nif</code>, <code class="inline">bad_nowarn_unused_function</code>, <code class="inline">undefined_on_load</code>, <code class="inline">undefined_function</code>, <code class="inline">undefined_record</code>, <code class="inline">undefined_field</code>, <code class="inline">unbound_var</code>.</p><p>Using a function with wrong arity has higher precedence than having a typo in the function name. If the compiler can find a defined function with the same name but a different arity, it will not suggest a defined function with a close-enough name, regardless of arity.</p><p>Own Id: OTP-19180 Aux Id: <a href="https://github.com/erlang/otp/pull/8699" title="">PR-8699</a>, <a href="https://github.com/erlang/otp/pull/9094" title="">PR-9094</a></p></li><li><p>Comprehensions have been extended with zip generators  according to <a href="https://www.erlang.org/eeps/eep-0073">EEP 73</a>. </p><p>Example:</p><pre><code class="makeup erlang" translate="no"><span class="gp unselectable">1&gt; </span><span class="p" data-group-id="0750943871-1">[</span><span class="n">A</span><span class="o">+</span><span class="n">B</span><span class="w"> </span><span class="p">||</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="p" data-group-id="0750943871-2">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p" data-group-id="0750943871-2">]</span><span class="w"> </span><span class="p">&amp;&amp;</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="p" data-group-id="0750943871-3">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p" data-group-id="0750943871-3">]</span><span class="p" data-group-id="0750943871-1">]</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="0750943871-4">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">9</span><span class="p" data-group-id="0750943871-4">]</span></code></pre><p>Own Id: OTP-19184 Aux Id: <a href="https://github.com/erlang/otp/pull/8926" title="">PR-8926</a></p></li><li><p>Before restarting a child, a supervisor must check if the restart limit is reached. This adds a penalty to the overall restart time, which should be kept low. The algorithm 
has been optimized from 2*O(n) to O(n) behavior.</p><p>Own Id: OTP-19204 Aux Id: <a href="https://github.com/erlang/otp/pull/8261" title="">PR-8261</a></p></li><li><p>Added the possibility to configure shell docs column width through the stdlib parameter <a href="stdlib_app.html#shell_docs_columns"><code class="inline">shell_docs_columns</code></a>.</p><p>Own Id: OTP-19224 Aux Id: <a href="https://github.com/erlang/otp/pull/8651" title="">PR-8651</a></p></li><li><p>The <a href="io.html#setopts/2"><code class="inline">io:setopts/2</code></a> function now accepts the <code class="inline">line_history</code> option for more explicit handling of when to save shell history.</p><p>Own Id: OTP-19230 Aux Id: <a href="https://github.com/erlang/otp/pull/8792" title="">PR-8792</a></p></li><li><p>The shell now prints a help message explaining how to interrupt a running command when stuck executing a command for longer than 5 seconds.</p><p>Own Id: OTP-19231 Aux Id: <a href="https://github.com/erlang/otp/pull/8793" title="">PR-8793</a></p></li><li><p>Binaries can now be used as input to <a href="calendar.html#rfc3339_to_system_time/2"><code class="inline">calendar:rfc3339_to_system_time/2</code></a>, and produced as output of <a href="calendar.html#system_time_to_rfc3339/2"><code class="inline">calendar:system_time_to_rfc3339/2</code></a>.</p><p>Own Id: OTP-19250 Aux Id: <a href="https://github.com/erlang/otp/pull/8812" title="">PR-8812</a></p></li><li><p>The <a href="../../apps/erts/erl_cmd.html#noshell"><code class="inline">erl -noshell</code></a> mode has been updated to have two sub modes called <code class="inline">raw</code> and <code class="inline">cooked</code>, where <code class="inline">cooked</code> is the old default behaviour and <code class="inline">raw</code> can be used to bypass the line-editing support of the native terminal. Using <code class="inline">raw</code> mode it is possible to read keystrokes as they happen without the user having to press Enter. Also, the <code class="inline">raw</code> mode does not echo the typed characters to stdout. An example of how to create a tic-tac-toe game using this mechanism is included in <a href="terminal_interface.html">the documentation</a>.</p><p>Own Id: OTP-19314 Aux Id: <a href="https://github.com/erlang/otp/pull/8962" title="">PR-8962</a>, <a href="https://github.com/erlang/otp/issues/8037" title="">GH-8037</a></p></li><li><p>Added <a href="io.html#get_password/0"><code class="inline">io:get_password/0</code></a> that can read passwords from stdin when in &quot;raw&quot; <code class="inline">-noshell</code> mode.</p><p>Own Id: OTP-19315 Aux Id: <a href="https://github.com/erlang/otp/pull/8962" title="">PR-8962</a>, <a href="https://github.com/erlang/otp/pull/9006" title="">PR-9006</a></p></li><li><p>New strict generators have been added for comprehensions.</p><p>The currently existing generators are &quot;relaxed&quot;: they ignore terms in the
right-hand side expression that do not match the left-hand side pattern.</p><p>The new strict generators fail with exception <code class="inline">badmatch</code> if a pattern doesn't match.</p><p>Examples:</p><p>Using the current relaxed generator operator <code class="inline">&lt;-</code>, any element not matching
the pattern <code class="inline">{_,_}</code> will be silently discarded:</p><pre><code class="makeup erlang" translate="no"><span class="gp unselectable">1&gt; </span><span class="p" data-group-id="2161537557-1">[</span><span class="n">T</span><span class="w"> </span><span class="p">||</span><span class="w"> </span><span class="p" data-group-id="2161537557-2">{</span><span class="p">_</span><span class="p">,</span><span class="p">_</span><span class="p" data-group-id="2161537557-2">}</span><span class="o">=</span><span class="n">T</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="p" data-group-id="2161537557-3">[</span><span class="p" data-group-id="2161537557-4">{</span><span class="ss">ok</span><span class="p">,</span><span class="mi">1</span><span class="p" data-group-id="2161537557-4">}</span><span class="p">,</span><span class="ss">ok</span><span class="p">,</span><span class="p" data-group-id="2161537557-5">{</span><span class="ss">error</span><span class="p">,</span><span class="mi">2</span><span class="p" data-group-id="2161537557-5">}</span><span class="p" data-group-id="2161537557-3">]</span><span class="p" data-group-id="2161537557-1">]</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="2161537557-6">[</span><span class="p" data-group-id="2161537557-7">{</span><span class="ss">ok</span><span class="p">,</span><span class="mi">1</span><span class="p" data-group-id="2161537557-7">}</span><span class="p">,</span><span class="p" data-group-id="2161537557-8">{</span><span class="ss">error</span><span class="p">,</span><span class="mi">2</span><span class="p" data-group-id="2161537557-8">}</span><span class="p" data-group-id="2161537557-6">]</span></code></pre><p>If the intention is that all lists processed by a list comprehension must only
contain tuples of size two, using the new strict version of the operator ensures
that term not matching will cause a crash:</p><pre><code class="makeup erlang" translate="no"><span class="gp unselectable">2&gt; </span><span class="p" data-group-id="7358046995-1">[</span><span class="n">T</span><span class="w"> </span><span class="p">||</span><span class="w"> </span><span class="p" data-group-id="7358046995-2">{</span><span class="p">_</span><span class="p">,</span><span class="p">_</span><span class="p" data-group-id="7358046995-2">}</span><span class="o">=</span><span class="n">T</span><span class="w"> </span><span class="o">&lt;:-</span><span class="w"> </span><span class="p" data-group-id="7358046995-3">[</span><span class="p" data-group-id="7358046995-4">{</span><span class="ss">ok</span><span class="p">,</span><span class="mi">1</span><span class="p" data-group-id="7358046995-4">}</span><span class="p">,</span><span class="ss">ok</span><span class="p">,</span><span class="p" data-group-id="7358046995-5">{</span><span class="ss">error</span><span class="p">,</span><span class="mi">2</span><span class="p" data-group-id="7358046995-5">}</span><span class="p" data-group-id="7358046995-3">]</span><span class="p" data-group-id="7358046995-1">]</span><span class="p">.</span><span class="w">
</span><span class="gt">** exception error: no match of right hand side value ok</span></code></pre><p>Using the strict generator operator to mark the intention that all list elements must match the pattern could help finding mistakes quicker if something unpexected is added to the list processed by the generator.</p><p>The strict version for bitstring generators is <code class="inline">&lt;:=</code>.</p><p>Own Id: OTP-19317 Aux Id: <a href="https://github.com/erlang/otp/pull/8625" title="">PR-8625</a></p></li><li><p>New options for suppressing behaviour warnings have been added:</p><ul><li><code class="inline">nowarn_conflicting_behaviours</code></li><li><code class="inline">nowarn_undefined_behaviour_func</code></li><li><code class="inline">nowarn_undefined_behaviour</code></li><li><code class="inline">nowarn_undefined_behaviour_callbacks</code></li><li><code class="inline">nowarn_ill_defined_behaviour_callbacks</code></li><li><code class="inline">nowarn_ill_defined_optional_callbacks</code></li></ul><p>Own Id: OTP-19334 Aux Id: <a href="https://github.com/erlang/otp/issues/8985" title="">GH-8985</a>, <a href="https://github.com/erlang/otp/pull/9020" title="">PR-9020</a></p></li><li><p>The <a href="binary.html#join/2"><code class="inline">join(Binaries, Separator)</code></a> function that joins a list of binaries has been added to the <a href="binary.html"><code class="inline">binary</code></a> module.</p><p>Own Id: OTP-19337 Aux Id: <a href="https://github.com/erlang/otp/issues/8099" title="">GH-8099</a>, <a href="https://github.com/erlang/otp/pull/8100" title="">PR-8100</a></p></li><li><p>The <a href="supervisor.html#which_child/2"><code class="inline">supervisor:which_child/2</code></a> function has been added to facilitate getting the pid of a sibling  process; that is a process under same supervisor as the process that calls to call the new function.</p><p>Own Id: OTP-19345 Aux Id: <a href="https://github.com/erlang/otp/pull/8976" title="">PR-8976</a></p></li><li><p>The function <a href="erl_anno.html#set_end_location/2"><code class="inline">erl_anno:set_end_location/2</code></a> for setting the end location of a token has been added.</p><p>Own Id: OTP-19354 Aux Id: <a href="https://github.com/erlang/otp/pull/8966" title="">PR-8966</a></p></li><li><p>Added a warning for calling non-exported functions with the remote function call syntax from the same module, and likewise for the remote fun syntax.</p><p>Own Id: OTP-19371 Aux Id: <a href="https://github.com/erlang/otp/issues/9092" title="">GH-9092</a>, <a href="https://github.com/erlang/otp/pull/9095" title="">PR-9095</a></p></li><li><p>The <code class="inline">warn_deprecated_catch</code> option enables warnings for use of old-style catch expressions on the form <code class="inline">catch Expr</code> instead of the modern <code class="inline">try ... catch ... end</code>. To prevent new uses of uses of old catches to be added, this compiler option can be enabled on the project level and <code class="inline">-compile(nowarn_deprecated_catch).</code> added to individual files that still contain old catches.</p><p>Own Id: OTP-19425 Aux Id: <a href="https://github.com/erlang/otp/pull/9154" title="">PR-9154</a></p></li><li><p>Module <a href="re.html"><code class="inline">re</code></a> has been updated to use PCRE2, which is mostly backward compatible with PCRE.</p><p>The most noticeable incompatibilities are</p><ul><li>The default character encoding is pure ASCII and not Latin1. Unicode support
is still available with options <code class="inline">unicode</code> and <code class="inline">ucp</code>.</li><li>Options <code class="inline">bsr_anycrlf</code>, <code class="inline">bsr_unicode</code> and <code class="inline">{newline,_}</code> are only set when a
regex is compiled and cannot be changed at matching for precompiled regex.</li></ul><p><strong><em> POTENTIAL INCOMPATIBILITY </em></strong></p><p>Own Id: OTP-19431 Aux Id: <a href="https://github.com/erlang/otp/pull/9299" title="">PR-9299</a>, <a href="https://github.com/erlang/otp/pull/9610" title="">PR-9610</a></p></li><li><p>Defining a fun in terms of an imported function is not allowed. Before this release, the compiler would not catch this kind of error if the name of the imported function happened to be a BIF.  Consider this example:</p><pre><code class="makeup erlang" translate="no"><span class="p">-</span><span class="na">module</span><span class="p" data-group-id="6462508296-1">(</span><span class="ss">fun_example</span><span class="p" data-group-id="6462508296-1">)</span><span class="p">.</span><span class="w">
</span><span class="p">-</span><span class="na">export</span><span class="p" data-group-id="6462508296-2">(</span><span class="p" data-group-id="6462508296-3">[</span><span class="ss">foo</span><span class="p">/</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="ss">bar</span><span class="p">/</span><span class="mi">0</span><span class="p" data-group-id="6462508296-3">]</span><span class="p" data-group-id="6462508296-2">)</span><span class="p">.</span><span class="w">
</span><span class="p">-</span><span class="na">import</span><span class="p" data-group-id="6462508296-4">(</span><span class="ss">m</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="6462508296-5">[</span><span class="ss">max</span><span class="p">/</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="ss">not_a_bif</span><span class="p">/</span><span class="mi">0</span><span class="p" data-group-id="6462508296-5">]</span><span class="p" data-group-id="6462508296-4">)</span><span class="p">.</span><span class="w">

</span><span class="nf">foo</span><span class="p" data-group-id="6462508296-6">(</span><span class="p" data-group-id="6462508296-6">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="k">fun</span><span class="w"> </span><span class="ss">max</span><span class="p">/</span><span class="mi">2</span><span class="p">.</span><span class="w">

</span><span class="nf">bar</span><span class="p" data-group-id="6462508296-7">(</span><span class="p" data-group-id="6462508296-7">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="k">fun</span><span class="w"> </span><span class="ss">not_a_bif</span><span class="p">/</span><span class="mi">0</span><span class="p">.</span></code></pre><p>The compiler in Erlang/OTP 27 would generate the following messages:</p><pre><code class="text">fun_example.erl:9:5: function not_a_bif/0 undefined
%    9|     fun not_a_bif/0.
%     |     ^

fun_example.erl:3:2: Warning: import directive overrides auto-imported BIF max/2 --
use &quot;-compile({no_auto_import,[max/2]}).&quot; to resolve name clash
%    3| -import(m, [max/2, not_a_bif/0]).
%     |  ^</code></pre><p>That is, there would be a (cryptic) error for <code class="inline">fun not_a_bif/0</code>, but only a warning for <code class="inline">fun max/2</code>.</p><p>When compiling with this release, both attempts to create a fun will result in error messages (as well as a warning):</p><pre><code class="text">fun_example.erl:6:5: creating a fun from imported name max/2 is not allowed
%    6|     fun max/2.
%     |     ^

fun_example.erl:9:5: creating a fun from imported name not_a_bif/0 is not allowed
%    9|     fun not_a_bif/0.
%     |     ^

fun_example.erl:3:2: Warning: import directive overrides auto-imported BIF max/2 --
use &quot;-compile({no_auto_import,[max/2]}).&quot; to resolve name clash
%    3| -import(m, [max/2, not_a_bif/0]).
%     |  ^</code></pre><p>Also, attempting to call a local function having the same name as auto-imported BIF would result in an error if the BIF was added to Erlang/OTP before R14, and a warning for newer BIFs. This has been changed to always emit a warning. For example:</p><pre><code class="makeup erlang" translate="no"><span class="p">-</span><span class="na">module</span><span class="p" data-group-id="6469036866-1">(</span><span class="ss">bif_example</span><span class="p" data-group-id="6469036866-1">)</span><span class="p">.</span><span class="w">
</span><span class="p">-</span><span class="na">export</span><span class="p" data-group-id="6469036866-2">(</span><span class="p" data-group-id="6469036866-3">[</span><span class="ss">bar</span><span class="p">/</span><span class="mi">1</span><span class="p" data-group-id="6469036866-3">]</span><span class="p" data-group-id="6469036866-2">)</span><span class="p">.</span><span class="w">

</span><span class="nf">bar</span><span class="p" data-group-id="6469036866-4">(</span><span class="n">B</span><span class="p" data-group-id="6469036866-4">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="nf">is_boolean</span><span class="p" data-group-id="6469036866-5">(</span><span class="n">B</span><span class="p" data-group-id="6469036866-5">)</span><span class="p">.</span><span class="w">

</span><span class="nf">is_boolean</span><span class="p" data-group-id="6469036866-6">(</span><span class="n">B</span><span class="p" data-group-id="6469036866-6">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
        </span><span class="n">B</span><span class="w"> </span><span class="o">=:=</span><span class="w"> </span><span class="ss">true</span><span class="w"> </span><span class="ow">orelse</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="o">=:=</span><span class="w"> </span><span class="ss">false</span><span class="p">.</span></code></pre><p>will now result in the following warning instead of an error:</p><pre><code class="text">if_example.erl:5:5: Warning: ambiguous call of overridden auto-imported BIF is_boolean/1 --
use erlang:is_boolean/1 or &quot;-compile({no_auto_import,[is_boolean/1]}).&quot; to resolve name clash
%    5|     is_boolean(B).
%     |     ^</code></pre><p>Own Id: OTP-19432 Aux Id: <a href="https://github.com/erlang/otp/pull/9246" title="">PR-9246</a></p></li><li><p>It is now possible to use any base for floating point numbers as described in <a href="https://www.erlang.org/eeps/eep-0075">EEP 75: Based Floating Point Literals</a>.</p><p>Computers represent floating point numbers in binary, but such numbers are typically printed using base ten, for example 0.314159265e1. To maintain exact bit-level precision when converting numbers to and from text, it is better to use a base that matches the internally used base, such as 16 for a compact but still exact representation, or 2 for visualizing or writing down the exact internal format. One particular case where such exact representations are useful is in code generating tools.</p><p>Examples:</p><pre><code class="makeup erlang" translate="no"><span class="gp unselectable">&gt; </span><span class="mi">2#0</span><span class="p">.</span><span class="mi">111</span><span class="p">.</span><span class="w">
</span><span class="mf">0.875</span><span class="gp unselectable">
&gt; </span><span class="mi">16#fefe</span><span class="p">.</span><span class="ss">fefe</span><span class="o">#</span><span class="ss">e16</span><span class="p">.</span><span class="w">
</span><span class="mf">1.2041849337671418e24</span></code></pre><p>Own Id: OTP-19452 Aux Id: <a href="https://github.com/erlang/otp/pull/9106" title="">PR-9106</a></p></li><li><p>The callback function <code class="inline">handle_continue/2</code> in <code class="inline">gen_server</code> callback modules is now cached like the others, thanks to code cleanup and optimization of the internal behaviour loop.</p><p>This should only improve performance, not affect functionality.</p><p>Own Id: OTP-19474 Aux Id: <a href="https://github.com/erlang/otp/pull/9333" title="">PR-9333</a></p></li><li><p>Encoding done by the <a href="json.html"><code class="inline">json</code></a> module has been optimized.</p><p>Own Id: OTP-19476 Aux Id: <a href="https://github.com/erlang/otp/pull/9251" title="">PR-9251</a></p></li><li><p>There is a new <a href="zstd.html"><code class="inline">zstd</code></a> module that does <a href="https://facebook.github.io/zstd/">Zstandard</a> compression.</p><p>Own Id: OTP-19477 Aux Id: <a href="https://github.com/erlang/otp/pull/9316" title="">PR-9316</a></p></li><li><p>Fixed licenses in files and added ORT curations to the following apps: otp, eldap, erl_interface, eunit, parsetools, stdlib, syntax_tools, and ERTS.</p><p>Own Id: OTP-19478 Aux Id: <a href="https://github.com/erlang/otp/pull/9376" title="">PR-9376</a>, <a href="https://github.com/erlang/otp/pull/9402" title="">PR-9402</a>, <a href="https://github.com/erlang/otp/pull/9819" title="">PR-9819</a></p></li><li><p>Functions of a module can now be grouped in the shell code completion by using the <em>group</em> key in the <em>-doc</em> attribute e.g. <code class="inline">-doc(#{group=&gt;&lt;&lt;&quot;Public API&quot;&gt;&gt;). fetch()-&gt;...</code>.</p><p>Functions, callbacks and types in the module reference documentation of OTP is now grouped using this feature.</p><p>Own Id: OTP-19483 Aux Id: <a href="https://github.com/erlang/otp/pull/9408" title="">PR-9408</a></p></li><li><p>Added calendar:universal_time_to_system_time/1,2 and calendar:local_time_to_system_time/1,2</p><p>Own Id: OTP-19505 Aux Id: <a href="https://github.com/erlang/otp/pull/9445" title="">PR-9445</a></p></li><li><p>Improve error messages for <a href="json.html#decode/1"><code class="inline">json:decode/1</code></a>.</p><p>Own Id: OTP-19508 Aux Id: <a href="https://github.com/erlang/otp/pull/9484" title="">PR-9484</a></p></li><li><p>ETS <code class="inline">heir</code> can be set without getting an <code class="inline">ETS-TRANSFER</code> message. Useful when the heir is a supervisor process that cannot handle custom messages.</p><p>Own Id: OTP-19512 Aux Id: <a href="https://github.com/erlang/otp/pull/7970" title="">PR-7970</a></p></li><li><p>Added support for the Unicode 16 standard.</p><p>Own Id: OTP-19516 Aux Id: <a href="https://github.com/erlang/otp/pull/9518" title="">PR-9518</a>, <a href="https://github.com/erlang/otp/pull/9141" title="">PR-9141</a></p></li><li><p>When documenting a function or type that needs to deal with durations, usually we can document it as &quot;time in milliseconds&quot;. Since the <code class="inline">timer</code> family of functions (<code class="inline">hms</code>, <code class="inline">hours</code>, <code class="inline">seconds</code>, ...) all return time in milliseconds, it is useful to be able to use this type in type specifications.</p><p>Own Id: OTP-19526 Aux Id: <a href="https://github.com/erlang/otp/pull/9515" title="">PR-9515</a></p></li><li><p>A new event time-out has been implemented in <code class="inline">gen_server</code>, that behaves more like the one in <code class="inline">gen_statem</code>.</p><p>See the type <code class="inline">gen_server:action/0</code> for <code class="inline">{timeout|hibernate,...}</code>, and also related functions.</p><p>Own Id: OTP-19537 Aux Id: <a href="https://github.com/erlang/otp/pull/9287" title="">PR-9287</a>, <a href="https://github.com/erlang/otp/pull/9615" title="">PR-9615</a>, <a href="https://github.com/erlang/otp/pull/9621" title="">PR-9621</a></p></li><li><p>Line numbers used to be reported in the following way:</p><pre><code class="makeup erlang" translate="no"><span class="gp unselectable">1&gt; </span><span class="nc">lists</span><span class="p">:</span><span class="nf">last</span><span class="p" data-group-id="5933282731-1">(</span><span class="p" data-group-id="5933282731-2">[</span><span class="p" data-group-id="5933282731-2">]</span><span class="p" data-group-id="5933282731-1">)</span><span class="p">.</span><span class="w">
</span><span class="gt">** exception error: no function clause matching lists:last([]) (lists.erl, line 389)</span></code></pre><p>Starting from Erlang/OTP 28, line numbers are now reported in the following way:</p><pre><code class="makeup erlang" translate="no"><span class="gp unselectable">1&gt; </span><span class="nc">lists</span><span class="p">:</span><span class="nf">last</span><span class="p" data-group-id="7453405791-1">(</span><span class="p" data-group-id="7453405791-2">[</span><span class="p" data-group-id="7453405791-2">]</span><span class="p" data-group-id="7453405791-1">)</span><span class="p">.</span><span class="w">
</span><span class="gt">** exception error: no function clause matching lists:last([]) (lists.erl:389)</span></code></pre><p>Own Id: OTP-19538 Aux Id: <a href="https://github.com/erlang/otp/pull/9468" title="">PR-9468</a></p></li><li><p>Upgrade pcre2 to 10.45</p><p>Own Id: OTP-19541 Aux Id: <a href="https://github.com/erlang/otp/pull/9582" title="">PR-9582</a></p></li><li><p>Added functions that produce utf-8 binaries instead of iolists. 
New functions are: <a href="io_lib.html#bformat/2"><code class="inline">io_lib:bformat/2</code></a>, <a href="io_lib.html#bformat/3"><code class="inline">io_lib:bformat/3</code></a>, <a href="io_lib.html#bfwrite/2"><code class="inline">io_lib:bfwrite/2</code></a>, <a href="io_lib.html#bfwrite/3"><code class="inline">io_lib:bfwrite/3</code></a>, <a href="io_lib.html#bwrite/2"><code class="inline">io_lib:bwrite/2</code></a> and <a href="io_lib.html#bwrite_string/3"><code class="inline">io_lib:bwrite_string/3</code></a>.</p><p>Own Id: OTP-19556 Aux Id: <a href="https://github.com/erlang/otp/pull/9772" title="">PR-9772</a></p></li><li><p>The license and copyright header has changed format to include an <code class="inline">SPDX-License-Identifier</code>. At the same time, most files have been updated to follow a uniform standard for license headers.</p><p>Own Id: OTP-19575 Aux Id: <a href="https://github.com/erlang/otp/pull/9670" title="">PR-9670</a></p></li><li><p>A list of PCRE2 incompatibilities is documented in a user's guide for stdlib.</p><p>Own Id: OTP-19578 Aux Id: <a href="https://github.com/erlang/otp/pull/9705" title="">PR-9705</a></p></li><li><p>Change automatic hibernation of static supervisors so that they will hibernate after being idle for 1 second instead of only after starting, dynamic supervisors (simple_one_for_one) will not be hibernated at all.  An option to the supervisor is added to make it configurable for the application. This option defaults to 1 second for static supervisors and to infinity for the simple_one_for_one supervisors.</p><p><strong><em> POTENTIAL INCOMPATIBILITY </em></strong></p><p>Own Id: OTP-19597 Aux Id: <a href="https://github.com/erlang/otp/pull/9680" title="">PR-9680</a></p></li></ul><h2 id="stdlib-6-2-2-2" class="section-heading"><a href="#stdlib-6-2-2-2" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 6.2.2.2</span></h2><h3 id="fixed-bugs-and-malfunctions-5" class="section-heading"><a href="#fixed-bugs-and-malfunctions-5" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>A set of small bugs in sort stability for `lists:sort/1` and `lists:keysort/1` has been fixed. The bug happened for only some, seemingly random, element sequences. Most sorts were stable.</p><p>Sort stability for `lists:sort/1` is only possible to observe when sorting lists with floating point and integer numbers of the same value.</p><p>For `lists:keysort/1` the list had to start with two tuples where the keys or the whole tuples compared equal.</p><p>Own Id: OTP-19673 Aux Id: ERIERL-1240</p></li></ul><h2 id="stdlib-6-2-2-1" class="section-heading"><a href="#stdlib-6-2-2-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 6.2.2.1</span></h2><h3 id="fixed-bugs-and-malfunctions-6" class="section-heading"><a href="#fixed-bugs-and-malfunctions-6" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>The <code class="inline">save_module/1</code> command in the shell now saves both the locally defined records and the imported records using the <code class="inline">rr/1</code> command.</p><p>Own Id: OTP-19647 Aux Id: <a href="https://github.com/erlang/otp/issues/9816" title="">GH-9816</a>, <a href="https://github.com/erlang/otp/pull/9897" title="">PR-9897</a></p></li><li><p>It's now possible to write <code class="inline">lists:map(fun is_atom/1, [])</code> or <code class="inline">lists:map(fun my_func/1, [])</code>, in the shell, instead of <code class="inline">lists:map(fun erlang:is_atom/1, [])</code> or <code class="inline">lists:map(fun shell_default:my_func/1, [])</code>.</p><p>Own Id: OTP-19649 Aux Id: <a href="https://github.com/erlang/otp/issues/9771" title="">GH-9771</a>, <a href="https://github.com/erlang/otp/pull/9898" title="">PR-9898</a></p></li><li><p>Properly strip the leading <code class="inline">/</code> and drive letter from filepaths when zipping and unzipping archives.</p><p>Thanks to Wander Nauta for finding and responsibly disclosing this vulnerability to the Erlang/OTP project.</p><p>Own Id: OTP-19653 Aux Id: <a href="https://nvd.nist.gov/vuln/detail/2025-4748" title="">CVE-2025-4748</a>, <a href="https://github.com/erlang/otp/pull/9941" title="">PR-9941</a></p></li><li><p>Shell no longer crashes when requesting to autocomplete map keys containing non-atoms.</p><p>Own Id: OTP-19659 Aux Id: <a href="https://github.com/erlang/otp/pull/9896" title="">PR-9896</a></p></li><li><p>A remote shell can now exit by closing the input stream, without terminating the remote node.</p><p>Own Id: OTP-19667 Aux Id: <a href="https://github.com/erlang/otp/pull/9912" title="">PR-9912</a></p></li></ul><h2 id="stdlib-6-2-2" class="section-heading"><a href="#stdlib-6-2-2" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 6.2.2</span></h2><h3 id="fixed-bugs-and-malfunctions-7" class="section-heading"><a href="#fixed-bugs-and-malfunctions-7" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Fixed crash when fetching <code class="inline">initial_call</code> when user code have modified the <code class="inline">process_dictionary</code>.</p><p>Own Id: OTP-19546 Aux Id: ERIERL-1205, <a href="https://github.com/erlang/otp/pull/9596" title="">PR-9596</a></p></li></ul><h2 id="stdlib-6-2-1" class="section-heading"><a href="#stdlib-6-2-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 6.2.1</span></h2><h3 id="fixed-bugs-and-malfunctions-8" class="section-heading"><a href="#fixed-bugs-and-malfunctions-8" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Fixed <a href="argparse.html#help/2"><code class="inline">argparse:help/2</code></a> to accept the program name as part of the command path.</p><p>Own Id: OTP-19397 Aux Id: <a href="https://github.com/erlang/otp/pull/9160" title="">PR-9160</a></p></li><li><p>Fixed <code class="inline">argparse:format_help/2</code> crash on 'hidden' command.</p><p>Own Id: OTP-19400 Aux Id: <a href="https://github.com/erlang/otp/pull/9151" title="">PR-9151</a>, <a href="https://github.com/erlang/otp/issues/9150" title="">GH-9150</a></p></li><li><p>Fixed the type specification for <a href="timer.html#sleep/1"><code class="inline">timer:sleep/1</code></a> by adding the value <code class="inline">infinity</code> to its input type.</p><p>Own Id: OTP-19442 Aux Id: <a href="https://github.com/erlang/otp/pull/9303" title="">PR-9303</a></p></li><li><p>Eliminated a crash in <a href="zip.html#unzip/1"><code class="inline">zip:unzip/1</code></a> while unzipping an archive where a directory within was read-only. This bug was introduced in Erlang/OTP 27.1.</p><p>Own Id: OTP-19447 Aux Id: <a href="https://github.com/erlang/otp/issues/9332" title="">GH-9332</a>, <a href="https://github.com/erlang/otp/pull/9335" title="">PR-9335</a></p></li><li><p>Fixed map comprehension result when a key value is replaced.</p><p>Own Id: OTP-19459 Aux Id: <a href="https://github.com/erlang/otp/issues/9348" title="">GH-9348</a>, <a href="https://github.com/erlang/otp/pull/9358" title="">PR-9358</a></p></li><li><p>Fixed <code class="inline">string:jaro_similarity/1</code> for matching strings of length 1.</p><p>Own Id: OTP-19468 Aux Id: <a href="https://github.com/erlang/otp/pull/9371" title="">PR-9371</a></p></li></ul><h2 id="stdlib-6-2" class="section-heading"><a href="#stdlib-6-2" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 6.2</span></h2><h3 id="fixed-bugs-and-malfunctions-9" class="section-heading"><a href="#fixed-bugs-and-malfunctions-9" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Made it possible to expand help text displayed by pressing ^[h by pressing ^[h again.</p><p>Own Id: OTP-19260 Aux Id: <a href="https://github.com/erlang/otp/pull/8884" title="">PR-8884</a></p></li><li><p>Defining a fun in the shell using the syntax <code class="inline">fun Name/Arity</code> would fail. This has been corrected so that the following now works:</p><pre><code class="makeup erlang" translate="no"><span class="gp unselectable">1&gt; </span><span class="n">F</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">fun</span><span class="w"> </span><span class="nb">is_atom</span><span class="p">/</span><span class="mi">1</span><span class="p">.</span><span class="w">
</span><span class="p">#</span><span class="n">Fun</span><span class="p">.</span><span class="ss">erl</span><span class="p">.</span><span class="mf">42.18682967</span><span class="o">&gt;</span><span class="gp unselectable">
&gt; </span><span class="n">F</span><span class="p" data-group-id="4465843701-1">(</span><span class="ss">a</span><span class="p" data-group-id="4465843701-1">)</span><span class="p">.</span><span class="w">
</span><span class="ss">true</span><span class="gp unselectable">
3&gt; </span><span class="n">Id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">fun</span><span class="w"> </span><span class="ss">id</span><span class="p">/</span><span class="mi">1</span><span class="p">.</span><span class="w">
</span><span class="p">#</span><span class="n">Fun</span><span class="p">.</span><span class="ss">erl</span><span class="p">.</span><span class="mf">42.18682967</span><span class="o">&gt;</span><span class="gp unselectable">
4&gt; </span><span class="n">Id</span><span class="p" data-group-id="4465843701-2">(</span><span class="mi">42</span><span class="p" data-group-id="4465843701-2">)</span><span class="p">.</span><span class="w">
</span><span class="gt">** exception error: undefined shell command id/1</span><span class="gp unselectable">
5&gt; </span><span class="nf">id</span><span class="p" data-group-id="4465843701-3">(</span><span class="n">I</span><span class="p" data-group-id="4465843701-3">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="n">I</span><span class="p">.</span><span class="w">
</span><span class="ss">ok</span><span class="gp unselectable">
6&gt; </span><span class="n">Id</span><span class="p" data-group-id="4465843701-4">(</span><span class="mi">42</span><span class="p" data-group-id="4465843701-4">)</span><span class="p">.</span><span class="w">
</span><span class="mi">42</span></code></pre><p>The Debugger has also been corrected to correctly handle this syntax for a BIF.</p><p>Own Id: OTP-19322 Aux Id: <a href="https://github.com/erlang/otp/issues/8963" title="">GH-8963</a>, <a href="https://github.com/erlang/otp/pull/8987" title="">PR-8987</a></p></li><li><p>Fixed a bug where completion of 'fun(' would cause the shell to crash.</p><p>Own Id: OTP-19351 Aux Id: <a href="https://github.com/erlang/otp/pull/9043" title="">PR-9043</a></p></li><li><p>Fixed a bug causing the shell to crash while trying to complete an expression starting with a '/' or a variable followed by '(' or '/'. E.g. Foo/ and Foo(.</p><p>Own Id: OTP-19361 Aux Id: <a href="https://github.com/erlang/otp/pull/9078" title="">PR-9078</a></p></li><li><p><a href="zip.html#extract/2"><code class="inline">zip:extract/2</code></a> with <code class="inline">keep_old_files</code> now respects the <code class="inline">cwd</code> option.</p><p>Own Id: OTP-19370 Aux Id: <a href="https://github.com/erlang/otp/pull/9097" title="">PR-9097</a>, <a href="https://github.com/erlang/otp/issues/9087" title="">GH-9087</a></p></li><li><p>Fixed an error in uri_string:percent_decode spec</p><p>Own Id: OTP-19380 Aux Id: <a href="https://github.com/erlang/otp/issues/8755" title="">GH-8755</a></p></li></ul><h3 id="improvements-and-new-features-2" class="section-heading"><a href="#improvements-and-new-features-2" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>Updated shell docs to display the type spec, that is, <code class="inline">h(erlang, min, 2)</code>) now prints the type spec and documentation in the shell.</p><pre><code class="makeup erlang" translate="no"><span class="gp unselectable">&gt; </span><span class="nf">h</span><span class="p" data-group-id="8528879524-1">(</span><span class="ss">erlang</span><span class="p">,</span><span class="ss">min</span><span class="p">,</span><span class="mi">2</span><span class="p" data-group-id="8528879524-1">)</span><span class="p">.</span><span class="w">
</span><span class="w">
  </span><span class="p">-</span><span class="na">spec</span><span class="w"> </span><span class="nf">min</span><span class="p" data-group-id="8528879524-2">(</span><span class="n">Term1</span><span class="p">,</span><span class="w"> </span><span class="n">Term2</span><span class="p" data-group-id="8528879524-2">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="n">Minimum</span><span class="w">
               </span><span class="k">when</span><span class="w"> </span><span class="n">Term1</span><span class="w"> </span><span class="p">:</span><span class="p">:</span><span class="w"> </span><span class="nf">term</span><span class="p" data-group-id="8528879524-3">(</span><span class="p" data-group-id="8528879524-3">)</span><span class="p">,</span><span class="w"> </span><span class="n">Term2</span><span class="w"> </span><span class="p">:</span><span class="p">:</span><span class="w"> </span><span class="nf">term</span><span class="p" data-group-id="8528879524-4">(</span><span class="p" data-group-id="8528879524-4">)</span><span class="p">,</span><span class="w"> </span><span class="n">Minimum</span><span class="w"> </span><span class="p">:</span><span class="p">:</span><span class="w"> </span><span class="nf">term</span><span class="p" data-group-id="8528879524-5">(</span><span class="p" data-group-id="8528879524-5">)</span><span class="p">.</span><span class="w">

  </span><span class="n">Returns</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">smallest</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">Term1</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">Term2</span><span class="p">.</span><span class="w"> </span><span class="n">If</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="ss">terms</span><span class="w"> </span><span class="ss">compare</span><span class="w"> </span><span class="ss">equal</span><span class="w"> </span><span class="ss">with</span><span class="w"> </span><span class="ss">the</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="ss">operator</span><span class="p">,</span><span class="w"> </span><span class="n">Term1</span><span class="w"> </span><span class="ss">is</span><span class="w"> </span><span class="ss">returned</span><span class="p">.</span></code></pre><p>Own Id: OTP-19234 Aux Id: <a href="https://github.com/erlang/otp/issues/8544" title="">GH-8544</a>, <a href="https://github.com/erlang/otp/pull/8833" title="">PR-8833</a></p></li><li><p>The <a href="../../apps/kernel/file.html#t:io_device/0"><code class="inline">file:io_device/0</code></a> type has been updated to clearly show the difference between a <code class="inline">raw</code> and <code class="inline">cooked</code> IoDevice.</p><p>Own Id: OTP-19301 Aux Id: <a href="https://github.com/erlang/otp/pull/8956" title="">PR-8956</a></p></li><li><p>Added <a href="json.html#format_key_value_list/3"><code class="inline">json:format_key_value_list/3</code></a> and
<a href="json.html#format_key_value_list_checked/3"><code class="inline">json:format_key_value_list_checked/3</code></a>.</p><p>Own Id: OTP-19320 Aux Id: <a href="https://github.com/erlang/otp/pull/8889" title="">PR-8889</a></p></li><li><p>Improved documentation of <a href="../../apps/erts/time_correction.html#timers">timers</a>.</p><p>Own Id: OTP-19360 Aux Id: ERIERL-1149, <a href="https://github.com/erlang/otp/pull/9062" title="">PR-9062</a></p></li><li><p>Added logging support to <a href="io.html#t:user/0"><code class="inline">io:user/0</code></a>, <a href="io.html#t:standard_io/0"><code class="inline">io:standard_io/0</code></a> and <a href="io.html#t:standard_error/0"><code class="inline">io:standard_error/0</code></a>. See <a href="io.html#setopts/2"><code class="inline">io:setopts/2</code></a> for more details.</p><p>Own Id: OTP-19372 Aux Id: <a href="https://github.com/erlang/otp/pull/8947" title="">PR-8947</a></p></li></ul><h2 id="stdlib-6-1-2" class="section-heading"><a href="#stdlib-6-1-2" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 6.1.2</span></h2><h3 id="fixed-bugs-and-malfunctions-10" class="section-heading"><a href="#fixed-bugs-and-malfunctions-10" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>With this change, uri_string:normalize assumes empty path (do not crash) when no path is provided in the URI map.</p><p>Own Id: OTP-19266 Aux Id: ERIERL-1127, <a href="https://github.com/erlang/otp/pull/8890" title="">PR-8890</a></p></li><li><p>Fixed spec for <a href="json.html#format/3"><code class="inline">json:format/3</code></a>.</p><p>Own Id: OTP-19286 Aux Id: <a href="https://github.com/erlang/otp/issues/8880" title="">GH-8880</a>, <a href="https://github.com/erlang/otp/pull/8914" title="">PR-8914</a></p></li></ul><h2 id="stdlib-6-1-1" class="section-heading"><a href="#stdlib-6-1-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 6.1.1</span></h2><h3 id="fixed-bugs-and-malfunctions-11" class="section-heading"><a href="#fixed-bugs-and-malfunctions-11" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Remove whitespace stripping of returned binaries in <a href="json.html#decode/3"><code class="inline">json:decode/3</code></a>.</p><p>Own Id: OTP-19227 Aux Id: ERIERL-1130, <a href="https://github.com/erlang/otp/pull/8809" title="">PR-8809</a></p></li><li><p>Fix <a href="zip.html#unzip/2"><code class="inline">zip:unzip/2</code></a> to not crash when extracting zip files with garbage in the Zip64 extra header. This bug was introduced in Erlang 27.1 and has so far only been seen on some archives creates by MS Excel.</p><p>Own Id: OTP-19241 Aux Id: <a href="https://github.com/erlang/otp/pull/8836" title="">PR-8836</a></p></li><li><p>With this change, shutdown procedure handles a race condition between supervisor executing a shutdown and child process termination from other reason.</p><p>Own Id: OTP-19256 Aux Id: <a href="https://github.com/erlang/otp/pull/8780" title="">PR-8780</a></p></li></ul><h2 id="stdlib-6-1" class="section-heading"><a href="#stdlib-6-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 6.1</span></h2><h3 id="fixed-bugs-and-malfunctions-12" class="section-heading"><a href="#fixed-bugs-and-malfunctions-12" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>The help printout for incorrect <a href="io.html#t:format/0"><code class="inline">io:format/0</code></a> strings now handles the <code class="inline">k</code> modifier correctly.</p><p>Own Id: OTP-19146 Aux Id: <a href="https://github.com/erlang/otp/pull/8611" title="">PR-8611</a>, <a href="https://github.com/erlang/otp/issues/8568" title="">GH-8568</a></p></li><li><p>Fixed a bug that caused the shell completion to crash when keyword and tuple appeared on the same line.</p><p>Own Id: OTP-19157 Aux Id: <a href="https://github.com/erlang/otp/pull/8638" title="">PR-8638</a></p></li><li><p>Due to PR-7419/OTP-18671, the cached internal value of the <code class="inline">callback_mode</code> started leaking out to <code class="inline">logger</code> reports, which could cause <code class="inline">logger</code> handlers to crash.  This has now been fixed to show the value that was set, as before caching.</p><p>Own Id: OTP-19164 Aux Id: <a href="https://github.com/erlang/otp/issues/8605" title="">GH-8605</a>, <a href="https://github.com/erlang/otp/pull/7419" title="">PR-7419</a>, OTP-18671</p></li><li><p>Fixed an emulator crash relating to compressed ETS tables.</p><p>Own Id: OTP-19176 Aux Id: <a href="https://github.com/erlang/otp/pull/8683" title="">PR-8683</a></p></li><li><p>The error description for <a href="maps.html#update/3"><code class="inline">maps:update/3</code></a> will no longer insist that the third argument is not a map when a key could not be found</p><p>Own Id: OTP-19189</p></li><li><p>Multiple issues have been corrected in the markdown parser that creates documentation for the shell. </p><p>The parser was incorrectly parsing formatted markdown (either bold or italics) within parenthesis. This used to not be shown correctly in the shell documentation <code class="inline">(_Option._)</code>, which was displayed verbatim. This fix makes <code class="inline">Option.</code> to appear in italics.</p><p>The markdown parser is also used in the creation of other documentation formats, so this was a bug that affected other generated documentation formats.</p><p>Own Id: OTP-19200 Aux Id: <a href="https://github.com/erlang/otp/issues/8738" title="">GH-8738</a>, <a href="https://github.com/erlang/otp/pull/8739" title="">PR-8739</a></p></li><li><p>Fixed category for some codepoint ranges in <code class="inline">unicode_util</code>.</p><p>Own Id: OTP-19210 Aux Id: <a href="https://github.com/erlang/otp/issues/8748" title="">GH-8748</a></p></li><li><p>Fixed <a href="argparse.html"><code class="inline">argparse</code></a> to print sub-commands help when available.</p><p>Own Id: OTP-19222 Aux Id: <a href="https://github.com/erlang/otp/pull/8777" title="">PR-8777</a></p></li></ul><h3 id="improvements-and-new-features-3" class="section-heading"><a href="#improvements-and-new-features-3" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>Class annotation to HTML from fenced blocks have been added.</p><p>Own Id: OTP-19105 Aux Id: <a href="https://github.com/erlang/otp/pull/8499" title="">PR-8499</a></p></li><li><p>Added JSON formatting functions for indented output.</p><p>Own Id: OTP-19112</p></li><li><p>Improved illegal pattern error for accidental map associations.</p><p>Own Id: OTP-19128 Aux Id: <a href="https://github.com/erlang/otp/pull/8555" title="">PR-8555</a></p></li><li><p>Progress reports for a dynamically started supervisor will now be logged at debug level.</p><p><strong><em> POTENTIAL INCOMPATIBILITY </em></strong></p><p>Own Id: OTP-19202 Aux Id: <a href="https://github.com/erlang/otp/pull/8261" title="">PR-8261</a>, <a href="https://github.com/erlang/otp/issues/8715" title="">GH-8715</a>, <a href="https://github.com/erlang/otp/pull/8741" title="">PR-8741</a></p></li><li><p>The <a href="zip.html"><code class="inline">zip</code></a> module has been updated with support for:</p><ul><li>zip64 archives - Archives larger than 4GB or with more than 2^32 entries.</li><li>extended timestamps - Higher resolution and in UTC.</li><li>UID/GID - Save and extract the original UID/GID.</li><li>Fixes so that permission mode attributes are correctly read and set for files in archives.</li><li><a href="zip.html#list_dir/2"><code class="inline">zip:list_dir/2</code></a> now also returns directories, not only files. (You can disable this behaviour by using the option <code class="inline">skip_directories</code>).</li></ul><p>Various bugs in the original implementation have also been fixed, such as:</p><ul><li>Correctly encode and decode the DOS timestamps for entries within an archive (that is the non-extended timestamp).</li><li>Fix DOS timestamps to be set to localtime instead of UTC (use extended timestamps for UTC timestamps).</li><li>Use the unix file attributes read from disk when creating archives instead of setting everything to 644.</li></ul><p>Own Id: OTP-19214 Aux Id: <a href="https://github.com/erlang/otp/pull/8765" title="">PR-8765</a></p></li></ul><h2 id="stdlib-6-0-1" class="section-heading"><a href="#stdlib-6-0-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 6.0.1</span></h2><h3 id="fixed-bugs-and-malfunctions-13" class="section-heading"><a href="#fixed-bugs-and-malfunctions-13" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Fix so that missing <code class="inline">-doc({file, File})</code> files only result in a warning and not an error.</p><p>Own Id: OTP-19099 Aux Id: <a href="https://github.com/erlang/otp/pull/8542" title="">PR-8542</a></p></li><li><p>Fixed <a href="json.html"><code class="inline">json</code></a> bugs, <a href="json.html#encode_key_value_list/2"><code class="inline">json:encode_key_value_list/2</code></a> did not generate arrays and <a href="json.html#decode/3"><code class="inline">json:decode/3</code></a> did not invoke the user callback for <code class="inline">0</code>.</p><p>Own Id: OTP-19106 Aux Id: <a href="https://github.com/erlang/otp/pull/8581" title="">PR-8581</a>, <a href="https://github.com/erlang/otp/issues/8580" title="">GH-8580</a>, <a href="https://github.com/erlang/otp/pull/8519" title="">PR-8519</a></p></li></ul><h2 id="stdlib-6-0" class="section-heading"><a href="#stdlib-6-0" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 6.0</span></h2><h3 id="fixed-bugs-and-malfunctions-14" class="section-heading"><a href="#fixed-bugs-and-malfunctions-14" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>The specs in module <a href="binary.html"><code class="inline">binary</code></a> has been updated to reflect what is allowed by the documentation.</p><p>Own Id: OTP-18684 Aux Id: <a href="https://github.com/erlang/otp/pull/7481" title="">PR-7481</a></p></li><li><p>Several functions in the <a href="binary.html"><code class="inline">binary</code></a> module would accept arguments of the wrong type under certain circumstances. In this release, they now raise an exception when incorrect types are given.</p><p>The following functions would accept an invalid pattern if the subject binary was empty or if the <code class="inline">{scope,{0,0}}</code> option was given:
<a href="binary.html#match/3"><code class="inline">binary:match/2,3</code></a>,
<a href="binary.html#matches/2"><code class="inline">binary:matches/2,3</code></a>,
<a href="binary.html#replace/3"><code class="inline">binary:replace/3,4</code></a>, and
<a href="binary.html#split/2"><code class="inline">binary:split/2,3</code></a></p><p>The call <code class="inline">binary:copy(&lt;&lt;1:1&gt;&gt;, 0)</code> would return an empty binary instead of raising an exception. Similarly, calls to <a href="binary.html#part/2"><code class="inline">binary:part/2,3</code></a> attempting to extract 0 bytes at position 0 of a bitstring would return an empty binary instead of raising an exception.</p><p>Own Id: OTP-18743 Aux Id: <a href="https://github.com/erlang/otp/pull/7607" title="">PR-7607</a>, <a href="https://github.com/erlang/otp/pull/7628" title="">PR-7628</a></p></li><li><p>The documentation for the preprocessor now mentions that <code class="inline">defined(Name)</code> can be called in the condition for an <code class="inline">-if</code> or <code class="inline">-elif</code> directive to test whether <code class="inline">Name</code> is the name of a defined macro. (This feature was implemented in OTP 21.)</p><p>If a function call in an <code class="inline">-if</code> or <code class="inline">-elif</code> with a name that is not the name of a guard BIF, there would not be a compilation error, but would instead cause the lines following the directive to be skipped. This has now been changed to be a compilation error.</p><p><strong><em> POTENTIAL INCOMPATIBILITY </em></strong></p><p>Own Id: OTP-18784 Aux Id: <a href="https://github.com/erlang/otp/issues/7706" title="">GH-7706</a>, <a href="https://github.com/erlang/otp/pull/7726" title="">PR-7726</a></p></li><li><p><code class="inline">get_until</code> requests using the I/O protocol now correctly return a binary or list when <code class="inline">eof</code> is the last item returned by the callback.</p><p>Own Id: OTP-18930 Aux Id: <a href="https://github.com/erlang/otp/pull/7993" title="">PR-7993</a>, <a href="https://github.com/erlang/otp/issues/4992" title="">GH-4992</a></p></li><li><p>The error handling the <code class="inline">simple_one_for_one</code> supervisor has been enhanced. A transient child returning <code class="inline">ignore</code> will no longer cause a crash.</p><p>Also, automatic shutdown has been disabled because it does not make sense for this supervisor type. That is was allowed is considered a bug. Therefore, we don't consider this an incompatible change.</p><p><strong><em> POTENTIAL INCOMPATIBILITY </em></strong></p><p>Own Id: OTP-19029 Aux Id: <a href="https://github.com/erlang/otp/pull/8230" title="">PR-8230</a></p></li><li><p>Fix shell expansion to not crash when expanding a map with non-atom keys and to not list zero arity functions when an argument has been given.</p><p>Own Id: OTP-19073 Aux Id: <a href="https://github.com/erlang/otp/pull/8375" title="">PR-8375</a>, <a href="https://github.com/erlang/otp/issues/8366" title="">GH-8366</a>, <a href="https://github.com/erlang/otp/issues/8365" title="">GH-8365</a>, <a href="https://github.com/erlang/otp/issues/8364" title="">GH-8364</a></p></li></ul><h3 id="improvements-and-new-features-4" class="section-heading"><a href="#improvements-and-new-features-4" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>The functions <a href="sets.html#is_equal/2"><code class="inline">is_equal/2</code></a>, <a href="sets.html#map/2"><code class="inline">map/2</code></a>, and <a href="sets.html#filtermap/2"><code class="inline">filtermap/2</code></a> have been added to the modules <a href="sets.html"><code class="inline">sets</code></a>, <a href="ordsets.html"><code class="inline">ordsets</code></a>, and <a href="gb_sets.html"><code class="inline">gb_sets</code></a>.</p><p>Own Id: OTP-18622 Aux Id: <a href="https://github.com/erlang/otp/pull/7183" title="">PR-7183</a>, <a href="https://github.com/erlang/otp/pull/7232" title="">PR-7232</a></p></li><li><p>The compiler now emits nicer error message for function head mismatches.
For example, given:</p><pre><code class="makeup erlang" translate="no"><span class="nf">a</span><span class="p" data-group-id="6883280495-1">(</span><span class="p" data-group-id="6883280495-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="ss">ok</span><span class="p">;</span><span class="w">
</span><span class="nf">a</span><span class="p" data-group-id="6883280495-2">(</span><span class="p">_</span><span class="p" data-group-id="6883280495-2">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="ss">error</span><span class="p">.</span></code></pre><p>Erlang/OTP 26 and earlier would emit a diagnostic similar to:</p><pre><code class="text">t.erl:6:1: head mismatch
%    6| a(_) -&gt; error.
%     | ^</code></pre><p>while in Erlang/OTP 27 the diagnostic is similar to:</p><pre><code class="text">t.erl:6:1: head mismatch: function a with arities 0 and 1 is regarded as two distinct functions. Is the number of arguments incorrect or is the semicolon in a/0 unwanted?
%    6| a(_) -&gt; error.
%     | ^</code></pre><p>Own Id: OTP-18648 Aux Id: <a href="https://github.com/erlang/otp/pull/7383" title="">PR-7383</a></p></li><li><p><a href="zip.html#create/2"><code class="inline">zip:create/2,3</code></a> will now tolerate POSIX timestamps in the provided <code class="inline">file_info</code> records.</p><p>Own Id: OTP-18668</p></li><li><p>The callback function <a href="gen_statem.html#c:handle_event/4"><code class="inline">gen_statem:handle_event/4</code></a> has been cached in the <code class="inline">gen_statem</code> engine to optimize callback call speed.</p><p>Own Id: OTP-18671 Aux Id: <a href="https://github.com/erlang/otp/pull/7419" title="">PR-7419</a></p></li><li><p>The type <code class="inline">beam_lib:beam/0</code> is now exported.</p><p>Own Id: OTP-18716 Aux Id: <a href="https://github.com/erlang/otp/pull/7534" title="">PR-7534</a></p></li><li><p>The documentation for the <a href="binary.html"><code class="inline">binary</code></a> module has been improved.</p><p>Own Id: OTP-18741 Aux Id: <a href="https://github.com/erlang/otp/pull/7585" title="">PR-7585</a></p></li><li><p><a href="binary.html#replace/3"><code class="inline">binary:replace/3,4</code></a> now supports using a fun for supplying the replacement binary.</p><p>Own Id: OTP-18742 Aux Id: <a href="https://github.com/erlang/otp/pull/7590" title="">PR-7590</a></p></li><li><p>Triple-Quoted Strings has been implemented as per <a href="https://www.erlang.org/eeps/eep-0064">EEP 64</a>. See <a href="../../system/data_types.html#string">String</a> in the Reference Manual.</p><p>Example:</p><pre><code class="makeup erlang" translate="no"><span class="gp unselectable">1&gt; </span><span class="s">&quot;&quot;</span><span class="s">&quot;
   a
   b
   c
   &quot;</span><span class="s">&quot;&quot;</span><span class="p">.</span><span class="w">
</span><span class="s">&quot;a\nb\nc&quot;</span></code></pre><p>Adjacent string literals without intervening white space is now a syntax error, to avoid possible confusion with triple-quoted strings. For example:</p><pre><code class="makeup erlang" translate="no"><span class="gp unselectable">1&gt; </span><span class="s">&quot;abc&quot;</span><span class="s">&quot;xyz&quot;</span><span class="p">.</span><span class="w">
</span><span class="s">&quot;xyz&quot;</span><span class="p">.</span><span class="w">
</span><span class="gt">* 1:6: adjacent string literals without intervening white space</span></code></pre><p><strong><em> POTENTIAL INCOMPATIBILITY </em></strong></p><p>Own Id: OTP-18750 Aux Id: OTP-18746, <a href="https://github.com/erlang/otp/pull/7313" title="">PR-7313</a>, <a href="https://github.com/erlang/otp/pull/7451" title="">PR-7451</a></p></li><li><p>The new function <a href="proc_lib.html#set_label/1"><code class="inline">proc_lib:set_label/1</code></a> can be used to add a descriptive term to any process that does not have a registered name. The name will be shown by tools such as <a href="c.html#i/0"><code class="inline">c:i/0</code></a>, <a href="../../apps/observer/observer.html"><code class="inline">observer</code></a>, and it will be included in crash reports produced by processes using <a href="gen_server.html"><code class="inline">gen_server</code></a>, <a href="gen_statem.html"><code class="inline">gen_statem</code></a>, <a href="gen_event.html"><code class="inline">gen_event</code></a>, and <a href="gen_fsm.html"><code class="inline">gen_fsm</code></a>.</p><p>The label for a process can be retrieved by calling <a href="proc_lib.html#get_label/1"><code class="inline">proc_lib:get_label/1</code></a>.</p><p>Note that those functions work on any process, not only processes that use <a href="proc_lib.html"><code class="inline">proc_lib</code></a>.</p><p>Example:</p><pre><code class="text">1&gt; self().
&lt;0.90.0&gt;
2&gt; proc_lib:set_label(my_label).
ok
3&gt; i().
    .
    .
    .
&lt;0.90.0&gt;              erlang:apply/2                        2586    75011    0
my_label              c:pinfo/2                               51
4&gt; proc_lib:get_label(self()).
my_label</code></pre><p>Own Id: OTP-18789 Aux Id: <a href="https://github.com/erlang/otp/pull/7720" title="">PR-7720</a>, <a href="https://github.com/erlang/otp/pull/8003" title="">PR-8003</a></p></li><li><p><code class="inline">-callback</code> attributes has been added to modules <a href="sys.html"><code class="inline">sys</code></a> and <a href="erl_error.html"><code class="inline">erl_error</code></a>.</p><p>Own Id: OTP-18793 Aux Id: <a href="https://github.com/erlang/otp/pull/7703" title="">PR-7703</a></p></li><li><p>Several new functions that accept funs have been added to module <a href="timer.html"><code class="inline">timer</code></a>.</p><p>Functions <a href="timer.html#apply_after/2"><code class="inline">apply_after/2</code></a>, <a href="timer.html#apply_interval/2"><code class="inline">apply_interval/2</code></a>, and <code class="inline">apply_repeatedly/2</code> accept a nullary fun as the second argument, while  functions <a href="timer.html#apply_after/3"><code class="inline">apply_after/3</code></a>, <a href="timer.html#apply_interval/3"><code class="inline">apply_interval/3</code></a>, and <code class="inline">apply_repeatedly/3</code> accept an n-ary fun as the second and a list of n arguments for the fun as the third argument.</p><p>Own Id: OTP-18808 Aux Id: <a href="https://github.com/erlang/otp/pull/7649" title="">PR-7649</a></p></li><li><p>Sigils on string literals have been implemented as per <a href="https://www.erlang.org/eeps/eep-0066">EEP 66</a>, that is: binary and string sigils in verbatim and escape characters variants, as well as a default (vanilla) Sigil.  All for ordinary strings and for triple-quoted strings (EEP 64). See <a href="../../system/data_types.html#sigil">Sigils in the Reference Manual</a>.</p><p>Examples:</p><pre><code class="makeup erlang" translate="no"><span class="gp unselectable">1&gt; </span><span class="s">~&quot;Björn&quot;</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="8485686092-1">&lt;&lt;</span><span class="s">&quot;Björn&quot;</span><span class="o">/</span><span class="ss">utf8</span><span class="p" data-group-id="8485686092-1">&gt;&gt;</span><span class="gp unselectable">
2&gt; </span><span class="s">~b&quot;Björn&quot;</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="8485686092-2">&lt;&lt;</span><span class="s">&quot;Björn&quot;</span><span class="o">/</span><span class="ss">utf8</span><span class="p" data-group-id="8485686092-2">&gt;&gt;</span><span class="gp unselectable">
3&gt; </span><span class="s">~S&quot;\s*(\w+)&quot;</span><span class="p">.</span><span class="w">
</span><span class="s">&quot;\\s*(\\w+)&quot;</span><span class="gp unselectable">
4&gt; </span><span class="s">~B&quot;\s*(\w+)&quot;</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="8485686092-3">&lt;&lt;</span><span class="s">&quot;\\s*(\\w+)&quot;</span><span class="p" data-group-id="8485686092-3">&gt;&gt;</span></code></pre><p>Own Id: OTP-18825 Aux Id: OTP-18750, <a href="https://github.com/erlang/otp/pull/7684" title="">PR-7684</a></p></li><li><p>Functions <a href="shell.html#default_multiline_prompt/1"><code class="inline">shell:default_multiline_prompt/1</code></a>, <a href="shell.html#inverted_space_prompt/1"><code class="inline">shell:inverted_space_prompt/1</code></a>, and 
<a href="shell.html#prompt_width/1"><code class="inline">shell:prompt_width/1</code></a> have been exported to help with custom prompt implementations.</p><p>Own Id: OTP-18834 Aux Id: <a href="https://github.com/erlang/otp/pull/7675" title="">PR-7675</a>, <a href="https://github.com/erlang/otp/pull/7816" title="">PR-7816</a></p></li><li><p>The shell now pages long output from the documentation help command (<code class="inline">h(Module)</code>), auto completions and the search command.</p><p>Own Id: OTP-18846 Aux Id: <a href="https://github.com/erlang/otp/pull/7845" title="">PR-7845</a></p></li><li><p>The <code class="inline">M-h</code> hotkey (Alt/Option-h) now outputs help for the module or function directly before the cursor.</p><p>Own Id: OTP-18847 Aux Id: <a href="https://github.com/erlang/otp/pull/7846" title="">PR-7846</a></p></li><li><p>Added support for adding a custom code formatter that formats your multi-line shell commands in your preferred formatting on submission. See <code class="inline">shell:format_shell_func/</code> and <a href="shell.html#erl_pp_format_func/1"><code class="inline">shell:erl_pp_format_func/1</code></a>.</p><p>Own Id: OTP-18848 Aux Id: <a href="https://github.com/erlang/otp/pull/7847" title="">PR-7847</a></p></li><li><p>Added shell functions for viewing, forgetting and saving locally defined functions, types and records.</p><p>Own Id: OTP-18852 Aux Id: <a href="https://github.com/erlang/otp/pull/7844" title="">PR-7844</a></p></li><li><p>Added <a href="string.html#jaro_similarity/2"><code class="inline">string:jaro_similarity/2</code></a>, which can be used to calculate the similarity between two strings.</p><p>Own Id: OTP-18865 Aux Id: <a href="https://github.com/erlang/otp/pull/7879" title="">PR-7879</a></p></li><li><p>The new function <a href="ets.html#update_element/4"><code class="inline">ets:update_element/4</code></a> is similar to <a href="ets.html#update_element/3"><code class="inline">ets:update_element/3</code></a>, but takes a default tuple as the fourth argument, which will be inserted if no previous record with that key exists.</p><p>Own Id: OTP-18870 Aux Id: <a href="https://github.com/erlang/otp/pull/7857" title="">PR-7857</a></p></li><li><p>Added functions to retrieve the next higher or lower key/element from <a href="gb_trees.html"><code class="inline">gb_trees</code></a> and <a href="gb_sets.html"><code class="inline">gb_sets</code></a>, as well as returning iterators that start at given keys/elements.</p><p>Own Id: OTP-18874 Aux Id: <a href="https://github.com/erlang/otp/pull/7745" title="">PR-7745</a></p></li><li><p>When the shell built-in function <a href="c.html#c/1" title=""><code class="inline">c/1,2</code></a> is used to re-compile a module, the current working directory of the original compilation is now added to the include path.</p><p>Own Id: OTP-18908 Aux Id: <a href="https://github.com/erlang/otp/pull/7957" title="">PR-7957</a></p></li><li><p>The <code class="inline">timer</code> module now uses a private table for its internal state, slightly improving its performance.</p><p>Own Id: OTP-18914 Aux Id: <a href="https://github.com/erlang/otp/pull/7973" title="">PR-7973</a></p></li><li><p><a href="https://www.erlang.org/eeps/eep-0059">EEP-59 - Documentation Attributes</a> has been implemented.</p><p>Documentation attributes can be used to document functions, types, callbacks, and modules.
The keyword <code class="inline">-moduledoc &quot;Documentation here&quot;.</code> is used to document modules, while <code class="inline">-doc &quot;Documentation here&quot;.</code> can be used on top of functions, types, and callbacks to document them, respectively.</p><ul><li><p>Types, callbacks, and function documentation can be set to <code class="inline">hidden</code> either via <code class="inline">-doc false</code> or <code class="inline">-doc hidden</code>. When documentation attributes mark a type as hidden, they will not be part of the documentation.</p></li><li><p>The documentation from <code class="inline">moduledoc</code> and <code class="inline">doc</code> gets added by default to the binary beam file, following the format of <a href="https://www.erlang.org/eeps/eep-0048">EEP-48</a>.</p></li><li><p>Using the compiler flag <code class="inline">warn_missing_doc</code> will raise a warning when
<code class="inline">-doc</code> attributes are missing in exported functions, types, and callbacks.</p></li><li><p>Using the compiler flag <code class="inline">warn_missing_spec_documented</code> will raise a warning when
spec attributes are missing in documented functions, types, and callbacks.</p></li><li><p><code class="inline">moduledoc</code>s and <code class="inline">doc</code>s may refer to external files to be embedded, such as <code class="inline">-doc {file, &quot;README.md&quot;}.</code>, which refers to the file <code class="inline">README.md</code> found in the current working directory.</p></li><li><p>The compiler warns about exported functions whose specs refer to hidden types. Thus, there will be warnings when a hidden type (meaning, the type is not part of the documentation) gets used in an exported function.</p></li></ul><p>Own Id: OTP-18916 Aux Id: <a href="https://github.com/erlang/otp/pull/7936" title="">PR-7936</a></p></li><li><p>New <a href="ets.html"><code class="inline">ets</code></a> functions <a href="ets.html#first_lookup/1"><code class="inline">ets:first_lookup/1</code></a>, <a href="ets.html#next_lookup/2"><code class="inline">ets:next_lookup/2</code></a>, <a href="ets.html#prev_lookup/2"><code class="inline">ets:prev_lookup/2</code></a> and <a href="ets.html#last_lookup/1"><code class="inline">ets:last_lookup/1</code></a>. Example: <code class="inline">ets:next_lookup/1</code> is equivalent to <a href="ets.html#next/2"><code class="inline">ets:next/2</code></a> followed by <a href="ets.html#lookup/2"><code class="inline">ets:lookup/2</code></a> with the next key. The new combined functions are more efficient and with guaranteed atomicity.</p><p>Own Id: OTP-18923 Aux Id: <a href="https://github.com/erlang/otp/pull/6791" title="">PR-6791</a></p></li><li><p>The <code class="inline">maybe</code> expression is now enabled by default.</p><p>To use <code class="inline">maybe</code> as an atom, it needs to be single-quoted. Alternatively, the <code class="inline">maybe</code> expression can be disabled by disabling the <code class="inline">maybe_expr</code> feature. That can be done by placing the following the line at the beginning of an Erlang source file:</p><pre><code class="makeup erlang" translate="no"><span class="p">-</span><span class="na">feature</span><span class="p" data-group-id="0515845606-1">(</span><span class="ss">maybe_expr</span><span class="p">,</span><span class="w"> </span><span class="ss">disable</span><span class="p" data-group-id="0515845606-1">)</span><span class="p">.</span></code></pre><p>Another way to disable the <code class="inline">maybe_expr</code> feature is by passing the <code class="inline">-disable-feature</code> option to <code class="inline">erlc</code>:</p><pre><code class="text">erlc -disable-feature maybe_expr some_file.erl</code></pre><p>Own Id: OTP-18944 Aux Id: <a href="https://github.com/erlang/otp/pull/8067" title="">PR-8067</a></p></li><li><p>The compiler will now raise a warning when updating record/map literals. As an example, consider this module:</p><pre><code class="makeup erlang" translate="no"><span class="p">-</span><span class="na">module</span><span class="p" data-group-id="8529331555-1">(</span><span class="ss">t</span><span class="p" data-group-id="8529331555-1">)</span><span class="p">.</span><span class="w">
</span><span class="p">-</span><span class="na">export</span><span class="p" data-group-id="8529331555-2">(</span><span class="p" data-group-id="8529331555-3">[</span><span class="ss">f</span><span class="p">/</span><span class="mi">0</span><span class="p" data-group-id="8529331555-3">]</span><span class="p" data-group-id="8529331555-2">)</span><span class="p">.</span><span class="w">
</span><span class="p">-</span><span class="na">record</span><span class="p" data-group-id="8529331555-4">(</span><span class="ss">r</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8529331555-5">{</span><span class="ss">a</span><span class="p">,</span><span class="ss">b</span><span class="p">,</span><span class="ss">c</span><span class="p" data-group-id="8529331555-5">}</span><span class="p" data-group-id="8529331555-4">)</span><span class="p">.</span><span class="w">

</span><span class="nf">f</span><span class="p" data-group-id="8529331555-6">(</span><span class="p" data-group-id="8529331555-6">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="o">#</span><span class="ss">r</span><span class="p" data-group-id="8529331555-7">{</span><span class="ss">a</span><span class="o">=</span><span class="mi">1</span><span class="p" data-group-id="8529331555-7">}</span><span class="o">#</span><span class="ss">r</span><span class="p" data-group-id="8529331555-8">{</span><span class="ss">b</span><span class="o">=</span><span class="mi">2</span><span class="p" data-group-id="8529331555-8">}</span><span class="p">.</span></code></pre><p>The compiler raises the following warning:</p><pre><code class="text">1&gt; c(t).
t.erl:6:12: Warning: expression updates a literal
%    6|     #r{a=1}#r{b=2}.
%     |            ^</code></pre><p>Own Id: OTP-18951 Aux Id: <a href="https://github.com/erlang/otp/pull/8069" title="">PR-8069</a></p></li><li><p>The documentation has been migrated to use Markdown and ExDoc.</p><p>Own Id: OTP-18955 Aux Id: <a href="https://github.com/erlang/otp/pull/8026" title="">PR-8026</a></p></li><li><p>Optimized <code class="inline">ets:foldl</code> and <code class="inline">ets:foldr</code> to use new <code class="inline">ets:next_lookup</code>. Also made them immune against table renaming.</p><p>Own Id: OTP-18993 Aux Id: <a href="https://github.com/erlang/otp/pull/8048" title="">PR-8048</a></p></li><li><p>Windows now supports all functions in <a href="math.html"><code class="inline">math</code></a>.</p><p>Own Id: OTP-19001 Aux Id: <a href="https://github.com/erlang/otp/pull/8164" title="">PR-8164</a></p></li><li><p><a href="erl_lint.html"><code class="inline">erl_lint</code></a> (and by extension the <a href="../../apps/compiler/compile.html"><code class="inline">compiler</code></a>) will now warn for code using deprecated callbacks.</p><p>The only callback currenly deprecated is <code class="inline">format_status/2</code> in <a href="gen_server.html#c:format_status/2"><code class="inline">gen_server</code></a>, <a href="gen_event.html#c:format_status/2"><code class="inline">gen_event</code></a> and <a href="gen_server.html#c:format_status/2"><code class="inline">gen_statem</code></a>.</p><p>You can use <code class="inline">nowarn_deprecated_callback</code> to silence the warning.</p><p>Own Id: OTP-19010 Aux Id: <a href="https://github.com/erlang/otp/pull/8205" title="">PR-8205</a></p></li><li><p>There is a new module <a href="json.html"><code class="inline">json</code></a> for encoding and decoding <a href="https://en.wikipedia.org/wiki/JSON">JSON</a>.</p><p>Both encoding and decoding can be customized. Decoding can be done in a SAX-like fashion and handle multiple documents and streams of data.</p><p>Own Id: OTP-19020 Aux Id: <a href="https://github.com/erlang/otp/pull/8111" title="">PR-8111</a></p></li></ul><h2 id="stdlib-5-2-3-5" class="section-heading"><a href="#stdlib-5-2-3-5" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 5.2.3.5</span></h2><h3 id="fixed-bugs-and-malfunctions-15" class="section-heading"><a href="#fixed-bugs-and-malfunctions-15" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>A set of small bugs in sort stability for `lists:sort/1` and `lists:keysort/1` has been fixed. The bug happened for only some, seemingly random, element sequences. Most sorts were stable.</p><p>Sort stability for `lists:sort/1` is only possible to observe when sorting lists with floating point and integer numbers of the same value.</p><p>For `lists:keysort/1` the list had to start with two tuples where the keys or the whole tuples compared equal.</p><p>Own Id: OTP-19673 Aux Id: ERIERL-1240</p></li></ul><h2 id="stdlib-5-2-3-4" class="section-heading"><a href="#stdlib-5-2-3-4" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 5.2.3.4</span></h2><h3 id="fixed-bugs-and-malfunctions-16" class="section-heading"><a href="#fixed-bugs-and-malfunctions-16" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>It's now possible to write <code class="inline">lists:map(fun is_atom/1, [])</code> or <code class="inline">lists:map(fun my_func/1, [])</code>, in the shell, instead of <code class="inline">lists:map(fun erlang:is_atom/1, [])</code> or <code class="inline">lists:map(fun shell_default:my_func/1, [])</code>.</p><p>Own Id: OTP-19649 Aux Id: GH-9771 PR-9898</p></li><li><p>Properly strip the leading <code class="inline">/</code> and drive letter from filepaths when zipping and unzipping archives.</p><p>Thanks to Wander Nauta for finding and responsibly disclosing this vulnerability to the Erlang/OTP project.</p><p>Own Id: OTP-19653 Aux Id: CVE-2025-4748 PR-9941</p></li><li><p>A remote shell can now exit by closing the input stream, without terminating the remote node.</p><p>Own Id: OTP-19667 Aux Id: PR-9912</p></li></ul><h2 id="stdlib-5-2-3-3" class="section-heading"><a href="#stdlib-5-2-3-3" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 5.2.3.3</span></h2><h3 id="fixed-bugs-and-malfunctions-17" class="section-heading"><a href="#fixed-bugs-and-malfunctions-17" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Fixed an error in uri_string:percent_decode spec</p><p>Own Id: OTP-19380 Aux Id: GH-8755</p></li></ul><h2 id="stdlib-5-2-3-2" class="section-heading"><a href="#stdlib-5-2-3-2" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 5.2.3.2</span></h2><h3 id="fixed-bugs-and-malfunctions-18" class="section-heading"><a href="#fixed-bugs-and-malfunctions-18" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>With this change, shutdown procedure handles a race condition between supervisor executing a shutdown and child process termination from other reason.</p><p>Own Id: OTP-19256 Aux Id: PR-8780</p></li><li><p>With this change, uri_string:normalize assumes empty path (do not crash) when no path is provided in the URI map.</p><p>Own Id: OTP-19266 Aux Id: ERIERL-1127, PR-8890</p></li></ul><h2 id="stdlib-5-2-3-1" class="section-heading"><a href="#stdlib-5-2-3-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 5.2.3.1</span></h2><h3 id="fixed-bugs-and-malfunctions-19" class="section-heading"><a href="#fixed-bugs-and-malfunctions-19" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Fixed a bug that caused the shell completion to crash when keyword and tuple appeared on the same line.</p><p>Own Id: OTP-19157 Aux Id: PR-8638</p></li></ul><h2 id="stdlib-5-2-3" class="section-heading"><a href="#stdlib-5-2-3" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 5.2.3</span></h2><h3 id="fixed-bugs-and-malfunctions-20" class="section-heading"><a href="#fixed-bugs-and-malfunctions-20" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Fix shell expansion of <code class="inline">-type a() :: $a.</code> in the erlang shell.</p><p>Own Id: OTP-19062</p></li><li><p>Fix the shell Job Control Mode to not crash when typing <code class="inline">TAB</code> or <code class="inline">CTRL+R</code>.</p><p>Own Id: OTP-19072 Aux Id: PR-8391</p></li></ul><h2 id="stdlib-5-2-2" class="section-heading"><a href="#stdlib-5-2-2" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 5.2.2</span></h2><h3 id="fixed-bugs-and-malfunctions-21" class="section-heading"><a href="#fixed-bugs-and-malfunctions-21" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Attempting to use the <code class="inline">maybe</code> construct in a macro argument could crash the compiler.</p><p>Own Id: OTP-19031 Aux Id: GH-8268</p></li></ul><h2 id="stdlib-5-2-1" class="section-heading"><a href="#stdlib-5-2-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 5.2.1</span></h2><h3 id="fixed-bugs-and-malfunctions-22" class="section-heading"><a href="#fixed-bugs-and-malfunctions-22" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>The help texts shown by <code class="inline">argparse</code> will now display sub-command arguments in the correct order.</p><p>Own Id: OTP-18900 Aux Id: PR-7945, GH-7934</p></li><li><p>Clarified the argparse documentation regarding the user-defined help template.</p><p>Own Id: OTP-18937</p></li><li><p>Fix shell expansion to not crash when expanding invalid using invalid atoms.</p><p>Own Id: OTP-18953 Aux Id: GH-8016 PR-8075</p></li></ul><h2 id="stdlib-5-2" class="section-heading"><a href="#stdlib-5-2" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 5.2</span></h2><h3 id="fixed-bugs-and-malfunctions-23" class="section-heading"><a href="#fixed-bugs-and-malfunctions-23" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Make <code class="inline">shell_docs</code> correctly trim the newline at the end of code blocks.</p><p>Own Id: OTP-18777 Aux Id: PR-7663</p></li><li><p>Replaced unintentional Erlang Public License 1.1 headers in some files with
the intended Apache License 2.0 header.</p><p>Own Id: OTP-18815 Aux Id: PR-7780</p></li><li><p>Fixed a bug where autocompletion could crash the shell when trying to expand a
nested tuple.</p><p>Own Id: OTP-18822 Aux Id: PR-7796</p></li><li><p>Removed auto closing feature, in autocompletion, for function arguments,
tuples, records and maps, since this could interfere with autocompletion of
atoms.</p><p>Own Id: OTP-18823</p></li><li><p>Fixed a bug where autocompletion string formatting would remove suggestions
that had the same name but different case.</p><p>Own Id: OTP-18824</p></li><li><p>Fix so that ctrl+h, ctrl+backspace in the shell only removes one character
instead of a whole word.</p><p>Own Id: OTP-18826 Aux Id: PR-7797</p></li><li><p>Fix so that its possible to override the default keyboard shortcuts for the
shell.</p><p>Own Id: OTP-18827 Aux Id: PR-7797</p></li><li><p>Allow shell local func v(), in a restricted shell</p><p>Own Id: OTP-18828 Aux Id: PR-7799</p></li><li><p>Report syntax error when writing an invalid attribute like '1&gt; -hej.'</p><p>Own Id: OTP-18829 Aux Id: PR-7799</p></li><li><p>When attempting to match part of a record in the key of a map generator, the
entire record would be matched.</p><p>Own Id: OTP-18866 Aux Id: GH-7875, PR-7878</p></li></ul><h3 id="improvements-and-new-features-5" class="section-heading"><a href="#improvements-and-new-features-5" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>The warning for accidental use of a future triple-quoted string delimiter has
been upgraded to instead warn for adjacent strings without intervening white
space, which effectively is the same at a string start, but also covers the
same situation at a string end.</p><p>Own Id: OTP-18821 Aux Id: OTP-18746</p></li><li><p>The removal of the deprecated <code class="inline">slave</code> module, originally planned for OTP 27,
has been postponed to OTP 29.</p><p>Own Id: OTP-18840 Aux Id: PR-7629</p></li><li><p>Guards have been added to <code class="inline">gen_*:start*</code> API functions to catch bad arguments
earlier. Before this change, in some cases, a bad argument could tag along and
cause the server to fail later, right after start.</p><p>Own Id: OTP-18857 Aux Id: GH-7685</p></li></ul><h2 id="stdlib-5-1-1" class="section-heading"><a href="#stdlib-5-1-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 5.1.1</span></h2><h3 id="improvements-and-new-features-6" class="section-heading"><a href="#improvements-and-new-features-6" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>Garbage collect the shell process when reducing the amount of saved history
and results.</p><p>Own Id: OTP-18773 Aux Id: PR-7691</p></li></ul><h2 id="stdlib-5-1" class="section-heading"><a href="#stdlib-5-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 5.1</span></h2><h3 id="fixed-bugs-and-malfunctions-24" class="section-heading"><a href="#fixed-bugs-and-malfunctions-24" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>The compiler could run forever when compiling a call to
<a href="../../apps/erts/erlang.html#is_record/3"><code class="inline">is_record/3</code></a> with a huge positive tuple size. The call
<a href="../../apps/erts/erlang.html#is_record/3"><code class="inline">is_record(A, a, 0)</code></a> would crash the compiler when used in a
function body. When used in a guard the compiler would emit incorrect code
that would accept <code class="inline">{a&gt;</code> as a record.</p><p>Own Id: OTP-18605 Aux Id: GH-7298, GH-7317</p></li><li><p>Fix bug in <code class="inline">ets:tab2file</code> that could make it fail if another Erlang process
created the same file at the same time.</p><p>Own Id: OTP-18614 Aux Id: GH-7162, PR-7237</p></li><li><p>An <code class="inline">{else_clause,Value}</code> exception will now be reported nicely in the shell.</p><p>Own Id: OTP-18616 Aux Id: GH-7258</p></li><li><p>Correct return value for error case, so that it matches the documented and
intended return value {error, {already_started, pid()} when local
registered names are used.</p><p>Own Id: OTP-18627 Aux Id: PR-7072</p></li><li><p><code class="inline">sys:get_state/1,2</code> and <code class="inline">sys:replace_state/2,3</code> has been corrected to handle a
state named <code class="inline">error</code> as a state name, not as a failed system callback.</p><p>For the standard server behaviours this was an issue only for <code class="inline">gen_statem</code>
(and <code class="inline">gen_fsm</code>) when the state name was <code class="inline">error</code>, and for <code class="inline">gen_server</code> if the
complete state was <code class="inline">{error,_}</code>.</p><p>Own Id: OTP-18633</p></li><li><p>Multiple problems were fixed in <a href="filelib.html#safe_relative_path/2"><code class="inline">filelib:safe_relative_path/2</code></a>. If its second
argument was a path that contained symbolic links, an incorrect result patch
could be returned. Also, paths were sometimes falsely considered unsafe.</p><p>Own Id: OTP-18655 Aux Id: GH-6460, PR-7208</p></li><li><p>Fix deadlock when <code class="inline">erl.exe</code> is used as part of a pipe on Windows and trying to
set the encoding of the <code class="inline">standard_io</code> device.</p><p>Own Id: OTP-18675 Aux Id: PR-7473 GH-7459</p></li><li><p>Expanded the documentation about how to use the <code class="inline">standard_io</code>,
<code class="inline">standard_error</code> and <code class="inline">user</code> I/O devices.</p><p>Added the types <a href="io.html#t:standard_io/0"><code class="inline">io:standard_io/0</code></a>,
<code class="inline">io:standard:error/0</code> and <a href="io.html#t:user/0"><code class="inline">io:user/0</code></a>.</p><p>Own Id: OTP-18676 Aux Id: PR-7473 GH-7459</p></li><li><p>Fix <code class="inline">h/2,3</code> to properly render multi-clause documentation.</p><p>Own Id: OTP-18683 Aux Id: PR-7502</p></li><li><p>Timers created by <a href="timer.html#apply_after/4"><code class="inline">timer:apply_after/4</code></a>, <code class="inline">apply_interval/4</code>, and
<code class="inline">apply_repeatedly/4</code> would silently fail to do the apply if it was not
possible to spawn a process when the timer expired. This has now been
corrected, and if the spawn fails, the system will be taken down producing a
crash dump.</p><p>Own Id: OTP-18759 Aux Id: GH-7606</p></li><li><p>When an Erlang source file lacked a module definition, there would be a
spurious &quot;module name must not be empty&quot; diagnostic for each spec in the file.</p><p>Own Id: OTP-18763 Aux Id: GH-7655</p></li></ul><h3 id="improvements-and-new-features-7" class="section-heading"><a href="#improvements-and-new-features-7" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>The argument descriptions for option types in <code class="inline">argparse</code> have been made less
ambiguous.</p><p>Own Id: OTP-18679 Aux Id: ERIERL-965</p></li><li><p>Clarified the documentation of normal shutdown reason on <code class="inline">gen_server:call/2,3</code></p><p>Own Id: OTP-18690 Aux Id: PR-7511, GH-7510</p></li><li><p>Pattern matching and equivalence (<code class="inline">=:=</code>, <code class="inline">=/=</code>) comparisons on <code class="inline">0.0</code> will now
raise a warning, as it will no longer be considered equivalent to <code class="inline">-0.0</code> in
OTP 27.</p><p>If a match on <code class="inline">0.0</code> specifically is desired (distinct from <code class="inline">-0.0</code>), the
warning can be suppressed by writing <code class="inline">+0.0</code> instead.</p><p>The arithmetic comparison operators are unaffected, including arithmetic
equality (<code class="inline">==</code>).</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-18696</p></li><li><p>The semantics of the <code class="inline">gen_{server,statem,event}</code> behaviour's synchronous start
behaviour introduced in OTP-26.0 with OTP-18471, has been clarified in the
documentation.</p><p>Own Id: OTP-18705 Aux Id: GH-7524, OTP-18471, GH-6339, PR-6843</p></li><li><p>Added functionality to set a custom multiline prompt.</p><p>Own Id: OTP-18736 Aux Id: PR-7564</p></li><li><p>A warning for (accidental use of) Triple-Quoted Strings has been implemented
as per
<a href="https://github.com/erlang/eep/blob/master/eeps/eep-0064.md#backwards-incompatibility">EEP 64</a>.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-18746 Aux Id: PR-7313, PR-7456</p></li><li><p>The keyboard shortcuts for the shell are now configurable.</p><p>Own Id: OTP-18754 Aux Id: PR-7604 PR-7647</p></li></ul><h2 id="stdlib-5-0-2" class="section-heading"><a href="#stdlib-5-0-2" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 5.0.2</span></h2><h3 id="fixed-bugs-and-malfunctions-25" class="section-heading"><a href="#fixed-bugs-and-malfunctions-25" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Fix bug where when you entered Alt+Enter in the terminal, the cursor would
move to the last line, instead of moving to the next line.</p><p>Own Id: OTP-18580 Aux Id: PR-7242</p></li><li><p>Fix eof handling when reading from stdin when erlang is started using
<code class="inline">-noshell</code>.</p><p>Own Id: OTP-18640 Aux Id: PR-7384 GH-7368 GH-7286 GH-6881</p></li><li><p>Fixed problem where output would disappear if it was received after a prompt
was written in the shell.</p><p>Own Id: OTP-18652 Aux Id: PR-7242</p></li><li><p>The following functions are now much faster when given a long list or binary:</p><ul><li>erlang:list_to_integer/1</li><li>erlang:binary_to_integer/1</li><li>erlang:binary_to_integer/2</li><li>erlang:list_to_integer/2</li><li>string:to_integer/1</li></ul><p>Own Id: OTP-18659 Aux Id: PR-7426</p></li></ul><h2 id="stdlib-5-0-1" class="section-heading"><a href="#stdlib-5-0-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 5.0.1</span></h2><h3 id="fixed-bugs-and-malfunctions-26" class="section-heading"><a href="#fixed-bugs-and-malfunctions-26" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>The POSIX error <code class="inline">exdev</code> was sometimes incorrectly described as &quot;cross domain
link&quot; in some error messages.</p><p>Own Id: OTP-18578 Aux Id: GH-7213</p></li></ul><h2 id="stdlib-5-0" class="section-heading"><a href="#stdlib-5-0" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 5.0</span></h2><h3 id="fixed-bugs-and-malfunctions-27" class="section-heading"><a href="#fixed-bugs-and-malfunctions-27" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>All process calls in <code class="inline">dets</code> have been updated to use the receive queue
optimizations.</p><p>Own Id: OTP-18275 Aux Id: PR-6045</p></li><li><p><code class="inline">proc_lib:start*/*</code> has become synchronous when the started process fails.
This requires that a failing process use a new function
<code class="inline">proc_lib:init_fail/2,3</code>, or exits, to indicate failure. All OTP behaviours
have been fixed to do this.</p><p>All these start functions now consume the <code class="inline">'EXIT'</code> message from a process link
for all error returns. Previously it was only the <code class="inline">start_link/*</code> functions
that did this, and only when the started function exited, not when it used
<code class="inline">init_ack/1,2</code> or <code class="inline">init_fail/2,3</code> to create the return value.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-18471 Aux Id: GH-6339, PR-6843</p></li><li><p>Fixed a bug where <code class="inline">file:read(standard_io, ...)</code> unexpectedly returned <code class="inline">eof</code> in
binary mode.</p><p>Own Id: OTP-18486 Aux Id: PR-6881</p></li><li><p>In the shell, <code class="inline">v(N)</code> would fail to retrieve the command if the command's
return value was <code class="inline">undefined</code>.</p><p>Own Id: OTP-18548 Aux Id: PR-6967</p></li></ul><h3 id="improvements-and-new-features-8" class="section-heading"><a href="#improvements-and-new-features-8" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>The Erlang shell has been improved to support the following features:</p><ul><li>Auto-complete variables, record names, record field names, map keys,
function parameter types and filenames.</li><li>Open external editor in the shell (with C-o) to edit the current expression
in an editor.</li><li>Support defining records (with types), functions and function typespecs, and
custom types in the shell.</li><li>Do not save pager commands, and input to io:getline in history.</li></ul><p>Own Id: OTP-14835 Aux Id: PR-5924</p></li><li><p>Gen_server now caches external functions for use in handle_call, handle_cast
and handle_info.</p><p>Own Id: OTP-15597 Aux Id: PR-5831</p></li><li><p>The TTY/terminal subsystem has been rewritten by moving more code to Erlang
from the old linked-in driver and implementing all the I/O primitives needed
in a NIF instead.</p><p>On Unix platforms the user should not notice a lot of difference, besides
better handling of unicode characters and fixing of some long standing bugs.</p><p>Windows users will notice that erl.exe has the same functionality as a normal
Unix shell and that werl.exe has been removed and replaced with a symlink to
erl.exe. This makes the Windows Erlang terminal experience identical to that
of Unix.</p><p>The re-write brings with it a number of bug fixes and feature additions:</p><ul><li>The TTY is now reset when Erlang exits, fixing zsh to not break when
terminating an Erlang session.</li><li><code class="inline">standard_error</code> now uses the same unicode mode as <code class="inline">standard_io</code>.</li><li>Hitting backspace when searching the shell history with an empty search
string no longer breaks the shell.</li><li>Tab expansion now works on remote nodes started using the JCL interface.</li><li>It is now possible to configure the shell slogan and the session slogans
(that is the texts that appear when you start an Erlang shell). See the
kernel documentation for more details.</li><li>Added shell:start_interactive for starting the interactive shell from a
non-interactive Erlang session (for example an escript).</li><li>On Windows, when starting in detached mode the standard handler are now set
to <code class="inline">nul</code> devices instead of being unset.</li><li>Standard I/O now always defaults to <code class="inline">unicode</code> mode if supported. Previously
the default was <code class="inline">latin1</code> if the runtime system had been started with
<code class="inline">-oldshell</code> or <code class="inline">-noshell</code> (for example in an <code class="inline">escript</code>). To send raw bytes
over standard out, one now explicitly has to specify
<code class="inline">io:setopts(standard_io, [{encoding, latin1}]).</code></li></ul><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-17932 Aux Id: PR-6144 GH-3150 GH-3390 GH-4343 GH-4225</p></li><li><p>Added the <a href="zip.html#zip_get_crc32/2"><code class="inline">zip:zip_get_crc32/2</code></a> function to retrieve the CRC32 checksum from
an opened ZIP archive.</p><p>Own Id: OTP-18159 Aux Id: PR-6904</p></li><li><p>Added the options <code class="inline">post_process_args</code> and <code class="inline">detached</code> to the <code class="inline">peer:start</code>
function.</p><p>Own Id: OTP-18176 Aux Id: PR-6118</p></li><li><p>The <code class="inline">re:replace/3,4</code> functions now accept a fun as the replacement argument.</p><p>Own Id: OTP-18221 Aux Id: PR-6197</p></li><li><p>The performance of the <code class="inline">base64</code> module has been significantly improved. For
example, on an x86_64 system with the JIT both encode and decode are more than
three times faster than in Erlang/OTP 25.</p><p>Own Id: OTP-18228 Aux Id: GH-5639</p></li><li><p>Improved implementation of <a href="timer.html#apply_interval/4"><code class="inline">timer:apply_interval/4</code></a> reducing load on the timer
server, and introduction of the new function <a href="timer.html#apply_repeatedly/4"><code class="inline">timer:apply_repeatedly/4</code></a>.
<a href="timer.html#apply_repeatedly/4"><code class="inline">timer:apply_repeatedly/4</code></a> is similar to <a href="timer.html#apply_interval/4"><code class="inline">timer:apply_interval/4</code></a>, but
<a href="timer.html#apply_repeatedly/4"><code class="inline">timer:apply_repeatedly/4</code></a> prevents parallel execution of triggered <code class="inline">apply</code>
operations which <a href="timer.html#apply_interval/4"><code class="inline">timer:apply_interval/4</code></a> does not.</p><p>Own Id: OTP-18236 Aux Id: PR-6256</p></li><li><p>The <code class="inline">base64</code> module now supports encoding and decoding with an alternate URL
safe alphabet, and an option for accepting or adding missing <code class="inline">=</code> padding
characters.</p><p>Own Id: OTP-18247 Aux Id: PR-6280, PR-6711</p></li><li><p>Add <a href="shell.html#whereis/0"><code class="inline">shell:whereis/0</code></a> which can be used to locate the current shell process.</p><p>Own Id: OTP-18272 Aux Id: PR-6279</p></li><li><p>The Erlang shell's auto-completion when typing <code class="inline">tab</code> has been changed to
happen after the editing current line instead of before it.</p><p>This behaviour can be configured using a the <code class="inline">shell_expand_location</code> STDLIB
configuration parameter.</p><p>Own Id: OTP-18278 Aux Id: PR-6260</p></li><li><p>New function <a href="ets.html#lookup_element/4"><code class="inline">ets:lookup_element/4</code></a> with a <code class="inline">Default</code> argument returned if the
key did not exist in the table. The old <a href="ets.html#lookup_element/3"><code class="inline">ets:lookup_element/3</code></a> raises a
<code class="inline">badarg</code> exception which can be both inconvenient and slower.</p><p>Own Id: OTP-18279 Aux Id: PR-6234</p></li><li><p>Typing <code class="inline">Ctrl+L</code> in a shell now clears the screen and redraws the current line
instead of only redrawing the current line. To only redraw the current line,
you must now type <code class="inline">Alt+L</code>. This brings the behaviour of <code class="inline">Ctrl+L</code> closer to how
bash and other shells work.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-18285 Aux Id: PR-6262</p></li><li><p><code class="inline">peer</code> nodes using <code class="inline">standard_io</code> connections now include standard error from
the node in the io stream from the started node.</p><p>Own Id: OTP-18287 Aux Id: PR-5955</p></li><li><p>A limitation in the binary syntax has been removed. It is now possible to
match binary patterns in parallel. Example: <code class="inline">&lt;&lt;A:8&gt;&gt; = &lt;&lt;B:4,C:4&gt;&gt; = Bin</code></p><p>Own Id: OTP-18297 Aux Id: GH-6348</p></li><li><p>Improve type specification of <code class="inline">unicode:characters_to_list()</code>.</p><p>Own Id: OTP-18301 Aux Id: PR-6350</p></li><li><p>In the <code class="inline">lists</code> module, the <code class="inline">zip</code> family of functions now takes options to
allow handling lists of different lengths.</p><p>Own Id: OTP-18318 Aux Id: PR-6347</p></li><li><p>It is documented that <code class="inline">$\^X</code> is the ASCII code for Control X, where X is an
uppercase or lowercase letter. However, this notation would work for any
character X, even then it didn't make sense.</p><p>In Erlang/OTP 26, it is now documented that the following characters are also
allowed to follow the <code class="inline">\^</code> characters: <code class="inline">@</code>, <code class="inline">[</code>, <code class="inline">\</code>, <code class="inline">]</code>, <code class="inline">^</code>, <code class="inline">_</code>, and <code class="inline">?</code>.
Attempt to use other characters will be rejected with a compiler error.</p><p>The value for <code class="inline">$\^?</code> is now 127 (instead of 31 as in earlier releases).</p><p>Own Id: OTP-18337 Aux Id: GH-6477, PR-6503</p></li><li><p>The <a href="binary.html#encode_hex/2"><code class="inline">binary:encode_hex/2</code></a> function has been added to allow the encoded
hexadecimal digits to be in either lower or upper case.</p><p>Own Id: OTP-18354 Aux Id: PR-6297</p></li><li><p>Variants of <code class="inline">timer:tc()</code> with user specified time unit have been introduced.</p><p>Own Id: OTP-18355 Aux Id: PR-6507</p></li><li><p>New function <a href="math.html#tau/0"><code class="inline">math:tau/0</code></a>. Returns <code class="inline">2*math:pi()</code>.</p><p>Own Id: OTP-18361 Aux Id: PR-6536</p></li><li><p>The BIFs <a href="../../apps/erts/erlang.html#min/2"><code class="inline">min/2</code></a> and <a href="../../apps/erts/erlang.html#max/2"><code class="inline">max/2</code></a> are now allowed to be used
in guards and match specs.</p><p>Own Id: OTP-18367 Aux Id: GH-6544</p></li><li><p>Optimized <code class="inline">gen_server:multi_call()</code>.</p><p>Own Id: OTP-18385 Aux Id: PR-6698</p></li><li><p>Map comprehensions as suggested in EEP 58 has now been implemented.</p><p>Own Id: OTP-18413 Aux Id: EEP-58, PR-6727</p></li><li><p>Some map operations have been optimized by changing the internal sort order of
atom keys. This changes the (undocumented) order of how atom keys in small
maps are printed and returned by <a href="maps.html#to_list/1"><code class="inline">maps:to_list/1</code></a> and <a href="maps.html#next/1"><code class="inline">maps:next/1</code></a>. The new
order is unpredictable and may change between different invocations of the
Erlang VM.</p><p>For applications where order is important, there is a new function
<a href="maps.html#iterator/2"><code class="inline">maps:iterator/2</code></a> for creating iterators that return the map elements in a
deterministic order. There are also new modifiers <code class="inline">k</code> and <code class="inline">K</code> for the format
string for <a href="io.html#t:format/0"><code class="inline">io:format()</code></a> to support printing map elements
ordered.</p><p>Own Id: OTP-18414 Aux Id: PR-6151</p></li><li><p>Make gen_server fail &quot;silently&quot; with a new return value for init/1.</p><p>Own Id: OTP-18423 Aux Id: <a href="https://github.com/erlang/backlog/issues/142">https://github.com/erlang/backlog/issues/142</a></p></li><li><p>Improved the selective receive optimization, which can now be enabled for
references returned from other functions.</p><p>This greatly improves the performance of <code class="inline">gen_server:send_request/3</code>,
<a href="gen_server.html#wait_response/2"><code class="inline">gen_server:wait_response/2</code></a>, and similar functions.</p><p>Own Id: OTP-18431 Aux Id: PR-6739</p></li><li><p>It is no longer necessary to enable a feature in the runtime system in order
to load modules that are using it. It is sufficient to enable the feature in
the compiler when compiling it.</p><p>That means that to use feature <code class="inline">maybe_expr</code> in Erlang/OTP 26, it is sufficient
to enable it during compilation.</p><p>In Erlang/OTP 27, feature <code class="inline">maybe_expr</code> will be enabled by default, but it will
be possible to disable it.</p><p>Own Id: OTP-18445</p></li><li><p>Static supervisors are very idle processes after they have started so they
will now be hibernated after start to improve resource management.</p><p>Own Id: OTP-18474 Aux Id: PR-6895</p></li><li><p>Deprecates <code class="inline">dbg:stop_clear/0</code> because it is simply a function alias to
<a href="../../apps/runtime_tools/dbg.html#stop/0"><code class="inline">dbg:stop/0</code></a></p><p>Own Id: OTP-18478 Aux Id: GH-6903</p></li><li><p>Support has been added in <code class="inline">ms_transform</code> for the actions <code class="inline">caller_line/0</code>,
<code class="inline">current_stacktrace/0</code>, and <code class="inline">current_stacktrace/1</code>.</p><p>Own Id: OTP-18494 Aux Id: PR-6924</p></li><li><p>The family of enumeration functions in module <code class="inline">lists</code> has been extended with
<code class="inline">enumerate/3</code> that allows a step value to be supplied.</p><p>Own Id: OTP-18495 Aux Id: PR-6943</p></li><li><p>Update Unicode to version 15.0.0.</p><p>Own Id: OTP-18500</p></li><li><p>The regular expression library powering the <code class="inline">re</code> module is likely to be
changed in Erlang/OTP 27. See
<a href="../../upcoming_incompatibilities.html#new_re_engine">Upcoming Potential Incompatibilities</a>.</p><p>Own Id: OTP-18511 Aux Id: PR-7017</p></li><li><p>Improved the performance of <a href="sets.html#subtract/2"><code class="inline">sets:subtract/2</code></a> when subtracting a small number
of elements.</p><p>Own Id: OTP-18515 Aux Id: GH-6990</p></li><li><p>The linter will no longer raise warnings for underspecified opaque types.</p><p>Own Id: OTP-18518 Aux Id: GH-7015</p></li><li><p>Added the new built-in type <a href="../../apps/erts/erlang.html#t:dynamic/0"><code class="inline">dynamic/0</code></a> introduced in EEP-61, improving
support for gradual type checkers.</p><p>Own Id: OTP-18522</p></li><li><p>The by <code class="inline">gen_statem</code> previously used call proxy process that was used for
preventing late replies from reaching the client at timeout or connection loss
has been removed. It is no longer needed since <em>process aliases</em> take care of
this, are used, and supported by all Erlang nodes that an OTP 26 Erlang node
can communicate with.</p><p>Own Id: OTP-18537 Aux Id: PR-7081</p></li><li><p>Added the <code class="inline">argparse</code> module for simplified argument handling in escripts and
similar.</p><p>Own Id: OTP-18558 Aux Id: PR-6852</p></li><li><p>Added support for multiple line expressions and navigation in the shell. Added
new keybindings:</p><ul><li>navigate up (ctrl+up)/(alt+up)</li><li>navigate down (ctrl+down)/(alt+down)</li><li>insert newline in middle of line (alt+enter)</li><li>navigate top (alt+&lt;)/(alt+shift+up)</li><li>navigate bottom (alt+&gt;)/(alt+shift+down)</li><li>clear current expression (alt+c)</li><li>cancel search (alt+c)</li><li>opening editor on mac (option+o)/(alt+o)</li></ul><p>Modifies the prompt for new lines to make it clearer that the prompt has
entered multi-line mode. Supports terminal with small window size, recommend
not go lower than 7 rows and 40 columns. Modifies the search prompt to support
multi-line statements. Redraw the prompt after continuing from JCL menu.</p><p>Own Id: OTP-18575 Aux Id: PR-7169</p></li></ul><h2 id="stdlib-4-3-1-6" class="section-heading"><a href="#stdlib-4-3-1-6" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 4.3.1.6</span></h2><h3 id="fixed-bugs-and-malfunctions-28" class="section-heading"><a href="#fixed-bugs-and-malfunctions-28" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Fixed an error in uri_string:percent_decode spec</p><p>Own Id: OTP-19380 Aux Id: GH-8755</p></li></ul><h2 id="stdlib-4-3-1-5" class="section-heading"><a href="#stdlib-4-3-1-5" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 4.3.1.5</span></h2><h3 id="fixed-bugs-and-malfunctions-29" class="section-heading"><a href="#fixed-bugs-and-malfunctions-29" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>With this change, shutdown procedure handles a race condition between supervisor executing a shutdown and child process termination from other reason.</p><p>Own Id: OTP-19256 Aux Id: PR-8780</p></li><li><p>With this change, uri_string:normalize assumes empty path (do not crash) when no path is provided in the URI map.</p><p>Own Id: OTP-19266 Aux Id: ERIERL-1127, PR-8890</p></li></ul><h2 id="stdlib-4-3-1-4" class="section-heading"><a href="#stdlib-4-3-1-4" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 4.3.1.4</span></h2><h3 id="fixed-bugs-and-malfunctions-30" class="section-heading"><a href="#fixed-bugs-and-malfunctions-30" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Attempting to use the <code class="inline">maybe</code> construct in a macro argument could crash the compiler.</p><p>Own Id: OTP-19031 Aux Id: GH-8268</p></li></ul><h2 id="stdlib-4-3-1-3" class="section-heading"><a href="#stdlib-4-3-1-3" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 4.3.1.3</span></h2><h3 id="improvements-and-new-features-9" class="section-heading"><a href="#improvements-and-new-features-9" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>Garbage collect the shell process when reducing the amount of saved history
and results.</p><p>Own Id: OTP-18773 Aux Id: PR-7691</p></li></ul><h2 id="stdlib-4-3-1-2" class="section-heading"><a href="#stdlib-4-3-1-2" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 4.3.1.2</span></h2><h3 id="fixed-bugs-and-malfunctions-31" class="section-heading"><a href="#fixed-bugs-and-malfunctions-31" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>The following functions are now much faster when given a long list or binary:</p><ul><li>erlang:list_to_integer/1</li><li>erlang:binary_to_integer/1</li><li>erlang:binary_to_integer/2</li><li>erlang:list_to_integer/2</li><li>string:to_integer/1</li></ul><p>Own Id: OTP-18659 Aux Id: PR-7426</p></li></ul><h2 id="stdlib-4-3-1-1" class="section-heading"><a href="#stdlib-4-3-1-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 4.3.1.1</span></h2><h3 id="improvements-and-new-features-10" class="section-heading"><a href="#improvements-and-new-features-10" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>Static supervisors are very idle processes after they have started so they
will now be hibernated after start to improve resource management.</p><p>Own Id: OTP-18556</p></li></ul><h2 id="stdlib-4-3-1" class="section-heading"><a href="#stdlib-4-3-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 4.3.1</span></h2><h3 id="fixed-bugs-and-malfunctions-32" class="section-heading"><a href="#fixed-bugs-and-malfunctions-32" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>The type specs in the <code class="inline">erl_parse</code> module has been updated to include the
<code class="inline">maybe</code> construct and the <code class="inline">!</code> operator.</p><p>Own Id: OTP-18506 Aux Id: GH-6956</p></li></ul><h2 id="stdlib-4-3" class="section-heading"><a href="#stdlib-4-3" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 4.3</span></h2><h3 id="fixed-bugs-and-malfunctions-33" class="section-heading"><a href="#fixed-bugs-and-malfunctions-33" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Fixed a bug that would cause analysis to crash.</p><p>Own Id: OTP-18372 Aux Id: GH-6580</p></li><li><p>Fixed a crash when formatting stack traces for error reports.</p><p>Own Id: OTP-18375 Aux Id: GH-6591</p></li><li><p>Instead of crashing, the <a href="../../apps/erts/erlang.html#list_to_integer/1"><code class="inline">list_to_integer/1</code></a> and
<a href="../../apps/erts/erlang.html#list_to_integer/2"><code class="inline">list_to_integer/2</code></a> BIFs now raise the <code class="inline">system_limit</code>
exception for overlong lists that can't be converted to integers. Similarly,
the <a href="string.html#to_integer/1"><code class="inline">string:to_integer/1</code></a> BIF now returns <code class="inline">{error,system_limit}</code> for overlong
lists.</p><p>Own Id: OTP-18475 Aux Id: PR-6897</p></li></ul><h3 id="improvements-and-new-features-11" class="section-heading"><a href="#improvements-and-new-features-11" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>Removal of non-necessary <code class="inline">undefined</code> types added to the state's <code class="inline">supervisor</code>
record.</p><p>Own Id: OTP-18393 Aux Id: PR-6666</p></li></ul><h2 id="stdlib-4-2" class="section-heading"><a href="#stdlib-4-2" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 4.2</span></h2><h3 id="fixed-bugs-and-malfunctions-34" class="section-heading"><a href="#fixed-bugs-and-malfunctions-34" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p><code class="inline">erl_tar</code> can now read gzip-compressed tar files that are padded. There is a
new option <code class="inline">compressed_one</code> for <a href="../../apps/kernel/file.html#open/2"><code class="inline">file:open/2</code></a> that will read a single member
from a gzip file,</p><p>Own Id: OTP-18289 Aux Id: PR-6343</p></li><li><p>A concurrent call to <code class="inline">ets:rename</code> could cause <code class="inline">ets:delete_all_objects</code> to fail
halfway through with badarg.</p><p>Own Id: OTP-18292 Aux Id: PR-6366</p></li><li><p>It is not allowed to call functions from guards. The compiler failed to reject
a call in a guard when done by constructing a record with a default
initialization expression that called a function.</p><p>Own Id: OTP-18325 Aux Id: GH-6465, GH-6466</p></li><li><p>The compiler could crash when using a record with complex field initialization
expression as a filter in a list comprehension.</p><p>Own Id: OTP-18336 Aux Id: GH-6501, PR-6502</p></li><li><p><code class="inline">unicode:characters_to_binary()</code> could build unnecessarily large call stack.</p><p>Own Id: OTP-18351 Aux Id: ERIERL-885, PR-6529</p></li></ul><h3 id="improvements-and-new-features-12" class="section-heading"><a href="#improvements-and-new-features-12" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>Improve error message for ets:new/2 name clash. Say &quot;name already exists&quot;
instead of less specific &quot;invalid options&quot;.</p><p>Own Id: OTP-18283 Aux Id: PR-6338</p></li></ul><h2 id="stdlib-4-1-1" class="section-heading"><a href="#stdlib-4-1-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 4.1.1</span></h2><h3 id="fixed-bugs-and-malfunctions-35" class="section-heading"><a href="#fixed-bugs-and-malfunctions-35" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p><a href="peer.html"><code class="inline">peer</code></a> nodes failed to halt when the process supervising the control
connection crashed. When an alternative control connection was used, this
supervision process also quite frequently crashed when the <code class="inline">peer</code> node was
stopped by the node that started it which caused the <code class="inline">peer</code> node to linger
without ever halting.</p><p>Own Id: OTP-18249 Aux Id: PR-6301</p></li></ul><h2 id="stdlib-4-1" class="section-heading"><a href="#stdlib-4-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 4.1</span></h2><h3 id="fixed-bugs-and-malfunctions-36" class="section-heading"><a href="#fixed-bugs-and-malfunctions-36" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Fixed inconsistency bugs in <a href="../../apps/kernel/global.html"><code class="inline">global</code></a> due to <code class="inline">nodeup</code>/<code class="inline">nodedown</code> messages not
being delivered before/after traffic over connections. Also fixed various
other inconsistency bugs and deadlocks in both <a href="../../apps/kernel/global_group.html"><code class="inline">global_group</code></a> and <code class="inline">global</code>.</p><p>As building blocks for these fixes, a new BIF <a href="../../apps/erts/erlang.html#nodes/2"><code class="inline">erlang:nodes/2</code></a> has been
introduced and <a href="../../apps/kernel/net_kernel.html#monitor_nodes/2"><code class="inline">net_kernel:monitor_nodes/2</code></a> has been extended.</p><p>The <a href="../../apps/erts/erl_cmd.html#hidden"><code class="inline">-hidden</code></a> and
<a href="../../apps/erts/erl_cmd.html#connect_all"><code class="inline">-connect_all</code></a> command line arguments did
not work if multiple instances were present on the command line which has been
fixed. The new kernel parameter
<a href="../../apps/kernel/kernel_app.html#connect_all"><code class="inline">connect_all</code></a> has also been introduced
in order to replace the <code class="inline">-connect_all</code> command line argument.</p><p>Own Id: OTP-17934 Aux Id: PR-6007</p></li><li><p>Fix the <code class="inline">public_key:ssh*</code> functions to be listed under the correct release in
the Removed Functionality User's Guide.</p><p>Own Id: OTP-18139 Aux Id: PR-6060</p></li><li><p>The type spec for <code class="inline">format_status/1</code> in <code class="inline">gen_statem</code>, <code class="inline">gen_server</code> and
<code class="inline">gen_event</code> has been corrected to state that the return value is of the same
type as the argument (instead of the same value as the argument).</p><p>Own Id: OTP-18142 Aux Id: PR-6078</p></li><li><p>If the <code class="inline">timer</code> server child spec was already present in <code class="inline">kernel_sup</code> but it
was not started, the <code class="inline">timer</code> server would fail to start with an
<code class="inline">{error, already_present}</code> error instead of restarting the server.</p><p>Own Id: OTP-18146 Aux Id: PR-5983</p></li><li><p>When changing callback module in <code class="inline">gen_statem</code> the state_enter calls flag from
the old module was used in for the first event in the new module, which could
confuse the new module and cause malfunction. This bug has been corrected.</p><p>With this change some <code class="inline">sys</code> debug message formats have been modified, which
can be a problem for debug code relying on the format.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-18239</p></li></ul><h3 id="improvements-and-new-features-13" class="section-heading"><a href="#improvements-and-new-features-13" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>There is a new configure option, <code class="inline">--enable-deterministic-build</code>, which will
apply the <code class="inline">deterministic</code> compiler option when building Erlang/OTP. The
<code class="inline">deterministic</code> option has been improved to eliminate more sources of
non-determinism in several applications.</p><p>Own Id: OTP-18165 Aux Id: PR-5965</p></li><li><p>The <code class="inline">rfc339_to_system_time/1,2</code> functions now allows the minutes part to be
omitted from the time zone.</p><p>Own Id: OTP-18166 Aux Id: PR-6108</p></li><li><p>The <code class="inline">receive</code> statement in <code class="inline">gen_event</code> has been optimized to not use selective
receive (which was never needed, and could cause severe performance
degradation under heavy load).</p><p>Own Id: OTP-18194 Aux Id: PR-6199</p></li><li><p>Add new API function erl_features:configurable/0</p><p>Own Id: OTP-18199 Aux Id: PR-5790</p></li></ul><h2 id="stdlib-4-0-1" class="section-heading"><a href="#stdlib-4-0-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 4.0.1</span></h2><h3 id="fixed-bugs-and-malfunctions-37" class="section-heading"><a href="#fixed-bugs-and-malfunctions-37" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>In the initial release of Erlang/OTP 25, the expression bound to the <code class="inline">_</code>
pseudo-field in a record initialization would always be evaluated once, even
if all other fields in the record were explicitly initialized. That would
break the use case of binding the expression <code class="inline">error(...)</code> to <code class="inline">_</code> in order to
get an exception if not all fields were initialized.</p><p>The behavior of binding to <code class="inline">_</code> has been reverted to the pre-OTP 25 behavior,
that is, to not evaluate the expression if all fields have been bound to
explicit values.</p><p>Own Id: OTP-18110 Aux Id: GH-6000</p></li></ul><h2 id="stdlib-4-0" class="section-heading"><a href="#stdlib-4-0" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 4.0</span></h2><h3 id="fixed-bugs-and-malfunctions-38" class="section-heading"><a href="#fixed-bugs-and-malfunctions-38" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Improve the Erlang code linter's check of unused types.</p><p>Own Id: OTP-17370 Aux Id: GH-4784</p></li><li><p>Fix race condition in <a href="proc_lib.html#stop/3"><code class="inline">proc_lib:stop/3</code></a> where the process is not stopped when
the timeout given is very short.</p><p>Own Id: OTP-17480 Aux Id: GH-4853 PR-4872</p></li><li><p>Maps are now fully supported in by <code class="inline">ms_transform</code>.</p><p>Own Id: OTP-17518 Aux Id: GH-4915</p></li><li><p>Fix gen_server:call with the first argument as self() to throw an error
instead of failing with a timeout.</p><p>The same fix has also been done for gen_statem:call/3, gen_event:sync_notify/2
and any other functionality relying on the internal gen:call/3 function.</p><p>A similar fix was also done when using io:format/2 and the current
group_leader was set to the current process.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-17544 Aux Id: PR-5008</p></li><li><p>erl_pp printed unary - and + operators with a space between the operator and
the operand. This is fixed by not having any space in between.</p><p>Own Id: OTP-17566 Aux Id: PR-5095, GH-5093</p></li><li><p>Adjust uri_string:normalize behavior for URIs with undefined port (URI string
with a port colon but no port value or URI map with port =&gt; undefined).</p><p>Remove redundant normalization from http_request module.</p><p>Before this change, normalize would not remove port subcomponent in such cases
and could for example return &quot;<a href="http://localhost:%22">http://localhost:&quot;</a> URI.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-17627</p></li><li><p>Fix reduction counting bug in <code class="inline">re:run</code> that caused the function to yield too
frequently when doing <code class="inline">global</code> matches.</p><p>Own Id: OTP-17661 Aux Id: PR-5165</p></li><li><p>Fix the memory value returned from <code class="inline">ets:info(Tid,memory)</code> when the
<code class="inline">read_concurrency</code> option is used.</p><p>Before this fix the memory used by the scheduler specific lock cache lines was
not counted towards the total. This caused the returned memory usage to be
very incorrect on systems with many schedulers for tables with man locks.</p><p>Own Id: OTP-17832 Aux Id: PR-5494</p></li><li><p>Avoid confusion by correcting the argument order in the gen_event crash log
printout.</p><p>Own Id: OTP-17878</p></li><li><p>Fixed <a href="string.html#next_grapheme/1"><code class="inline">string:next_grapheme/1</code></a> to return an empty binary in the tail for
binary input for the last grapheme cluster.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-18009 Aux Id: PR-5785</p></li><li><p>Fixed type specifications of the <code class="inline">supervisor:sup_name/0</code> and
<a href="supervisor.html#t:sup_ref/0"><code class="inline">supervisor:sup_ref/0</code></a> types.</p><p>Own Id: OTP-18034 Aux Id: PR-4661, GH-4622</p></li><li><p>If a default record field initialization (<code class="inline">_ = Expr</code>) was used even though all
records fields were explicitly initialized, <code class="inline">Expr</code> would not be evaluated.
That would not be a problem, except when <code class="inline">Expr</code> would bind a variable
subsequently used, in which case the compiler would crash.</p><p>As an example, if record <code class="inline">#r{}</code> is defined to have only one field <code class="inline">a</code>, the
following code would crash the compiler:</p><p><code class="inline">#r{a=[],_=V=42}, V</code></p><p>To fix that problem, the compiler will make sure that <code class="inline">Expr</code> is always
evaluated at least once. The compiler will now rewrite the example to
essentially:</p><p><code class="inline">V=42, #r{a=[]}, V</code></p><p>Own Id: OTP-18083</p></li></ul><h3 id="improvements-and-new-features-14" class="section-heading"><a href="#improvements-and-new-features-14" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>Users can now configure ETS tables with the <code class="inline">{write_concurrency, auto}</code>
option. This option forces tables to automatically change the number of locks
that are used at run-time depending on how much concurrency is detected. The
<code class="inline">{decentralized_counters, true}</code> option is enabled by default when
<code class="inline">{write_concurrency, auto}</code> is active.</p><p>Benchmark results comparing this option with the other ETS optimization
options are available here:</p><p><a href="https://erlang.org/bench/ets_bench_result_lock_config.html">https://erlang.org/bench/ets_bench_result_lock_config.html</a></p><p>Own Id: OTP-15991 Aux Id: PR-5208</p></li><li><p>The <code class="inline">format_status/2</code> callback for <code class="inline">gen_server</code>, <code class="inline">gen_statem</code> and <code class="inline">gen_event</code>
has been deprecated in favor of the new <code class="inline">format_status/1</code> callback.</p><p>The new callback adds the possibility to limit and change many more things
than the just the state, such as the last received message, the reason for
terminating and more events specific to each type of behavior. See the
respective modules documentation for more details.</p><p>Own Id: OTP-17351 Aux Id: GH-4673 PR-4952</p></li><li><p>The <code class="inline">timer</code> module has been modernized and made more efficient, which makes
the timer server less susceptible to being overloaded. The <a href="timer.html#sleep/1"><code class="inline">timer:sleep/1</code></a>
function now accepts an arbitrarily large integer.</p><p>Own Id: OTP-17481 Aux Id: PR-4811</p></li><li><p>Add <code class="inline">lists:enumerate/[1,2]</code>.</p><p>Own Id: OTP-17523 Aux Id: PR-4928</p></li><li><p>The configuration files <a href="../../apps/erts/erl_cmd.html"><code class="inline">.erlang</code></a>,
<a href="../../system/distributed.html"><code class="inline">.erlang.cookie</code></a> and
<a href="beam_lib.html#module-erlang-crypt"><code class="inline">.erlang.crypt</code></a> can now be located in the XDG
Config Home directory.</p><p>See the documentation for each file and <a href="filename.html#basedir/2"><code class="inline">filename:basedir/2</code></a> for more details.</p><p>Own Id: OTP-17554 Aux Id: GH-5016 PR-5408 OTP-17821</p></li><li><p>Support <code class="inline">native</code> time unit in <code class="inline">calendar</code> functions <code class="inline">system_time_to_rfc3339/2</code>
and <code class="inline">rfc3339_to_system_time</code>.</p><p>Own Id: OTP-17592 Aux Id: ERIERL-663, PR-5243</p></li><li><p>The tagged tuple tests and fun-calls have been optimized and are now a little
bit cheaper than previously.</p><p>These optimizations become possible after making sure that all boxed terms
have at least one word allocated after the arity word. This has been
accomplished by letting all empty tuples refer to the same empty tuple literal
which also reduces memory usage for empty tuples.</p><p>Own Id: OTP-17608</p></li><li><p>The signal queue benchmark in parallel_messages_SUITE and the ETS benchmark in
ets_SUITE have benchmark result visualization HTML pages with &quot;fill-screen&quot;
buttons to make the graphs bigger. This button did not work as intended
before. When pressing the button for a graph, the last graph got replaced with
a bigger version and not the one over the button. This is now fixed.</p><p>Own Id: OTP-17630</p></li><li><p>The new module <code class="inline">peer</code> supersedes the <code class="inline">slave</code> module. The <code class="inline">slave</code> module is now
deprecated and will be removed in OTP 27.</p><p><code class="inline">peer</code> contains an extended and more robust API for starting erlang nodes.</p><p>Own Id: OTP-17720 Aux Id: PR-5162</p></li><li><p>This change introduces quote and unquote functions in uri_string module - a
replacement for deprecated encode and decode functions from http_uri.</p><p>Own Id: OTP-17778 Aux Id: GH-5368</p></li><li><p>In order to make it easier for the user to manage multiple outstanding
asynchronous <code class="inline">call</code> requests, new functionality utilizing request identifier
collections have been introduced in
<a href="../../apps/kernel/erpc.html#t:request_id_collection/0"><code class="inline">erpc</code></a>,
<a href="gen_server.html#t:request_id_collection/0"><code class="inline">gen_server</code></a>,
<a href="gen_statem.html#t:request_id_collection/0"><code class="inline">gen_statem</code></a>, and
<a href="gen_event.html#t:request_id_collection/0"><code class="inline">gen_event</code></a>.</p><p>Own Id: OTP-17784 Aux Id: PR-5792</p></li><li><p>Update to the Unicode 14.0 specification.</p><p>Own Id: OTP-17869 Aux Id: PR-5595</p></li><li><p>The following ets types have been renamed to a clearer name: <code class="inline">tab/0</code> to
<code class="inline">table/0</code> and <code class="inline">comp_match_spec/0</code> to <code class="inline">compiled_match_spec/0</code>.</p><p>The types <code class="inline">table_access/0</code> and <code class="inline">table_type/0</code> have been exported.</p><p>Own Id: OTP-17901 Aux Id: GH-4968 PR-5649</p></li><li><p>Add support for locating <code class="inline">.asn1</code> files to the default search rules of
<code class="inline">filelib:find_file/1</code> and <a href="filelib.html#find_source/1"><code class="inline">filelib:find_source/1</code></a>.</p><p>Own Id: OTP-17908 Aux Id: GH-5655 PR-5669</p></li><li><p>Type specifications have been added to the <code class="inline">gen_server</code>, and the documentation
has been updated to utilize this.</p><p>This surfaced a few type violations that has been corrected in <code class="inline">global</code>,
<code class="inline">logger_olp</code> and <code class="inline">rpc</code>.</p><p>Own Id: OTP-17915 Aux Id: PR-5751, GH-2375, GH-2690</p></li><li><p>The non-local function handler for the <code class="inline">erl_eval</code> can now be called with
either two or three arguments. When called with three arguments, the first
argument is the annotation for the node in the abstract format.</p><p>All errors during evaluation will now be passed through <a href="../../apps/erts/erlang.html#raise/3"><code class="inline">erlang:raise/3</code></a>. If
the restricted shell is active and it does not let <a href="../../apps/erts/erlang.html#raise/3"><code class="inline">erlang:raise/3</code></a> through,
evaluation errors will be printed in less clear way. See the documentation for
restricted shell in <code class="inline">shell</code>.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-17925 Aux Id: PR-5631</p></li><li><p>Added <a href="filelib.html#ensure_path/1"><code class="inline">filelib:ensure_path/1</code></a> that ensures that all directories for the given
path exists (unlike <a href="filelib.html#ensure_dir/1"><code class="inline">filelib:ensure_dir/1</code></a>, which will not create the last
segment of the path).</p><p>Own Id: OTP-17953 Aux Id: PR-5621</p></li><li><p>The functions <code class="inline">groups_from_list/2</code> and <code class="inline">groups_from_list/3</code> have been added to
the <code class="inline">maps</code> module.</p><p>Own Id: OTP-17969 Aux Id: PR-5588</p></li><li><p><code class="inline">gen_server</code> has been refactored to throw more readable exceptions when a
callback returns bad values in the <code class="inline">Timeout</code> field
(<code class="inline">timeout() | 'hibernate' | {'continue,_}</code>), and also to verify that argument
in the <code class="inline">gen_server:enter_loop/3,4,5</code> API function.</p><p>Own Id: OTP-17974 Aux Id: GH-5683</p></li><li><p>The functions <code class="inline">uniq/1</code> and <code class="inline">uniq/2</code> for removing duplicates have been added to
the <code class="inline">lists</code> module.</p><p>Own Id: OTP-17977 Aux Id: GH-5606, PR-5766</p></li><li><p>Added support for configurable features as described in EEP-60. Features can
be enabled/disabled during compilation with options
(<code class="inline">-enable-feature Feature</code>, <code class="inline">-disable-feature Feature</code> and
<code class="inline">+{feature, Feature, enable|disable}</code>) to <code class="inline">erlc</code> as well as with directives
(<code class="inline">-feature(Feature, enable|disable).</code>) in the file. Similar options can be
used to <code class="inline">erl</code> for enabling/disabling features allowed at runtime. The new
<code class="inline">maybe</code> expression (EEP-49) is fully supported as the feature <code class="inline">maybe_expr</code>.
The features support is documented in the reference manual.</p><p>Own Id: OTP-17988</p></li><li><p>The function <code class="inline">filename:safe_relative_path/1</code>, which has been deprecated since
OTP 25, has been removed. Use <a href="filelib.html#safe_relative_path/2"><code class="inline">filelib:safe_relative_path/2</code></a> instead.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-17991</p></li><li><p>A new PRNG have been added to the <code class="inline">rand</code> module: <code class="inline">mwc59</code> which has been
developed in collaboration with Sebastiano Vigna. It is intended for
applications that need really fast pseudo-random numbers, and it comes with
two output value scramblers, one fast and one thorough.</p><p>Two internal functions for the <code class="inline">exsp</code> generator have also been exported so
they can be used outside the <code class="inline">rand</code> plug-in framework to shave off some
overhead.</p><p>The internal <code class="inline">splitmix64</code> generator has also been exported which can be useful
for seeding other kinds of PRNG:s than its own.</p><p>Own Id: OTP-18011</p></li></ul><h2 id="stdlib-3-17-2-4" class="section-heading"><a href="#stdlib-3-17-2-4" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.17.2.4</span></h2><h3 id="fixed-bugs-and-malfunctions-39" class="section-heading"><a href="#fixed-bugs-and-malfunctions-39" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>The following functions are now much faster when given a long list or binary:</p><ul><li>erlang:list_to_integer/1</li><li>erlang:binary_to_integer/1</li><li>erlang:binary_to_integer/2</li><li>erlang:list_to_integer/2</li><li>string:to_integer/1</li></ul><p>Own Id: OTP-18659 Aux Id: PR-7426</p></li></ul><h2 id="stdlib-3-17-2-3" class="section-heading"><a href="#stdlib-3-17-2-3" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.17.2.3</span></h2><h3 id="improvements-and-new-features-15" class="section-heading"><a href="#improvements-and-new-features-15" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>Static supervisors are very idle processes after they have started so they
will now be hibernated after start to improve resource management.</p><p>Own Id: OTP-18556</p></li></ul><h2 id="stdlib-3-17-2-2" class="section-heading"><a href="#stdlib-3-17-2-2" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.17.2.2</span></h2><h3 id="fixed-bugs-and-malfunctions-40" class="section-heading"><a href="#fixed-bugs-and-malfunctions-40" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>It is not allowed to call functions from guards. The compiler failed to reject
a call in a guard when done by constructing a record with a default
initialization expression that called a function.</p><p>Own Id: OTP-18325 Aux Id: GH-6465, GH-6466</p></li></ul><h2 id="stdlib-3-17-2-1" class="section-heading"><a href="#stdlib-3-17-2-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.17.2.1</span></h2><h3 id="fixed-bugs-and-malfunctions-41" class="section-heading"><a href="#fixed-bugs-and-malfunctions-41" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>When changing callback module in <code class="inline">gen_statem</code> the state_enter calls flag from
the old module was used in for the first event in the new module, which could
confuse the new module and cause malfunction. This bug has been corrected.</p><p>With this change some <code class="inline">sys</code> debug message formats have been modified, which
can be a problem for debug code relying on the format.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-18239</p></li></ul><h2 id="stdlib-3-17-2" class="section-heading"><a href="#stdlib-3-17-2" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.17.2</span></h2><h3 id="fixed-bugs-and-malfunctions-42" class="section-heading"><a href="#fixed-bugs-and-malfunctions-42" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>The type specifications for <code class="inline">shell_docs:get_doc/3</code>,
<code class="inline">shell_docs:get_callback_doc/3</code>, and <code class="inline">shell_docs:get_type_doc/3</code> incorrectly
stated that the returned <code class="inline">Metadata</code> was an empty map.</p><p>Own Id: OTP-18081</p></li></ul><h2 id="stdlib-3-17-1" class="section-heading"><a href="#stdlib-3-17-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.17.1</span></h2><h3 id="fixed-bugs-and-malfunctions-43" class="section-heading"><a href="#fixed-bugs-and-malfunctions-43" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>The compilation time is no longer recorded in BEAM files. There remained
several undocumented functions that attempted to retrieve compilation times.
Those have now been removed.</p><p>Own Id: OTP-17962</p></li></ul><h2 id="stdlib-3-17" class="section-heading"><a href="#stdlib-3-17" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.17</span></h2><h3 id="fixed-bugs-and-malfunctions-44" class="section-heading"><a href="#fixed-bugs-and-malfunctions-44" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Fix rendering of nbsp on terminals that do not support unicode.</p><p>Own Id: OTP-17662 Aux Id: PR-5206</p></li><li><p>Improved the <a href="erl_error.html"><code class="inline">erl_error</code></a> printout for when <a href="re.html"><code class="inline">re</code></a> fails to compile a regular
expression to also print hints about why the compilation failed.</p><p>Own Id: OTP-17750 Aux Id: PR-5366</p></li><li><p>Fixed spec for <code class="inline">supervisor_bridge:start_link()</code>.</p><p>Own Id: OTP-17766 Aux Id: PR-5362</p></li><li><p>Added missing shutdown clauses in <code class="inline">supervisor</code> which could cause erroneous
error reports.</p><p>Own Id: OTP-17767 Aux Id: PR-5344</p></li></ul><h3 id="improvements-and-new-features-16" class="section-heading"><a href="#improvements-and-new-features-16" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>Add the <code class="inline">no_auto_import_types</code> to erl_lint to allow a module to define types
of the same name as a predefined type.</p><p>Own Id: OTP-17744 Aux Id: PR-5292</p></li></ul><h2 id="stdlib-3-16-1" class="section-heading"><a href="#stdlib-3-16-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.16.1</span></h2><h3 id="fixed-bugs-and-malfunctions-45" class="section-heading"><a href="#fixed-bugs-and-malfunctions-45" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Fixed a bug that could cause a child to become orphaned when a supervisor died
between unlinking and sending the shutdown signal to this child.</p><p>There was also a possibility for erratic supervisor reports caused by a race
between a supervisor shutting down a child and that child exiting by itself at
the same time.</p><p>Own Id: OTP-17649 Aux Id: GH-5193, PR-5201</p></li></ul><h2 id="stdlib-3-16" class="section-heading"><a href="#stdlib-3-16" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.16</span></h2><h3 id="fixed-bugs-and-malfunctions-46" class="section-heading"><a href="#fixed-bugs-and-malfunctions-46" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Fix <code class="inline">io:format</code> with <code class="inline">~p</code> to no longer interpret floats as printable
characters.</p><p>Own Id: OTP-17424 Aux Id: GH-4801 PR-4803</p></li><li><p>Fix specs for base64 encode/decode functions to also include 0.</p><p>Own Id: OTP-17429 Aux Id: GH-4761</p></li><li><p>The failing call <code class="inline">io:format(&quot;~p\n&quot;)</code> would result in a warning for line number
0 instead of the correct line and column numbers. This has been corrected, and
all warnings for failing calls to <a href="io.html#t:format/0"><code class="inline">io:format()</code></a> has been
rephrased to make it clearer exactly what the problem is.</p><p>Own Id: OTP-17430</p></li><li><p>When the options <code class="inline">warn_missing_spec</code> and <code class="inline">export_all</code> were given, there would
only be warnings for missing specs for functions that had been explicitly
exported using an <code class="inline">-export</code> attribute.</p><p>Own Id: OTP-17434 Aux Id: GH-4772</p></li><li><p>Calling <code class="inline">c:ls/1</code> with an atom whose contents is the the name of a file (as
opposed to a directory) would crash.</p><p>Own Id: OTP-17463 Aux Id: GH-4916</p></li><li><p>The <code class="inline">MODULE</code> and <code class="inline">MODULE_STRING</code> macros would always appear to be defined
(when tested by <code class="inline">-ifdef</code>), even though no <code class="inline">-module()</code> declaration had been
seen yet. Changed so that <code class="inline">-ifdef ?MODULE.</code> will not consider ?MODULE defined
if <code class="inline">-module()</code> has not been previously seen.</p><p>Own Id: OTP-17505 Aux Id: GH-4995</p></li><li><p>Fix bug with rendering of missing types and callbacks in shell_docs.</p><p>Own Id: OTP-17573 Aux Id: ERL-1264 GH-4270</p></li><li><p>When the <code class="inline">deterministic</code> option was given to the compiler, the <code class="inline">?FILE</code> macro
would be expanded to full path of the source file before the first <code class="inline">include</code>
directive and to base part of the filename after <code class="inline">include</code> directive.</p><p>Own Id: OTP-17581 Aux Id: PR-5141</p></li><li><p>Fixed broken <code class="inline">win32reg:delete_key</code> and fixed <code class="inline">win32reg:value</code> for <code class="inline">default</code>
value.</p><p>Own Id: OTP-17622 Aux Id: PR-5038</p></li><li><p>Fixed error information for the call <code class="inline">maps:get(some_key, #{})</code>.</p><p>Own Id: OTP-17634 Aux Id: GH-5196</p></li></ul><h3 id="improvements-and-new-features-17" class="section-heading"><a href="#improvements-and-new-features-17" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>Most output functions in the <code class="inline">io</code> module now print extra error information
when provided with invalid arguments. The functions are: <code class="inline">io:format</code>,
<code class="inline">io:fwrite</code>, <code class="inline">io:put_chars</code>, <code class="inline">io:nl</code> and <code class="inline">io:write</code>.</p><p>Own Id: OTP-17317 Aux Id: PR-4757</p></li><li><p>EEP-54 (Provide more information about errors) now includes two new return
values for the <code class="inline">format_error</code> callback, <code class="inline">general</code> and <code class="inline">reason</code>.</p><p>Multi-line error descriptions returned from a <code class="inline">format_error</code> callback are now
correctly indented.</p><p>The documentation for <a href="erl_error.html"><code class="inline">erl_error</code></a>, <a href="../../apps/erts/erlang.html#error/3"><code class="inline">error/3</code></a> and
<a href="../../system/errors.html">Errors and Error Handling</a> in the Erlang Reference
Manual have been extended.</p><p>Own Id: OTP-17454 Aux Id: PR-4764</p></li><li><p>In the documentation for the <code class="inline">lists</code> module, it has been clarified that
predicate funs must return a boolean.</p><p>Own Id: OTP-17503 Aux Id: GH-4985</p></li><li><p>The documentation for <code class="inline">c:c/1</code>, <code class="inline">c:c/2</code>, and <code class="inline">c:c/3</code> has been clarified.</p><p>Own Id: OTP-17571 Aux Id: GH-5103</p></li></ul><h2 id="stdlib-3-15-2" class="section-heading"><a href="#stdlib-3-15-2" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.15.2</span></h2><h3 id="fixed-bugs-and-malfunctions-47" class="section-heading"><a href="#fixed-bugs-and-malfunctions-47" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Fix a bug that could cause a crash when formatting tuples using the control
sequences <code class="inline">p</code> or <code class="inline">P</code> and limiting the output with the option <code class="inline">chars_limit</code>.</p><p>Own Id: OTP-17525 Aux Id: GH-5053</p></li></ul><h2 id="stdlib-3-15-1" class="section-heading"><a href="#stdlib-3-15-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.15.1</span></h2><h3 id="fixed-bugs-and-malfunctions-48" class="section-heading"><a href="#fixed-bugs-and-malfunctions-48" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Fix a bug that could cause a loop when formatting terms using the control
sequences p or P and limiting the output with the option <code class="inline">chars_limit</code>.</p><p>Own Id: OTP-17459 Aux Id: GH-4824, GH-4842</p></li></ul><h2 id="stdlib-3-15" class="section-heading"><a href="#stdlib-3-15" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.15</span></h2><h3 id="fixed-bugs-and-malfunctions-49" class="section-heading"><a href="#fixed-bugs-and-malfunctions-49" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Time-outs in <code class="inline">gen_statem</code> with relative time <code class="inline">0</code> did not behave quite
according to the intended model. This has now been corrected.</p><p>The correction introduces a small potential incompatibility e.g when combining
a state time-out with inserted events, and the inserted event does a state
change in the state with the time-out. Before this correction the state
time-out could be delivered even after the second state change, but now it is
guaranteed that a state time-out is only delivered in the state it was started
for, even in this corner case.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-15107 Aux Id: ERL-1381, PR-2813</p></li><li><p>Fix bugs in <code class="inline">erl_eval</code> concerning bitstring comprehensions.</p><p>Own Id: OTP-16865</p></li><li><p>File names that start with a dot (such as &quot;<code class="inline">.gitignore</code>&quot; are now treated as
file names and not extensions by <a href="filename.html#extension/1"><code class="inline">filename:extension/1</code></a> and
<a href="filename.html#rootname/1"><code class="inline">filename:rootname/1</code></a>.</p><p>Own Id: OTP-16905</p></li><li><p>Fixed a bug where <a href="beam_lib.html#chunks/3"><code class="inline">beam_lib:chunks/3</code></a> with the <code class="inline">allow_missing_chunks</code> option
would crash if a named chunk was missing.</p><p>Own Id: OTP-16950 Aux Id: ERL-1378</p></li><li><p>A floating point zero (0.0) can be both positive (+0.0) and negative (-0.0).
Multiple bugs in the compiler, runtime system, and STDLIB have been fixed to
ensure that the minus sign on 0.0 is not lost.</p><p>Own Id: OTP-17077 Aux Id: ERL-1431, PR-2903, PR-2905, PR-2906</p></li><li><p>Eliminated a Dialyzer crashed when the <code class="inline">-MMD</code> option is used to generate a
dependency file and a BEAM file a the same time.</p><p>Own Id: OTP-17118 Aux Id: PR-2825</p></li><li><p>Fixed bug in <a href="shell_docs.html"><code class="inline">shell_docs</code></a> and <code class="inline">erl_docgen</code> that interpreted <code class="inline">em</code> tags as
<code class="inline">strong</code>.</p><p>Own Id: OTP-17122</p></li><li><p>On Solaris, the <a href="math.html#acos/1"><code class="inline">math:acos/1</code></a> and <a href="math.html#asin/1"><code class="inline">math:asin/1</code></a> functions would not fail for
arguments outside the valid domain.</p><p>Own Id: OTP-17133</p></li><li><p>Silence <code class="inline">unused_record</code> warnings when using <code class="inline">ms_transform</code>. The parse
transform <code class="inline">ms_transform</code> replaces records with tuples, which can cause the
Erlang code linter to emit warnings about unused records.</p><p>Own Id: OTP-17186</p></li><li><p>Documented a deficiency in the <code class="inline">re</code> module regarding the <code class="inline">[:ascii:]</code> character
class matching Latin-1 characters.</p><p>Own Id: OTP-17222 Aux Id: GH-4544</p></li><li><p>Fixed <code class="inline">spec</code> of start functions in generic behaviors.</p><p>Own Id: OTP-17342 Aux Id: GH-4725 PR-4726</p></li><li><p>Supervisors rejected child specs with a shutdown value of 0.</p><p>Own Id: OTP-17364 Aux Id: PR-4747</p></li></ul><h3 id="improvements-and-new-features-18" class="section-heading"><a href="#improvements-and-new-features-18" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>In the <code class="inline">rand</code> module it is now possible to seed the default algorithm using an
algorithm alias: <code class="inline">default</code>.</p><p>Generating pseudo random binaries has been implemented with <a href="rand.html#bytes/1"><code class="inline">rand:bytes/1</code></a> and
<a href="rand.html#bytes_s/2"><code class="inline">rand:bytes_s/2</code></a>.</p><p>Own Id: OTP-14646 Aux Id: PR-2920</p></li><li><p>New functions have been added to the <code class="inline">proplists</code> module: <code class="inline">to_map/1,2</code> and
<code class="inline">from_map/1</code>.</p><p>Own Id: OTP-14647 Aux Id: PR-2910</p></li><li><p>New functions have been added to the <code class="inline">queue</code> module: <code class="inline">all/2</code>, <code class="inline">any/2</code>,
<code class="inline">delete/2</code>, <code class="inline">delete_r/2</code>, <code class="inline">delete_with/2</code>, and <code class="inline">delete_with_r/2</code>.</p><p>Own Id: OTP-14650 Aux Id: PR-2850</p></li><li><p>New function have been added to the <code class="inline">queue</code> module: <code class="inline">fold/2</code> and
<code class="inline">filtermap/2</code>.</p><p>Own Id: OTP-14793 Aux Id: PR-2791</p></li><li><p>Support for handling abstract code created before OTP R15 has been dropped.</p><p>Own Id: OTP-16678 Aux Id: PR-2627</p></li><li><p>Extended error information for failing BIF calls as proposed in
<a href="https://github.com/erlang/eep/blob/master/eeps/eep-0054.md">EEP 54</a> has been
implemented.</p><p>When a BIF call from the Erlang shell fails, more information about which
argument or arguments that were in error will be printed. The same extended
error information will by <code class="inline">proc_lib</code>, <code class="inline">common_test</code>, and <code class="inline">qlc</code> when BIF calls
fail.</p><p>For applications that wish to provide the same extended error information,
there are new functions <a href="erl_error.html#format_exception/3"><code class="inline">erl_error:format_exception/3</code></a> and
<a href="erl_error.html#format_exception/4"><code class="inline">erl_error:format_exception/4</code></a>.</p><p>There is a new <a href="../../apps/erts/erlang.html#error/3"><code class="inline">error/3</code></a> BIF that allows applications or
libraries to provide extended error information in the same way for their own
exceptions.</p><p>Own Id: OTP-16686</p></li><li><p>The <a href="../../system/ref_man_processes.html#process-aliases"><em>process alias</em></a> feature
as outlined by
<a href="https://github.com/erlang/eep/blob/master/eeps/eep-0053.md">EEP 53</a> has been
introduced. It is introduced in order to provide a lightweight mechanism that
can prevent late replies after timeout or connection loss. For more
information, see EEP 53 and the documentation of the new
<a href="../../apps/erts/erlang.html#alias/1"><code class="inline">alias/1</code></a> BIF and the new options to the
<a href="../../apps/erts/erlang.html#monitor/3"><code class="inline">monitor/3</code></a> BIF.</p><p>The <code class="inline">call</code> operation in the framework used by <code class="inline">gen_server</code>, <code class="inline">gen_statem</code>, and
<code class="inline">gen_event</code> has been updated to utilize alias in order to prevent late
responses. The <code class="inline">gen_statem</code> behavior still use a proxy process in the
distributed case, since it has always prevented late replies and aliases wont
work against pre OTP 24 nodes. The proxy process can be removed in OTP 26.</p><p>The alias feature also made it possible to introduce new functions similar to
the <a href="../../apps/kernel/erpc.html#receive_response/2"><code class="inline">erpc:receive_response()</code></a> function in the gen
behaviors, so the new functions
<a href="gen_server.html#receive_response/2"><code class="inline">gen_server:receive_response()</code></a>,
<a href="gen_statem.html#receive_response/2"><code class="inline">gen_statem:receive_response()</code></a>,
<a href="gen_event.html#receive_response/2"><code class="inline">gen_event:receive_response()</code></a> have also
been introduced.</p><p>Own Id: OTP-16718 Aux Id: PR-2735</p></li><li><p>Improved documentation about exit signals emitted when a <code class="inline">gen_server</code>
terminates.</p><p>Own Id: OTP-16910 Aux Id: PR-2771</p></li><li><p>New functions have been added to the <code class="inline">maps</code> module: <code class="inline">merge_with/3</code>,
<code class="inline">intersect/2</code>, <code class="inline">intersect_with/3</code>, <code class="inline">filtermap/2</code>, <code class="inline">from_keys/2</code>, and
<a href="maps.html#foreach/2"><code class="inline">maps:foreach/2</code></a>.</p><p><a href="maps.html#merge_with/3"><code class="inline">maps:merge_with/3</code></a> is the same as <code class="inline">merge/2</code> but takes an extra fun that is
used to combine items with the same key.</p><p><a href="maps.html#intersect/2"><code class="inline">maps:intersect/2</code></a> computes the intersection of two maps.</p><p><a href="maps.html#intersect_with/3"><code class="inline">maps:intersect_with/3</code></a> is the same as <code class="inline">intersect/2</code> but takes an extra fun
that is used to combine intersecting items.</p><p><a href="maps.html#filtermap/2"><code class="inline">maps:filtermap/2</code></a> allows filtering and mapping of a map in a single pass.</p><p><a href="maps.html#from_keys/2"><code class="inline">maps:from_keys/2</code></a> constructs a map from a list of keys and a single value and
can be used to to optimize sets operations such as from_list/1, filter/2,
intersection/2, and subtract/2.</p><p><a href="maps.html#foreach/2"><code class="inline">maps:foreach/2</code></a> allows iteration over a map without returning any value.</p><p>Own Id: OTP-16936 Aux Id: ERL-1367</p></li><li><p>The experimental HiPE application has been removed, together with all related
functionality in other applications.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-16963</p></li><li><p>The <code class="inline">filename:src/1</code> function which was deprecated in OTP 20 has been removed.
Use <code class="inline">filelib:find_source/1,3</code> instead.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-16971</p></li><li><p>The pretty printer for floating point number have been changed to make it
easier to see if the integer part of the number has been rounded. After the
change the digit that may have been rounded always appears last or just before
the exponent character (e or E). This is accomplished by always printing the
number using scientific notation if it is so large that the integer part could
be rounded.</p><p>Own Id: OTP-16980 Aux Id: ERL-1308</p></li><li><p>Accept references up to a size of 160-bits from remote nodes. This is the
first step in an upgrade path toward using references up to 160-bits in a
future OTP release.</p><p>Own Id: OTP-17005 Aux Id: OTP-16718</p></li><li><p>Add option <code class="inline">location</code> to <a href="erl_parse.html#abstract/2"><code class="inline">erl_parse:abstract/2</code></a>.</p><p>Own Id: OTP-17024</p></li><li><p>All long running functions in the maps API are now yielding. In previous
releases the functions <a href="maps.html#from_list/1"><code class="inline">maps:from_list/1</code></a>, <a href="maps.html#keys/1"><code class="inline">maps:keys/1</code></a> and <a href="maps.html#values/1"><code class="inline">maps:values/1</code></a>
did not yield. This could cause unfair scheduling of processes.</p><p>Own Id: OTP-17057</p></li><li><p>The <code class="inline">sets</code> module now has an optional map-based implementation, as described
in <code class="inline">EEP 50</code>.</p><p>To use this implementation, pass the <code class="inline">{version,2}</code> option to <a href="sets.html#new/1"><code class="inline">sets:new/1</code></a> or
<a href="sets.html#from_list/2"><code class="inline">sets:from_list/2</code></a>.</p><p>Own Id: OTP-17059 Aux Id: PR-2864</p></li><li><p>Added <a href="shell_docs.html#supported_tags/0"><code class="inline">shell_docs:supported_tags/0</code></a>. This function can be used to retrieve the
tags currently supported by <code class="inline">shell_docs</code>.</p><p>Own Id: OTP-17120</p></li><li><p>The <code class="inline">application/erlang+html</code> documentation storage format used by
<a href="shell_docs.html"><code class="inline">shell_docs</code></a> has been updated to include the tags <code class="inline">b</code>, <code class="inline">strong</code>, <code class="inline">h4</code>, <code class="inline">h5</code>
and <code class="inline">h6</code>.</p><p>Own Id: OTP-17121</p></li><li><p>Do not pretty-print <code class="inline">catch</code> expressions with unnecessary parentheses. The
re-write of the Erlang parser grammar in PR-2584 implies that parentheses
around <code class="inline">catch</code> expressions are in many cases no longer required.</p><p>Own Id: OTP-17169 Aux Id: PR-2584</p></li><li><p>Improved explanation of <code class="inline">{continue,Continue}</code> in <code class="inline">Module:init/1</code> of the
<code class="inline">gen_server</code> documentation.</p><p>Own Id: OTP-17171 Aux Id: PR-3011</p></li><li><p>The <code class="inline">erl_eval</code> module now accepts a map for keeping track of bindings. Using
an <code class="inline">orddict</code> for bindings will still work.</p><p>Own Id: OTP-17175</p></li><li><p>Documented <a href="epp.html#scan_erl_form/1"><code class="inline">epp:scan_erl_form/1</code></a> and added <a href="epp.html#scan_file/2"><code class="inline">epp:scan_file/2</code></a>.</p><p>Own Id: OTP-17199 Aux Id: PR-2658</p></li><li><p>The standard floating point printing algorithm used by the <code class="inline">io</code> and <code class="inline">io_lib</code>
modules has been changed from the algorithm described in [1] to the Ryu
algorithm [2]. This gives a significant speed improvement for the printing of
most floating point numbers and a small memory consumption improvement.</p><p>[1]: Robert G. Burger and R. Kent Dybvig. 1996. Printing floating-point
numbers quickly and accurately. In Proceedings of the ACM SIGPLAN 1996
conference on Programming language design and implementation (PLDI '96).
Association for Computing Machinery, New York, NY, USA, 108–116.
DOI:<a href="https://doi.org/10.1145/231379.231397">https://doi.org/10.1145/231379.231397</a></p><p>[2]: Ulf Adams. 2018. Ryū: fast float-to-string conversion. In Proceedings of
the 39th ACM SIGPLAN Conference on Programming Language Design and
Implementation (PLDI 2018). Association for Computing Machinery, New York, NY,
USA, 270–282. DOI:<a href="https://doi.org/10.1145/3192366.3192369">https://doi.org/10.1145/3192366.3192369</a></p><p>Thanks to Thomas Depierre</p><p>Own Id: OTP-17210</p></li><li><p>Add hex encoding and decoding functions in the binary module.</p><p>Own Id: OTP-17236 Aux Id: PR-3014</p></li><li><p>The undocumented and partially broken <code class="inline">ets:filter/3</code> function has been
removed.</p><p>Own Id: OTP-17263</p></li><li><p>Add support in <a href="shell_docs.html"><code class="inline">shell_docs</code></a> to display any <code class="inline">&quot;text&quot;</code> documentation format.
This means that <code class="inline">h(Module)</code> in the shell now can display the <code class="inline">&quot;text/markdown&quot;</code>
of Elixir documentation.</p><p>Own Id: OTP-17267</p></li><li><p>The internal hashing of keys within ETS tables of types <code class="inline">set</code>, <code class="inline">bag</code>,
<code class="inline">duplicate_bag</code> has been salted to diverge from <code class="inline">erlang:phash2</code>. This to avoid
bad hashing if <code class="inline">phash2</code> is used to distribute the keys over separate
tables/nodes.</p><p>Own Id: OTP-17276 Aux Id: PR-2979</p></li><li><p>Updated to the Unicode 13.0 specification.</p><p>Own Id: OTP-17327 Aux Id: PR-4707</p></li><li><p>Add compiler option <code class="inline">{nowarn_unused_record, RecordNames}</code>. Document compiler
option <code class="inline">nowarn_unused_type</code>.</p><p>Own Id: OTP-17330</p></li><li><p>Implementation of
<a href="https://github.com/erlang/eep/blob/master/eeps/eep-0056.md">EEP 56</a> in
supervisor. It adds the concept of <code class="inline">significant</code> children as well as the
<code class="inline">auto_shutdown</code> supervisor flag.</p><p>See the <a href="supervisor.html">supervisor manual page</a> for more information.</p><p>Own Id: OTP-17334 Aux Id: PR-4638, EEP-56</p></li><li><p>Fixed warnings in code matching on underscore prefixed variables.</p><p>Own Id: OTP-17385 Aux Id: OTP-17123</p></li></ul><h2 id="stdlib-3-14-2-3" class="section-heading"><a href="#stdlib-3-14-2-3" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.14.2.3</span></h2><h3 id="fixed-bugs-and-malfunctions-50" class="section-heading"><a href="#fixed-bugs-and-malfunctions-50" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>It is not allowed to call functions from guards. The compiler failed to reject
a call in a guard when done by constructing a record with a default
initialization expression that called a function.</p><p>Own Id: OTP-18325 Aux Id: GH-6465, GH-6466</p></li></ul><h2 id="stdlib-3-14-2-2" class="section-heading"><a href="#stdlib-3-14-2-2" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.14.2.2</span></h2><h3 id="fixed-bugs-and-malfunctions-51" class="section-heading"><a href="#fixed-bugs-and-malfunctions-51" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Fix a bug that could cause a crash when formatting tuples using the control
sequences <code class="inline">p</code> or <code class="inline">P</code> and limiting the output with the option <code class="inline">chars_limit</code>.</p><p>Own Id: OTP-17525 Aux Id: GH-5053</p></li></ul><h2 id="stdlib-3-14-2-1" class="section-heading"><a href="#stdlib-3-14-2-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.14.2.1</span></h2><h3 id="fixed-bugs-and-malfunctions-52" class="section-heading"><a href="#fixed-bugs-and-malfunctions-52" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Fix a bug that could cause a loop when formatting terms using the control
sequences p or P and limiting the output with the option <code class="inline">chars_limit</code>.</p><p>Own Id: OTP-17459 Aux Id: GH-4824, GH-4842</p></li></ul><h2 id="stdlib-3-14-2" class="section-heading"><a href="#stdlib-3-14-2" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.14.2</span></h2><h3 id="fixed-bugs-and-malfunctions-53" class="section-heading"><a href="#fixed-bugs-and-malfunctions-53" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Dictionaries that have become zipped by the zip module did not get executable
permission (for the file owner) which makes the files inside the dictionary
inaccessible. This is fixed by giving dictionaries inside a zip archive XRW
permission.</p><p>Own Id: OTP-17295 Aux Id: GH-4687</p></li></ul><h2 id="stdlib-3-14-1" class="section-heading"><a href="#stdlib-3-14-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.14.1</span></h2><h3 id="fixed-bugs-and-malfunctions-54" class="section-heading"><a href="#fixed-bugs-and-malfunctions-54" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Handle maps in <code class="inline">erl_parse:tokens()</code>.</p><p>Own Id: OTP-16978</p></li><li><p>The erlang shell function <code class="inline">rr</code> has been fixed to be able to read records from
files within a code archive.</p><p>Own Id: OTP-17182 Aux Id: PR-3002</p></li><li><p>If <code class="inline">beam_lib</code> is asked to return abstract code for a BEAM file produced by
Elixir and Elixir is not installed on the computer, <code class="inline">beam_lib</code> will no longer
crash, but will return an error tuple. The <code class="inline">cover:compile_beam()</code> and
<code class="inline">cover:compile_beam_directory()</code> functions have been updated to also return an
error tuple in that situation.</p><p>Own Id: OTP-17194 Aux Id: GH-4353</p></li><li><p>Correct example module <code class="inline">erl_id_trans</code> regarding the <code class="inline">{char, C}</code> type.</p><p>Own Id: OTP-17273</p></li></ul><h2 id="stdlib-3-14" class="section-heading"><a href="#stdlib-3-14" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.14</span></h2><h3 id="fixed-bugs-and-malfunctions-55" class="section-heading"><a href="#fixed-bugs-and-malfunctions-55" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>This change fixes the handling of deep lists in the path component when using
uri_string:recompose/1.</p><p>Own Id: OTP-16941</p></li><li><p>Fix <a href="shell_docs.html"><code class="inline">shell_docs</code></a> to clear shell decorations (bold/underline) when paginating
output.</p><p>Fix various small renderings issues when integrating <a href="shell_docs.html"><code class="inline">shell_docs</code></a> with edoc.</p><p>Own Id: OTP-17047</p></li></ul><h3 id="improvements-and-new-features-19" class="section-heading"><a href="#improvements-and-new-features-19" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>Improved the API and documentation of the uri_string module.</p><p>Added a new chapter to the Users Guide about Uniform Resource Identifiers and
their handling with the new API.</p><p>Added two new API functions: uri_string:allowed_characters/0 and
uri_string:percent_decode/1.</p><p>This change has been marked as potentially incompatible as
uri<em>string:normalize/2 used to decode percent-encoded character triplets that
corresponded to characters not in the reserved set. After this change,
uri_string:normalize/2 will only decode those percent-encoded triplets that
correspond to characters in the unreserved set (ALPHA / DIGIT / &quot;-&quot; / &quot;.&quot; /
&quot;</em>&quot; / &quot;~&quot;).</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-16460</p></li><li><p>The <code class="inline">shell_docs</code> module has been expanded with the possibility to configure
unicode, ansi and column size for the rendered text.</p><p>Own Id: OTP-16990</p></li></ul><h2 id="stdlib-3-13-2" class="section-heading"><a href="#stdlib-3-13-2" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.13.2</span></h2><h3 id="fixed-bugs-and-malfunctions-56" class="section-heading"><a href="#fixed-bugs-and-malfunctions-56" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>The functions <a href="digraph.html#in_edges/2"><code class="inline">digraph:in_edges/2</code></a> and <a href="digraph.html#out_edges/2"><code class="inline">digraph:out_edges/2</code></a> would return
false edges if called for a vertex that had a '_' atom in its name term.</p><p>Own Id: OTP-16655</p></li><li><p><code class="inline">filelib:wildcard(&quot;not-a-directory/..&quot;)</code> should return an empty list. On
Windows it returned <code class="inline">&quot;not-a-directory/..&quot;</code>.</p><p>Own Id: OTP-16700</p></li><li><p>Fix the typespec of shell_docs:render to use the correct type for an MFA.</p><p>Own Id: OTP-16739</p></li><li><p>Fix uri_string:recompose/1 when host is present but input path is not
absolute.</p><p>This change prevents the recompose operation to change the top level domain of
the host when the path does not start with a slash.</p><p>Own Id: OTP-16751 Aux Id: ERL-1283</p></li><li><p>The <code class="inline">epp</code> module would return a badly formed error term when an '<code class="inline">if</code>'
preprocessor directive referenced an undefined symbol. <a href="epp.html#format_error/1"><code class="inline">epp:format_error/1</code></a>
would crash when called with the bad error term.</p><p>Own Id: OTP-16816 Aux Id: ERL-1310</p></li><li><p><code class="inline">lists:sublist(List, Start, Len)</code> failed with an exception if
<code class="inline">Start &gt; length(List) + 1</code> even though it is explicitly documented that &quot;It is
not an error for <code class="inline">Start+Len</code> to exceed the length of the list&quot;.</p><p>Own Id: OTP-16830 Aux Id: ERL-1334, PR-2718</p></li></ul><h2 id="stdlib-3-13-1" class="section-heading"><a href="#stdlib-3-13-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.13.1</span></h2><h3 id="fixed-bugs-and-malfunctions-57" class="section-heading"><a href="#fixed-bugs-and-malfunctions-57" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>When a temporary child of a <code class="inline">simple_one_for_one supervisor</code> died, the internal
state of the supervisor would be corrupted in a way that would cause the
supervisor to retain the start arguments for subsequent children started by
the supervisor, causing unnecessary growth of the supervisor's heap. There
state corruption could potentially cause other problems as well.</p><p>Own Id: OTP-16804</p></li></ul><h2 id="stdlib-3-13" class="section-heading"><a href="#stdlib-3-13" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.13</span></h2><h3 id="fixed-bugs-and-malfunctions-58" class="section-heading"><a href="#fixed-bugs-and-malfunctions-58" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Compiling a match specification with excessive nesting caused the runtime
system to crash due to scheduler stack exhaustion. Instead of crashing the
runtime system, effected functions will now raise a <code class="inline">system_limit</code> error
exception in this situation.</p><p>Own Id: OTP-16431 Aux Id: ERL-592</p></li><li><p>Initialization of record fields using <code class="inline">_</code> is no longer allowed if the number
of affected fields is zero.</p><p>Own Id: OTP-16516</p></li><li><p>Fix bugs in <code class="inline">eval_bits</code>.</p><p>Own Id: OTP-16545</p></li></ul><h3 id="improvements-and-new-features-20" class="section-heading"><a href="#improvements-and-new-features-20" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>Improved the printout of single line logger events for most of the OTP
behaviours in STDLIB and Kernel. This includes <code class="inline">proc_lib</code>, <code class="inline">gen_server</code>,
<code class="inline">gen_event</code>, <code class="inline">gen_statem</code>, <code class="inline">gen_fsm</code>, <code class="inline">supervisor</code>, <code class="inline">supervisor_bridge</code> and
<code class="inline">application</code>.</p><p>Improved the <a href="../../apps/kernel/logger_formatter.html#chars_limit"><code class="inline">chars_limit</code></a> and
<a href="../../apps/kernel/logger_formatter.html#depth"><code class="inline">depth</code></a> handling in <code class="inline">proc_lib</code> and when
formatting of exceptions.</p><p>Own Id: OTP-15299</p></li><li><p>Remove usage and documentation of old requests of the I/O-protocol.</p><p>Own Id: OTP-15695</p></li><li><p>Improved ETS scalability of concurrent calls that change the size of a table,
like <a href="ets.html#insert/2"><code class="inline">ets:insert/2</code></a> and <a href="ets.html#delete/2"><code class="inline">ets:delete/2</code></a>.</p><p>This performance feature was implemented for <code class="inline">ordered_set</code> in OTP 22.0 and
does now apply for all ETS table types.</p><p>The improved scalability may come at the cost of longer latency of
<code class="inline">ets:info(T,size)</code> and <code class="inline">ets:info(T,memory)</code>. A new table option
<code class="inline">decentralized_counters</code> has therefore been added. It is default <code class="inline">true</code> for
<code class="inline">ordered_set</code> with <code class="inline">write_concurrency</code> enabled and default <code class="inline">false</code> for all
other table types.</p><p>Own Id: OTP-15744 Aux Id: OTP-15623, PR-2229</p></li><li><p>Handle Unicode filenames in the <code class="inline">zip</code> module.</p><p>Own Id: OTP-16005 Aux Id: ERL-1003, ERL-1150</p></li><li><p>Unicode support was updated to the Unicode 12.1 standard.</p><p>Own Id: OTP-16073 Aux Id: PR-2339</p></li><li><p>All of the modules <a href="proc_lib.html#start_monitor/3"><code class="inline">proc_lib</code></a>,
<a href="gen_server.html#start_monitor/3"><code class="inline">gen_server</code></a>,
<a href="gen_statem.html#start_monitor/3"><code class="inline">gen_statem</code></a>, and
<a href="gen_event.html#start_monitor/0"><code class="inline">gen_event</code></a> have been extended with a
<code class="inline">start_monitor()</code> function. For more information, see the documentation of
<code class="inline">start_monitor()</code> for these modules.</p><p>Own Id: OTP-16120 Aux Id: ERIERL-402, PR-2427</p></li><li><p>Updates for new <code class="inline">erlang:term_to_iovec()</code> BIF.</p><p>Own Id: OTP-16128 Aux Id: OTP-15618</p></li><li><p>Documented a quirk regarding extraction from file descriptors in <code class="inline">erl_tar</code>.</p><p>Own Id: OTP-16171 Aux Id: ERL-1057</p></li><li><p>Added <code class="inline">ok</code> as return value to <a href="gen_server.html#reply/2"><code class="inline">gen_server:reply/2</code></a></p><p>Own Id: OTP-16210 Aux Id: PR-2411</p></li><li><p>New functions have been added to <a href="c.html"><code class="inline">c</code></a> for printing embedded documentation for
Erlang modules. The functions are:</p><ul><li><p><strong>h/1,2,3</strong> - Print the documentation for a Module:Function/Arity.</p></li><li><p><strong>ht/1,2,3</strong> - Print the type documentation for a Module:Type/Arity.</p></li></ul><p>The embedded documentation is created when building the Erlang/OTP
documentation.</p><p>Own Id: OTP-16222</p></li><li><p>Add <code class="inline">indent</code> and <code class="inline">linewidth</code> to the options of the <code class="inline">erl_pp</code> module's
functions.</p><p>Own Id: OTP-16276 Aux Id: PR-2443</p></li><li><p>Minor updates due to the new spawn improvements made.</p><p>Own Id: OTP-16368 Aux Id: OTP-15251</p></li><li><p>The compiler will now raise a warning when inlining is used in modules that
load NIFs.</p><p>Own Id: OTP-16429 Aux Id: ERL-303</p></li><li><p>Refactored the internal handling of deprecated and removed functions.</p><p>Own Id: OTP-16469</p></li><li><p>Extend <code class="inline">erl_parse:abstract/1,2</code> to handle external fun expressions
(<code class="inline">fun M:F/A</code>).</p><p>Own Id: OTP-16480</p></li><li><p>Added <a href="filelib.html#safe_relative_path/2"><code class="inline">filelib:safe_relative_path/2</code></a> to replace
<code class="inline">filename:safe_relative_path/1</code>, which did not safely handle symbolic links.</p><p><code class="inline">filename:safe_relative_path/1</code> has been deprecated.</p><p>Own Id: OTP-16483 Aux Id: PR-2542</p></li><li><p>The module <code class="inline">shell_docs</code> has been added. The module contains functions for
rendering, validating and normalizing embedded documentation.</p><p>Own Id: OTP-16500</p></li><li><p>Module and function auto-completion in the shell now looks at all available
modules instead of only those loaded. A module is considered available if it
either is loaded already or would be loaded if called.</p><p>The auto-completion has also been expanded to work in the new <code class="inline">h/1,2,3</code>
function in <a href="c.html"><code class="inline">c</code></a>.</p><p>Own Id: OTP-16501 Aux Id: OTP-16494, OTP-16222, OTP-16406, OTP-16499,
OTP-16500, PR-2545, ERL-708</p></li><li><p>Updated the internal <code class="inline">pcre</code> library to <code class="inline">8.44</code>.</p><p>Own Id: OTP-16557</p></li></ul><h2 id="stdlib-3-12-1-2" class="section-heading"><a href="#stdlib-3-12-1-2" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.12.1.2</span></h2><h3 id="fixed-bugs-and-malfunctions-59" class="section-heading"><a href="#fixed-bugs-and-malfunctions-59" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Fix a bug that could cause a crash when formatting tuples using the control
sequences <code class="inline">p</code> or <code class="inline">P</code> and limiting the output with the option <code class="inline">chars_limit</code>.</p><p>Own Id: OTP-17525 Aux Id: GH-5053</p></li></ul><h2 id="stdlib-3-12-1-1" class="section-heading"><a href="#stdlib-3-12-1-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.12.1.1</span></h2><h3 id="fixed-bugs-and-malfunctions-60" class="section-heading"><a href="#fixed-bugs-and-malfunctions-60" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Fix a bug that could cause a loop when formatting terms using the control
sequences p or P and limiting the output with the option <code class="inline">chars_limit</code>.</p><p>Own Id: OTP-17459 Aux Id: GH-4824, GH-4842</p></li></ul><h2 id="stdlib-3-12-1" class="section-heading"><a href="#stdlib-3-12-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.12.1</span></h2><h3 id="fixed-bugs-and-malfunctions-61" class="section-heading"><a href="#fixed-bugs-and-malfunctions-61" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>[re:run(Subject, RE, [unicode])](<a href="re.html#run/3"><code class="inline">re:run/3</code></a>) returned <code class="inline">nomatch</code> instead of
failing with a <code class="inline">badarg</code> error exception when <code class="inline">Subject</code> contained illegal utf8
and <code class="inline">RE</code> was passed as a binary. This has been corrected along with
corrections of reduction counting in <code class="inline">re:run()</code> error cases.</p><p>Own Id: OTP-16553</p></li></ul><h2 id="stdlib-3-12" class="section-heading"><a href="#stdlib-3-12" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.12</span></h2><h3 id="fixed-bugs-and-malfunctions-62" class="section-heading"><a href="#fixed-bugs-and-malfunctions-62" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Fix type specification for uri_string:normalize/2 that may also return
error().</p><p>Own Id: OTP-16322</p></li><li><p>Improve error handling in uri_string:normalize/2. This change fixes a crash
when the input URI has faulty percent-encoding.</p><p>Own Id: OTP-16351</p></li><li><p>Fix minor bugs in the Erlang pretty printer (<code class="inline">erl_pp</code>).</p><p>Own Id: OTP-16435</p></li><li><p>Fix the Erlang parser regarding consecutive unary operators.</p><p>Own Id: OTP-16439</p></li><li><p>Let <code class="inline">calendar:rfc3339_to_system_time()</code> crash when the time offset is missing.</p><p>Own Id: OTP-16514 Aux Id: ERL-1182</p></li></ul><h3 id="improvements-and-new-features-21" class="section-heading"><a href="#improvements-and-new-features-21" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>Implement uri_string:resolve/{2,3} that can be used to resolve a URI
reference against a base URI.</p><p>Own Id: OTP-16321</p></li><li><p>In <code class="inline">gen_statem</code> it is now possible to change the callback module for a running
server. See <code class="inline">gen_statem</code>'s documentation for <code class="inline">change_callback_module</code>,
<code class="inline">push_callback_module</code>, and <code class="inline">pop_callback_module</code>.</p><p>Own Id: OTP-16477 Aux Id: PR-2531</p></li></ul><h2 id="stdlib-3-11-2" class="section-heading"><a href="#stdlib-3-11-2" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.11.2</span></h2><h3 id="fixed-bugs-and-malfunctions-63" class="section-heading"><a href="#fixed-bugs-and-malfunctions-63" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>A directory traversal vulnerability has been eliminated in erl_tar. erl_tar
will now refuse to extract symlinks that points outside the targeted
extraction directory and will return <code class="inline">{error,{Path,unsafe_symlink}}</code>. (Thanks
to Eric Meadows-Jönsson for the bug report and for suggesting a fix.)</p><p>Own Id: OTP-16441</p></li></ul><h2 id="stdlib-3-11-1" class="section-heading"><a href="#stdlib-3-11-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.11.1</span></h2><h3 id="fixed-bugs-and-malfunctions-64" class="section-heading"><a href="#fixed-bugs-and-malfunctions-64" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>The <a href="ets.html#update_counter/4"><code class="inline">ets:update_counter/4</code></a> core dumped when given an ordered_set with
write_concurrency enabled and an invalid position. This bug has been fixed.</p><p>Own Id: OTP-16378 Aux Id: ERL-1125</p></li></ul><h2 id="stdlib-3-11" class="section-heading"><a href="#stdlib-3-11" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.11</span></h2><h3 id="fixed-bugs-and-malfunctions-65" class="section-heading"><a href="#fixed-bugs-and-malfunctions-65" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>The functions <a href="unicode.html#characters_to_list/2"><code class="inline">unicode:characters_to_list()</code></a>
and <a href="unicode.html#characters_to_binary/3"><code class="inline">unicode:characters_to_binary()</code></a>
raised a <code class="inline">badarg</code> exception instead of returning an error tuple when passed
very large invalid code points as input.</p><p>Own Id: OTP-16052</p></li><li><p>Fixed a bug in the linter where list and binary comprehensions could suppress
unsafe variable errors.</p><p>Own Id: OTP-16053 Aux Id: ERL-1039</p></li><li><p>Fixed incorrect type specifications for <a href="erl_tar.html#open/2"><code class="inline">erl_tar:open/2</code></a>, <code class="inline">create/2,3</code>, and
<code class="inline">add/4</code>.</p><p>Own Id: OTP-16085 Aux Id: PR-2379</p></li><li><p>Fixed erroneous type spec for <a href="binary.html#list_to_bin/1"><code class="inline">binary:list_to_bin/1</code></a>. Argument type was
changed from <a href="../../apps/erts/erlang.html#t:iodata/0"><code class="inline">iodata/0</code></a> to <a href="../../apps/erts/erlang.html#t:iolist/0"><code class="inline">iolist/0</code></a>.</p><p>Own Id: OTP-16132 Aux Id: ERL-1041</p></li><li><p>Fix a race in <code class="inline">pool:pspawn_link</code> that caused a <code class="inline">noproc</code> error to be thrown
when using it to spawn a very short lived process.</p><p>Own Id: OTP-16211</p></li><li><p>Fixed a performance issue in ETS lookup when using the <code class="inline">compressed</code> option and
the term contained atoms. Before this fix the decompress algorithm for atoms
would unnecessarily take a global lock to validate the atom.</p><p>Own Id: OTP-16316</p></li></ul><h3 id="improvements-and-new-features-22" class="section-heading"><a href="#improvements-and-new-features-22" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>Added a new compiler/linter option to disable warnings for unused types
(<code class="inline">nowarn_unused_type</code>).</p><p>Own Id: OTP-16262 Aux Id: ERIERL-435</p></li><li><p>ETS tables have been optimized to not use any locks when running in a system
with only one scheduler enabled. This can provide significant performance
gains for applications that use ETS tables heavily.</p><p>Own Id: OTP-16315</p></li></ul><h2 id="stdlib-3-10" class="section-heading"><a href="#stdlib-3-10" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.10</span></h2><h3 id="fixed-bugs-and-malfunctions-66" class="section-heading"><a href="#fixed-bugs-and-malfunctions-66" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p><code class="inline">re:run()</code> now yields when validating utf8 in a large subject.</p><p>Own Id: OTP-15836 Aux Id: ERL-876</p></li><li><p>Upgraded the ERTS internal PCRE library from version 8.42 to version 8.43. See
<a href="http://pcre.org/original/changelog.txt">http://pcre.org/original/changelog.txt</a>
for information about changes made to PCRE. This library implements major
parts of the <a href="re.html"><code class="inline">re</code></a> regular expressions module.</p><p>Own Id: OTP-15889</p></li><li><p>The bug with ID ERL-717 has been fixed. The functions <code class="inline">io:columns()</code> and
<code class="inline">io:rows()</code> only worked correctly inside interactive erlang shells before this
fix. These functions returned <code class="inline">{error,enotsup}</code> before this fix even if stdout
and stdin were connected to a terminal when they were invoked from an escript
or a program started with e.g., <code class="inline">erl -noshell</code>.</p><p>Own Id: OTP-15959 Aux Id: ERL-717</p></li><li><p>Fixed handling of &quot;..&quot; and &quot;@&quot; in wildcards. &quot;..&quot; would only work when
preceded by a literal pattern such as in &quot;a/..&quot;, not when preceded by wildcard
characters such as in &quot;*/..&quot;. The combination &quot;@/..&quot; was also broken, and in
addition &quot;@&quot; in a pattern could degrade performance of the wildcard matching.</p><p>Own Id: OTP-15987 Aux Id: ERL-1029</p></li><li><p>Make sure <code class="inline">ets:fun2ms()</code> can handle <code class="inline">++/2</code> in the head of functions when
called from the shell.</p><p>Own Id: OTP-15992 Aux Id: PR-2322</p></li></ul><h3 id="improvements-and-new-features-23" class="section-heading"><a href="#improvements-and-new-features-23" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>Debugging of time-outs in <code class="inline">gen_statem</code> has been improved. Starting a time-out
is now logged in <code class="inline">sys:log</code> and <code class="inline">sys:trace</code>. Running time-outs are visible in
server crash logs, and with <code class="inline">sys:get_status</code>. Due to this system events
<code class="inline">{start_timer, Action, State}</code> and <code class="inline">{insert_timout, Event, State}</code> have been
added, which may surprise tools that rely on the format of these events.</p><p>New features: The <code class="inline">EventContent</code> of a running time-out can be updated with
<code class="inline">{TimeoutType, update, NewEventContent}</code>. Running time-outs can be cancelled
with <code class="inline">{TimeoutType, cancel}</code> which is more readable than using
<code class="inline">Time = infinity</code>.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-15510</p></li><li><p><code class="inline">re:run()</code> now avoids validating utf8 in the subject more than once in the
same call. This validation could previously be performed multiple times when
the <code class="inline">global</code> option was passed.</p><p>Own Id: OTP-15831 Aux Id: ERL-876</p></li><li><p>ETS <code class="inline">ordered_set</code> tables with <code class="inline">write_concurrency</code> enabled has got a
performance issue fixed. There were no limits for the values of internal
statistics counters before this fix. This could result in that the data
structure sometimes reacted slowly to a change in how many parallel processes
were using it.</p><p>Own Id: OTP-15906</p></li><li><p>The <a href="ordsets.html#union/1"><code class="inline">ordsets:union/1</code></a> is now faster when passed a long list of ordsets.</p><p>Own Id: OTP-15927</p></li><li><p><code class="inline">unicode:characters_to_binary()</code> could return very small binaries as reference
counted off heap binaries. This could cause an unnecessary large memory usage
and an unnecessary load on the binary allocator. Small binaries are now always
returned as heap binaries.</p><p>Own Id: OTP-16002 Aux Id: ERIERL-366</p></li><li><p>Display a more meaningful error message when a bad I/O server is used in a
script written in Erlang (<code class="inline">escript</code>).</p><p>Own Id: OTP-16006 Aux Id: ERL-992</p></li><li><p>New feature <code class="inline">ets:info(_, binary)</code> to get information about all reference
counted binaries kept by a table. This is the same kind of debug information
that <a href="../../apps/erts/erlang.html#process_info/2"><code class="inline">process_info(_, binary)</code></a> returns for a process.</p><p>Own Id: OTP-16035 Aux Id: ERIERL-366</p></li><li><p>Corrected ETS documentation about the behavior of compiled match
specifications when serialized through external format.</p><p>Own Id: OTP-16038 Aux Id: PR-2366</p></li></ul><h2 id="stdlib-3-9-2" class="section-heading"><a href="#stdlib-3-9-2" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.9.2</span></h2><h3 id="fixed-bugs-and-malfunctions-67" class="section-heading"><a href="#fixed-bugs-and-malfunctions-67" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Fix a bug that could cause a loop when formatting terms using the control
sequences <code class="inline">p</code> or <code class="inline">P</code> and limiting the output with the option <code class="inline">chars_limit</code>.</p><p>Own Id: OTP-15875 Aux Id: ERL-967</p></li></ul><h2 id="stdlib-3-9-1" class="section-heading"><a href="#stdlib-3-9-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.9.1</span></h2><h3 id="fixed-bugs-and-malfunctions-68" class="section-heading"><a href="#fixed-bugs-and-malfunctions-68" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Fix a bug that could cause a failure when formatting binaries using the
control sequences <code class="inline">p</code> or <code class="inline">P</code> and limiting the output with the option
<code class="inline">chars_limit</code>.</p><p>Own Id: OTP-15847 Aux Id: ERL-957</p></li></ul><h2 id="stdlib-3-9" class="section-heading"><a href="#stdlib-3-9" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.9</span></h2><h3 id="fixed-bugs-and-malfunctions-69" class="section-heading"><a href="#fixed-bugs-and-malfunctions-69" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Fix a bug in <a href="string.html#lexemes/2"><code class="inline">string:lexemes/2</code></a>.</p><p>The bug was found when optimizing the handling of deep lists of Unicode
characters in the <code class="inline">string</code> module.</p><p>Own Id: OTP-15649</p></li><li><p>A bug has been fixed in the <code class="inline">maps</code> implementation that could cause a crash or
memory usage to grow until the machine ran out of memory. This could happen
when inserting a new key-value pair with a key <code class="inline">K1</code> containing a binary <code class="inline">B1</code>
into a map <code class="inline">M</code> having a key <code class="inline">K2</code> with a binary <code class="inline">B2</code> if the following
conditions were met:</p><ul><li><code class="inline">B1 =/= B2</code></li><li><code class="inline">size(B1) &gt;= 4294967296</code></li><li><code class="inline">size(B2) &gt;= 4294967296</code></li><li><code class="inline">size(M) &gt;= 32</code></li><li><code class="inline">(size(B1) rem 4294967296) == (size(B2) rem 4294967296)</code></li><li>the first <code class="inline">(size(B1) rem 4294967296)</code> bytes are the same both in <code class="inline">B1</code> and
<code class="inline">B2</code></li><li>substituting <code class="inline">B1</code> in <code class="inline">K1</code> with <code class="inline">B2</code> would create a term with the same value
as <code class="inline">K2</code></li></ul><p>The root cause of the problem is that the <code class="inline">maps</code> implementation only hashed
the first <code class="inline">(X rem 4294967296)</code> bytes of binaries so that different binaries
could get the same hash value independently of the hash seed.</p><p>Own Id: OTP-15707</p></li><li><p>Since the introduction of the stack trace variable, the Erlang Pretty Printer
has left out the exception class <code class="inline">throw</code> even when the stack trace variable
cannot be left out, which is not correct Erlang code. The fix is to always
include the exception class <code class="inline">throw</code>.</p><p>Own Id: OTP-15751</p></li><li><p><code class="inline">record_info/2</code> is a pseudo-function that requires literal arguments known at
compile time. Therefore, the following usage is illegal: <code class="inline">fun record/info/2</code>.
The compiler would crash when during compilation of that kind of code.
Corrected to issue a compilation error.</p><p>Own Id: OTP-15760 Aux Id: ERL-907</p></li></ul><h3 id="improvements-and-new-features-24" class="section-heading"><a href="#improvements-and-new-features-24" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>A new <code class="inline">rand</code> module algorithm, <code class="inline">exro928ss</code> (Xoroshiro928**), has been
implemented. It has got a really long period and good statistical quality for
all output bits, while still being only about 50% slower than the default
algorithm.</p><p>The same generator is also used as a long period counter in a new <code class="inline">crypto</code>
plugin for the <code class="inline">rand</code> module, algorithm <code class="inline">crypto_aes</code>. This plugin uses AES-256
to scramble the counter which buries any detectable statistical artifacts.
Scrambling is done in chunks which are cached to get good amortized speed
(about half of the default algorithm).</p><p>Own Id: OTP-14461 Aux Id: PR-1857</p></li><li><p>Types related to server naming and starting have been exported from
<code class="inline">gen_statem</code>. These are: <code class="inline">server_name/0</code>, <code class="inline">server_ref/0</code>, <code class="inline">start_opt/0</code>,
<code class="inline">start_ret/0</code> and <code class="inline">enter_loop_opt/0</code>.</p><p>Own Id: OTP-14724 Aux Id: PR-2056</p></li><li><p>The default algorithm for the <code class="inline">rand</code> module has been changed to <code class="inline">exsss</code>
(Xorshift116**) which is a combination of the Xorshift116 (<code class="inline">exsp</code>) state
update and a new scrambler &quot;StarStar&quot; from the 2018 paper &quot;Scrambled Linear
Pseudorandom Number Generators&quot; by David Blackman and Sebastiano Vigna. This
combination should not have the caveat of weak low bits that the previous
default algorithm(s) have had, with the cost of about 10% lower speed. See
GitHub pull request #1969.</p><p>Own Id: OTP-14731 Aux Id: PR-1969</p></li><li><p>The generic state machine behaviour <code class="inline">gen_statem</code> has gotten code cleanup and
documentation improvements from GitHub Pull Request #1855, even though the PR
itself was rejected.</p><p>Own Id: OTP-14737 Aux Id: PR-1855</p></li><li><p>Update Unicode specification to version 11.0.</p><p>Own Id: OTP-15111</p></li><li><p>ETS option <code class="inline">write_concurrency</code> now also affects and improves the scalability
of <code class="inline">ordered_set</code> tables. The implementation is based on a data structure
called contention adapting search tree, where the lock granularity adapts to
the actual amount of concurrency exploited by the applications in runtime.</p><p>Own Id: OTP-15128</p></li><li><p>Optimized <a href="maps.html#new/0"><code class="inline">maps:new/0</code></a> with trivial Erlang implementation, making use of
literal terms (the empty map) not needing dynamic heap allocation.</p><p>Own Id: OTP-15200 Aux Id: PR-1878</p></li><li><p>The <code class="inline">gen_*</code> behaviours have been changed so that if logging of the last N
messages through <code class="inline">sys:log/2,3</code> is active for the server, this log is included
in the terminate report.</p><p>To accomplish this the format of &quot;System Events&quot; as defined in the man page
for <code class="inline">sys</code> has been clarified and cleaned up, a new function <a href="sys.html#get_log/1"><code class="inline">sys:get_log/1</code></a>
has been added, and <a href="sys.html#get_debug/3"><code class="inline">sys:get_debug/3</code></a> has been deprecated. Due to these
changes, code that relies on the internal badly documented format of &quot;System
Events&quot;, need to be corrected.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-15381</p></li><li><p>The <code class="inline">gen_statem</code> behaviour engine loop has been optimized for better
performance in particular when the callback module returns some actions, that
is better performance for more realistic applications than the Echo Benchmark.</p><p>Own Id: OTP-15452</p></li><li><p>Do not allow function specifications for functions residing in other modules.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-15563 Aux Id: ERL-845, OTP-15562</p></li><li><p>The <code class="inline">persistent_term</code> functions <a href="../../apps/erts/erlang.html#put/2"><code class="inline">put/2</code></a> and <a href="../../apps/erts/erlang.html#erase/1"><code class="inline">erase/1</code></a>
are now yielding.</p><p>Own Id: OTP-15615</p></li><li><p>Previously, all ETS tables used centralized counter variables to keep track of
the number of items stored and the amount of memory consumed. These counters
can cause scalability problems (especially on big NUMA systems). This change
adds an implementation of a decentralized counter and modifies the
implementation of ETS so that ETS tables of type <code class="inline">ordered_set</code> with
<code class="inline">write_concurrency</code> enabled use the decentralized counter. Experiments
indicate that this change substantially improves the scalability of ETS
<code class="inline">ordered_set</code> tables with <code class="inline">write_concurrency</code> enabled in scenarios with
frequent <a href="ets.html#insert/2"><code class="inline">ets:insert/2</code></a> and <a href="ets.html#delete/2"><code class="inline">ets:delete/2</code></a> calls.</p><p>Own Id: OTP-15623 Aux Id: PR-2190</p></li><li><p>Use <code class="inline">ssh</code> instead of <code class="inline">rsh</code> as the default remote shell.</p><p>Own Id: OTP-15633 Aux Id: PR-1787</p></li><li><p>Added <a href="beam_lib.html#strip/2"><code class="inline">beam_lib:strip/2</code></a> and friends, which accept a list of chunks that
should be preserved when stripping.</p><p>Own Id: OTP-15680 Aux Id: PR-2114</p></li><li><p>Optimize printing of maps with <code class="inline">io_lib:write()</code>. Also optimize pretty printing
of strings (<code class="inline">~s</code> and <code class="inline">~ts</code>) when limiting the output with the <code class="inline">chars_limit</code>
option.</p><p>Own Id: OTP-15705</p></li><li><p>There are new compiler options <code class="inline">nowarn_removed</code> and <code class="inline">{nowarn_removed,Items}</code>
to suppress warnings for functions and modules that have been removed from
OTP.</p><p>Own Id: OTP-15749 Aux Id: ERL-904</p></li><li><p>Let the Erlang Pretty Printer put atomic parts on the same line.</p><p>Own Id: OTP-15755</p></li><li><p>Add option <code class="inline">quote_singleton_atom_types</code> to the Erlang Pretty Printer's
functions. Setting the option to <code class="inline">true</code> adds quotes to all singleton atom
types.</p><p>Own Id: OTP-15756</p></li></ul><h2 id="stdlib-3-8-2-4" class="section-heading"><a href="#stdlib-3-8-2-4" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.8.2.4</span></h2><h3 id="fixed-bugs-and-malfunctions-70" class="section-heading"><a href="#fixed-bugs-and-malfunctions-70" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>[re:run(Subject, RE, [unicode])](<a href="re.html#run/3"><code class="inline">re:run/3</code></a>) returned <code class="inline">nomatch</code> instead of
failing with a <code class="inline">badarg</code> error exception when <code class="inline">Subject</code> contained illegal utf8
and <code class="inline">RE</code> was passed as a binary. This has been corrected along with
corrections of reduction counting in <code class="inline">re:run()</code> error cases.</p><p>Own Id: OTP-16553</p></li></ul><h2 id="stdlib-3-8-2-3" class="section-heading"><a href="#stdlib-3-8-2-3" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.8.2.3</span></h2><h3 id="fixed-bugs-and-malfunctions-71" class="section-heading"><a href="#fixed-bugs-and-malfunctions-71" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>A directory traversal vulnerability has been eliminated in erl_tar. erl_tar
will now refuse to extract symlinks that points outside the targeted
extraction directory and will return <code class="inline">{error,{Path,unsafe_symlink}}</code>. (Thanks
to Eric Meadows-Jönsson for the bug report and for suggesting a fix.)</p><p>Own Id: OTP-16441</p></li></ul><h2 id="stdlib-3-8-2-2" class="section-heading"><a href="#stdlib-3-8-2-2" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.8.2.2</span></h2><h3 id="fixed-bugs-and-malfunctions-72" class="section-heading"><a href="#fixed-bugs-and-malfunctions-72" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Fix a bug that could cause a loop when formatting terms using the control
sequences <code class="inline">p</code> or <code class="inline">P</code> and limiting the output with the option <code class="inline">chars_limit</code>.</p><p>Own Id: OTP-15875 Aux Id: ERL-967</p></li></ul><h2 id="stdlib-3-8-2-1" class="section-heading"><a href="#stdlib-3-8-2-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.8.2.1</span></h2><h3 id="fixed-bugs-and-malfunctions-73" class="section-heading"><a href="#fixed-bugs-and-malfunctions-73" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Fix a bug that could cause a failure when formatting binaries using the
control sequences <code class="inline">p</code> or <code class="inline">P</code> and limiting the output with the option
<code class="inline">chars_limit</code>.</p><p>Own Id: OTP-15847 Aux Id: ERL-957</p></li></ul><h2 id="stdlib-3-8-2" class="section-heading"><a href="#stdlib-3-8-2" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.8.2</span></h2><h3 id="fixed-bugs-and-malfunctions-74" class="section-heading"><a href="#fixed-bugs-and-malfunctions-74" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>A bug in gen_statem has been fixed where the internal timeout message could
arrive as an info to the callback module during high load due to incorrect use
of asynchronous timer cancel.</p><p>Own Id: OTP-15295</p></li></ul><h2 id="stdlib-3-8-1" class="section-heading"><a href="#stdlib-3-8-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.8.1</span></h2><h3 id="fixed-bugs-and-malfunctions-75" class="section-heading"><a href="#fixed-bugs-and-malfunctions-75" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Fixed a performance regression when reading files opened with the <code class="inline">compressed</code>
flag.</p><p>Own Id: OTP-15706 Aux Id: ERIERL-336</p></li></ul><h2 id="stdlib-3-8" class="section-heading"><a href="#stdlib-3-8" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.8</span></h2><h3 id="fixed-bugs-and-malfunctions-76" class="section-heading"><a href="#fixed-bugs-and-malfunctions-76" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Fix a bug in the Erlang Pretty Printer: long atom names in combination with
<code class="inline">&lt;&lt;&gt;&gt;</code> could cause a crash.</p><p>Own Id: OTP-15592 Aux Id: ERL-818</p></li><li><p>Fix bugs that could cause wrong results or bad performance when formatting
lists of characters using the control sequences <code class="inline">p</code> or <code class="inline">P</code> and limiting the
output with the option <code class="inline">chars_limit</code>.</p><p>Own Id: OTP-15639</p></li></ul><h3 id="improvements-and-new-features-25" class="section-heading"><a href="#improvements-and-new-features-25" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>Improved ETS documentation about safe table traversal and the partially bound
key optimization for <code class="inline">ordered_set</code>.</p><p>Own Id: OTP-15545 Aux Id: PR-2103, PR-2139</p></li><li><p>Optimize <a href="calendar.html#gregorian_days_to_date/1"><code class="inline">calendar:gregorian_days_to_date/1</code></a>.</p><p>Own Id: OTP-15572 Aux Id: PR-2121</p></li><li><p>Optimize functions <code class="inline">calendar:rfc3339_to_system_time()</code> and
<code class="inline">calendar:system_time_to_rfc3339()</code>.</p><p>Own Id: OTP-15630</p></li></ul><h2 id="stdlib-3-7-1" class="section-heading"><a href="#stdlib-3-7-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.7.1</span></h2><h3 id="fixed-bugs-and-malfunctions-77" class="section-heading"><a href="#fixed-bugs-and-malfunctions-77" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Optimize pretty printing of terms. The slower behaviour was introduced in
Erlang/OTP 20.</p><p>Own Id: OTP-15573 Aux Id: ERIERL-306</p></li></ul><h2 id="stdlib-3-7" class="section-heading"><a href="#stdlib-3-7" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.7</span></h2><h3 id="fixed-bugs-and-malfunctions-78" class="section-heading"><a href="#fixed-bugs-and-malfunctions-78" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Document <code class="inline">bit_size</code> in match specifications and allow it in <code class="inline">ets:fun2ms</code>.</p><p>Own Id: OTP-15343 Aux Id: PR-1962</p></li><li><p>The <code class="inline">beam()</code> type in <code class="inline">beam_lib</code> is defined as
<code class="inline">module() | file:filename() | binary()</code>. The <a href="../../apps/erts/erlang.html#t:module/0"><code class="inline">module/0</code></a> is misleading.
Giving the module name as an atom will only work if the BEAM file is in a
current directory.</p><p>To avoid confusion, <a href="../../apps/erts/erlang.html#t:module/0"><code class="inline">module/0</code></a> has been removed from the type. That means
that there will be a Dialyzer warning for code that call <code class="inline">beam_lib</code> with an
atom as filename, but the calls will still work.</p><p>Own Id: OTP-15378 Aux Id: ERL-696</p></li><li><p><code class="inline">unicode_util</code> crashed on certain emoji grapheme clusters in binary strings.</p><p>Own Id: OTP-15428 Aux Id: ERL-777</p></li><li><p>When an external fun was used, warnings for unused variables could be
suppressed.</p><p>Own Id: OTP-15437 Aux Id: ERL-762</p></li><li><p>Fix reduction count in lists:member/2</p><p>Own Id: OTP-15474 Aux Id: ERIERL-229</p></li></ul><h3 id="improvements-and-new-features-26" class="section-heading"><a href="#improvements-and-new-features-26" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>When specified, the <code class="inline">+{source,Name}</code> option will now override the actual file
name in stack traces, instead of only affecting the return value of
<code class="inline">Mod:module_info()</code>.</p><p>The <code class="inline">+deterministic</code> flag will also affect stack traces now, omitting all path
information except the file name, fixing a long-standing issue where
deterministic builds required deterministic paths.</p><p>Own Id: OTP-15245 Aux Id: ERL-706</p></li><li><p>List subtraction (The <code class="inline">--</code> operator) will now yield properly on large inputs.</p><p>Own Id: OTP-15371</p></li><li><p><code class="inline">calendar:system_time_to_rfc3339/1,2</code> no longer remove trailing zeros from
fractions.</p><p>Own Id: OTP-15464</p></li></ul><h2 id="stdlib-3-6" class="section-heading"><a href="#stdlib-3-6" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.6</span></h2><h3 id="fixed-bugs-and-malfunctions-79" class="section-heading"><a href="#fixed-bugs-and-malfunctions-79" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>The specs of <code class="inline">filename:basedir/2,3</code> are corrected.</p><p>Own Id: OTP-15252 Aux Id: ERL-667</p></li></ul><h3 id="improvements-and-new-features-27" class="section-heading"><a href="#improvements-and-new-features-27" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>Let <code class="inline">dets:open_file()</code> exit with a <code class="inline">badarg</code> message if given a raw file name
(a binary).</p><p>Own Id: OTP-15253 Aux Id: OTP-13229, ERL-55</p></li><li><p>The <code class="inline">Format</code> argument of the formatting functions in modules <code class="inline">io</code> and <code class="inline">io_lib</code>
is accepted even if it is, for example, a list of binaries. This is how it
used to be before Erlang/OTP 21.0.</p><p>Own Id: OTP-15304</p></li></ul><h2 id="stdlib-3-5-1" class="section-heading"><a href="#stdlib-3-5-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.5.1</span></h2><h3 id="fixed-bugs-and-malfunctions-80" class="section-heading"><a href="#fixed-bugs-and-malfunctions-80" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Fix a bug that could cause a crash when formatting a list of non-characters
using the control sequences <code class="inline">p</code> or <code class="inline">P</code> and limiting the output with the option
<code class="inline">chars_limit</code>.</p><p>Own Id: OTP-15159</p></li></ul><h2 id="stdlib-3-5" class="section-heading"><a href="#stdlib-3-5" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.5</span></h2><h3 id="fixed-bugs-and-malfunctions-81" class="section-heading"><a href="#fixed-bugs-and-malfunctions-81" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p><code class="inline">gen_statem</code> improvements.</p><p>When using an exception that is valid but not allowed in a state enter call,
the reason has been changed from <code class="inline">{bad_action_from_state_function,Action}</code> to
<code class="inline">{bad_state_enter_action_from_state_function,Action}</code>.</p><p>Timer parsing has been improved. Many erroneous timeout tuples was not handled
correctly.</p><p>The documentation has been updated, in particular the User's Guide and the
pointer to it from the Reference Manual is much more obvious.</p><p>Own Id: OTP-14015</p></li><li><p>The type specifications for <a href="../../apps/kernel/file.html#t:posix/0"><code class="inline">file:posix/0</code></a> and
<a href="../../apps/kernel/inet.html#t:posix/0"><code class="inline">inet:posix/0</code></a> have been updated according to which errors
file and socket operations should be able to return.</p><p>Own Id: OTP-14019 Aux Id: ERL-550</p></li><li><p>File operations used to accept <a href="../../apps/kernel/file.html#t:name_all/0">filenames</a> containing
null characters (integer value zero). This caused the name to be truncated and
in some cases arguments to primitive operations to be mixed up. Filenames
containing null characters inside the filename are now <em>rejected</em> and will
cause primitive file operations to fail.</p><p>Also environment variable operations used to accept
<a href="../../apps/kernel/os.html#t:env_var_name/0">names</a> and <a href="../../apps/kernel/os.html#t:env_var_value/0">values</a> of
environment variables containing null characters (integer value zero). This
caused operations to silently produce erroneous results. Environment variable
names and values containing null characters inside the name or value are now
<em>rejected</em> and will cause environment variable operations to fail.</p><p>Primitive environment variable operations also used to accept the <code class="inline">$=</code>
character in environment variable names causing various problems. <code class="inline">$=</code>
characters in environment variable names are now also <em>rejected</em>.</p><p>Also <a href="../../apps/kernel/os.html#cmd/1"><code class="inline">os:cmd/1</code></a> now reject null characters inside its
<a href="../../apps/kernel/os.html#t:os_command/0">command</a>.</p><p><a href="../../apps/erts/erlang.html#open_port/2"><code class="inline">erlang:open_port/2</code></a> will also reject null characters inside the port name
from now on.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-14543 Aux Id: ERL-370</p></li><li><p>Make <a href="io_lib.html#unscan_format/1"><code class="inline">io_lib:unscan_format/1</code></a> work with pad char and default precision.</p><p>Own Id: OTP-14958 Aux Id: PR-1735</p></li><li><p>The control sequence modifiers <code class="inline">t</code> and <code class="inline">l</code> can be used together in the same
control sequence which makes it possible to have Unicode atoms and no
detection of printable character lists at the same time.</p><p>Own Id: OTP-14971 Aux Id: PR-1743</p></li><li><p>Fix a bug in the Erlang code linter: the check of guard expressions no longer
returns <code class="inline">false</code> if the map syntax is used. The bug affected the Erlang shell,
the Debugger, and other modules evaluating abstract code.</p><p>Own Id: OTP-15035 Aux Id: ERL-613</p></li><li><p>A sys debug fun of type {Fun,State} should not be possible to install twice.
This was, however, possible if the current State was 'undefined', which was
mistaken for non-existing fun. This has been corrected.</p><p>Own Id: OTP-15049</p></li><li><p>Fix <code class="inline">io:putchars/2</code> stacktrace rewriting at errors to point to a valid
function.</p><p>Own Id: OTP-15101</p></li></ul><h3 id="improvements-and-new-features-28" class="section-heading"><a href="#improvements-and-new-features-28" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>The <code class="inline">gen_server</code> has gotten a new callback <code class="inline">handle_continue/2</code> for check
pointing the state. This is useful at least when implementing behaviours on
top of <code class="inline">gen_server</code> and for some start up scenarios.</p><p>Own Id: OTP-13019 Aux Id: PR-1490</p></li><li><p>The semantics of timeout parameter <code class="inline">{clean_timeout,infinity}</code> to
<a href="gen_statem.html#call/3"><code class="inline">gen_statem:call/3</code></a> has been changed to use a proxy process for the call. With
this change <code class="inline">clean_timeout</code> implicates a proxy process with no exceptions.
This may be a hard to observe incompatibility: in the presence of network
problems a late reply could arrive in the caller's message queue when catching
errors. That will not happen after this correction.</p><p>The semantics of timeout parameter <code class="inline">infinity</code> has not been changed.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-13073 Aux Id: PR-1595</p></li><li><p>A new logging API is added to Erlang/OTP, see the <a href="../../apps/kernel/logger.html"><code class="inline">logger</code></a> manual page, and
section <a href="../../apps/kernel/logger_chapter.html">Logging</a> in the Kernel User's Guide.</p><p>Calls to <code class="inline">error_logger</code> are automatically redirected to the new API, and
legacy error logger event handlers can still be used. It is, however,
recommended to use the Logger API directly when writing new code.</p><p>Notice the following potential incompatibilities:</p><ul><li><p>Kernel configuration parameters <code class="inline">error_logger</code> still works, but is overruled
if the default handler's output destination is configured with Kernel
configuration parameter <code class="inline">logger</code>.</p><p>In general, parameters for configuring error logger are overwritten by new
parameters for configuring Logger.</p></li><li><p>The concept of SASL error logging is deprecated, meaning that by default the
SASL application does not affect which log events are logged.</p><p>By default, supervisor reports and crash reports are logged by the default
Logger handler started by Kernel, and end up at the same destination
(terminal or file) as other standard log event from Erlang/OTP.</p><p>Progress reports are not logged by default, but can be enabled by setting
the primary log level to info, for example with the Kernel configuration
parameter <code class="inline">logger_level</code>.</p><p>To obtain backwards compatibility with the SASL error logging functionality
from earlier releases, set Kernel configuration parameter
<code class="inline">logger_sasl_compatible</code> to <code class="inline">true</code>. This prevents the default Logger handler
from logging any supervisor-, crash-, or progress reports. Instead, SASL
adds a separate Logger handler during application start, which takes care of
these log events. The SASL configuration parameters <code class="inline">sasl_error_logger</code> and
<code class="inline">sasl_errlog_type</code> specify the destination (terminal or file) and severity
level to log for these events.</p></li></ul><p>Since Logger is new in Erlang/OTP 21.0, we do reserve the right to introduce
changes to the Logger API and functionality in patches following this release.
These changes might or might not be backwards compatible with the initial
version.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-13295</p></li><li><p>Add functions <a href="calendar.html#system_time_to_local_time/2"><code class="inline">calendar:system_time_to_local_time/2</code></a> and
<a href="calendar.html#system_time_to_universal_time/2"><code class="inline">calendar:system_time_to_universal_time/2</code></a>.</p><p>Own Id: OTP-13413</p></li><li><p>Functions <a href="rand.html#uniform_real/0"><code class="inline">rand:uniform_real/0</code></a> and <a href="rand.html#uniform_real_s/1"><code class="inline">rand:uniform_real_s/1</code></a> have been added.
They produce uniformly distributed numbers in the range <code class="inline">0.0 =&lt; X &lt; 1.0</code> that
are as close to random real numbers as Normalized IEEE 754 Double Precision
allows. Because the random real number exactly <code class="inline">0.0</code> is infinitely improbable
they will never return exactly <code class="inline">0.0</code>.</p><p>These properties are useful when you need to call for example <code class="inline">math:log(X)</code> or
<code class="inline">1 / X</code> on a random value <code class="inline">X</code>, since that will never fail with a number from
these new functions.</p><p>Own Id: OTP-13764 Aux Id: PR-1574</p></li><li><p>Added maps:iterator/0 and maps:next/1 to be used for iterating over the
key-value associations in a map.</p><p>Own Id: OTP-14012</p></li><li><p>Changed the default behaviour of <code class="inline">.erlang</code> loading: <code class="inline">.erlang</code> is no longer
loaded from the current directory. <code class="inline">c:erlangrc(PathList)</code> can be used to
search and load an <code class="inline">.erlang</code> file from user specified directories.</p><p><code class="inline">escript</code>, <code class="inline">erlc</code>, <code class="inline">dialyzer</code> and <code class="inline">typer</code> no longer load an <code class="inline">.erlang</code> at all.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-14439</p></li><li><p>Added new uri_string module to stdlib for handling URIs (RFC 3986).</p><p>Own Id: OTP-14496</p></li><li><p>Update Unicode specification to version 10.0.</p><p>Own Id: OTP-14503</p></li><li><p><code class="inline">filelib:wildcard()</code> now allows characters with a special meaning to be
escaped using backslashes.</p><p>This is an incompatible change, but note that the use of backslashes in
wildcards would already work differently on Windows and Unix. Existing calls
to <code class="inline">filelib:wildcard()</code> needs to be updated. On Windows, directory separators
must always be written as a slash.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-14577</p></li><li><p>The supervisor now stores its child specifications in a map instead of a list.
This causes a significant improvement when starting many children under a
non-simple_one_for_one supervisor.</p><p>Own Id: OTP-14586</p></li><li><p>The <code class="inline">base64</code> module is optimized.</p><p>Note that the functions <code class="inline">encode/1</code>, <code class="inline">decode/1</code>, and <code class="inline">mime_decode/1</code> fail
unless called with an argument of the documented type. They used to accept any
<a href="../../apps/erts/erlang.html#t:iodata/0"><code class="inline">iodata/0</code></a>.</p><p>Own Id: OTP-14624 Aux Id: PR-1565</p></li><li><p>Add function <a href="lists.html#search/2"><code class="inline">lists:search/2</code></a>.</p><p>Own Id: OTP-14675 Aux Id: PR-102</p></li><li><p>uri_string module extended with functions for handling
application/x-www-form-urlencoded query strings based on the HTML5
specification.</p><p>Own Id: OTP-14747</p></li><li><p>Add functions <code class="inline">calendar:rfc3339_to_system_time/1,2</code> and
<code class="inline">calendar:system_time_to_rfc3339/1,2</code>.</p><p>Own Id: OTP-14764</p></li><li><p>The stack traces returned by the functions of the <code class="inline">erl_eval</code> module more
accurately reflect where the exception occurred.</p><p>Own Id: OTP-14826 Aux Id: PR 1540</p></li><li><p>Add options <code class="inline">atime</code>, <code class="inline">mtime</code>, <code class="inline">ctime</code>, <code class="inline">uid</code>, and <code class="inline">gid</code> to the
<code class="inline">erl_tar:add/3,4</code> functions.</p><p>Own Id: OTP-14834 Aux Id: PR 1608</p></li><li><p>Added <a href="ets.html#whereis/1"><code class="inline">ets:whereis/1</code></a> for retrieving the table identifier of a named table.</p><p>Own Id: OTP-14884</p></li><li><p>Improved URI normalization functions in the uri_string module.</p><p>Own Id: OTP-14910</p></li><li><p>The new functions <a href="io_lib.html#fwrite/3"><code class="inline">io_lib:fwrite/3</code></a> and <a href="io_lib.html#format/3"><code class="inline">io_lib:format/3</code></a> take a third
argument, an option list. The only option is <code class="inline">chars_limit</code>, which is used for
limiting the number of returned characters. The limit is soft, which means
that the number of returned characters exceeds the limit with at most a
smallish amount. If the limit is set, the functions <code class="inline">format/3</code> and <code class="inline">fwrite/3</code>
try to distribute the number of characters evenly over the control sequences
<code class="inline">pPswW</code>. Furthermore, the control sequences <code class="inline">pPwP</code> try to distribute the
number of characters evenly over substructures.</p><p>A modification of the control sequences <code class="inline">pPwW</code> is that even if there is no
limit on the number of returned characters, all associations of a map are
printed to the same depth. The aim is to give a more consistent output as the
order of map keys is not defined. As before, if the depth is less than the
number of associations of a map, the selection of associations to print is
arbitrary.</p><p>Own Id: OTP-14983</p></li><li><p>Add functions <a href="ordsets.html#is_empty/1"><code class="inline">ordsets:is_empty/1</code></a> and <a href="sets.html#is_empty/1"><code class="inline">sets:is_empty/1</code></a>.</p><p>Own Id: OTP-14996 Aux Id: ERL-557, PR-1703</p></li><li><p>Improve performance of <a href="string.html#uppercase/1"><code class="inline">string:uppercase/1</code></a>, <a href="string.html#lowercase/1"><code class="inline">string:lowercase/1</code></a> and
<a href="string.html#casefold/1"><code class="inline">string:casefold/1</code></a> when handling ASCII characters.</p><p>Own Id: OTP-14998</p></li><li><p>External funs with literal values for module, name, and arity (e.g.
<a href="../../apps/erts/erlang.html#abs/1"><code class="inline">erlang:abs/1</code></a>) are now treated as literals. That means more efficient code
that produces less garbage on the heap.</p><p>Own Id: OTP-15003</p></li><li><p>sys:statistics(Pid,get) did not report 'out' messages from gen_server. This is
now corrected.</p><p>Own Id: OTP-15047</p></li><li><p>A sys debug function can now have the format {Id,Fun,State} in addition to
the old {Fun,State}. This allows installing multiple instances of a debug
fun.</p><p>Own Id: OTP-15048</p></li><li><p>The <code class="inline">lib</code> module is removed:</p><ul><li><code class="inline">lib:error_message/2</code> is removed.</li><li><code class="inline">lib:flush_receive/0</code> is removed.</li><li><code class="inline">lib:nonl/1</code> is removed.</li><li><code class="inline">lib:progname/0</code> is replaced by <a href="../../apps/common_test/ct.html#get_progname/0"><code class="inline">ct:get_progname/0</code></a>.</li><li><code class="inline">lib:send/2</code> is removed.</li><li><code class="inline">lib:sendw/2</code> is removed.</li></ul><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-15072 Aux Id: PR 1786, OTP-15114</p></li><li><p>Function <a href="ets.html#delete_all_objects/1"><code class="inline">ets:delete_all_objects/1</code></a> now yields the scheduler thread for large
tables that take significant time to clear. This to improve real time
characteristics of other runnable processes.</p><p>Own Id: OTP-15078</p></li><li><p>In control sequences of the functions <code class="inline">io:fwrite/2,3</code> and <code class="inline">io_lib:fwrite/2,3</code>
containing <code class="inline">p</code> or <code class="inline">P</code>, a field width of value <code class="inline">0</code> means that no line breaks
are inserted. This is in contrast to the old behaviour, where <code class="inline">0</code> used to
insert line breaks after every subterm. To insert line breaks after every
subterm, a field width of value <code class="inline">1</code> can be used.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-15103 Aux Id: ERL-607</p></li></ul><h2 id="stdlib-3-4-5-1" class="section-heading"><a href="#stdlib-3-4-5-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.4.5.1</span></h2><h3 id="improvements-and-new-features-29" class="section-heading"><a href="#improvements-and-new-features-29" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>List subtraction (The <code class="inline">--</code> operator) will now yield properly on large inputs.</p><p>Own Id: OTP-15371</p></li></ul><h2 id="stdlib-3-4-5" class="section-heading"><a href="#stdlib-3-4-5" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.4.5</span></h2><h3 id="fixed-bugs-and-malfunctions-82" class="section-heading"><a href="#fixed-bugs-and-malfunctions-82" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>The <code class="inline">Module:init/1</code> function in <code class="inline">gen_statem</code> may return an actions list
containing any action, but an erroneous check only allowed state enter actions
so e.g <code class="inline">{next_event,internal,event}</code> caused a server crash. This bug has been
fixed.</p><p>Own Id: OTP-13995</p></li></ul><h2 id="stdlib-3-4-4" class="section-heading"><a href="#stdlib-3-4-4" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.4.4</span></h2><h3 id="fixed-bugs-and-malfunctions-83" class="section-heading"><a href="#fixed-bugs-and-malfunctions-83" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Correct <code class="inline">filelib:find_source()</code> and <code class="inline">filelib:find_file()</code> to by default also
search one level below <code class="inline">src</code>. This is in accordance with the Design Principles
which states that an application can have Erlang source files one level below
the <code class="inline">src</code> directory.</p><p>Own Id: OTP-14832 Aux Id: ERL-527</p></li><li><p>The contract of <a href="erl_tar.html#table/2"><code class="inline">erl_tar:table/2</code></a> is corrected.</p><p>Own Id: OTP-14860 Aux Id: PR 1670</p></li><li><p>Correct a few contracts.</p><p>Own Id: OTP-14889</p></li><li><p>Fix string:prefix/2 to handle an empty string as second argument.</p><p>Own Id: OTP-14942 Aux Id: PR-1702</p></li></ul><h2 id="stdlib-3-4-3" class="section-heading"><a href="#stdlib-3-4-3" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.4.3</span></h2><h3 id="fixed-bugs-and-malfunctions-84" class="section-heading"><a href="#fixed-bugs-and-malfunctions-84" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Make <a href="ets.html#i/1"><code class="inline">ets:i/1</code></a> exit cleaner when ^D is input while browsing a table. Only the
old Erlang shell is affected (<a href="../../apps/erts/erl_cmd.html">erl</a> flag <code class="inline">-oldshell</code>).</p><p>Own Id: OTP-14663</p></li><li><p>Fixed handling of windows UNC paths in module <code class="inline">filename</code>.</p><p>Own Id: OTP-14693</p></li></ul><h3 id="improvements-and-new-features-30" class="section-heading"><a href="#improvements-and-new-features-30" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>Improve performance of the new string functionality when handling ASCII
characters.</p><p>Own Id: OTP-14670</p></li><li><p>Added a clarification to the documentation of <a href="unicode.html#characters_to_list/2"><code class="inline">unicode:characters_to_list/2</code></a>.</p><p>Own Id: OTP-14798</p></li></ul><h2 id="stdlib-3-4-2" class="section-heading"><a href="#stdlib-3-4-2" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.4.2</span></h2><h3 id="fixed-bugs-and-malfunctions-85" class="section-heading"><a href="#fixed-bugs-and-malfunctions-85" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Fix a bug in the Erlang shell where recursively defined records with typed
fields could cause a loop.</p><p>Own Id: OTP-14488 Aux Id: PR-1489</p></li><li><p>Make edlin handle grapheme clusters instead of codepoints to improve the
handling multi-codepoints characters.</p><p>Own Id: OTP-14542</p></li><li><p>There could be false warnings for <code class="inline">erlang:get_stacktrace/0</code> being used outside
of a <code class="inline">try</code> block when using multiple <code class="inline">catch</code> clauses.</p><p>Own Id: OTP-14600 Aux Id: ERL-478</p></li></ul><h3 id="improvements-and-new-features-31" class="section-heading"><a href="#improvements-and-new-features-31" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>The Erlang code linter no longer checks that the functions mentioned in
<code class="inline">nowarn_deprecated_function</code> options are declared in the module.</p><p>Own Id: OTP-14378</p></li><li><p>General Unicode improvements.</p><p>Own Id: OTP-14462</p></li></ul><h2 id="stdlib-3-4-1" class="section-heading"><a href="#stdlib-3-4-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.4.1</span></h2><h3 id="fixed-bugs-and-malfunctions-86" class="section-heading"><a href="#fixed-bugs-and-malfunctions-86" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>A bug in <code class="inline">proc_lib:format()</code> introduced in Erlang/OTP 20.0 is corrected.</p><p>Own Id: OTP-14482 Aux Id: PR-1488</p></li><li><p>Fix string:len/1 to be compatible with previous versions.</p><p>Own Id: OTP-14487 Aux Id: ERIERL-40</p></li><li><p>In OTP-20.0, the behavior of c, make, and ct_make was changed so that in some
cases the beam files by default would be written to the directory where the
source files were found. This is now changed back to the old behavior so beam
files are by default written to current directory.</p><p>Own Id: OTP-14489 Aux Id: ERL-438</p></li></ul><h2 id="stdlib-3-4" class="section-heading"><a href="#stdlib-3-4" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.4</span></h2><h3 id="fixed-bugs-and-malfunctions-87" class="section-heading"><a href="#fixed-bugs-and-malfunctions-87" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>For many releases, it has been legal to override a BIF with a local function
having the same name. However, calling a local function with the same name as
guard BIF as filter in a list comprehension was not allowed.</p><p>Own Id: OTP-13690</p></li><li><p>A new (default) pseudo-random number generator algorithm Xoroshiro116+ has
been implemented in the <code class="inline">rand</code> module.</p><p>The old algorithm implementations had a number of flaws so they are all
deprecated, but corrected versions of two of them have been added. See the
documentation.</p><p>Own Id: OTP-14295 Aux Id: PR-1372</p></li><li><p>The Erlang shell, <code class="inline">qlc:string_to_handle()</code>, and the Debugger (the Evaluator
area and Edit variable window of the Bindings area) can parse pids, ports,
references, and external funs, as long as they can be created in the running
system.</p><p>Own Id: OTP-14296</p></li><li><p>Internal code change: Calls to <code class="inline">catch</code> followed by a call to
<code class="inline">erlang:get_stacktrace/0</code> has been rewritten to use <code class="inline">try</code> instead of <code class="inline">catch</code>
to make the code future-proof.</p><p>Own Id: OTP-14400</p></li><li><p>The <code class="inline">ms_transform</code> module, used by <a href="ets.html#fun2ms/1"><code class="inline">ets:fun2ms/1</code></a> and <a href="../../apps/runtime_tools/dbg.html#fun2ms/1"><code class="inline">dbg:fun2ms/1</code></a>,
evaluates constant arithmetic expressions. This is necessary since the Erlang
compiler, which normally evaluates constant expressions, does not recognize
the format generated by <code class="inline">ms_transform</code>.</p><p>Own Id: OTP-14454 Aux Id: ERIERL-29</p></li><li><p>The state machine engine <code class="inline">gen_statem</code> can now handle generic time-outs
(multiple named) as well as absolute time-out time. See the documentation.</p><p>The <code class="inline">gen_statem</code> callback <code class="inline">Module:init/1</code> has become mandatory to harmonize
with other <code class="inline">gen_*</code> modules. This may be an incompatibility for <code class="inline">gen_statem</code>
callback modules that use <code class="inline">gen_statem:enter_loop/4-6</code>.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-14531</p></li></ul><h3 id="improvements-and-new-features-32" class="section-heading"><a href="#improvements-and-new-features-32" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>Improved unicode support for strings. Added normalization functions in the
<code class="inline">unicode</code> module. Extended the <code class="inline">string</code> module API with new functions with
improved unicode handling and that works on grapheme clusters. The new
functions operates on the <a href="unicode.html#t:chardata/0"><code class="inline">unicode:chardata()</code></a> type,
thus they also accept <code class="inline">UTF-8 binaries</code> as input.</p><p>The old string API have been marked as obsolete. The return values have been
changed for some error cases.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-10289 Aux Id: OTP-10309</p></li><li><p>There are two new guard BIFs '<a href="../../apps/erts/erlang.html#floor/1"><code class="inline">floor/1</code></a>' and
'<a href="../../apps/erts/erlang.html#ceil/1"><code class="inline">ceil/1</code></a>'. They both return integers. In the '<code class="inline">math</code>' module,
there are two new BIFs with the same names that return floating point values.</p><p>Own Id: OTP-13692</p></li><li><p>Making code_change, terminate and handle_info callbacks optional in the OTP
behaviours.</p><p>Own Id: OTP-13801</p></li><li><p>The support for Dets files created with Erlang/OTP R7 and earlier is removed.</p><p>Own Id: OTP-13830</p></li><li><p>Replaced usage of deprecated symbolic <a href="../../apps/erts/erlang.html#t:time_unit/0"><code class="inline">time unit</code></a>
representations.</p><p>Own Id: OTP-13831 Aux Id: OTP-13735</p></li><li><p>The function <code class="inline">fmod/2</code> has been added to the <code class="inline">math</code> module.</p><p>Own Id: OTP-14000</p></li><li><p>The EXIT signals received from processes using <code class="inline">proc_lib</code> now looks like EXIT
signals from processes that were spawned using <code class="inline">spawn_link</code>. In particular,
that means that the stack trace is now included in the EXIT signal so that it
can see where the process crashed.</p><p>Own Id: OTP-14001</p></li><li><p><a href="sets.html#add_element/2"><code class="inline">sets:add_element/2</code></a> is faster when adding an element that is already present,
and <a href="sets.html#del_element/2"><code class="inline">sets:del_element/2</code></a> is faster when the element to be deleted is not
present. This optimization can make certain operations, such as sets:union/2
with many overlapping elements, up to two orders of magnitude faster.</p><p>Own Id: OTP-14035</p></li><li><p>Add information in doc about supervisor shutdown reason when maximum restart
frequency is reached.</p><p>Own Id: OTP-14037 Aux Id: PR-1233</p></li><li><p>Added <code class="inline">rand:jump/[0|1]</code> functions.</p><p>Own Id: OTP-14038 Aux Id: PR-1235</p></li><li><p>Functions for detecting changed code has been added. <a href="../../apps/kernel/code.html#modified_modules/0"><code class="inline">code:modified_modules/0</code></a>
returns all currently loaded modules that have changed on disk.
<a href="../../apps/kernel/code.html#module_status/1"><code class="inline">code:module_status/1</code></a> returns the status for a module. In the shell and in
<code class="inline">c</code> module, <code class="inline">mm/0</code> is short for <a href="../../apps/kernel/code.html#modified_modules/0"><code class="inline">code:modified_modules/0</code></a>, and <code class="inline">lm/0</code> reloads
all currently loaded modules that have changed on disk.</p><p>Own Id: OTP-14059</p></li><li><p>Each assert macro in <code class="inline">assert.hrl</code> now has a corresponding version with an
extra argument, for adding comments to assertions. These can for example be
printed as part of error reports, to clarify the meaning of the check that
failed.</p><p>Own Id: OTP-14066</p></li><li><p><code class="inline">error_logger_tty_h</code> and <code class="inline">error_logger_file_h</code> now inserts the node
information for nonlocal messages before the message itself instead of after,
both for readability and so as not to change the line termination property at
the end of the message.</p><p>Own Id: OTP-14068</p></li><li><p>The Erlang code linter checks for badly formed type constraints.</p><p>Own Id: OTP-14070 Aux Id: PR-1214</p></li><li><p>By default, there will now be a warning when <code class="inline">export_all</code> is used. The warning
can be disabled using <code class="inline">nowarn_export_all</code>.</p><p>Own Id: OTP-14071</p></li><li><p>When a <code class="inline">gen_server</code> process crashes, the stacktrace for the client will be
printed to facilitate debugging.</p><p>Own Id: OTP-14089</p></li><li><p>Optimized ETS operations by changing table identifier type from integer to
reference. The reference enables a more direct mapping to the table with less
potential lock contention and makes especially creation and deletion of tables
scale much better.</p><p>The change of the opaque type for the ETS table identifiers may cause failure
in code that make faulty assumptions about this opaque type.</p><section role="note" class="admonition info"><h4 class="admonition-title info">Note</h4><p>The number of tables stored at one Erlang node <em>used</em> to be limited. This is
no longer the case (except by memory usage). The previous default limit was
about 1400 tables and could be increased by setting the environment variable
<code class="inline">ERL_MAX_ETS_TABLES</code> before starting the Erlang runtime system. This hard
limit has been removed, but it is currently useful to set the
<code class="inline">ERL_MAX_ETS_TABLES</code> anyway. It should be set to an approximate of the
maximum amount of tables used. This since an internal table for named tables
is sized using this value. If large amounts of named tables are used and
<code class="inline">ERL_MAX_ETS_TABLES</code> hasn't been increased, the performance of named table
lookup will degrade.</p></section><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-14094</p></li><li><p><code class="inline">take/2</code> has been added to <code class="inline">dict</code>, <code class="inline">orddict</code>, and <code class="inline">gb_trees</code>. <code class="inline">take_any/2</code> has
been added to <code class="inline">gb_trees</code>.</p><p>Own Id: OTP-14102</p></li><li><p>Extend gen_event API to handle options as well.</p><p>Own Id: OTP-14123</p></li><li><p>Advice on how to tune the supervisor restart frequency (intensity and period)
is added to System Documentation - Design Principles - Supervisor Behaviour.</p><p>Own Id: OTP-14168 Aux Id: PR-1289</p></li><li><p>gen_fsm is deprecated and is replaced by gen_statem, however for backwards
compatibility reasons gen_fsm may continue to exist as an undocumented feature
for quite some time.</p><p>Own Id: OTP-14183</p></li><li><p>The shell functions <code class="inline">c/1</code> and <code class="inline">c/2</code> have been extended so that if the argument
is a module name instead of a file name, it automatically locates the .beam
file and the corresponding source file, and then recompiles the module using
the same compiler options (plus any options passed to c/2). If compilation
fails, the old beam file is preserved. Also adds <code class="inline">c(Mod, Opts, Filter)</code>, where
the Filter argument allows you to remove old compiler options before the new
options are added.</p><p>New utility functions <code class="inline">file_find/2/3</code> and <code class="inline">find_source/1/2/3</code> have been added
to <code class="inline">filelib</code>.</p><p>Own Id: OTP-14190</p></li><li><p><code class="inline">erl_tar</code> in previous versions of OTP only supports the USTAR format. That
limited path names to at most 255 bytes, and did not support Unicode
characters in names in a portable way.</p><p><code class="inline">erl_tar</code> now has support for reading tar archives in the formats currently in
common use, such as v7, STAR, USTAR, PAX, and GNU tar's extensions to the
STAR/USTAR format. When writing tar archives, <code class="inline">erl_tar</code> can now write them in
the <code class="inline">PAX</code> format if necessary (for example, to support very long filenames or
filenames with Unicode characters). If possible, <code class="inline">erl_tar</code> will still write
tar archives in the USTAR for maximum portability.</p><p>Own Id: OTP-14226</p></li><li><p><a href="base64.html#mime_decode/1"><code class="inline">base64:mime_decode/1</code></a> has been optimized so that it is now almost as fast
as<a href="base64.html#decode/1"><code class="inline">base64:decode/1</code></a>; it used be noticeably slower.</p><p>Own Id: OTP-14245</p></li><li><p><code class="inline">erl_tar</code> will now strip any leading '<code class="inline">/</code>' from pathnames when extracting
files from a tar archive and write a message to the error logger. There is
also new check for directory traversal attacks; if a relative path points
above the current working directory the extraction will be aborted.</p><p>Own Id: OTP-14278</p></li><li><p>Miscellaneous updates due to atoms containing arbitrary Unicode characters.</p><p>Own Id: OTP-14285</p></li><li><p>The Crypto application now supports generation of cryptographically strong
random numbers (floats &lt; 1.0 and integer arbitrary ranges) as a plugin to the
'rand' module.</p><p>Own Id: OTP-14317 Aux Id: PR-1372</p></li><li><p>Add new function <a href="ets.html#select_replace/2"><code class="inline">ets:select_replace/2</code></a> which performs atomic
&quot;compare-and-swap&quot; operations for ETS objects using match specifications.</p><p>Own Id: OTP-14319 Aux Id: PR-1076</p></li><li><p>The Erlang code linter checks for bad <code class="inline">dialyzer</code> attributes. It also checks
for bad type variables in type declarations.</p><p>Own Id: OTP-14323</p></li><li><p>Two new functions has been implemented in the <code class="inline">rand</code> module; <code class="inline">normal/2</code> and
<code class="inline">normal_s/3</code>, that both produce normal distribution (pseudo) random numbers
with mean value and variance according to arguments.</p><p>Own Id: OTP-14328 Aux Id: PR-1382</p></li><li><p>Upgraded the OTP internal PCRE library from version 8.33 to version 8.40. This
library is used for implementation of the <a href="re.html"><code class="inline">re</code></a> regular expressions module.</p><p>Besides various bug fixes, the new version allows for better stack protection.
In order to utilize this feature, the stack size of normal scheduler threads
is now by default set to 128 kilo words on all platforms. The stack size of
normal scheduler threads can be set upon system start by passing the
<a href="../../apps/erts/erl_cmd.html#sched_thread_stack_size"><code class="inline">+sss</code></a> command line argument to
the <a href="../../apps/erts/erl_cmd.html"><code class="inline">erl</code></a> command.</p><p>See
<a href="http://pcre.org/original/changelog.txt">http://pcre.org/original/changelog.txt</a>
for information about changes made to PCRE between the versions 8.33 and 8.40.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-14331 Aux Id: ERL-208</p></li><li><p>Added function <a href="re.html#version/0"><code class="inline">re:version/0</code></a> which returns information about the OTP internal
PCRE version used for implementation of the <code class="inline">re</code> module.</p><p>Own Id: OTP-14347 Aux Id: PR-1412</p></li><li><p>The format of debug information that is stored in BEAM files (when
<code class="inline">debug_info</code> is used) has been changed. The purpose of the change is to better
support other BEAM-based languages such as Elixir or LFE.</p><p>All tools included in OTP (dialyzer, debugger, cover, and so on) will handle
both the new format and the previous format. Tools that retrieve the debug
information using <code class="inline">beam_lib:chunk(Beam, [abstract_code])</code> will continue to
work with both the new and old format. Tools that call
<code class="inline">beam_lib:chunk(Beam, [&quot;Abst&quot;])</code> will not work with the new format.</p><p>For more information, see the description of <code class="inline">debug_info</code> in the documentation
for <code class="inline">beam_lib</code> and the description of the <code class="inline">{debug_info,{Backend,Data}}</code> option
in the documentation for <code class="inline">compile</code>.</p><p>Own Id: OTP-14369 Aux Id: PR-1367</p></li><li><p>Add option hibernate_after to gen_server, gen_statem and gen_event. Also added
to the deprecated gen_fsm behaviour.</p><p>Own Id: OTP-14405</p></li><li><p>The size of crash reports created by <code class="inline">gen_server</code>, <code class="inline">gen_statem</code> and <code class="inline">proc_lib</code>
is limited with aid of the Kernel application variable
<code class="inline">error_logger_format_depth</code>. The purpose is to limit the size of the messages
sent to the <code class="inline">error_logger</code> process when processes with huge message queues or
states crash.</p><p>The crash report generated by <code class="inline">proc_lib</code> includes the new tag
<code class="inline">message_queue_len</code>. The neighbour report also includes the new tag
<code class="inline">current_stacktrace</code>. Finally, the neighbour report no longer includes the
tags <code class="inline">messages</code> and <code class="inline">dictionary</code>.</p><p>The new function <a href="../../apps/kernel/error_logger.html#get_format_depth/0"><code class="inline">error_logger:get_format_depth/0</code></a> can be used to retrieve the
value of the Kernel application variable <code class="inline">error_logger_format_depth</code>.</p><p>Own Id: OTP-14417</p></li></ul><h2 id="stdlib-3-3" class="section-heading"><a href="#stdlib-3-3" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.3</span></h2><h3 id="fixed-bugs-and-malfunctions-88" class="section-heading"><a href="#fixed-bugs-and-malfunctions-88" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>An escript with only two lines would not work.</p><p>Own Id: OTP-14098</p></li><li><p>Characters (<code class="inline">$char</code>) can be used in constant pattern expressions. They can
also be used in types and contracts.</p><p>Own Id: OTP-14103 Aux Id: ERL-313</p></li><li><p>The signatures of <a href="erl_parse.html#anno_to_term/1"><code class="inline">erl_parse:anno_to_term/1</code></a> and <a href="erl_parse.html#anno_from_term/1"><code class="inline">erl_parse:anno_from_term/1</code></a>
are corrected. Using these functions no longer results in false Dialyzer
warnings.</p><p>Own Id: OTP-14131</p></li><li><p>Pretty-printing of maps is improved.</p><p>Own Id: OTP-14175 Aux Id: seq13277</p></li><li><p>If any of the following functions in the <code class="inline">zip</code> module crashed, a file would be
left open: <code class="inline">extract()</code>, <code class="inline">unzip()</code>, <code class="inline">create()</code>, or <code class="inline">zip()</code>. This has been
corrected.</p><p>A <code class="inline">zip</code> file having a &quot;Unix header&quot; could not be unpacked.</p><p>Own Id: OTP-14189 Aux Id: ERL-348, ERL-349</p></li><li><p>Improve the Erlang shell's tab-completion of long names.</p><p>Own Id: OTP-14200 Aux Id: ERL-352</p></li><li><p>The reference manual for <code class="inline">sys</code> had some faulty information about the
'get_modules' message used by processes where modules change dynamically
during runtime. The documentation is now corrected.</p><p>Own Id: OTP-14248 Aux Id: ERL-367</p></li></ul><h3 id="improvements-and-new-features-33" class="section-heading"><a href="#improvements-and-new-features-33" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>Bug fixes, new features and improvements to gen_statem:</p><p>A new type init_result/1 has replaced the old init_result/0, so if you used
that old type (that was never documented) you have to change your code, which
may be regarded as a potential incompatibility.</p><p>Changing callback modes after code change did not work since the new callback
mode was not recorded. This bug has been fixed.</p><p>The event types state_timeout and {call,From} could not be generated with a
{next_event,EventType,EventContent} action since they did not pass the
runtime type check. This bug has now been corrected.</p><p>State entry calls can now be repeated using (new) state callback returns
{repeat<em>state,...}, {repeat_state_and_data,</em>} and repeat_state_and_data.</p><p>There have been lots of code cleanup in particular regarding timer handling.
For example is async cancel_timer now used. Error handling has also been
cleaned up.</p><p>To align with probable future changes to the rest of gen_*, terminate/3 has
now got a fallback and code_change/4 is not mandatory.</p><p>Own Id: OTP-14114</p></li><li><p><code class="inline">filename:safe_relative_path/1</code> to sanitize a relative path has been added.</p><p>Own Id: OTP-14215</p></li></ul><h2 id="stdlib-3-2" class="section-heading"><a href="#stdlib-3-2" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.2</span></h2><h3 id="fixed-bugs-and-malfunctions-89" class="section-heading"><a href="#fixed-bugs-and-malfunctions-89" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>When a simple_one_for_one supervisor is shutting down, and a child exits with
an exit reason of the form {shutdown, Term}, an error report was earlier
printed. This is now corrected.</p><p>Own Id: OTP-13907 Aux Id: PR-1158, ERL-163</p></li><li><p>Allow empty list as parameter of the fun used with <a href="../../apps/runtime_tools/dbg.html#fun2ms/1"><code class="inline">dbg:fun2ms/1</code></a>.</p><p>Own Id: OTP-13974</p></li></ul><h3 id="improvements-and-new-features-34" class="section-heading"><a href="#improvements-and-new-features-34" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>The new behaviour gen_statem has been improved with 3 new features: the
possibility to use old style non-proxy timeouts for gen_statem:call/2,3, state
entry code, and state timeouts. These are backwards compatible. Minor code and
documentation improvements has been performed including a borderline semantics
correction of timeout zero handling.</p><p>Own Id: OTP-13929 Aux Id: PR-1170, ERL-284</p></li></ul><h2 id="stdlib-3-1" class="section-heading"><a href="#stdlib-3-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.1</span></h2><h3 id="fixed-bugs-and-malfunctions-90" class="section-heading"><a href="#fixed-bugs-and-malfunctions-90" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>The <code class="inline">zip:unzip/1,2</code> and <code class="inline">zip:extract/1,2</code> functions have been updated to
handle directory traversal exploits. Any element in the zip file that contains
a path that points to a directory above the top level working directory,
<code class="inline">cwd</code>, will instead be extracted in <code class="inline">cwd</code>. An error message is printed for any
such element in the zip file during the unzip operation. The <code class="inline">keep_old_files</code>
option determines if a file will overwrite a previous file with the same name
within the zip file.</p><p>Own Id: OTP-13633</p></li><li><p>Correct the contracts for <code class="inline">ets:match_object/1,3</code>.</p><p>Own Id: OTP-13721 Aux Id: PR-1113</p></li><li><p>Errors in type specification and Emacs template generation for
<code class="inline">gen_statem:code_change/4</code> has been fixed from bugs.erlang.org's Jira cases
ERL-172 and ERL-187.</p><p>Own Id: OTP-13746 Aux Id: ERL-172, ERL-187</p></li></ul><h3 id="improvements-and-new-features-35" class="section-heading"><a href="#improvements-and-new-features-35" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>gen_statem has been changed to set the callback mode for a server to what
Module:callback_mode/0 returns. This facilitates e.g code downgrade since the
callback mode now becomes a property of the currently active code, not of the
server process.</p><p>Exception handling from Module:init/1 has also been improved.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-13752</p></li></ul><h2 id="stdlib-3-0-1" class="section-heading"><a href="#stdlib-3-0-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.0.1</span></h2><h3 id="fixed-bugs-and-malfunctions-91" class="section-heading"><a href="#fixed-bugs-and-malfunctions-91" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Correct a bug regarding typed records in the Erlang shell. The bug was
introduced in OTP-19.0.</p><p>Own Id: OTP-13719 Aux Id: ERL-182</p></li></ul><h2 id="stdlib-3-0" class="section-heading"><a href="#stdlib-3-0" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 3.0</span></h2><h3 id="fixed-bugs-and-malfunctions-92" class="section-heading"><a href="#fixed-bugs-and-malfunctions-92" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Fix a race bug affecting <a href="dets.html#open_file/2"><code class="inline">dets:open_file/2</code></a>.</p><p>Own Id: OTP-13260 Aux Id: seq13002</p></li><li><p>Don't search for non-existing Map keys twice</p><p>For <code class="inline">maps:get/2,3</code> and <a href="maps.html#find/2"><code class="inline">maps:find/2</code></a>, searching for an immediate key, e.g. an
atom, in a small map, the search was performed twice if the key did not exist.</p><p>Own Id: OTP-13459</p></li><li><p>Avoid stray corner-case math errors on Solaris, e.g. an error is thrown on
underflows in exp() and pow() when it shouldn't be.</p><p>Own Id: OTP-13531</p></li><li><p>Fix linting of map key variables</p><p>Map keys cannot be unbound and then used in parallel matching.</p><p>Example: <code class="inline">#{ K := V } = #{ k := K } = M.</code> This is illegal if <code class="inline">'K'</code> is not
bound.</p><p>Own Id: OTP-13534 Aux Id: ERL-135</p></li><li><p>Fixed a bug in re on openbsd where sometimes re:run would return an incorrect
result.</p><p>Own Id: OTP-13602</p></li><li><p>To avoid potential timer bottleneck on supervisor restart, timer server is no
longer used when the supervisor is unable to restart a child.</p><p>Own Id: OTP-13618 Aux Id: PR-1001</p></li><li><p>The Erlang code preprocessor (<code class="inline">epp</code>) can handle file names spanning over many
tokens. Example: <code class="inline">-include(&quot;a&quot; &quot;file&quot; &quot;name&quot;).</code>.</p><p>Own Id: OTP-13662 Aux Id: seq13136</p></li></ul><h3 id="improvements-and-new-features-36" class="section-heading"><a href="#improvements-and-new-features-36" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>The types of The Abstract Format in the <code class="inline">erl_parse</code> module have been refined.</p><p>Own Id: OTP-10292</p></li><li><p>Undocumented syntax for function specifications,
<code class="inline">-spec F/A :: Domain -&gt; Range</code>, has been removed (without deprecation).</p><p>Using the <code class="inline">is_subtype(V, T)</code> syntax for constraints (in function
specifications) is no longer documented, and the newer syntax <code class="inline">V :: T</code> should
be used instead. The Erlang Parser still recognizes the <code class="inline">is_subtype</code> syntax,
and will continue to do so for some time.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-11879</p></li><li><p>The '<code class="inline">random</code>' module has been deprecated. Use the '<code class="inline">rand</code>' module instead.</p><p>Own Id: OTP-12502 Aux Id: OTP-12501</p></li><li><p>Background: In record fields with a type declaration but without an
initializer, the Erlang parser inserted automatically the singleton type
<code class="inline">'undefined'</code> to the list of declared types, if that value was not present
there. That is, the record declaration:</p><p>-record(rec, {f1 :: float(), f2 = 42 :: integer(), f3 ::
some_mod:some_typ()}).</p><p>was translated by the parser to:</p><table><tbody><tr><td style="text-align: left;">-record(rec, {f1 :: float()</td><td style="text-align: left;">'undefined', f2 = 42 :: integer(), f3 ::</td></tr><tr><td style="text-align: left;">some_mod:some_typ()</td><td style="text-align: left;">'undefined'}).</td></tr></tbody></table><p>The rationale for this was that creation of a &quot;dummy&quot; <code class="inline">#rec{}</code> record should
not result in a warning from dialyzer that, for example, the implicit
initialization of the <code class="inline">#rec.f1</code> field violates its type declaration.</p><p>Problems: This seemingly innocent action has some unforeseen consequences.</p><p>For starters, there is no way for programmers to declare that e.g. only floats
make sense for the <code class="inline">f1</code> field of <code class="inline">#rec{}</code> records when there is no &quot;obvious&quot;
default initializer for this field. (This also affects tools like PropEr that
use these declarations produced by the Erlang parser to generate random
instances of records for testing purposes.)</p><p>It also means that dialyzer does not warn if e.g. an
<a href="../../apps/erts/erlang.html#is_atom/1"><code class="inline">is_atom/1</code></a> test or something more exotic like an
<a href="../../apps/erts/erlang.html#atom_to_list/1"><code class="inline">atom_to_list/1</code></a> call is performed on the value of the
<code class="inline">f1</code> field.</p><p>Similarly, there is no way to extend dialyzer to warn if it finds record
constructions where <code class="inline">f1</code> is not initialized to some float.</p><p>Last but not least, it is semantically problematic when the type of the field
is an opaque type: creating a union of an opaque and a structured type is very
problematic for analysis because it fundamentally breaks the opacity of the
term at that point.</p><p>Change: To solve these problems the parser will not automatically insert the
<code class="inline">'undefined'</code> value anymore; instead the user has the option to choose the
places where this value makes sense (for the field) and where it does not and
insert the <code class="inline">| 'undefined'</code> there manually.</p><p>Consequences of this change: This change means that dialyzer will issue a
warning for all places where records with uninitialized fields are created and
those fields have a declared type that is incompatible with <code class="inline">'undefined'</code>
(e.g. <a href="../../apps/erts/erlang.html#t:float/0"><code class="inline">float/0</code></a>). This warning can be suppressed easily by adding
<code class="inline">| 'undefined'</code> to the type of this field. This also adds documentation that
the user really intends to create records where this field is uninitialized.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-12719</p></li><li><p>Remove deprecated functions in the modules <code class="inline">erl_scan</code> and <code class="inline">erl_parse</code>.</p><p>Own Id: OTP-12861</p></li><li><p>The pre-processor can now expand the ?FUNCTION_NAME and ?FUNCTION_ARITY
macros.</p><p>Own Id: OTP-13059</p></li><li><p>A new behaviour <code class="inline">gen_statem</code> has been implemented. It has been thoroughly
reviewed, is stable enough to be used by at least two heavy OTP applications,
and is here to stay. But depending on user feedback, we do not expect but
might find it necessary to make minor not backwards compatible changes into
OTP-20.0, so its state can be designated as &quot;not quite experimental&quot;...</p><p>The <code class="inline">gen_statem</code> behaviour is intended to replace <code class="inline">gen_fsm</code> for new code. It
has the same features and add some really useful:</p><ul><li>State code is gathered</li><li>The state can be any term</li><li>Events can be postponed</li><li>Events can be self generated</li><li>A reply can be sent from a later state</li><li>There can be multiple sys traceable replies</li></ul><p>The callback model(s) for <code class="inline">gen_statem</code> differs from the one for <code class="inline">gen_fsm</code>, but
it is still fairly easy to rewrite from <code class="inline">gen_fsm</code> to <code class="inline">gen_statem</code>.</p><p>Own Id: OTP-13065 Aux Id: PR-960</p></li><li><p>Optimize binary:split/2 and binary:split/3 with native BIF implementation.</p><p>Own Id: OTP-13082</p></li><li><p>Background: The types of record fields have since R12B been put in a separate
form by <code class="inline">epp:parse_file()</code>, leaving the record declaration form untyped. The
separate form, however, does not follow the syntax of type declarations, and
parse transforms inspecting <code class="inline">-type()</code> attributes need to know about the
special syntax. Since the compiler stores the return value of
<code class="inline">epp:parse_file()</code> as debug information in the abstract code chunk (<code class="inline">&quot;Abst&quot;</code>
or <code class="inline">abstract_code</code>), tools too need to know about the special syntax, if they
inspect <code class="inline">-type()</code> attributes in abstract code.</p><p>Change: No separate type form is created by <code class="inline">epp:parse_file()</code>, but the type
information is kept in the record fields. This means that all parse transforms
and all tools inspecting <code class="inline">-record()</code> declarations need to recognize
<code class="inline">{typed_record_field, Field, Type}</code>.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-13148</p></li><li><p>Unsized fields of the type <code class="inline">bytes</code> in binary generators are now forbidden.
(The other ways of writing unsized fields, such as <code class="inline">binary</code>, are already
forbidden.)</p><p>Own Id: OTP-13152</p></li><li><p>The type <a href="../../apps/erts/erlang.html#t:map/0"><code class="inline">map/0</code></a> is built-in, and cannot be redefined.</p><p>Own Id: OTP-13153</p></li><li><p>Let <code class="inline">dets:open_file()</code> exit with a <code class="inline">badarg</code> message if given a raw file name
(a binary).</p><p>Own Id: OTP-13229 Aux Id: ERL-55</p></li><li><p>Add <code class="inline">filename:basedir/2,3</code></p><p>basedir returns suitable path(s) for 'user_cache', 'user_config', 'user_data',
'user_log', 'site_config' and 'site_data'. On linux and linux like systems the
paths will respect the XDG environment variables.</p><p>Own Id: OTP-13392</p></li><li><p>There are new preprocessor directives <code class="inline">-error(Term)</code> and <code class="inline">-warning(Term)</code> to
cause a compilation error or a compilation warning, respectively.</p><p>Own Id: OTP-13476</p></li><li><p>Optimize <code class="inline">'++'</code> operator and <a href="lists.html#append/2"><code class="inline">lists:append/2</code></a> by using a single pass to build
a new list while checking for properness.</p><p>Own Id: OTP-13487</p></li><li><p>Add <code class="inline">maps:update_with/3,4</code> and <a href="maps.html#take/2"><code class="inline">maps:take/2</code></a></p><p>Own Id: OTP-13522 Aux Id: PR-1025</p></li><li><p><a href="lists.html#join/2"><code class="inline">lists:join/2</code></a> has been added. Similar to <a href="string.html#join/2"><code class="inline">string:join/2</code></a> but works with
arbitrary lists.</p><p>Own Id: OTP-13523</p></li><li><p>Obfuscate asserts to make Dialyzer shut up.</p><p>Own Id: OTP-13524 Aux Id: PR-1002</p></li><li><p>Supervisors now explicitly add their callback module in the return from
sys:get_status/1,2. This is to simplify custom supervisor implementations. The
Misc part of the return value from sys:get_status/1,2 for a supervisor is now:</p><p>[{data, [{&quot;State&quot;, State}]},{supervisor,[{&quot;Callback&quot;,Module}]}]</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-13619 Aux Id: PR-1000</p></li><li><p>Relax translation of initial calls in <code class="inline">proc_lib</code>, i.e. remove the restriction
to only do the translation for <code class="inline">gen_server</code> and <code class="inline">gen_fsm</code>. This enables user
defined <code class="inline">gen</code> based generic callback modules to be displayed nicely in <code class="inline">c:i()</code>
and observer.</p><p>Own Id: OTP-13623</p></li><li><p>The function <a href="queue.html#lait/1"><code class="inline">queue:lait/1</code></a> (misspelling of <code class="inline">liat/1</code>) is now deprecated.</p><p>Own Id: OTP-13658</p></li></ul><h2 id="stdlib-2-8-0-1" class="section-heading"><a href="#stdlib-2-8-0-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 2.8.0.1</span></h2><h3 id="improvements-and-new-features-37" class="section-heading"><a href="#improvements-and-new-features-37" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>List subtraction (The <code class="inline">--</code> operator) will now yield properly on large inputs.</p><p>Own Id: OTP-15371</p></li></ul><h2 id="stdlib-2-8" class="section-heading"><a href="#stdlib-2-8" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 2.8</span></h2><h3 id="fixed-bugs-and-malfunctions-93" class="section-heading"><a href="#fixed-bugs-and-malfunctions-93" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Fix evaluation in matching of bound map key variables in the interpreter.</p><p>Prior to this patch, the following code would not evaluate:
<code class="inline">X = key,(fun(#{X := value}) -&gt; true end)(#{X =&gt; value})</code></p><p>Own Id: OTP-13218</p></li><li><p>Fix <code class="inline">erl_eval</code> not using non-local function handler.</p><p>Own Id: OTP-13228 Aux Id: ERL-32</p></li><li><p>The Erlang Code Linter no longer crashes if there is a <code class="inline">-deprecated()</code>
attribute but no <code class="inline">-module()</code> declaration.</p><p>Own Id: OTP-13230 Aux Id: ERL-62</p></li><li><p>The timestamp in the result returned by <code class="inline">dets:info(Tab, safe_fixed)</code> was
unintentionally broken as a result of the time API rewrites in OTP 18.0. This
has now been fixed.</p><p>Own Id: OTP-13239 Aux Id: OTP-11997</p></li><li><p>A rare race condition in <code class="inline">beam_lib</code> when using encrypted abstract format has
been eliminated.</p><p>Own Id: OTP-13278</p></li><li><p>Improved maps:with/2 and maps:without/2 algorithms</p><p>The new implementation speeds up the execution significantly for all sizes of
input.</p><p>Own Id: OTP-13376</p></li></ul><h3 id="improvements-and-new-features-38" class="section-heading"><a href="#improvements-and-new-features-38" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>Time warp safety improvements.</p><p>Introduced the options <code class="inline">monotonic_timestamp</code>, and <code class="inline">strict_monotonic_timestamp</code>
to the trace, sequential trace, and system profile functionality. This since
the already existing <code class="inline">timestamp</code> option is not time warp safe.</p><p>Introduced the option <code class="inline">safe_fixed_monotonic_time</code> to <a href="ets.html#info/2"><code class="inline">ets:info/2</code></a> and
<a href="dets.html#info/2"><code class="inline">dets:info/2</code></a>. This since the already existing <code class="inline">safe_fixed</code> option is not time
warp safe.</p><p>Own Id: OTP-13222 Aux Id: OTP-11997</p></li><li><p>In the shell Ctrl+W (delete word) will no longer consider &quot;.&quot; as being part of
a word.</p><p>Own Id: OTP-13281</p></li></ul><h2 id="stdlib-2-7" class="section-heading"><a href="#stdlib-2-7" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 2.7</span></h2><h3 id="fixed-bugs-and-malfunctions-94" class="section-heading"><a href="#fixed-bugs-and-malfunctions-94" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>The Erlang Pretty Printer uses <code class="inline">::</code> for function type constraints.</p><p>A bug concerning pretty printing of annotated type union elements in map pair
types has been fixed.</p><p>Some minor issues regarding the documentation of types and specs have been
corrected.</p><p>Own Id: OTP-13084</p></li><li><p>The shell command <code class="inline">rp</code> prints strings as lists of integers if pretty printing
of lists is set to <code class="inline">false</code>.</p><p>Own Id: OTP-13145</p></li><li><p>The shell would crash if a bit syntax expression with conflicting types were
given (e.g. if a field type was given as '<code class="inline">integer-binary</code>'). (Thanks to
Aleksei Magusev for reporting this bug.)</p><p>Own Id: OTP-13157</p></li><li><p>The <a href="rand.html#export_seed/0"><code class="inline">rand:export_seed/0</code></a> would never return '<code class="inline">undefined</code>' even if no seed has
previously been created. Fixed to return '<code class="inline">undefined</code>' if there is no seed in
the process dictionary.</p><p>Own Id: OTP-13162</p></li></ul><h3 id="improvements-and-new-features-39" class="section-heading"><a href="#improvements-and-new-features-39" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>Add support for the Delete, Home and End keys in the Erlang shell.</p><p>Own Id: OTP-13032</p></li><li><p><a href="beam_lib.html#all_chunks/1"><code class="inline">beam_lib:all_chunks/1</code></a> and <a href="beam_lib.html#build_module/1"><code class="inline">beam_lib:build_module/1</code></a> have been documented.</p><p>Own Id: OTP-13063</p></li></ul><h2 id="stdlib-2-6" class="section-heading"><a href="#stdlib-2-6" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 2.6</span></h2><h3 id="fixed-bugs-and-malfunctions-95" class="section-heading"><a href="#fixed-bugs-and-malfunctions-95" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>In OTP 18.0, <code class="inline">qlc</code> does not handle syntax errors well. This bug has been
fixed.</p><p>Own Id: OTP-12946</p></li><li><p>Optimize zip:unzip/2 when uncompressing to memory.</p><p>Own Id: OTP-12950</p></li><li><p>The STDLIB reference manual is updated to show correct information about the
return value of <a href="gen_fsm.html#reply/2"><code class="inline">gen_fsm:reply/2</code></a>.</p><p>Own Id: OTP-12973</p></li><li><p>re:split2,3 and re:replace/3,4 now correctly handles pre-compiled patterns
that have been compiled using the '<code class="inline">unicode</code>' option.</p><p>Own Id: OTP-12977</p></li><li><p>Export <a href="shell.html#catch_exception/1"><code class="inline">shell:catch_exception/1</code></a> as documented.</p><p>Own Id: OTP-12990</p></li></ul><h3 id="improvements-and-new-features-40" class="section-heading"><a href="#improvements-and-new-features-40" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>A mechanism for limiting the amount of text that the built-in error logger
events will produce has been introduced. It is useful for limiting both the
size of log files and the CPU time used to produce them.</p><p>This mechanism is experimental in the sense that it may be changed if it turns
out that it does not solve the problem it is supposed to solve. In that case,
there may be backward incompatible improvements to this mechanism.</p><p>See the documentation for the config parameter <code class="inline">error_logger_format_depth</code> in
the Kernel application for information about how to turn on this feature.</p><p>Own Id: OTP-12864</p></li></ul><h2 id="stdlib-2-5" class="section-heading"><a href="#stdlib-2-5" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 2.5</span></h2><h3 id="fixed-bugs-and-malfunctions-96" class="section-heading"><a href="#fixed-bugs-and-malfunctions-96" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Fix handling of single dot in filename:join/2</p><p>The reference manual says that filename:join(A,B) is equivalent to
filename:join([A,B]). In some rare cases this turns out not to be true. For
example:</p><p><code class="inline">filename:join(&quot;/a/.&quot;,&quot;b&quot;) -&gt; &quot;/a/./b&quot;</code> vs
<code class="inline">filename:join([&quot;/a/.&quot;,&quot;b&quot;]) -&gt; &quot;/a/b&quot;</code>.</p><p>This has been corrected. A single dot is now only kept if it occurs at the
very beginning or the very end of the resulting path.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-12158</p></li><li><p>The undocumented option <code class="inline">generic_debug</code> for <code class="inline">gen_server</code> has been removed.</p><p>Own Id: OTP-12183</p></li><li><p>erl_lint:icrt_export/4 has been rewritten to make the code really follow the
scoping rules of Erlang, and not just in most situations by accident.</p><p>Own Id: OTP-12186</p></li><li><p>Add 'trim_all' option to binary:split/3</p><p>This option can be set to remove _ALL_ empty parts of the result of a call
to binary:split/3.</p><p>Own Id: OTP-12301</p></li><li><p>Correct orddict(3) regarding evaluation order of <code class="inline">fold()</code> and <a href="../../apps/erts/erlang.html#t:map/0"><code class="inline">map/0</code></a>.</p><p>Own Id: OTP-12651 Aux Id: seq12832</p></li><li><p>Correct <code class="inline">maps</code> module error exceptions</p><p>Bad input to maps module function will now yield the following exceptions:</p><ul><li>{badmap, NotMap}, or</li><li>badarg.</li></ul><p>Own Id: OTP-12657</p></li><li><p>It is now possible to paste text in JCL mode (using Ctrl-Y) that has been
copied in the previous shell session. Also a bug that caused the JCL mode to
crash when pasting text has been fixed.</p><p>Own Id: OTP-12673</p></li><li><p>Add <code class="inline">uptime()</code> shell command.</p><p>Own Id: OTP-12752</p></li><li><p>Cache nowarn_bif_clash functions in erl_lint.</p><p>This patch stores nowarn_bif_clash in the lint record. By using erlc
+'{eprof,lint_module}' when compiling the erlang parser, we noticed the time
spent on nowarn_function/2 reduced from 30% to 0.01%.</p><p>Own Id: OTP-12754</p></li><li><p>Optimize the Erlang Code Linter by using the cached filename information.</p><p>Own Id: OTP-12772</p></li><li><p>If a child of a simple_one_for_one returns ignore from its start function no
longer store the child for any restart type. It is not possible to restart or
delete the child because the supervisor is a simple_one_for_one.</p><p>Own Id: OTP-12793</p></li><li><p>Make <code class="inline">ets:file2tab</code> preserve enabled <code class="inline">read_concurrency</code> and
<code class="inline">write_concurrency</code> options for tables.</p><p>Own Id: OTP-12814</p></li><li><p>There are many cases where user code needs to be able to distinguish between a
socket that was closed normally and one that was aborted. Setting the option
{show_econnreset, true} enables the user to receive ECONNRESET errors on
both active and passive sockets.</p><p>Own Id: OTP-12841</p></li></ul><h3 id="improvements-and-new-features-41" class="section-heading"><a href="#improvements-and-new-features-41" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>Allow maps for supervisor flags and child specs</p><p>Earlier, supervisor flags and child specs were given as tuples. While this is
kept for backwards compatibility, it is now also allowed to give these
parameters as maps, see <a href="supervisor.html#sup_flags">sup_flags</a> and
<a href="supervisor.html#child_spec">child_spec</a>.</p><p>Own Id: OTP-11043</p></li><li><p>A new system message, <code class="inline">terminate</code>, is added. This can be sent with
<code class="inline">sys:terminate/2,3</code>. If the receiving process handles system messages properly
it will terminate shortly after receiving this message.</p><p>The new function <code class="inline">proc_lib:stop/1,3</code> utilizes this new system message and
monitors the receiving process in order to facilitate a synchronous stop
mechanism for 'special processes'.</p><p><code class="inline">proc_lib:stop/1,3</code> is used by the following functions:</p><ul><li><code class="inline">gen_server:stop/1,3</code> (new)</li><li><code class="inline">gen_fsm:stop/1,3</code> (new)</li><li><code class="inline">gen_event:stop/1,3</code> (modified to be synchronous)</li><li><code class="inline">wx_object:stop/1,3</code> (new)</li></ul><p>Own Id: OTP-11173 Aux Id: seq12353</p></li><li><p>Remove the <code class="inline">pg</code> module, which has been deprecated through OTP-17, is now
removed from the STDLIB application. This module has been marked experimental
for more than 15 years, and has largely been superseded by the <code class="inline">pg2</code> module
from the Kernel application.</p><p>Own Id: OTP-11907</p></li><li><p>New BIF: <a href="../../apps/erts/erlang.html#get_keys/0"><code class="inline">erlang:get_keys/0</code></a>, lists all keys associated with the process
dictionary. Note: <a href="../../apps/erts/erlang.html#get_keys/0"><code class="inline">erlang:get_keys/0</code></a> is auto-imported.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-12151 Aux Id: seq12521</p></li><li><p>Add three new functions to <code class="inline">io_lib</code>-- <code class="inline">scan_format/2</code>, <code class="inline">unscan_format/1</code>, and
<code class="inline">build_text/1</code>-- which expose the parsed form of the format control sequences
to make it possible to easily modify or filter the input to <a href="io_lib.html#format/2"><code class="inline">io_lib:format/2</code></a>.
This can e.g. be used in order to replace unbounded-size control sequences
like <code class="inline">~w</code> or <code class="inline">~p</code> with corresponding depth-limited <code class="inline">~W</code> and <code class="inline">~P</code> before doing
the actual formatting.</p><p>Own Id: OTP-12167</p></li><li><p>Introduce the <code class="inline">erl_anno</code> module, an abstraction of the second element of
tokens and tuples in the abstract format.</p><p>Own Id: OTP-12195</p></li><li><p>Support variables as Map keys in expressions and patterns</p><p>Erlang will accept any expression as keys in Map expressions and it will
accept literals or bound variables as keys in Map patterns.</p><p>Own Id: OTP-12218</p></li><li><p>The last traces of Mnemosyne Rules have been removed.</p><p>Own Id: OTP-12257</p></li><li><p>Properly support maps in match_specs</p><p>Own Id: OTP-12270</p></li><li><p>New function <a href="ets.html#take/2"><code class="inline">ets:take/2</code></a>. Works the same as <a href="ets.html#delete/2"><code class="inline">ets:delete/2</code></a> but also returns
the deleted object(s).</p><p>Own Id: OTP-12309</p></li><li><p><a href="string.html#tokens/2"><code class="inline">string:tokens/2</code></a> is somewhat faster, especially if the list of separators
only contains one separator character.</p><p>Own Id: OTP-12422 Aux Id: seq12774</p></li><li><p>The documentation of the Abstract Format (in the ERTS User's Guide) has been
updated with types and specification. (Thanks to Anthony Ramine.)</p><p>The explicit representation of parentheses used in types of the abstract
format has been removed. Instead the new functions
<code class="inline">erl_parse:type_inop_prec()</code> and <code class="inline">erl_parse:type_preop_prec()</code> can be used for
inserting parentheses where needed.</p><p>Own Id: OTP-12492</p></li><li><p>Prevent zip:zip_open/[12] from leaking file descriptors if parent process
dies.</p><p>Own Id: OTP-12566</p></li><li><p>Add a new random number generator, see <code class="inline">rand</code> module. It have better
characteristics and an improved interface.</p><p>Own Id: OTP-12586 Aux Id: OTP-12501, OTP-12502</p></li><li><p><a href="filename.html#split/1"><code class="inline">filename:split/1</code></a> when given an empty binary will now return an empty list,
to make it consistent with return value when given an empty list.</p><p>Own Id: OTP-12716</p></li><li><p>Add <code class="inline">sync</code> option to <a href="ets.html#tab2file/3"><code class="inline">ets:tab2file/3</code></a>.</p><p>Own Id: OTP-12737 Aux Id: seq12805</p></li><li><p>Add functions <code class="inline">gb_sets:iterator_from()</code> and <code class="inline">gb_trees:iterator_from()</code>.
(Thanks to Kirill Kinduk.)</p><p>Own Id: OTP-12742</p></li><li><p>Add <a href="maps.html#filter/2"><code class="inline">maps:filter/2</code></a> to maps module.</p><p>Own Id: OTP-12745</p></li><li><p>Change some internal data structures to Maps in order to speed up compilation
time. Measured speed up is around 10%-15%.</p><p>Own Id: OTP-12774</p></li><li><p>Update <code class="inline">orddict</code> to use parameterized types and specs. (Thanks to UENISHI
Kota.)</p><p>Own Id: OTP-12785</p></li><li><p>The assert macros in <code class="inline">eunit</code> has been moved out to
<code class="inline">stdlib/include/assert.hrl</code>. This files get included by <code class="inline">eunit.hrl</code>. Thus,
nothing changes for eunit users, but the asserts can now also be included
separately.</p><p>Own Id: OTP-12808</p></li></ul><h2 id="stdlib-2-4" class="section-heading"><a href="#stdlib-2-4" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 2.4</span></h2><h3 id="fixed-bugs-and-malfunctions-97" class="section-heading"><a href="#fixed-bugs-and-malfunctions-97" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Behaviour of character types \d, \w and \s has always been to not match
characters with value above 255, not 128, i.e. they are limited to ISO-Latin-1
and not ASCII</p><p>Own Id: OTP-12521</p></li></ul><h3 id="improvements-and-new-features-42" class="section-heading"><a href="#improvements-and-new-features-42" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>c:m/1 now displays the module's MD5 sum.</p><p>Own Id: OTP-12500</p></li><li><p>Make ets:i/1 handle binary input from IO server.</p><p>Own Id: OTP-12550</p></li></ul><h2 id="stdlib-2-3" class="section-heading"><a href="#stdlib-2-3" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 2.3</span></h2><h3 id="fixed-bugs-and-malfunctions-98" class="section-heading"><a href="#fixed-bugs-and-malfunctions-98" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>The documentation of string:tokens/2 now explicitly specifies that adjacent
separator characters do not give any empty strings in the resulting list of
tokens.</p><p>Own Id: OTP-12036</p></li><li><p>Fix broken deprecation warnings in ssh application</p><p>Own Id: OTP-12187</p></li><li><p>Maps: Properly align union typed assoc values in documentation</p><p>Own Id: OTP-12190</p></li><li><p>Fix filelib:wildcard/2 when 'Cwd' ends with a dot</p><p>Own Id: OTP-12212</p></li><li><p>Allow <code class="inline">Name/Arity</code> syntax in maps values inside attributes.</p><p>Own Id: OTP-12213</p></li><li><p>Fix edlin to correctly save text killed with ctrl-u. Prior to this fix,
entering text into the Erlang shell and then killing it with ctrl-u followed
by yanking it back with ctrl-y would result in the yanked text being the
reverse of the original killed text.</p><p>Own Id: OTP-12224</p></li><li><p>If a callback function was terminated with exit/1, there would be no stack
trace in the ERROR REPORT produced by gen_server. This has been corrected.</p><p>To keep the backwards compatibility, the actual exit reason for the process is
not changed.</p><p>Own Id: OTP-12263 Aux Id: seq12733</p></li><li><p>Warnings produced by <code class="inline">ms_transform</code> could point out the wrong line number.</p><p>Own Id: OTP-12264</p></li></ul><h3 id="improvements-and-new-features-43" class="section-heading"><a href="#improvements-and-new-features-43" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>Supports tar file creation on other media than file systems mounted on the
local machine.</p><p>The <code class="inline">erl_tar</code> api is extended with <a href="erl_tar.html#init/3"><code class="inline">erl_tar:init/3</code></a> that enables usage of user
provided media storage routines. A ssh-specific set of such routines is hidden
in the new function <a href="../../apps/ssh/ssh_sftp.html#open_tar/3"><code class="inline">ssh_sftp:open_tar/3</code></a> to simplify creating a tar archive
on a remote ssh server.</p><p>A chunked file reading option is added to <code class="inline">erl_tar:add/3,4</code> to save memory on
e.g small embedded systems. The size of the slices read from a file in that
case can be specified.</p><p>Own Id: OTP-12180 Aux Id: seq12715</p></li><li><p>I/O requests are optimized for long message queues in the calling process.</p><p>Own Id: OTP-12315</p></li></ul><h2 id="stdlib-2-2" class="section-heading"><a href="#stdlib-2-2" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 2.2</span></h2><h3 id="fixed-bugs-and-malfunctions-99" class="section-heading"><a href="#fixed-bugs-and-malfunctions-99" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>The type spec of the FormFunc argument to sys:handle_debug/4 was erroneously
pointing to dbg_fun(). This is now corrected and the new type is format_fun().</p><p>Own Id: OTP-11800</p></li><li><p>Behaviors such as gen_fsm and gen_server should always invoke format_status/2
before printing the state to the logs.</p><p>Own Id: OTP-11967</p></li><li><p>The documentation of <a href="dets.html#insert_new/2"><code class="inline">dets:insert_new/2</code></a> has been corrected. (Thanks to Alexei
Sholik for reporting the bug.)</p><p>Own Id: OTP-12024</p></li><li><p>Printing a term with io_lib:format and control sequence w, precision P and
field width F, where F&lt; P would fail in one of the two following ways:</p><ol><li><p>If P &lt; printed length of the term, an infinite loop would be entered,
consuming all available memory.</p></li><li><p>If P &gt;= printed length of the term, an exception would be raised.</p></li></ol><p>These two problems are now corrected.</p><p>Own Id: OTP-12041</p></li><li><p>The documentation of <a href="maps.html#values/1"><code class="inline">maps:values/1</code></a> has been corrected.</p><p>Own Id: OTP-12055</p></li><li><p>Expand shell functions in map expressions.</p><p>Own Id: OTP-12063</p></li></ul><h3 id="improvements-and-new-features-44" class="section-heading"><a href="#improvements-and-new-features-44" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>Add maps:with/2</p><p>Own Id: OTP-12137</p></li></ul><h2 id="stdlib-2-1-1" class="section-heading"><a href="#stdlib-2-1-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 2.1.1</span></h2><h3 id="fixed-bugs-and-malfunctions-100" class="section-heading"><a href="#fixed-bugs-and-malfunctions-100" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>OTP-11850 fixed filelib:wildcard/1 to work with broken symlinks. This
correction, however, introduced problems since symlinks were no longer
followed for functions like filelib:ensure_dir/1, filelib:is_dir/1,
filelib:file_size/1, etc. This is now corrected.</p><p>Own Id: OTP-12054 Aux Id: seq12660</p></li></ul><h2 id="stdlib-2-1" class="section-heading"><a href="#stdlib-2-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 2.1</span></h2><h3 id="fixed-bugs-and-malfunctions-101" class="section-heading"><a href="#fixed-bugs-and-malfunctions-101" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p><code class="inline">filelib:wildcard(&quot;broken_symlink&quot;)</code> would return an empty list if
&quot;broken_symlink&quot; was a symlink that did not point to an existing file.</p><p>Own Id: OTP-11850 Aux Id: seq12571</p></li><li><p><code class="inline">erl_tar</code> can now handle files names that contain Unicode characters. See
&quot;UNICODE SUPPORT&quot; in the documentation for <code class="inline">erl_tar</code>.</p><p>When creating a tar file, <code class="inline">erl_tar</code> would sometime write a too short end of
tape marker. GNU tar would correctly extract files from such tar file, but
would complain about &quot;A lone zero block at...&quot;.</p><p>Own Id: OTP-11854</p></li><li><p>When redefining and exporting the type <a href="../../apps/erts/erlang.html#t:map/0"><code class="inline">map/0</code></a> the Erlang Code Linter
(<code class="inline">erl_lint</code>) erroneously emitted an error. This bug has been fixed.</p><p>Own Id: OTP-11872</p></li><li><p>Fix evaluation of map updates in the debugger and erl_eval</p><p>Reported-by: José Valim</p><p>Own Id: OTP-11922</p></li></ul><h3 id="improvements-and-new-features-45" class="section-heading"><a href="#improvements-and-new-features-45" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>The following native functions now bump an appropriate amount of reductions
and yield when out of reductions:</p><ul><li><a href="../../apps/erts/erlang.html#binary_to_list/1"><code class="inline">erlang:binary_to_list/1</code></a></li><li><a href="../../apps/erts/erlang.html#binary_to_list/3"><code class="inline">erlang:binary_to_list/3</code></a></li><li><a href="../../apps/erts/erlang.html#bitstring_to_list/1"><code class="inline">erlang:bitstring_to_list/1</code></a></li><li><a href="../../apps/erts/erlang.html#list_to_binary/1"><code class="inline">erlang:list_to_binary/1</code></a></li><li><a href="../../apps/erts/erlang.html#iolist_to_binary/1"><code class="inline">erlang:iolist_to_binary/1</code></a></li><li><a href="../../apps/erts/erlang.html#list_to_bitstring/1"><code class="inline">erlang:list_to_bitstring/1</code></a></li><li><a href="binary.html#list_to_bin/1"><code class="inline">binary:list_to_bin/1</code></a></li></ul><p>Characteristics impact:</p><ul><li><p><strong>Performance</strong> - The functions converting from lists got a performance loss
for very small lists, and a performance gain for very large lists.</p></li><li><p><strong>Priority</strong> - Previously a process executing one of these functions
effectively got an unfair priority boost. This priority boost depended on
the input size. The larger the input was, the larger the priority boost got.
This unfair priority boost is now lost.</p></li></ul><p>Own Id: OTP-11888</p></li><li><p>Add <a href="maps.html#get/3"><code class="inline">maps:get/3</code></a> to maps module. The function will return the supplied default
value if the key does not exist in the map.</p><p>Own Id: OTP-11951</p></li></ul><h2 id="stdlib-2-0" class="section-heading"><a href="#stdlib-2-0" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 2.0</span></h2><h3 id="fixed-bugs-and-malfunctions-102" class="section-heading"><a href="#fixed-bugs-and-malfunctions-102" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>The option dupnames did not work as intended in re. When looking for names
with {capture, [Name, ...]}, re:run returned a random instance of the match
for that name, instead of the leftmost matching instance, which was what the
documentation stated. This is now corrected to adhere to the documentation.
The option {capture,all_names} along with a re:inspect/2 function is also
added to further help in using named subpatterns.</p><p>Own Id: OTP-11205</p></li><li><p>If option 'binary' was set for standard_input, then c:i() would hang if the
output was more than one page long - i.e. then input after &quot;(c)ontinue (q)uit
--&gt;&quot; could not be read. This has been corrected. (Thanks to José Valim)</p><p>Own Id: OTP-11589</p></li><li><p>stdlib/lists: Add function droplast/1 This functions drops the last element of
a non-empty list. lists:last/1 and lists:droplast/1 are the dual of hd/1 and
tl/1 but for the end of a list. (Thanks to Hans Svensson)</p><p>Own Id: OTP-11677</p></li><li><p>Allow all auto imports to be suppressed at once. Introducing the
no_auto_import attribute: -compile(no_auto_import). Useful for code generation
tools that always use the qualified function names and want to avoid the auto
imported functions clashing with local ones. (Thanks to José Valim.)</p><p>Own Id: OTP-11682</p></li><li><p>supervisor_bridge does no longer report normal termination of children. The
reason is that in some cases, for instance when the restart strategy is
simple_one_for_one, the log could be completely overloaded with reports about
normally terminating processes. (Thanks to Artem Ocheredko)</p><p>Own Id: OTP-11685</p></li><li><p>The type annotations for alternative registries using the {via, Module,
Name} syntax for sup_name() and sup_ref() in the supervisor module are now
consistent with the documentation. Dialyzer should no longer complain about
valid supervisor:start_link() and supervisor:start_child() calls. (Thanks to
Caleb Helbling.)</p><p>Own Id: OTP-11707</p></li><li><p>Two Dets bugs have been fixed. When trying to open a short file that is not a
Dets file, the file was deleted even with just read access. Calling
<a href="dets.html#is_dets_file/1"><code class="inline">dets:is_dets_file/1</code></a> with a file that is not a Dets file, a file descriptor
was left open. (Thanks to Håkan Mattsson for reporting the bugs.)</p><p>Own Id: OTP-11709</p></li><li><p>Fix race bug in <code class="inline">ets:all</code>. Concurrent creation of tables could cause other
tables to not be included in the result. (Thanks to Florian Schintke for bug
report)</p><p>Own Id: OTP-11726</p></li><li><p>erl_eval now properly evaluates '=='/2 when it is used in guards. (Thanks to
José Valim)</p><p>Own Id: OTP-11747</p></li><li><p>Calls to proplists:get_value/3 are replaced by the faster lists:keyfind/3 in
io_lib_pretty. Elements in the list are always 2-tuples. (Thanks to Andrew
Thompson)</p><p>Own Id: OTP-11752</p></li><li><p>A qlc bug where filters were erroneously optimized away has been fixed. Thanks
to Sam Bobroff for reporting the bug.</p><p>Own Id: OTP-11758</p></li><li><p>A number of compiler errors where unusual or nonsensical code would crash the
compiler have been reported by Ulf Norell and corrected by Anthony Ramine.</p><p>Own Id: OTP-11770</p></li><li><p>Since Erlang/OTP R16B the Erlang Core Linter (<code class="inline">erl_lint</code>) has not emitted
errors when built-in types were re-defined. This bug has been fixed. (Thanks
to Roberto Aloi.)</p><p>Own Id: OTP-11772</p></li><li><p>The functions <code class="inline">sys:get_state/1,2</code> and <code class="inline">sys:replace_state/2,3</code> are fixed so
they can now be run while the process is sys suspended. To accomplish this,
the new callbacks <code class="inline">Mod:system_get_state/1</code> and <code class="inline">Mod:system_replace_state/2</code>
are added, which are also implemented by the generic behaviours <code class="inline">gen_server</code>,
<code class="inline">gen_event</code> and <code class="inline">gen_fsm</code>.</p><p>The potential incompatibility refers to:</p><ul><li>The previous behaviour of intercepting the system message and passing a
tuple of size 2 as the last argument to <a href="sys.html#handle_system_msg/6"><code class="inline">sys:handle_system_msg/6</code></a> is no
longer supported.</li><li>The error handling when <code class="inline">StateFun</code> in <code class="inline">sys:replace_state/2,3</code> fails is
changed from being totally silent to possibly (if the callback module does
not catch) throw an exception in the client process.</li></ul><p>(Thanks to James Fish and Steve Vinoski)</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-11817</p></li></ul><h3 id="improvements-and-new-features-46" class="section-heading"><a href="#improvements-and-new-features-46" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>Options to set match_limit and match_limit_recursion are added to re:run. The
option report_errors is also added to get more information when re:run fails
due to limits or compilation errors.</p><p>Own Id: OTP-10285</p></li><li><p>The pre-defined types <code class="inline">array/0</code>, <code class="inline">dict/0</code>, <code class="inline">digraph/0</code>, <code class="inline">gb_set/0</code>,
<code class="inline">gb_tree/0</code>, <code class="inline">queue/0</code>, <code class="inline">set/0</code>, and <code class="inline">tid/0</code> have been deprecated. They will
be removed in Erlang/OTP 18.0.</p><p>Instead the types <a href="array.html#t:array/0"><code class="inline">array:array/0</code></a>,
<a href="dict.html#t:dict/0"><code class="inline">dict:dict/0</code></a>, <a href="digraph.html#t:graph/0"><code class="inline">digraph:graph/0</code></a>,
<code class="inline">gb_set:set/0</code>, <code class="inline">gb_tree:tree/0</code>, <a href="queue.html#t:queue/0"><code class="inline">queue:queue/0</code></a>,
<a href="sets.html#t:set/0"><code class="inline">sets:set/0</code></a>, and <a href="ets.html#t:tid/0"><code class="inline">ets:tid/0</code></a> can be used.
(Note: it has always been necessary to use <a href="ets.html#t:tid/0"><code class="inline">ets:tid/0</code></a>.)</p><p>It is allowed in Erlang/OTP 17.0 to locally re-define the types <code class="inline">array/0</code>,
<code class="inline">dict/0</code>, and so on.</p><p>New types <a href="array.html#t:array/1"><code class="inline">array:array/1</code></a>,
<a href="dict.html#t:dict/2"><code class="inline">dict:dict/2</code></a>, <a href="gb_sets.html#t:set/1"><code class="inline">gb_sets:set/1</code></a>,
<a href="gb_trees.html#t:tree/2"><code class="inline">gb_trees:tree/2</code></a>,
<a href="queue.html#t:queue/1"><code class="inline">queue:queue/1</code></a>, and <a href="sets.html#t:set/1"><code class="inline">sets:set/1</code></a> have
been added.</p><p>A compiler option, <code class="inline">nowarn_deprecated_type</code>, has been introduced. By including
the attribute</p><p><code class="inline">-compile(nowarn_deprecated_type).</code></p><p>in an Erlang source file, warnings about deprecated types can be avoided in
Erlang/OTP 17.0.</p><p>The option can also be given as a compiler flag:</p><p><code class="inline">erlc +nowarn_deprecated_type file.erl</code></p><p>Own Id: OTP-10342</p></li><li><p>Calls to erlang:open_port/2 with 'spawn' are updated to handle space in the
command path.</p><p>Own Id: OTP-10842</p></li><li><p>Dialyzer's <code class="inline">unmatched_return</code> warnings have been corrected.</p><p>Own Id: OTP-10908</p></li><li><p>Forbid unsized fields in patterns of binary generators and simplified
v3_core's translation of bit string generators. (Thanks to Anthony Ramine.)</p><p>Own Id: OTP-11186</p></li><li><p>The version of the PCRE library Used by Erlang's re module is raised to 8.33
from 7.6. This means, among other things, better Unicode and Unicode Character
Properties support. New options connected to PCRE 8.33 are also added to the
re module (ucd, notempty_atstart, no_start_optimize). PCRE has extended the
regular expression syntax between 7.6 and 8.33, why this imposes a potential
incompatibility. Only very complicated regular expressions may be affected,
but if you know you are using obscure features, please test run your regular
expressions and verify that their behavior has not changed.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-11204</p></li><li><p>Added dict:is_empty/1 and orddict:is_empty/1. (Thanks to Magnus Henoch.)</p><p>Own Id: OTP-11353</p></li><li><p>A call to either the <a href="../../apps/erts/erlang.html#garbage_collect/1"><code class="inline">garbage_collect/1</code></a> BIF or the
<a href="../../apps/erts/erlang.html#check_process_code/2"><code class="inline">check_process_code/2</code></a> BIF may trigger garbage
collection of another processes than the process calling the BIF. The previous
implementations performed these kinds of garbage collections without
considering the internal state of the process being garbage collected. In
order to be able to more easily and more efficiently implement yielding native
code, these types of garbage collections have been rewritten. A garbage
collection like this is now triggered by an asynchronous request signal, the
actual garbage collection is performed by the process being garbage collected
itself, and finalized by a reply signal to the process issuing the request.
Using this approach processes can disable garbage collection and yield without
having to set up the heap in a state that can be garbage collected.</p><p>The <a href="../../apps/erts/erlang.html#garbage_collect/2"><code class="inline">garbage_collect/2</code></a>, and
<a href="../../apps/erts/erlang.html#check_process_code/3"><code class="inline">check_process_code/3</code></a> BIFs have been
introduced. Both taking an option list as last argument. Using these, one can
issue asynchronous requests.</p><p><a href="../../apps/kernel/code.html#purge/1"><code class="inline">code:purge/1</code></a> and <a href="../../apps/kernel/code.html#soft_purge/1"><code class="inline">code:soft_purge/1</code></a> have been rewritten to utilize
asynchronous <code class="inline">check_process_code</code> requests in order to parallelize work.</p><p>Characteristics impact: A call to the
<a href="../../apps/erts/erlang.html#garbage_collect/1"><code class="inline">garbage_collect/1</code></a> BIF or the
<a href="../../apps/erts/erlang.html#check_process_code/2"><code class="inline">check_process_code/2</code></a> BIF will normally take longer
time to complete while the system as a whole wont be as much negatively
effected by the operation as before. A call to <a href="../../apps/kernel/code.html#purge/1"><code class="inline">code:purge/1</code></a> and
<a href="../../apps/kernel/code.html#soft_purge/1"><code class="inline">code:soft_purge/1</code></a> may complete faster or slower depending on the state of
the system while the system as a whole wont be as much negatively effected by
the operation as before.</p><p>Own Id: OTP-11388 Aux Id: OTP-11535, OTP-11648</p></li><li><p>Improve the documentation of the supervisor's <code class="inline">via</code> reference. (Thanks to
MaximMinin.)</p><p>Own Id: OTP-11399</p></li><li><p><a href="orddict.html#from_list/1"><code class="inline">orddict:from_list/1</code></a> now uses the optimized sort routines in the <code class="inline">lists</code>
module instead of (essentially) an insertion sort. Depending on the input
data, the speed of the new <code class="inline">from_list/1</code> is anything from slightly faster up
to several orders of magnitude faster than the old <code class="inline">from_list/1</code>.</p><p>(Thanks to Steve Vinoski.)</p><p>Own Id: OTP-11552</p></li><li><p>EEP43: New data type - Maps</p><p>With Maps you may for instance:</p><ul><li><p>____ - <code class="inline">M0 = #{ a =&gt; 1, b =&gt; 2}, % create associations</code></p></li><li><p>____ - <code class="inline">M1 = M0#{ a := 10 }, % update values</code></p></li><li><p>____ - <code class="inline">M2 = M1#{ &quot;hi&quot; =&gt; &quot;hello&quot;}, % add new associations</code></p></li><li><p>____ - <code class="inline">#{ &quot;hi&quot; := V1, a := V2, b := V3} = M2. % match keys with values</code></p></li></ul><p>For information on how to use Maps please see Map Expressions in the
<a href="../../system/expressions.html#map-expressions">Reference Manual</a>.</p><p>The current implementation is without the following features:</p><ul><li><p>____ - No variable keys</p></li><li><p>____ - No single value access</p></li><li><p>____ - No map comprehensions</p></li></ul><p>Note that Maps is <em>experimental</em> during OTP 17.0.</p><p>Own Id: OTP-11616</p></li><li><p>When tab completing the erlang shell now expands zero-arity functions all the
way to closing parenthesis, unless there is another function with the same
name and a different arity. (Thanks to Pierre Fenoll.)</p><p>Own Id: OTP-11684</p></li><li><p>The Erlang Code Preprocessor (<code class="inline">epp</code>) could loop when encountering a circular
macro definition in an included file. This bug has been fixed.</p><p>Thanks to Maruthavanan Subbarayan for reporting the bug, and to Richard
Carlsson for providing a bug fix.</p><p>Own Id: OTP-11728</p></li><li><p>The Erlang Code Linter (<code class="inline">erl_lint</code>) has since Erlang/OTP R13B emitted warnings
whenever any of the types <a href="../../apps/erts/erlang.html#t:arity/0"><code class="inline">arity/0</code></a>, <a href="../../apps/erts/erlang.html#t:bitstring/0"><code class="inline">bitstring/0</code></a>, <a href="../../apps/erts/erlang.html#t:iodata/0"><code class="inline">iodata/0</code></a>, or
<a href="../../apps/erts/erlang.html#t:boolean/0"><code class="inline">boolean/0</code></a> were re-defined. Now errors are emitted instead.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-11771</p></li><li><p>The <code class="inline">encoding</code> option of <a href="erl_parse.html#abstract/2"><code class="inline">erl_parse:abstract/2</code></a> has been extended to include
<code class="inline">none</code> and a callback function (a predicate).</p><p>Own Id: OTP-11807</p></li><li><p>Export zip option types to allow referal from other modules.</p><p>Thanks to Pierre Fenoll and Håkan Mattson</p><p>Own Id: OTP-11828</p></li><li><p>The module <code class="inline">pg</code> has been deprecated and will be removed in Erlang/OTP 18.</p><p>Own Id: OTP-11840</p></li></ul><h2 id="stdlib-1-19-4" class="section-heading"><a href="#stdlib-1-19-4" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 1.19.4</span></h2><h3 id="fixed-bugs-and-malfunctions-103" class="section-heading"><a href="#fixed-bugs-and-malfunctions-103" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Fix typo in gen_server.erl. Thanks to Brian L. Troutwine.</p><p>Own Id: OTP-11398</p></li><li><p>Spec for atan2 should be atan2(Y, X), not atan2(X, Y). Thanks to Ary
Borenszweig.</p><p>Own Id: OTP-11465</p></li></ul><h3 id="improvements-and-new-features-47" class="section-heading"><a href="#improvements-and-new-features-47" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>Add XML marker for regexp syntax. Thanks to Håkan Mattson.</p><p>Own Id: OTP-11442</p></li></ul><h2 id="stdlib-1-19-3" class="section-heading"><a href="#stdlib-1-19-3" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 1.19.3</span></h2><h3 id="fixed-bugs-and-malfunctions-104" class="section-heading"><a href="#fixed-bugs-and-malfunctions-104" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>The functions <a href="dets.html#foldl/3"><code class="inline">dets:foldl/3</code></a>, <a href="dets.html#foldr/3"><code class="inline">dets:foldr/3</code></a>, and <a href="dets.html#traverse/2"><code class="inline">dets:traverse/2</code></a> did not
release the table after having traversed the table to the end. The bug was
introduced in R16B. (Thanks to Manuel Duran Aguete.)</p><p>Own Id: OTP-11245</p></li><li><p>If the <code class="inline">fun M:F/A</code> construct was used erroneously the linter could crash.
(Thanks to Mikhail Sobolev.)</p><p>Own Id: OTP-11254</p></li><li><p>The specifications of <code class="inline">io_lib:fread/2,3</code> have been corrected. (Thanks to Chris
King and Kostis Sagonas for pinpointing the bug.)</p><p>Own Id: OTP-11261</p></li></ul><h3 id="improvements-and-new-features-48" class="section-heading"><a href="#improvements-and-new-features-48" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>Fixed type typo in gen_server.</p><p>Own Id: OTP-11200</p></li><li><p>Update type specs in filelib and io_prompt. Thanks to Jose Valim.</p><p>Own Id: OTP-11208</p></li><li><p>Fix typo in abcast() function comment. Thanks to Johannes Weissl.</p><p>Own Id: OTP-11219</p></li><li><p>Make edlin understand a few important control keys. Thanks to Stefan
Zegenhagen.</p><p>Own Id: OTP-11251</p></li><li><p>Export the edge/0 type from the digraph module. Thanks to Alex Ronne Petersen.</p><p>Own Id: OTP-11266</p></li><li><p>Fix variable usage tracking in erl_lint and fixed unsafe variable tracking in
try expressions. Thanks to Anthony Ramine.</p><p>Own Id: OTP-11268</p></li></ul><h2 id="stdlib-1-19-2" class="section-heading"><a href="#stdlib-1-19-2" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 1.19.2</span></h2><h3 id="fixed-bugs-and-malfunctions-105" class="section-heading"><a href="#fixed-bugs-and-malfunctions-105" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>The Erlang scanner no longer accepts floating point numbers in the input
string.</p><p>Own Id: OTP-10990</p></li><li><p>When converting a faulty binary to a list with unicode:characters_to_list, the
error return value could contain a faulty &quot;rest&quot;, i.e. the io_list of
characters that could not be converted was wrong. This happened only if input
was a sub binary and conversion was from utf8. This is now corrected.</p><p>Own Id: OTP-11080</p></li><li><p>The type <code class="inline">hook_function()</code> has been corrected in <code class="inline">erl_pp</code>, the Erlang Pretty
Printer.</p><p>The printing of invalid forms, e.g. record field types, has also been fixed.
It has been broken since R16B.</p><p>(Thanks to Tomáš Janoušek.)</p><p>Own Id: OTP-11100</p></li><li><p>Fix receive support in erl_eval with a BEAM module. Thanks to Anthony Ramine.</p><p>Own Id: OTP-11137</p></li></ul><h3 id="improvements-and-new-features-49" class="section-heading"><a href="#improvements-and-new-features-49" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>Delete obsolete note about simple-one-for-one supervisor. Thanks to Magnus
Henoch.</p><p>Own Id: OTP-10938</p></li><li><p>When selecting encoding of a script written in Erlang (<code class="inline">escript</code>) the optional
directive on the second line is now recognized.</p><p>Own Id: OTP-10951</p></li><li><p>The function <a href="erl_parse.html#abstract/2"><code class="inline">erl_parse:abstract/2</code></a> has been documented.</p><p>Own Id: OTP-10992</p></li><li><p>Integrate elliptic curve contribution from Andreas Schultz</p><p>In order to be able to support elliptic curve cipher suites in SSL/TLS,
additions to handle elliptic curve infrastructure has been added to public_key
and crypto.</p><p>This also has resulted in a rewrite of the crypto API to gain consistency and
remove unnecessary overhead. All OTP applications using crypto has been
updated to use the new API.</p><p>Impact: Elliptic curve cryptography (ECC) offers equivalent security with
smaller key sizes than other public key algorithms. Smaller key sizes result
in savings for power, memory, bandwidth, and computational cost that make ECC
especially attractive for constrained environments.</p><p>Own Id: OTP-11009</p></li><li><p>Added sys:get_state/1,2 and sys:replace_state/2,3. Thanks to Steve Vinoski.</p><p>Own Id: OTP-11013</p></li><li><p>Optimizations to gen mechanism. Thanks to Loïc Hoguin.</p><p>Own Id: OTP-11025</p></li><li><p>Optimizations to gen.erl. Thanks to Loïc Hoguin.</p><p>Own Id: OTP-11035</p></li><li><p>Use erlang:demonitor(Ref, [flush]) where applicable. Thanks to Loïc Hoguin.</p><p>Own Id: OTP-11039</p></li><li><p>Erlang source files with non-ASCII characters are now encoded in UTF-8
(instead of latin1).</p><p>Own Id: OTP-11041 Aux Id: OTP-10907</p></li><li><p>Fix rest_for_one and one_for_all restarting a child not terminated. Thanks to
James Fish.</p><p>Own Id: OTP-11042</p></li><li><p>Fix excessive CPU consumption of timer_server. Thanks to Aliaksey
Kandratsenka.</p><p>Own Id: OTP-11053</p></li><li><p>Rename and document lists:zf/2 as lists:filtermap/2. Thanks to Anthony Ramine.</p><p>Own Id: OTP-11078</p></li><li><p>Fixed an inconsistent state in epp. Thanks to Anthony Ramine</p><p>Own Id: OTP-11079</p></li><li><p>c:ls(File) will now print File, similar to ls(1) in Unix. The error messages
have also been improved. (Thanks to Bengt Kleberg.)</p><p>Own Id: OTP-11108</p></li><li><p>Support callback attributes in erl_pp. Thanks to Anthony Ramine.</p><p>Own Id: OTP-11140</p></li><li><p>Improve erl_lint performance. Thanks to José Valim.</p><p>Own Id: OTP-11143</p></li></ul><h2 id="stdlib-1-19-1" class="section-heading"><a href="#stdlib-1-19-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 1.19.1</span></h2><h3 id="fixed-bugs-and-malfunctions-106" class="section-heading"><a href="#fixed-bugs-and-malfunctions-106" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Bugs related to Unicode have been fixed in the <code class="inline">erl_eval</code> module.</p><p>Own Id: OTP-10622 Aux Id: kunagi-351 [262]</p></li><li><p><code class="inline">filelib:wildcard(&quot;some/relative/path/*.beam&quot;, Path)</code> would fail to match any
file. That is, filelib:wildcard/2 would not work if the first component of the
pattern did not contain any wildcard characters. (A previous attempt to fix
the problem in R15B02 seems to have made matters worse.)</p><p>(Thanks to Samuel Rivas and Tuncer Ayaz.)</p><p>There is also an incompatible change to the <code class="inline">Path</code> argument. It is no longer
allowed to be a binary.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-10812</p></li></ul><h3 id="improvements-and-new-features-50" class="section-heading"><a href="#improvements-and-new-features-50" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>The new STDLIB application variable <code class="inline">shell_strings</code> can be used for
determining how the Erlang shell outputs lists of integers. The new function
<a href="shell.html#strings/1"><code class="inline">shell:strings/1</code></a> toggles the value of the variable.</p><p>The control sequence modifier <code class="inline">l</code> can be used for turning off the string
recognition of <code class="inline">~p</code> and <code class="inline">~P</code>.</p><p>Own Id: OTP-10755</p></li><li><p>Miscellaneous updates due to Unicode support.</p><p>Own Id: OTP-10820</p></li><li><p>Extend <code class="inline">~ts</code> to handle binaries with characters coded in ISO-latin-1</p><p>Own Id: OTP-10836</p></li><li><p>The +pc flag to erl can be used to set the range of characters considered
printable. This affects how the shell and io:format(&quot;~tp&quot;,...) functionality
does heuristic string detection. More can be read in STDLIB users guide.</p><p>Own Id: OTP-10884</p></li></ul><h2 id="stdlib-1-19" class="section-heading"><a href="#stdlib-1-19" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 1.19</span></h2><h3 id="fixed-bugs-and-malfunctions-107" class="section-heading"><a href="#fixed-bugs-and-malfunctions-107" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Wildcards such as &quot;some/path/*&quot; passed to <a href="filelib.html#wildcard/2"><code class="inline">filelib:wildcard/2</code></a> would fail to
match any file. (Thanks to Samuel Rivas for reporting this bug.)</p><p>Own Id: OTP-6874 Aux Id: kunagi-190 [101]</p></li><li><p>Fixed error handling in proc_lib:start which could hang if the spawned process
died in init.</p><p>Own Id: OTP-9803 Aux Id: kunagi-209 [120]</p></li><li><p>Allow ** in filelib:wildcard</p><p>Two adjacent * used as a single pattern will match all files and zero or more
directories and subdirectories. (Thanks to José Valim)</p><p>Own Id: OTP-10431</p></li><li><p>Add the \gN and \g{N} syntax for back references in re:replace/3,4 to
allow use with numeric replacement strings. (Thanks to Vance Shipley)</p><p>Own Id: OTP-10455</p></li><li><p>Export ets:match_pattern/0 type (Thanks to Joseph Wayne Norton)</p><p>Own Id: OTP-10472</p></li><li><p>Fix printing the empty binary at depth 1 with ~W (Thanks to Andrew Thompson)</p><p>Own Id: OTP-10504</p></li><li><p>The type <code class="inline">ascii_string()</code> in the <code class="inline">base64</code> module has been corrected. The type
<a href="../../apps/kernel/file.html#t:file_info/0"><code class="inline">file:file_info()</code></a> has been cleaned up. The type
<a href="../../apps/kernel/file.html#t:fd/0"><code class="inline">file:fd()</code></a> has been made opaque in the documentation.</p><p>Own Id: OTP-10624 Aux Id: kunagi-352 [263]</p></li></ul><h3 id="improvements-and-new-features-51" class="section-heading"><a href="#improvements-and-new-features-51" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>Dets tables are no longer fixed while traversing with a bound key (when only
the objects with the right key are matched). This optimization affects the
functions <code class="inline">match/2</code>, <code class="inline">match_object/2</code>, <code class="inline">select/2</code>, <code class="inline">match_delete/2</code>, and
<code class="inline">select_delete/2</code>.</p><p>Own Id: OTP-10097</p></li><li><p>Support for Unicode has been implemented.</p><p>Own Id: OTP-10302</p></li><li><p>The linter now warns for opaque types that are not exported, as well as for
under-specified opaque types.</p><p>Own Id: OTP-10436</p></li><li><p>The type <a href="../../apps/kernel/file.html#t:name/0"><code class="inline">file:name()</code></a> has been substituted for the type
<a href="../../apps/kernel/file.html#t:filename/0"><code class="inline">file:filename()</code></a> in the following functions in the
<code class="inline">filename</code> module: <code class="inline">absname/2</code>, <code class="inline">absname_join/2</code>, <code class="inline">join/1,2</code>, and <code class="inline">split/1</code>.</p><p>Own Id: OTP-10474</p></li><li><p>If a child process fails in its start function, then the error reason was
earlier only reported as an error report from the error_handler, and
supervisor:start_link would only return <code class="inline">{error,shutdown}</code>. This has been
changed so the supervisor will now return <code class="inline">{error,{shutdown,Reason}}</code>, where
<code class="inline">Reason</code> identifies the failing child and its error reason. (Thanks to Tomas
Pihl)</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-10490</p></li><li><p>Where necessary a comment stating encoding has been added to Erlang files. The
comment is meant to be removed in Erlang/OTP R17B when UTF-8 becomes the
default encoding.</p><p>Own Id: OTP-10630</p></li><li><p>The contracts and types of the modules <code class="inline">erl_scan</code> and <code class="inline">sys</code> have been
corrected and improved. (Thanks to Kostis Sagonas.)</p><p>Own Id: OTP-10658</p></li><li><p>The Erlang shell now skips the rest of the line when it encounters an Erlang
scanner error.</p><p>Own Id: OTP-10659</p></li><li><p>Clean up some specs in the proplists module. (Thanks to Kostis Sagonas.)</p><p>Own Id: OTP-10663</p></li><li><p>Some examples overflowing the width of PDF pages have been corrected.</p><p>Own Id: OTP-10665</p></li><li><p>Enable escript to accept emulator arguments when script file has no shebang.
Thanks to Magnus Henoch</p><p>Own Id: OTP-10691</p></li><li><p>Fix bug in queue:out/1, queue:out_r/1 that makes it O(N^2) in worst case.
Thanks to Aleksandr Erofeev.</p><p>Own Id: OTP-10722</p></li><li><p>There are new functions in the <code class="inline">epp</code> module which read the character encoding
from files. See <a href="epp.html"><code class="inline">epp</code></a> for more information.</p><p>Own Id: OTP-10742 Aux Id: OTP-10302</p></li><li><p>The functions in <code class="inline">io_lib</code> have been adjusted for Unicode. The existing
functions <code class="inline">write_string()</code> and so on now take Unicode strings, while the old
behavior has been taken over by new functions <code class="inline">write_latin1_string()</code> and so
on. There are also new functions to write Unicode strings as Latin-1 strings,
mainly targetted towards the Erlang pretty printer (<code class="inline">erl_pp</code>).</p><p>Own Id: OTP-10745 Aux Id: OTP-10302</p></li><li><p>The new functions <a href="proc_lib.html#format/2"><code class="inline">proc_lib:format/2</code></a> and <a href="erl_parse.html#abstract/2"><code class="inline">erl_parse:abstract/2</code></a> accept an
encoding as second argument.</p><p>Own Id: OTP-10749 Aux Id: OTP-10302</p></li><li><p>Increased potential concurrency in ETS for <code class="inline">write_concurrency</code> option. The
number of internal table locks has increased from 16 to 64. This makes it four
times less likely that two concurrent processes writing to the same table
would collide and thereby serialized. The cost is an increased constant memory
footprint for tables using write_concurrency. The memory consumption per
inserted record is not affected. The increased footprint can be particularly
large if <code class="inline">write_concurrency</code> is combined with <code class="inline">read_concurrency</code>.</p><p>Own Id: OTP-10787</p></li></ul><h2 id="stdlib-1-18-3" class="section-heading"><a href="#stdlib-1-18-3" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 1.18.3</span></h2><h3 id="fixed-bugs-and-malfunctions-108" class="section-heading"><a href="#fixed-bugs-and-malfunctions-108" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Minor test updates</p><p>Own Id: OTP-10591</p></li></ul><h2 id="stdlib-1-18-2" class="section-heading"><a href="#stdlib-1-18-2" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 1.18.2</span></h2><h3 id="fixed-bugs-and-malfunctions-109" class="section-heading"><a href="#fixed-bugs-and-malfunctions-109" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Fixed bug where if given an invalid drive letter on windows ensure dir would
go into an infinite loop.</p><p>Own Id: OTP-10104</p></li><li><p>Calls to gen_server:enter_loop/4 where ServerName has a global scope and no
timeout is given now works correctly.</p><p>Thanks to Sam Bobroff for reporting the issue.</p><p>Own Id: OTP-10130</p></li><li><p>fix escript/primary archive reloading</p><p>If the mtime of an escript/primary archive file changes after being added to
the code path, correctly reload the archive and update the cache. (Thanks to
Tuncer Ayaz)</p><p>Own Id: OTP-10151</p></li><li><p>Fix bug that in some cases could cause corrupted binaries in ETS tables with
<code class="inline">compressed</code> option.</p><p>Own Id: OTP-10182</p></li><li><p>Fix filename:nativename/1 on Win32</p><p>Don't choke on paths given as binary argument on Win32. Thanks to Jan Klötzke</p><p>Own Id: OTP-10188</p></li><li><p>Fix bug in <a href="ets.html#test_ms/2"><code class="inline">ets:test_ms/2</code></a> that could cause emulator crash when using <code class="inline">'$_'</code>
in match spec.</p><p>Own Id: OTP-10190</p></li><li><p>Fix bug where zip archives wrongly have a first disk number set to 1</p><p>Own Id: OTP-10223</p></li></ul><h3 id="improvements-and-new-features-52" class="section-heading"><a href="#improvements-and-new-features-52" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>The message printed by the Erlang shell as an explanation of the <code class="inline">badarith</code>
error has been corrected. (Thanks to Matthias Lang.)</p><p>Own Id: OTP-10054</p></li></ul><h2 id="stdlib-1-18-1" class="section-heading"><a href="#stdlib-1-18-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 1.18.1</span></h2><h3 id="fixed-bugs-and-malfunctions-110" class="section-heading"><a href="#fixed-bugs-and-malfunctions-110" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>References to <code class="inline">is_constant/1</code> (which was removed in the R12 release) has been
removed from documentation and code.</p><p>Own Id: OTP-6454 Aux Id: seq10407</p></li><li><p>Leave control back to gen_server during supervisor's restart loop</p><p>When an attempt to restart a child failed, supervisor would earlier keep the
execution flow and try to restart the child over and over again until it
either succeeded or the restart frequency limit was reached. If none of these
happened, supervisor would hang forever in this loop.</p><p>This commit adds a timer of 0 ms where the control is left back to the
gen_server which implements the supervisor. This way any incoming request to
the supervisor will be handled - which could help breaking the infinite loop -
e.g. shutdown request for the supervisor or for the problematic child.</p><p>This introduces some incompatibilities in stdlib due to new return values from
supervisor:</p><ul><li>restart_child/2 can now return {error,restarting}</li><li>delete_child/2 can now return {error,restarting}</li><li>which_children/1 returns a list of {Id,Child,Type,Mods}, where Child, in
addition to the old pid() or 'undefined', now also can be 'restarting'.</li></ul><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-9549</p></li><li><p>If a temporary child's start function returned 'ignore', then the supervisor
would keep it's child specification. This has been corrected. Child
specifications for non-existing temporary children shall never be kept.</p><p>Own Id: OTP-9782 Aux Id: seq11964</p></li><li><p>Use universal time as base in error logger</p><p>Previous conversion used the deprecated
calendar:local_time_to_universal_time/1</p><p>Own Id: OTP-9854</p></li><li><p>Calling a guard test (such as is_list/1) from the top-level in a guard, would
cause a compiler crash if there was a local definition with the same name.
Corrected to reject the program with an error message.</p><p>Own Id: OTP-9866</p></li><li><p>Fix the type spec from the doc of binary:part/3 (Thanks to Ricardo Catalinas
Jiménez)</p><p>Own Id: OTP-9920</p></li><li><p>Correct spelling of registered (Thanks to Richard Carlsson)</p><p>Own Id: OTP-9925</p></li><li><p>Put gb_trees documentation into alphabetical order (Thanks to Aidan Hobson
Sayers)</p><p>Own Id: OTP-9929</p></li><li><p>Fix bug in ETS with <code class="inline">compressed</code> option and insertion of term containing large
integers (&gt;2G) on 64-bit machines. Seen to cause emulator crash. (Thanks to
Diego Llarrull for excellent bug report)</p><p>Own Id: OTP-9932</p></li><li><p>Add plugin support for alternative name lookup This patch introduces a new way
of locating a behaviour instance: {via, Module, Name}. (Thanks to Ulf Wiger)</p><p>Own Id: OTP-9945</p></li><li><p>The function <a href="digraph_utils.html#condensation/1"><code class="inline">digraph_utils:condensation/1</code></a> used to create a digraph
containing loops contradicting the documentation which states that the created
digraph is free of cycles. This bug has been fixed. (Thanks to Kostis Sagonas
for finding the bug.)</p><p>Own Id: OTP-9953</p></li><li><p>When an escript ends now all printout to standard output and standard error
gets out on the terminal. This bug has been corrected by changing the
behaviour of erlang:halt/0,1, which should fix the same problem for other
escript-like applications, i.e that data stored in the output port driver
buffers got lost when printing on a TTY and exiting through erlang:halt/0,1.</p><p>The BIF:s erlang:halt/0,1 has gotten improved semantics and there is a new BIF
erlang:halt/2 to accomplish something like the old semantics. See the
documentation.</p><p>Now erlang:halt/0 and erlang:halt/1 with an integer argument will close all
ports and allow all pending async threads operations to finish before exiting
the emulator. Previously erlang:halt/0 and erlang:halt(0) would just wait for
pending async threads operations but not close ports. And erlang:halt/1 with a
non-zero integer argument would not even wait for pending async threads
operations.</p><p>To roughly the old behaviour, to not wait for ports and async threads
operations when you exit the emulator, you use erlang:halt/2 with an integer
first argument and an option list containing {flush,false} as the second
argument. Note that now is flushing not dependant of the exit code, and you
cannot only flush async threads operations which we deemed as a strange
behaviour anyway.</p><p>Also, erlang:halt/1,2 has gotten a new feature: If the first argument is the
atom 'abort' the emulator is aborted producing a core dump, if the operating
system so allows.</p><p>Own Id: OTP-9985</p></li><li><p>Add escript win32 alternative invocation. escript can now be started as both
&quot;escript.exe&quot; and &quot;escript&quot; (Thanks to Pierre Rouleau)</p><p>Own Id: OTP-9997</p></li></ul><h2 id="stdlib-1-18" class="section-heading"><a href="#stdlib-1-18" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 1.18</span></h2><h3 id="fixed-bugs-and-malfunctions-111" class="section-heading"><a href="#fixed-bugs-and-malfunctions-111" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Improved algorithm in module <code class="inline">random</code>. Avoid seed values that are even
divisors of the primes and by that prevent getting sub-seeds that are stuck on
zero. Worst case was random:seed(0,0,0) that produced a series of only zeros.
This is an incompatible change in the sense that applications that relies on
reproducing a specific series for a given seed will fail. The pseudo random
output is still deterministic but different compared to earlier versions.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-8713</p></li><li><p>Calls to <a href="../../apps/kernel/global.html#whereis_name/1"><code class="inline">global:whereis_name/1</code></a> have been substituted for calls to
<code class="inline">global:safe_whereis_name/1</code> since the latter is not safe at all.</p><p>The reason for not doing this earlier is that setting a global lock masked out
a bug concerning the restart of supervised children. The bug has now been
fixed by a modification of <a href="../../apps/kernel/global.html#whereis_name/1"><code class="inline">global:whereis_name/1</code></a>. (Thanks to Ulf Wiger for
code contribution.)</p><p>A minor race conditions in <code class="inline">gen_fsm:start*</code> has been fixed: if one of these
functions returned <code class="inline">{error, Reason}</code> or ignore, the name could still be
registered (either locally or in <code class="inline">global</code>. (This is the same modification as
was done for gen_server in OTP-7669.)</p><p>The undocumented function <code class="inline">global:safe_whereis_name/1</code> has been removed.</p><p>Own Id: OTP-9212 Aux Id: seq7117, OTP-4174</p></li><li><p>If a child of a supervisor terminates with reason {shutdown,Term} it is now
handled by the supervisor as if the reason was 'shutdown'.</p><p>For children with restart type 'permanent', this implies no change. For
children with restart type 'transient', the child will no longer be restarted
and no supervisor report will be written. For children with restart type
'temporary', no supervisor report will be written.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-9222</p></li><li><p>Minor improvement of documentation regarding supervisor restart strategy for
temporary and transient child processes.</p><p>Own Id: OTP-9381</p></li><li><p>A Dets table with sufficiently large buckets could not always be repaired.
This bug has been fixed.</p><p>The format of Dets files has been modified. When downgrading tables created
with the new system will be repaired. Otherwise the modification should not be
noticeable.</p><p>Own Id: OTP-9607</p></li><li><p>A few contracts in the <code class="inline">lists</code> module have been corrected.</p><p>Own Id: OTP-9616</p></li><li><p>Add '-callback' attributes in stdlib's behaviours</p><p>Replace the behaviour_info(callbacks) export in stdlib's behaviours with
-callback' attributes for all the callbacks. Update the documentation with
information on the callback attribute Automatically generate 'behaviour_info'
function from '-callback' attributes</p><p>'behaviour_info(callbacks)' is a special function that is defined in a module
which describes a behaviour and returns a list of its callbacks.</p><p>This function is now automatically generated using the '-callback' specs. An
error is returned by lint if user defines both '-callback' attributes and the
behaviour_info/1 function. If no type info is needed for a callback use a
generic spec for it. Add '-callback' attribute to language syntax</p><p>Behaviours may define specs for their callbacks using the familiar spec
syntax, replacing the '-spec' keyword with '-callback'. Simple lint checks are
performed to ensure that no callbacks are defined twice and all types referred
are declared.</p><p>These attributes can be then used by tools to provide documentation to the
behaviour or find discrepancies in the callback definitions in the callback
module.</p><p>Add callback specs into 'application' module in kernel Add callback specs to
tftp module following internet documentation Add callback specs to
inets_service module following possibly deprecated comments</p><p>Own Id: OTP-9621</p></li><li><p>If a Dets table had been properly closed but the space management data could
not been read, it was not possible to repair the file. This bug has been
fixed.</p><p>Own Id: OTP-9622</p></li><li><p>The Unicode noncharacter code points 16#FFFE and 16#FFFE were not allowed to
be encoded or decoded using the <code class="inline">unicode</code> module or bit syntax. That was
inconsistent with the other noncharacters 16#FDD0 to 16#FDEF that could be
encoded/decoded. To resolve the inconsistency, 16#FFFE and 16#FFFE can now be
encoded and decoded. (Thanks to Alisdair Sullivan.)</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-9624</p></li><li><p>Make epp search directory of current file first when including another file
This completes a partial fix in R11 that only worked for include_lib().
(Thanks to Richard Carlsson)</p><p>Own Id: OTP-9645</p></li><li><p>ms_transform: Fix incorrect `variable shadowed' warnings</p><p>This patch removes incorrect passing of variable bindings from one function
clause to another. (Thanks to Haitao Li)</p><p>Own Id: OTP-9646</p></li><li><p>Explicitly kill dynamic children in supervisors</p><p>According to the supervisor's documentation: &quot;Important note on
simple-one-for-one supervisors: The dynamically created child processes of a
simple-one-for-one supervisor are not explicitly killed, regardless of
shutdown strategy, but are expected to terminate when the supervisor does
(that is, when an exit signal from the parent process is received).&quot;</p><p>All is fine as long as we stop simple_one_for_one supervisor manually. Dynamic
children catch the exit signal from the supervisor and leave. But, if this
happens when we stop an application, after the top supervisor has stopped, the
application master kills all remaining processes associated to this
application. So, dynamic children that trap exit signals can be killed during
their cleanup (here we mean inside terminate/2). This is unpredictable and
highly time-dependent.</p><p>In this commit, supervisor module is patched to explicitly terminate dynamic
children accordingly to the shutdown strategy.</p><p>NOTE: Order in which dynamic children are stopped is not defined. In fact,
this is &quot;almost&quot; done at the same time.</p><p>Stack errors when dynamic children are stopped</p><p>Because a simple_one_for_one supervisor can have many workers, we stack errors
during its shutdown to report only one message for each encountered error
type. Instead of reporting the child's pid, we use the number of concerned
children. (Thanks to Christopher Faulet)</p><p>Own Id: OTP-9647</p></li><li><p>Allow an infinite timeout to shutdown worker processes</p><p>Now, in child specification, the shutdown value can also be set to infinity
for worker children. This restriction was removed because this is not always
possible to predict the shutdown time for a worker. This is highly
application-dependent. Add a warning to docs about workers' shutdown strategy
(Thanks to Christopher Faulet)</p><p>Own Id: OTP-9648</p></li><li><p>A badarg would sometimes occur in supervisor when printing error reports and
the child pid was undefined. This has been corrected.</p><p>Own Id: OTP-9669</p></li><li><p>Fix re:split spec not to accept option 'global'(Thanks to Shunichi Shinohara)</p><p>Own Id: OTP-9691</p></li></ul><h3 id="improvements-and-new-features-53" class="section-heading"><a href="#improvements-and-new-features-53" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>Fix a few tests that used to fail on the HiPE platform.</p><p>Own Id: OTP-9637</p></li><li><p>Variables are now now allowed in '<code class="inline">fun M:F/A</code>' as suggested by Richard O'Keefe
in EEP-23.</p><p>The representation of '<code class="inline">fun M:F/A</code>' in the abstract format has been changed in
an incompatible way. Tools that directly read or manipulate the abstract
format (such as parse transforms) may need to be updated. The compiler can
handle both the new and the old format (i.e. extracting the abstract format
from a pre-R15 BEAM file and compiling it using compile:forms/1,2 will work).
The <code class="inline">syntax_tools</code> application can also handle both formats.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-9643</p></li><li><p>Tuple funs (a two-element tuple with a module name and a function) are now
officially deprecated and will be removed in R16. Use '<code class="inline">fun M:F/A</code>' instead.
To make you aware that your system uses tuple funs, the very first time a
tuple fun is applied, a warning will be sent to the error logger.</p><p>Own Id: OTP-9649</p></li><li><p>The deprecated '<code class="inline">regexp</code>' module has been removed. Use the '<code class="inline">re</code>' module
instead.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-9737</p></li><li><p><code class="inline">filename:find_src/1,2</code> will now work on stripped BEAM files (reported by Per
Hedeland). The HiPE compiler will also work on stripped BEAM files. The BEAM
compiler will no longer include compilation options given in the source code
itself in <code class="inline">M:module_info(compile)</code> (because those options will be applied
anyway if the module is re-compiled).</p><p>Own Id: OTP-9752</p></li></ul><h2 id="stdlib-1-17-5" class="section-heading"><a href="#stdlib-1-17-5" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 1.17.5</span></h2><h3 id="fixed-bugs-and-malfunctions-112" class="section-heading"><a href="#fixed-bugs-and-malfunctions-112" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>erl_tar:extract failed when executed inside a directory with some parent
directory to which the user has no read access. This has been corrected.</p><p>Own Id: OTP-9368</p></li><li><p>A bug in <code class="inline">erl_scan:set_attribute/3</code> has been fixed.</p><p>Own Id: OTP-9412</p></li><li><p>The contract of <code class="inline">io_lib:fread()</code> has been corrected.</p><p>Own Id: OTP-9413 Aux Id: seq11873</p></li><li><p>A crash in io<em>lib:fread/2 when end of input data was encountered while trying
to match literal characters, which should return {more,</em>,<em>,</em>} but instead
crashed, has been corrected. Reported by Klas Johansson.</p><p>A similar peculiarity for io:fread when encountering end of file before any
field data has also been corrected.</p><p>Own Id: OTP-9439</p></li><li><p>The contract of <code class="inline">timer:now_diff()</code> has been corrected. (Thanks to Alex
Morarash).</p><p>Own Id: OTP-9450</p></li><li><p>Fix minor typo in gen_fsm documentation (Thanks to Haitao Li)</p><p>Own Id: OTP-9456</p></li><li><p>The contracts of <a href="zip.html#zip_list_dir/1"><code class="inline">zip:zip_list_dir/1</code></a> and <a href="zip.html#zip_get/2"><code class="inline">zip:zip_get/2</code></a> have been corrected.</p><p>Own Id: OTP-9471 Aux Id: seq11887, OTP-9472</p></li><li><p>A bug in <code class="inline">zip:zip_open()</code> has been fixed.</p><p>Own Id: OTP-9472 Aux Id: seq11887, OTP-9471</p></li><li><p>Fix trivial documentation errors(Thanks to Matthias Lang)</p><p>Own Id: OTP-9498</p></li><li><p>Add a proplist() type</p><p>Recently I was adding specs to an API and found that there is no canonical
proplist() type defined. (Thanks to Ryan Zezeski)</p><p>Own Id: OTP-9499</p></li><li><p>fix supervisors restarting temporary children</p><p>In the current implementation of supervisors, temporary children should never
be restarted. However, when a temporary child is restarted as part of a
one_for_all or rest_for_one strategy where the failing process is not the
temporary child, the supervisor still tries to restart it.</p><p>Because the supervisor doesn't keep some of the MFA information of temporary
children, this causes the supervisor to hit its restart limit and crash.</p><p>This patch fixes the behaviour by inserting a clause in terminate_children/2-3
(private function) that will omit temporary children when building a list of
killed processes, to avoid having the supervisor trying to restart them again.</p><p>Only supervisors in need of restarting children used the list, so the change
should be of no impact for the functions that called terminate_children/2-3
only to kill all children.</p><p>The documentation has been modified to make this behaviour more explicit.
(Thanks to Fred Hebert)</p><p>Own Id: OTP-9502</p></li><li><p>fix broken edoc annotations (Thanks to Richard Carlsson)</p><p>Own Id: OTP-9516</p></li><li><p>XML files have been corrected.</p><p>Own Id: OTP-9550 Aux Id: OTP-9541</p></li><li><p>Handle rare race in the crypto key server functionality</p><p>Own Id: OTP-9586</p></li></ul><h3 id="improvements-and-new-features-54" class="section-heading"><a href="#improvements-and-new-features-54" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>Types and specifications have been added.</p><p>Own Id: OTP-9356</p></li><li><p>The contracts of the <code class="inline">queue</code> module have been modified.</p><p>Own Id: OTP-9418</p></li><li><p>Contracts in STDLIB and Kernel have been improved and type errors have been
corrected.</p><p>Own Id: OTP-9485</p></li><li><p>Types for several BIFs have been extended/corrected. Also the types for types
for <a href="lists.html#keyfind/3"><code class="inline">lists:keyfind/3</code></a>, <a href="lists.html#keysearch/3"><code class="inline">lists:keysearch/3</code></a>, and <code class="inline">lists:keyemember/3</code> have been
corrected. The incorrect/incomplete types could cause false dialyzer warnings.</p><p>Own Id: OTP-9496</p></li></ul><h2 id="stdlib-1-17-4" class="section-heading"><a href="#stdlib-1-17-4" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 1.17.4</span></h2><h3 id="fixed-bugs-and-malfunctions-113" class="section-heading"><a href="#fixed-bugs-and-malfunctions-113" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>The default value <code class="inline">undefined</code> was added to records field types in such a way
that the result was not always a well-formed type. This bug has been fixed.</p><p>Own Id: OTP-9147</p></li><li><p>Update index file atomically</p><p>Since the log_mf_h index file might be read by other processes than the error
handler (e.g. by the rb tool), this file should be updated atomically. This
will avoid hitting the time gap between opening the file in write mode (and
thus emptying the file) and the actual update with the new contents. To do
this, a temporary file is written, and the file:rename/1 used to replace the
real index file.</p><p>Own Id: OTP-9148</p></li><li><p>Fixed various typos across the documentation (Thanks to Tuncer Ayaz)</p><p>Own Id: OTP-9154</p></li><li><p>Supervisors should not save child-specs for temporary processes when they
terminate as they should not be restarted. Saving the temporary child spec
will result in that you cannot start a new temporary process with the same
child spec as an already terminated temporary process. Since R14B02 you cannot
restart a temporary temporary process as arguments are no longer saved, it has
however always been semantically incorrect to restart a temporary process.
Thanks to Filipe David Manana for reporting this and suggesting a solution.</p><p>Own Id: OTP-9167 Aux Id: OTP-9064</p></li><li><p>Various small documentation fixes (Thanks to Bernard Duggan)</p><p>Own Id: OTP-9172</p></li><li><p>Fix format_status bug for unregistered gen_event processes</p><p>Port the gen_fsm code for format_status to gen_event in order to prevent a
lists:concat([...,pid()]) crash when calling sys:get_status/1 on an
unregistered gen_event process.</p><p>Refactor format<em>status header code from gen</em>* behaviours to module gen.</p><p>Extend the format_status tests in gen_event_SUITE to cover format_status bugs
with anonymous gen_event processes. (Thanks To Geoff Cant)</p><p>Own Id: OTP-9218</p></li><li><p>List of pids changed to 'set' in supervisor for dynamic temporary children.
Accessing the list would not scale well when adding/deleting many children.
(Thanks to Evgeniy Khramtsov)</p><p>Own Id: OTP-9242</p></li><li><p>Change pool module to attempt to attach to nodes that are already running</p><p>The pool module prints out an error message and takes no further action for
nodes that are already running. This patch changes that behavior so that if
the return from slave:start/3 is {already_running, Node} then an attempt to
attach to the node is still made. This makes sense because the node has been
specified by the user in the .hosts.erlang file indicating a wish for the node
to be part of the pool and a manual attach can be successfully made after the
pool is started.(Thanks to Kelly McLaughlin)</p><p>Own Id: OTP-9244</p></li><li><p>unicode: document 16#FFFE and 16#FFFF (non chars)(Thanks to Tuncer Ayaz)</p><p>Own Id: OTP-9256</p></li><li><p>re: remove gratuitous &quot;it &quot; in manpage (Thanks to Tuncer Ayaz)</p><p>Own Id: OTP-9307</p></li><li><p>A bug in erl_eval(3) has been fixed.</p><p>Own Id: OTP-9322</p></li></ul><h3 id="improvements-and-new-features-55" class="section-heading"><a href="#improvements-and-new-features-55" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>Add <a href="timer.html#tc/1"><code class="inline">timer:tc/1</code></a> and remove the catch in <code class="inline">tc/2</code> and <code class="inline">tc/3</code>. The time measuring
functions will thus no longer trap exits, errors or throws caused by the
measured function.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-9169</p></li><li><p>Allow supervisor:terminate_child(SupRef,Pid) for simple_one_for_one
supervisors</p><p>supervisor:terminate_child/2 was earlier not allowed if the supervisor used
restart strategy simple_one_for_one. This is now changed so that children of
this type of supervisors can be terminated by specifying the child's Pid.</p><p>(Thanks to Vance Shipley.)</p><p>Own Id: OTP-9201</p></li><li><p>Types and specifications have been added.</p><p>Own Id: OTP-9267</p></li><li><p>Erlang types and specifications are used for documentation.</p><p>Own Id: OTP-9271</p></li><li><p>Allow Dets tablenames to be arbitrary terms.</p><p>Own Id: OTP-9282</p></li><li><p>A specification that could cause problems for Dialyzer has been fixed. An
opaque type in erl_eval has been turned in to a ordinary type. This is a
temporary fix.</p><p>Own Id: OTP-9333</p></li></ul><h2 id="stdlib-1-17-3" class="section-heading"><a href="#stdlib-1-17-3" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 1.17.3</span></h2><h3 id="fixed-bugs-and-malfunctions-114" class="section-heading"><a href="#fixed-bugs-and-malfunctions-114" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Two bugs in io:format for ~F.~Ps has been corrected. When length(S) &gt;=
abs(F) &gt; P, the precision P was incorrectly ignored. When F == P &gt; length(S)
the result was incorrectly left adjusted. Bug found by Ali Yakout who also
provided a fix.</p><p>Own Id: OTP-8989 Aux Id: seq11741</p></li><li><p>Fix exception generation in the io module</p><p>Some functions did not generate correct badarg exception on a badarg
exception.</p><p>Own Id: OTP-9045</p></li><li><p>Fixes to the dict and orddict module documentation</p><p>Fixed grammar and one inconsistency (Key - Value instead of key/value, since
everywhere else the former is used). (thanks to Filipe David Manana)</p><p>Own Id: OTP-9083</p></li><li><p>Add ISO week number calculation functions to the calendar module in stdlib</p><p>This new feature adds the missing week number function to the calendar module
of the stdlib application. The implementation conforms to the ISO 8601
standard. The new feature has been implemented tested and documented (thanks
to Imre Horvath).</p><p>Own Id: OTP-9087</p></li></ul><h3 id="improvements-and-new-features-56" class="section-heading"><a href="#improvements-and-new-features-56" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>Implement the 'MAY' clauses from RFC4648 regarding the pad character to make
mime_decode() and mime_decode_to_string() functions more tolerant of badly
padded base64. The RFC is quoted below for easy reference.</p><p>&quot;RFC4648 Section 3.3 with reference to MIME decoding: Furthermore, such
specifications MAY ignore the pad character, &quot;=&quot;, treating it as non-alphabet
data, if it is present before the end of the encoded data. If more than the
allowed number of pad characters is found at the end of the string (e.g., a
base 64 string terminated with &quot;===&quot;), the excess pad characters MAY also be
ignored.&quot;</p><p>Own Id: OTP-9020</p></li><li><p>Supervisors will no longer save start parameters for temporary processes as
they will not be restarted. In the case of simple_one_for_one workers such as
ssl-connection processes this will substantial reduce the memory footprint of
the supervisor.</p><p>Own Id: OTP-9064</p></li><li><p>When running escript it is now possible to add the -n flag and the escript
will be compiled using +native.</p><p>Own Id: OTP-9076</p></li></ul><h2 id="stdlib-1-17-2-1" class="section-heading"><a href="#stdlib-1-17-2-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 1.17.2.1</span></h2><h3 id="fixed-bugs-and-malfunctions-115" class="section-heading"><a href="#fixed-bugs-and-malfunctions-115" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Several type specifications for standard libraries were wrong in the R14B01
release. This is now corrected. The corrections concern types in
re,io,filename and the module erlang itself.</p><p>Own Id: OTP-9008</p></li></ul><h2 id="stdlib-1-17-2" class="section-heading"><a href="#stdlib-1-17-2" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 1.17.2</span></h2><h3 id="fixed-bugs-and-malfunctions-116" class="section-heading"><a href="#fixed-bugs-and-malfunctions-116" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>When several clients accessed a Dets table simultaneously, one of them calling
<a href="dets.html#insert_new/2"><code class="inline">dets:insert_new/2</code></a>, the Dets server could crash. Alternatively, under the
same conditions, <code class="inline">ok</code> was sometimes returned instead of <code class="inline">true</code>. (Thanks to
John Hughes.)</p><p>Own Id: OTP-8856</p></li><li><p>When several clients accessed a Dets table simultaneously, inserted or updated
objects were sometimes lost due to the Dets file being truncated. (Thanks to
John Hughes.)</p><p>Own Id: OTP-8898</p></li><li><p>When several clients accessed a Dets table simultaneously, modifications of
the Dets server's internal state were sometimes thrown away. The symptoms are
diverse: error with reason <code class="inline">bad_object</code>; inserted objects not returned by
<code class="inline">lookup()</code>; et cetera. (Thanks to John Hughes.)</p><p>Own Id: OTP-8899</p></li><li><p>If a Dets table was closed after calling <code class="inline">bchunk/2</code>, <code class="inline">match/1,3</code>,
<code class="inline">match_object/1,3</code>, or <code class="inline">select/1,3</code> and then opened again, a subsequent call
using the returned continuation would normally return a reply. This bug has
fixed; now the call fails with reason <code class="inline">badarg</code>.</p><p>Own Id: OTP-8903</p></li><li><p>Cover did not collect coverage data for files such as Yecc parses containing
include directives. The bug has been fixed by modifying <code class="inline">epp</code>, the Erlang Code
Preprocessor.</p><p>Own Id: OTP-8911</p></li><li><p>If a Dets table with fewer slots than keys was opened and then closed after
just a lookup, the contents were no longer well-formed. This bug has been
fixed. (Thanks to Matthew Evans.)</p><p>Own Id: OTP-8923</p></li><li><p>In a supervisor, when it terminates a child, if that child happens to have
exited fractionally early, with normal, the supervisor reports this as an
error. This should not be reported as an error.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-8938 Aux Id: seq11615</p></li></ul><h3 id="improvements-and-new-features-57" class="section-heading"><a href="#improvements-and-new-features-57" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>The documentation filelib:wildcard/1,2 now describes the character set syntax
for wildcards.</p><p>Own Id: OTP-8879 Aux Id: seq11683</p></li><li><p>Buffer overflows have been prevented in <code class="inline">erlc</code>, <code class="inline">dialyzer</code>, <code class="inline">typer</code>,
<code class="inline">run_test</code>, <code class="inline">heart</code>, <code class="inline">escript</code>, and <code class="inline">erlexec</code>.</p><p>(Thanks to Michael Santos.)</p><p>Own Id: OTP-8892</p></li><li><p>Using a float for the number of copies for <a href="string.html#copies/2"><code class="inline">string:copies/2</code></a> resulted in an
infinite loop. Now it will fail with an exception instead. (Thanks to Michael
Santos.)</p><p>Own Id: OTP-8915</p></li><li><p>New ETS option <code class="inline">compressed</code>, to enable a more compact storage format at the
expence of heavier table operations. For test and evaluation, <code class="inline">erl +ec</code> can be
used to force compression on all ETS tables.</p><p>Own Id: OTP-8922 Aux Id: seq11658</p></li><li><p>The default maximum number of slots of a Dets table has been changed as to be
equal to the maximum number of slots. (Thanks to Richard Carlsson.)</p><p>Own Id: OTP-8959</p></li></ul><h2 id="stdlib-1-17-1" class="section-heading"><a href="#stdlib-1-17-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 1.17.1</span></h2><h3 id="fixed-bugs-and-malfunctions-117" class="section-heading"><a href="#fixed-bugs-and-malfunctions-117" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>reference() has been substituted for ref() in the documentation.</p><p>Own Id: OTP-8733</p></li></ul><h3 id="improvements-and-new-features-58" class="section-heading"><a href="#improvements-and-new-features-58" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>The ms_transform now warns if the fun head shadows surrounding variables (just
like the warnings you would get for an ordinary fun in the same context).</p><p>Own Id: OTP-6759</p></li><li><p>ets:select_reverse/{1,2,3} are now documented.</p><p>Own Id: OTP-7863</p></li><li><p>Large parts of the <code class="inline">ethread</code> library have been rewritten. The <code class="inline">ethread</code>
library is an Erlang runtime system internal, portable thread library used by
the runtime system itself.</p><p>Most notable improvement is a reader optimized rwlock implementation which
dramatically improve the performance of read-lock/read-unlock operations on
multi processor systems by avoiding ping-ponging of the rwlock cache lines.
The reader optimized rwlock implementation is used by miscellaneous rwlocks in
the runtime system that are known to be read-locked frequently, and can be
enabled on ETS tables by passing the
<a href="ets.html#new_2_read_concurrency">{read_concurrency, true}</a> option upon table
creation. See the documentation of <a href="ets.html#new/2"><code class="inline">ets:new/2</code></a> for more information. The
reader optimized rwlock implementation can be fine tuned when starting the
runtime system. For more information, see the documentation of the
<a href="../../apps/erts/erl_cmd.html#%2Brg">+rg</a> command line argument of <code class="inline">erl</code>.</p><p>There is also a new implementation of rwlocks that is not optimized for
readers. Both implementations interleaves readers and writers during
contention as opposed to, e.g., the NPTL (Linux) pthread rwlock implementation
which use either a reader or writer preferred strategy. The reader/writer
preferred strategy is problematic since it starves threads doing the
non-preferred operation.</p><p>The new rwlock implementations in general performs better in ERTS than common
pthread implementations. However, in some extremely heavily contended cases
this is not the case. Such heavy contention can more or less only appear on
ETS tables. This when multiple processes do very large amounts of write locked
operations simultaneously on the same table. Such use of ETS is bad regardless
of rwlock implementation, will never scale, and is something we strongly
advise against.</p><p>The new rwlock implementations depend on atomic operations. If no native
atomic implementation is found, a fallback solution will be used. Using the
fallback implies a performance degradation. That is, it is more important now
than before to build OTP with a native atomic implementation.</p><p>The <code class="inline">ethread</code> library contains native atomic implementations for, x86 (32 and
64 bit), powerpc (32 bit), sparc V9 (32 and 64 bit), and tilera (32 bit). On
other hardware gcc's builtin support for atomic memory access will be used if
such exists. If no such support is found, <code class="inline">configure</code> will warn about no
atomic implementation available.</p><p>The <code class="inline">ethread</code> library can now also use the <code class="inline">libatomic_ops</code> library for atomic
memory accesses. This makes it possible for the Erlang runtime system to
utilize optimized native atomic operations on more platforms than before. If
<code class="inline">configure</code> warns about no atomic implementation available, try using the
<code class="inline">libatomic_ops</code> library. Use the
<a href="../../system/install.html#advanced-configuration-and-build-of-erlang-otp">--with-libatomic_ops=PATH</a>
<code class="inline">configure</code> command line argument when specifying where the <code class="inline">libatomic_ops</code>
installation is located. The <code class="inline">libatomic_ops</code> library can be downloaded from:
<a href="http://www.hpl.hp.com/research/linux/atomic_ops/">http://www.hpl.hp.com/research/linux/atomic_ops/</a></p><p>The changed API of the <code class="inline">ethread</code> library has also caused modifications in the
Erlang runtime system. Preparations for the to come &quot;delayed deallocation&quot;
feature has also been done since it depends on the <code class="inline">ethread</code> library.</p><p><em>Note</em>: When building for x86, the <code class="inline">ethread</code> library will now use instructions
that first appeared on the pentium 4 processor. If you want the runtime system
to be compatible with older processors (back to 486) you need to pass the
<a href="../../system/install.html#advanced-configuration-and-build-of-erlang-otp">--enable-ethread-pre-pentium4-compatibility</a>
<code class="inline">configure</code> command line argument when configuring the system.</p><p>Own Id: OTP-8544</p></li><li><p>Some Built In Functions (BIFs) from the module erlang was never made
autoimported for backward compatibility reasons. As local functions now
override autoimports, new autoimports is no longer a problem, why the
following BIFs are finally made autoimported: monitor/2, monitor/3,
demonitor/2, demonitor/3, error/1, error/2, integer_to_list/2,
list_to_integer/2.</p><p>Own Id: OTP-8763</p></li></ul><h2 id="stdlib-1-17" class="section-heading"><a href="#stdlib-1-17" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 1.17</span></h2><h3 id="fixed-bugs-and-malfunctions-118" class="section-heading"><a href="#fixed-bugs-and-malfunctions-118" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>The Erlang code preprocessor (<code class="inline">epp</code>) sent extra messages on the form
<code class="inline">{eof,Location}</code> to the client when parsing the <code class="inline">file</code> attribute. This bug,
introduced in R11B, has been fixed.</p><p>Own Id: OTP-8470</p></li><li><p>The abstract type 'fun' could not be printed by the Erlang pretty printer
(<code class="inline">erl_pp</code>). This bug has been fixed.</p><p>Own Id: OTP-8473</p></li><li><p>The function <a href="erl_scan.html#reserved_word/1"><code class="inline">erl_scan:reserved_word/1</code></a> no longer returns <code class="inline">true</code> when given
the word <code class="inline">spec</code>. This bug was introduced in STDLIB-1.15.3 (R12B-3).</p><p>Own Id: OTP-8567</p></li><li><p>The documentation of <a href="lists.html#keysort/2"><code class="inline">lists:keysort/2</code></a> states that the sort is stable.</p><p>Own Id: OTP-8628 Aux Id: seq11576</p></li><li><p>The shell's line editing has been improved to more resemble the behaviour of
readline and other shells. (Thanks to Dave Peticolas)</p><p>Own Id: OTP-8635</p></li><li><p>The Erlang code preprocessor (<code class="inline">epp</code>) did not correctly handle premature
end-of-input when defining macros. This bug, introduced in STDLIB 1.16, has
been fixed.</p><p>Own Id: OTP-8665 Aux Id: OTP-7810</p></li></ul><h3 id="improvements-and-new-features-59" class="section-heading"><a href="#improvements-and-new-features-59" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>The module binary from EEP31 (and EEP9) is implemented.</p><p>Own Id: OTP-8217</p></li><li><p>The erlang pretty printer (<code class="inline">erl_pp</code>) no longer quotes atoms in types.</p><p>Own Id: OTP-8501</p></li><li><p>The Erlang code preprocessor (<code class="inline">epp</code>) now considers records with no fields as
typed.</p><p>Own Id: OTP-8503</p></li><li><p>Added function <a href="zip.html#foldl/3"><code class="inline">zip:foldl/3</code></a> to iterate over zip archives.</p><p>Added functions to create and extract escripts. See <a href="escript.html#create/2"><code class="inline">escript:create/2</code></a> and
<a href="escript.html#extract/2"><code class="inline">escript:extract/2</code></a>.</p><p>The undocumented function <code class="inline">escript:foldl/3</code> has been removed. The same
functionality can be achieved with the more flexible functions
<a href="escript.html#extract/2"><code class="inline">escript:extract/2</code></a> and <a href="zip.html#foldl/3"><code class="inline">zip:foldl/3</code></a>.</p><p>Record fields has been annotated with type info. Source files as been adapted
to fit within 80 chars and trailing whitespace has been removed.</p><p>Own Id: OTP-8521</p></li><li><p>The Erlang parser no longer duplicates the singleton type <code class="inline">undefined</code> in the
type of record fields without initial value.</p><p>Own Id: OTP-8522</p></li><li><p>A regular expression with many levels of parenthesis could cause a buffer
overflow. That has been corrected. (Thanks to Michael Santos.)</p><p>Own Id: OTP-8539</p></li><li><p>When defining macros the closing right parenthesis before the dot is now
mandatory.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-8562</p></li><li><p>Some properties of a compiled re pattern are defined to allow for guard tests.</p><p>Own Id: OTP-8577</p></li><li><p>Local and imported functions now override the auto-imported BIFs when the
names clash. The pre R14 behaviour was that auto-imported BIFs would override
local functions. To avoid that old programs change behaviour, the following
will generate an error:</p><ul><li>Doing a call without explicit module name to a local function having a name
clashing with the name of an auto-imported BIF that was present (and
auto-imported) before OTP R14A</li><li>Explicitly importing a function having a name clashing with the name of an
autoimported BIF that was present (and autoimported) before OTP R14A</li><li>Using any form of the old compiler directive <code class="inline">nowarn_bif_clash</code></li></ul><p>If the BIF was added or auto-imported in OTP R14A or later, overriding it with
an import or a local function will only result in a warning,</p><p>To resolve clashes, you can either use the explicit module name <code class="inline">erlang</code> to
call the BIF, or you can remove the auto-import of that specific BIF by using
the new compiler directive <code class="inline">-compile({no_auto_import,[F/A]}).</code>, which makes
all calls to the local or imported function without explicit module name pass
without warnings or errors.</p><p>The change makes it possible to add auto-imported BIFs without breaking or
silently changing old code in the future. However some current code
ingeniously utilizing the old behaviour or the <code class="inline">nowarn_bif_clash</code> compiler
directive, might need changing to be accepted by the compiler.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-8579</p></li><li><p>The undocumented, unsupport, and deprecated function <code class="inline">lists:flat_length/1</code> has
been removed.</p><p>Own Id: OTP-8584</p></li><li><p>A bug in re that could cause certain regular expression matches never to
terminate is corrected. (Thanks to Michael Santos and Gordon Guthrie.)</p><p>Own Id: OTP-8589</p></li><li><p>Nested records can now be accessed without parenthesis. See the Reference
Manual for examples. (Thanks to YAMASHINA Hio and Tuncer Ayaz.)</p><p>Own Id: OTP-8597</p></li><li><p><code class="inline">receive</code> statements that can only read out a newly created reference are now
specially optimized so that it will execute in constant time regardless of the
number of messages in the receive queue for the process. That optimization
will benefit calls to <code class="inline">gen_server:call()</code>. (See <code class="inline">gen:do_call/4</code> for an example
of a receive statement that will be optimized.)</p><p>Own Id: OTP-8623</p></li><li><p>The beam_lib:cmp/2 function now compares BEAM files in stricter way. The BEAM
files will be considered different if there are any changes except in the
compilation information (&quot;CInf&quot;) chunk. beam_lib:cmp/2 used to ignore
differences in the debug information (significant for Dialyzer) and other
chunks that did not directly change the run-time behavior.</p><p>Own Id: OTP-8625</p></li><li><p>When a gen_server, gen_fsm process, or gen_event terminates abnormally,
sometimes the text representation of the process state can occupy many lines
of the error log, depending on the definition of the state term. A mechanism
to trim out parts of the state from the log has been added (using a
format_status/2 callback). See the documentation.</p><p>Own Id: OTP-8630</p></li><li><p>Calling <code class="inline">sys:get_status()</code> for processes that have globally registered names
that were not atoms would cause a crash. Corrected. (Thanks to Steve Vinoski.)</p><p>Own Id: OTP-8656</p></li><li><p>The Erlang scanner has been augmented with two new tokens: <code class="inline">..</code> and <code class="inline">...</code>.</p><p>Own Id: OTP-8657</p></li><li><p>Expressions evaluating to integers can now be used in types and function
specifications where hitherto only integers were allowed (&quot;Erlang_Integer&quot;).</p><p>Own Id: OTP-8664</p></li><li><p>The compiler optimizes record operations better.</p><p>Own Id: OTP-8668</p></li><li><p>The recently added BIFs erlang:min/2, erlang:max/2 and erlang:port_command/3
are now auto-imported (as they were originally intended to be). Due to the
recent compiler change (OTP-8579), the only impact on old code defining it's
own min/2, max/2 or port_command/3 functions will be a warning, the local
functions will still be used. The warning can be removed by using
-compile({no_auto_import,[min/2,max/2,port_command/3]}). in the source
file.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-8669 Aux Id: OTP-8579</p></li><li><p>Now, binary_to_term/2 is auto-imported. This will cause a compile warning if
and only if a module has got a local function with that name.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-8671</p></li><li><p>The predefined builtin type tid() has been removed. Instead, ets:tid() should
be used.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-8687</p></li></ul><h2 id="stdlib-1-16-5" class="section-heading"><a href="#stdlib-1-16-5" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 1.16.5</span></h2><h3 id="fixed-bugs-and-malfunctions-119" class="section-heading"><a href="#fixed-bugs-and-malfunctions-119" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Because of a race condition, using filelib:ensure_dir/1 from multiple
processes to create the same path or parts of the same directory structure,
filelib:ensure_dir/1 could return a meaningless {error,eexist}. That race
condition has been eliminated, and {error,eexist} will now be returned only
if there exists a regular file, device file, or some other non-directory file
with the same name. (Thanks to Tuncer Ayaz.)</p><p>Own Id: OTP-8389</p></li><li><p>A number of bugs concerning re and unicode are corrected:</p><p>re:compile no longer loses unicode option, which also fixes bug in re:split.</p><p>re:replace now handles unicode charlist replacement argument</p><p>re:replace now handles unicode RE charlist argument correctly</p><p>re:replace now handles binary unicode output correctly when nothing is
replaced.</p><p>Most code, testcases and error isolation done by Rory Byrne.</p><p>Own Id: OTP-8394</p></li><li><p>The loading of native code was not properly atomic in the SMP emulator, which
could cause crashes. Also a per-MFA information table for the native code has
now been protected with a lock since it turns that it could be accessed
concurrently in the SMP emulator. (Thanks to Mikael Pettersson.)</p><p>Own Id: OTP-8397</p></li><li><p>user.erl (used in oldshell) is updated to handle unicode in prompt strings
(io:get_line/{1,2}). io_lib is also updated to format prompts with the 't'
modifier (i.e. ~ts instead of ~s).</p><p>Own Id: OTP-8418 Aux Id: OTP-8393</p></li><li><p>The re module: A regular expression with an option change at the start of a
pattern that had top-level alternatives could cause overwriting and/or a
crash. (Thanks to Michael Santos.)</p><p>Own Id: OTP-8438</p></li></ul><h3 id="improvements-and-new-features-60" class="section-heading"><a href="#improvements-and-new-features-60" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>The ability for the gen_server and gen_fsm callback modules to format their
own state for display under the sys:get_status/1,2 calls has been restored and
documented. (Thanks to Steve Vinoski.)</p><p>Own Id: OTP-8324</p></li><li><p>c:nc/{1,2} used to assume that the beam file was created in the same
directory as the source code and failed to load the code if it was not.
Corrected to look for the beam file in the current directory or in the
directory specified by the <code class="inline">{outdir,Dir}</code> option. (Thanks to Alex Suraci.)</p><p>Own Id: OTP-8337</p></li><li><p>The documentation is now possible to build in an open source environment after
a number of bugs are fixed and some features are added in the documentation
build process.</p><p>- The arity calculation is updated.</p><p>- The module prefix used in the function names for bif's are removed in the
generated links so the links will look like
&quot;<a href="http://www.erlang.org/doc/man/erlang.html#append_element-2%22">http://www.erlang.org/doc/man/erlang.html#append_element-2&quot;</a> instead of
&quot;<a href="http://www.erlang.org/doc/man/erlang.html#erlang:append_element-2%22">http://www.erlang.org/doc/man/erlang.html#erlang:append_element-2&quot;</a>.</p><p>- Enhanced the menu positioning in the html documentation when a new page is
loaded.</p><p>- A number of corrections in the generation of man pages (thanks to Sergei
Golovan)</p><p>- The legal notice is taken from the xml book file so OTP's build process can
be used for non OTP applications.</p><p>Own Id: OTP-8343</p></li><li><p>Shell tab completion now works for quoted module and function names. (Thanks
to Ulf Wiger.)</p><p>Own Id: OTP-8383</p></li><li><p>Explicit top directories in archive files are now optional.</p><p>For example, if an archive (app-vsn.ez) just contains an app-vsn/ebin/mod.beam
file, the file info for the app-vsn and app-vsn/ebin directories are faked
using the file info from the archive file as origin. The virtual direcories
can also be listed. For short, the top directories are virtual if they does
not exist.</p><p>Own Id: OTP-8387</p></li><li><p>Macros overloading has been implemented. (Thanks to Christopher Faulet.)</p><p>Own Id: OTP-8388</p></li><li><p>The new function <a href="shell.html#prompt_func/1"><code class="inline">shell:prompt_func/1</code></a> and the new application configuration
parameter <code class="inline">shell_prompt_func</code> can be used for customizing the Erlang shell
prompt.</p><p>Own Id: OTP-8393</p></li><li><p>Improved handling of typed records in escripts</p><p>Own Id: OTP-8434</p></li><li><p>Added supervisor:count_children/1 to count the number of children being
managed without the memory impact of which_children/1. (Thanks to Jay Nelson.)</p><p>Own Id: OTP-8436</p></li></ul><h2 id="stdlib-1-16-4" class="section-heading"><a href="#stdlib-1-16-4" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 1.16.4</span></h2><h3 id="improvements-and-new-features-61" class="section-heading"><a href="#improvements-and-new-features-61" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>The documentation is now built with open source tools (xsltproc and fop) that
exists on most platforms. One visible change is that the frames are removed.</p><p>Own Id: OTP-8201</p></li><li><p>[escript] The restriction that the first line in escripts must begin with
<code class="inline">#!</code> has been removed.</p><p>[escript] Some command line options to the escript executable has now been
documented. For example you can run an escript in the debugger by just adding
a command line option.</p><p>[escript] The documentation of the escript header syntax has been clarified.
For example the header is optional. This means that it is possible to directly
&quot;execute&quot; <code class="inline">.erl</code>, <code class="inline">.beam</code> and<code class="inline">.zip</code> files.</p><p>Own Id: OTP-8215</p></li><li><p>Optimized array:from_orddict/1, it is now faster and uses less memory if the
orddict was sparse.</p><p>Changed array:reset/2, it will now never expand the array which it could
before for non fixed arrays. See the documentation.</p><p>Own Id: OTP-8216</p></li><li><p>The Erlang Pretty Printer (<code class="inline">erl_pp</code>) now puts the leading <code class="inline">[</code> of list
comprehensions as well as the leading <code class="inline">&lt;&lt;</code> of bit string comprehensions on a
separate line in order to expose the Cover counter of the template.</p><p>Own Id: OTP-8227</p></li><li><p>The extension &quot;.xrl&quot; used for Leex input files is now recognized by the
compiler.</p><p>Own Id: OTP-8232</p></li><li><p>Some clarifications have been made in the documentation regarding
<code class="inline">gen_server</code>, <code class="inline">gen_fsm</code>, and <code class="inline">gen_event</code> behavior when handling <code class="inline">'EXIT'</code>
messages from the parent process. For more information see the <a href="gen_server.html"><code class="inline">gen_server</code></a>,
<a href="gen_fsm.html"><code class="inline">gen_fsm</code></a>, and <a href="gen_event.html"><code class="inline">gen_event</code></a> documentation.</p><p>Own Id: OTP-8255 Aux Id: seq11419</p></li><li><p>The -on_load() directive can be used to run a function when a module is
loaded. It is documented in the section about code loading in the Reference
Manual.</p><p>Own Id: OTP-8295</p></li></ul><h2 id="stdlib-1-16-3-1" class="section-heading"><a href="#stdlib-1-16-3-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 1.16.3.1</span></h2><h3 id="fixed-bugs-and-malfunctions-120" class="section-heading"><a href="#fixed-bugs-and-malfunctions-120" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>An erroneous type spec for <code class="inline">gen:start/6</code> caused dialyzer to erroneously issue
warnings when <code class="inline">{spawn_opt, SpawnOptionList}</code> was passed in the option list to
the <code class="inline">gen_server</code> and <code class="inline">gen_fsm</code> start functions.</p><p>Own Id: OTP-8068 Aux Id: seq11323, seq11314</p></li></ul><h2 id="stdlib-1-16-3" class="section-heading"><a href="#stdlib-1-16-3" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 1.16.3</span></h2><h3 id="fixed-bugs-and-malfunctions-121" class="section-heading"><a href="#fixed-bugs-and-malfunctions-121" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>The linter used to crash on invalid <code class="inline">-opaque</code> declarations.</p><p>Own Id: OTP-8051</p></li><li><p>Bugs in <a href="digraph.html#add_edge/5"><code class="inline">digraph:add_edge/5</code></a> and <a href="digraph.html#del_path/3"><code class="inline">digraph:del_path/3</code></a> have been fixed. (Thanks
to Crystal Din.)</p><p>Own Id: OTP-8066</p></li><li><p>When trying to insert objects with <code class="inline">dets:insert_new()</code> into a Dets table of
type <code class="inline">duplicate_bag</code>, already existing objects would sometimes be duplicated.
This bug has been fixed. (Thanks to Crystal Din.)</p><p>Own Id: OTP-8070</p></li><li><p>Running erlc in a very deep directory (with a path length of more 256 or more
characters) would cause the emulator to crash in a call to
<a href="../../apps/erts/erlang.html#list_to_atom/1"><code class="inline">list_to_atom/1</code></a>. (Thanks to Chris Newcombe.)</p><p>Own Id: OTP-8124</p></li><li><p>A few minor bugs have been fixed in the Erlang Code Preprocessor (<code class="inline">epp</code>).</p><p>Own Id: OTP-8130</p></li><li><p>A bug in The Erlang Meta Interpreter (<code class="inline">erl_eval</code>) has been fixed: exceptions
generated in the template of bit string comprehensions were not handled
properly. (Thanks to Ulf Wiger.)</p><p>Own Id: OTP-8133</p></li></ul><h3 id="improvements-and-new-features-62" class="section-heading"><a href="#improvements-and-new-features-62" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>Option <code class="inline">{capture,none}</code> was missing in documentation for <a href="re.html#run/3"><code class="inline">re:run/3</code></a>.</p><p>Own Id: OTP-8113</p></li><li><p>When <a href="erl_scan.html#t:tokens/0"><code class="inline">erl_scan:tokens()</code></a> returns an error tuple
<code class="inline">{error, ErrorInfo, EndLocation</code>}, the list <code class="inline">LeftOverChars</code> is the remaining
characters of the input data, starting from <code class="inline">EndLocation</code>. It used to be the
empty list.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-8129</p></li><li><p>The Erlang Meta Interpreter (<code class="inline">erl_eval</code>) has been somewhat optimized when it
comes to interpreting <code class="inline">receive</code>-expressions. (Thanks to Richard Carlsson.)</p><p>Own Id: OTP-8139</p></li><li><p>The Erlang Pretty Printer (<code class="inline">erl_pp</code>) has been modified as to handle types.</p><p>Own Id: OTP-8150</p></li></ul><h2 id="stdlib-1-16-2" class="section-heading"><a href="#stdlib-1-16-2" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 1.16.2</span></h2><h3 id="fixed-bugs-and-malfunctions-122" class="section-heading"><a href="#fixed-bugs-and-malfunctions-122" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>The text of tokens returned by the Erlang scanner (<code class="inline">erl_scan</code>) was sometimes
empty when the <code class="inline">text</code> option was given and <code class="inline">StartLocation</code> was a line. This
bug has been fixed.</p><p>Own Id: OTP-7965</p></li><li><p>The documentation for <a href="base64.html#decode/1"><code class="inline">base64:decode/1</code></a> has been updated to point out that it
strips whitespace.</p><p><a href="base64.html#decode/1"><code class="inline">base64:decode/1</code></a> and <a href="base64.html#mime_decode/1"><code class="inline">base64:mime_decode/1</code></a> would sometimes fail instead of
stripping away non-base64 characters.</p><p>Own Id: OTP-7984</p></li><li><p>Two types in the <code class="inline">gen</code> module were corrected.</p><p>Own Id: OTP-8029 Aux Id: seq11296</p></li><li><p><code class="inline">array:from_orddict([])</code> and <code class="inline">array:from_list([])</code> would construct fixed
arrays instead of extendible arrays.</p><p>Own Id: OTP-8033</p></li></ul><h3 id="improvements-and-new-features-63" class="section-heading"><a href="#improvements-and-new-features-63" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>Interpreted escripts are now tail recursive.</p><p>The function erl_eval:expr/5 has been introduced.</p><p>Own Id: OTP-7933</p></li><li><p><code class="inline">gen_server:call/2,3</code> will be somewhat faster if the calling process has a
many messages in its message queue.</p><p>Own Id: OTP-7979</p></li><li><p>Random now supports seed with arity one, <a href="random.html#seed/1"><code class="inline">random:seed/1</code></a>, which takes a
three-tuple.</p><p>Own Id: OTP-8019</p></li><li><p>The <code class="inline">regexp</code> module now recognizes the escape sequences <code class="inline">\xXY</code> and <code class="inline">\x{X...}</code>.</p><p>Own Id: OTP-8024</p></li></ul><h2 id="stdlib-1-16-1" class="section-heading"><a href="#stdlib-1-16-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 1.16.1</span></h2><h3 id="fixed-bugs-and-malfunctions-123" class="section-heading"><a href="#fixed-bugs-and-malfunctions-123" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>The documentation of <a href="dets.html#open_file/1"><code class="inline">dets:open_file/1</code></a> now states that the file is repaired
if it has not been properly closed. (Thanks to Ulf Wiger.)</p><p>Own Id: OTP-7895</p></li></ul><h3 id="improvements-and-new-features-64" class="section-heading"><a href="#improvements-and-new-features-64" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>The Erlang scanner no longer returns the text of tokens when the start
location is a pair of a line and column unless the new option <code class="inline">text</code> is
supplied (incompatibility with R13A).</p><p>There are new functions to access the attributes of tokens:
<code class="inline">attributes_info/1,2</code> and <code class="inline">set_attribute/3</code>.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-7892 Aux Id: OTP-7810</p></li><li><p>Several glitches and performance issues in the Unicode and I/O-system
implementation of R13A have been corrected.</p><p>Own Id: OTP-7896 Aux Id: OTP-7648 OTP-7887</p></li><li><p>The type spec of filelib:wildcard/2 has been corrected.</p><p>Own Id: OTP-7915</p></li><li><p>New functions: <a href="gb_sets.html#is_disjoint/2"><code class="inline">gb_sets:is_disjoint/2</code></a>, <a href="ordsets.html#is_disjoint/2"><code class="inline">ordsets:is_disjoint/2</code></a>, and
<a href="gb_sets.html#is_disjoint/2"><code class="inline">gb_sets:is_disjoint/2</code></a>.</p><p>Own Id: OTP-7947</p></li><li><p>The function <a href="gb_trees.html#map/2"><code class="inline">gb_trees:map/2</code></a> which was added in R13A is now documented.</p><p>Own Id: OTP-7948</p></li></ul><h2 id="stdlib-1-16" class="section-heading"><a href="#stdlib-1-16" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 1.16</span></h2><h3 id="fixed-bugs-and-malfunctions-124" class="section-heading"><a href="#fixed-bugs-and-malfunctions-124" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Fixed a minor race conditions in <code class="inline">gen_server:start*</code>: if one of these
functions returned <code class="inline">{error,Reason}</code> or <code class="inline">ignore</code>, the name could still be
registered (either locally or in <code class="inline">global</code>).</p><p>A process started by <code class="inline">proc_lib</code> in some cases depended on its process
dictionary not to be erased, and would crash when terminating abnormally and
not generate a proper crash report. This has been corrected (but the initial
call will not be shown in the error report if the process dictionary has been
erased). NOTE: There is no longer any need to erase the process dictionary for
memory conservation reasons, since the actual call arguments are no longer
saved in the process dictionary.</p><p>Own Id: OTP-7669</p></li><li><p>The Erlang preprocessor used wrong line number when stringifying macro
arguments. (Thanks to John Hughes.)</p><p>Own Id: OTP-7702</p></li><li><p>A bug in the <code class="inline">qlc</code> module has been fixed: merge join sometimes failed to
return all answers. (Thanks to Bernard Duggan.)</p><p>Own Id: OTP-7714</p></li></ul><h3 id="improvements-and-new-features-65" class="section-heading"><a href="#improvements-and-new-features-65" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>A new option, <code class="inline">key_equality</code>, has been added to <a href="qlc.html#table/2"><code class="inline">qlc:table/2</code></a>. This option
makes it possible for <code class="inline">qlc</code> to better handle tables that use <code class="inline">==/2</code> when
comparing keys for equality (examples of such tables are ordered ETS tables
and gb_table in qlc(3)).</p><p>Own Id: OTP-6674</p></li><li><p>The functions <code class="inline">lists:seq/1,2</code> return the empty list in a few cases when they
used to generate an exception, for example <code class="inline">lists:seq(1, 0)</code>. See lists(3) for
details. (Thanks to Richard O'Keefe.)</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-7230</p></li><li><p>The order of objects visited in select for ordered_set is now documented.</p><p>Own Id: OTP-7339</p></li><li><p>It is now possible to debug code in escripts and archives.</p><p>Own Id: OTP-7626</p></li><li><p>Support for Unicode is implemented as described in EEP10. Formatting and
reading of unicode data both from terminals and files is supported by the io
and io_lib modules. Files can be opened in modes with automatic translation to
and from different unicode formats. The module 'unicode' contains functions
for conversion between external and internal unicode formats and the re module
has support for unicode data. There is also language syntax for specifying
string and character data beyond the ISO-latin-1 range.</p><p>The interactive shell will support input and output of unicode characters when
the terminal and operating system supports it.</p><p>Please see the EEP and the io/io_lib manual pages as well as the stdlib users
guide for details.</p><p><em>I/O-protocol incompatibilities:</em></p><p>The io<em>protocol between io_Server and client is updated to handle protocol
data in unicode formats. The updated protocol is now documented. The
specification resides in the stdlib _users manual</em>, which is a new part of the
manual.</p><p><em>io module incompatibilities:</em></p><p>The io:put<em>chars, io:get_chars and io:get_line all handle and return unicode
data. In the case where binaries can be provided (as to io:put_chars), they
shall be encoded in UTF-8. When binaries are returned (as by
io:get_line/get_chars when the io_server is set in _binary mode</em>) the returned
data is also <em>always</em> encoded as UTF-8. The file module however still returns
byte-oriented data, why file:read can be used instead of io:get_chars to read
binary data in ISO-latin-1.</p><p><em>io_lib module incompatibilities:</em></p><p>io_lib:format can, given new format directives (i.e &quot;~ts&quot; and &quot;~tc&quot;), return
lists containing integers larger than 255.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-7648 Aux Id: OTP-7580 OTP-7514 OTP-7494 OTP-7443 OTP-7181 EEP10
EEP11</p></li><li><p>The function <a href="pool.html#attach/1"><code class="inline">pool:attach/1</code></a> now returns <code class="inline">already_attached</code> if the node is
already attached, rather than <code class="inline">allready_attached</code> (sic!). (Thanks to Edwin
Fine.)</p><p>Own Id: OTP-7653 Aux Id: OTP-7603</p></li><li><p>Preprocessor directives are now allowed in escripts. This means that for
example macros may be used in escripts.</p><p>Own Id: OTP-7662</p></li><li><p>When a process started with <code class="inline">proc_lib</code>, <code class="inline">gen_server</code>, or <code class="inline">gen_fsm</code> exits with
reason <code class="inline">{shutdown,Term}</code>, a crash report will no longer be generated (to allow
a clean shutdown, but still provide additional information to process that are
linked to the terminating process).</p><p>Own Id: OTP-7740 Aux Id: seq10847</p></li><li><p>A new BIF, <a href="lists.html#keyfind/3"><code class="inline">lists:keyfind/3</code></a>, has been added. It works like
<a href="lists.html#keysearch/3"><code class="inline">lists:keysearch/3</code></a> except that it does not wrap the returned tuple in a
<code class="inline">value</code> tuple in case of success. (Thanks to James Hague for suggesting this
function.)</p><p>Own Id: OTP-7752</p></li><li><p><code class="inline">lists:suffix(Suffix, List)</code> used to have a a complexity of
<code class="inline">length(Suffix)*length(List)</code> (which could become quite slow for some inputs).
It has now been re-implemented so that its complexity is
<code class="inline">length(Suffix)+length(List)</code>. (Thanks to Richard O'Keefe for the new
implementation.)</p><p>Own Id: OTP-7797</p></li><li><p>The Erlang scanner has been augmented as to return white spaces, comments, and
exact location of tokens. The functions <code class="inline">string/3</code>, <code class="inline">tokens/4</code>, and
<code class="inline">token_info/1,2</code> are new. See erl_scan(3) for details.</p><p><code class="inline">tokens/3,4</code> have been modified as to return a list of tokens instead of an
error when <code class="inline">eof</code> is encountered before the dot.</p><p>Own Id: OTP-7810</p></li><li><p><a href="filelib.html#fold_files/5"><code class="inline">filelib:fold_files/5</code></a> now uses the <code class="inline">re</code> module instead of the <code class="inline">regexp</code> module
for regular expression matching. In practice, this change will not be a
problem for most regular expressions used for <a href="filelib.html#fold_files/5"><code class="inline">filelib:fold_files/5</code></a>. (The
major difference in regular expression is that parenthesis and curly brackets
is treated as literal characters by <code class="inline">regexp</code> but as special characters by
<code class="inline">re</code>; fortunately, those characters are rarely used in filenames.)</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-7819</p></li><li><p><code class="inline">digraph:new(Type)</code> will now cause a <code class="inline">badarg</code> exception if <code class="inline">Type</code> is not a
valid type. Similarly, <code class="inline">digraph_utils:subgraph/2,3</code> will now cause a <code class="inline">badarg</code>
if the arguments are invalid. (Those functions used to return error tuples if
something was wrong.)</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-7824</p></li><li><p>The argument passed to <a href="random.html#uniform/1"><code class="inline">random:uniform/1</code></a> must now be an integer (as stated in
the documentation). In previous releases, a floating point number was also
allowed.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-7827</p></li><li><p>The copyright notices have been updated.</p><p>Own Id: OTP-7851</p></li><li><p>A few missing match spec functions was added to dbg:fun2ms; exception_trace/0
and trace/2,3.</p><p>There is a new function queue:member/2.</p><p>A bug in io_lib:fread that made it accidentally concatenate fields separated
by newline has been corrected. Reported and analyzed by Matthew Palmer to
erlang-patches.</p><p>Own Id: OTP-7865</p></li></ul><h2 id="stdlib-1-15-5" class="section-heading"><a href="#stdlib-1-15-5" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 1.15.5</span></h2><h3 id="fixed-bugs-and-malfunctions-125" class="section-heading"><a href="#fixed-bugs-and-malfunctions-125" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>A bug in the <code class="inline">qlc</code> module has been fixed: when merge joining two query handles
the temporary file used for equivalence classes was not truncated properly
which could result in poor performance.</p><p>Own Id: OTP-7552</p></li><li><p>The characters 16#C0 and 16#E0 (&quot;A&quot; and &quot;a&quot; with grave accent), were not
properly converted by the <a href="string.html#to_lower/1"><code class="inline">string:to_lower/1</code></a> and <a href="string.html#to_upper/1"><code class="inline">string:to_upper/1</code></a>
functions. (Thanks to Richard O'Keefe.)</p><p>Own Id: OTP-7589</p></li><li><p>The function <a href="pool.html#attach/1"><code class="inline">pool:attach/1</code></a> now returns <code class="inline">already_attached</code> if the node is
already attached, rather than <code class="inline">allready_attached</code> (sic!). (Thanks to Edwin
Fine.)</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-7603</p></li><li><p>The documentation for <code class="inline">io:get_line/1,2</code> now mentions that the return value can
also be <code class="inline">{error,Reason}</code>.</p><p>Own Id: OTP-7604 Aux Id: seq11063</p></li></ul><h3 id="improvements-and-new-features-66" class="section-heading"><a href="#improvements-and-new-features-66" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>The split function is now added to the re library. Exceptions and errors from
both run, replace and split are made more consistent.</p><p>Own Id: OTP-7514 Aux Id: OTP-7494</p></li><li><p>Processes spawned using <code class="inline">proc_lib</code> (including <code class="inline">gen_server</code> and other library
modules that use <code class="inline">proc_lib</code>) no longer keep the entire argument list for the
initial call, but only the arity.</p><p>Also, if <a href="proc_lib.html#spawn/1"><code class="inline">proc_lib:spawn/1</code></a> is used to spawn a fun, the actual fun is not
kept, but only module, function name, and arity of the function that
implements the fun.</p><p>The reason for the change is that keeping the initial fun (or a fun in an
argument list), would prevent upgrading the code for the module. A secondary
reason is that keeping the fun and function arguments could waste a
significant amount of memory.</p><p>The drawback with the change is that the crash reports will provide less
precise information about the initial call (only <code class="inline">Module:Function/Arity</code>
instead of <code class="inline">Module:Function(Arguments)</code>). The function
<a href="proc_lib.html#initial_call/1"><code class="inline">proc_lib:initial_call/1</code></a> still returns a list, but each argument has been
replaced with a dummy atom.</p><p>Own Id: OTP-7531 Aux Id: seq11036</p></li><li><p>There is now experimental support for loading of code from archive files. See
the documentation of <code class="inline">code</code>, <code class="inline">init</code>, <code class="inline">erl_prim_loader</code>and <code class="inline">escript</code> for more
info.</p><p>The error handling of <code class="inline">escripts</code> has been improved.</p><p>An <code class="inline">escript</code> may now set explicit arguments to the emulator, such as
<code class="inline">-smp enabled</code>.</p><p>An <code class="inline">escript</code> may now contain a precompiled beam file.</p><p>An <code class="inline">escript</code> may now contain an archive file containing one or more
applications (experimental).</p><p>The internal module <code class="inline">code_aux</code> has been removed.</p><p>Own Id: OTP-7548 Aux Id: otp-6622</p></li><li><p>Enabled explicit control of which types of files that should be compressed in
a ZIP archive.</p><p>Own Id: OTP-7549 Aux Id: otp-6622</p></li><li><p>In the job control mode, the &quot;s&quot; and &quot;r&quot; commands now take an optional
argument to specify which shell to start. (Thanks to Robert Virding.)</p><p>Own Id: OTP-7617</p></li></ul><h2 id="stdlib-1-15-4" class="section-heading"><a href="#stdlib-1-15-4" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 1.15.4</span></h2><h3 id="fixed-bugs-and-malfunctions-126" class="section-heading"><a href="#fixed-bugs-and-malfunctions-126" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>A bug in the calendar module could cause
calendar:local_time_to_universal_time_dst/1 to return duplicate identical
values for local times in timezones without DST. Multiple values should only
be returned when a local time is within the hour occurring twice due to shift
from DST to non-DST, and certainly only in timezones with DST. The correct
behaviour is now implemented.</p><p>Own Id: OTP-7344 Aux Id: seq10960</p></li><li><p>The documentation of <code class="inline">(d)ets:init_table()</code> has been corrected. (Thanks to Paul
Mineiro.)</p><p>Own Id: OTP-7413</p></li><li><p>The soft upper limit of 60 on the number of non-white characters on a line,
which was introduced in R12B-0 for the control sequences <code class="inline">p</code> and <code class="inline">P</code> of the
functions <code class="inline">io:fwrite/2,3</code> and <a href="io_lib.html#fwrite/2"><code class="inline">io_lib:fwrite/2</code></a>, has been removed. This means
that terms whose printed representation fits on a line will have no NEWLINEs.
The Erlang shell still uses the 60 character limit, though.</p><p>Own Id: OTP-7421 Aux Id: OTP-6708</p></li><li><p>Some debug code has been removed from Dets.</p><p>Own Id: OTP-7424</p></li><li><p>The documentation of <a href="dets.html#match_delete/2"><code class="inline">dets:match_delete/2</code></a> has been corrected. (Thanks to Paul
Mineiro.)</p><p>Own Id: OTP-7445</p></li><li><p>Corrections of digraph(3). (Thanks to Vlad Dumitrescu.)</p><p>Own Id: OTP-7492</p></li><li><p>For the process that an escript runs in, the <code class="inline">trap_exit</code> process flag is now
<code class="inline">false</code> instead of <code class="inline">true</code> (as in previous releases). Scripts that depend on
the previous (counter-intuitive) behaviour might not work. (Thanks to Bengt
Kleberg.)</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-7517</p></li></ul><h3 id="improvements-and-new-features-67" class="section-heading"><a href="#improvements-and-new-features-67" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>The documentation of <code class="inline">lists:(u)sort/2</code> now states what is expected of an
ordering function.</p><p>Own Id: OTP-7489</p></li><li><p>The re module is extended with repetitive matches (global option) and
replacement function.</p><p>Own Id: OTP-7494 Aux Id: OTP-7181</p></li><li><p>The Erlang shell now displays a nicer error message when evaluating an
undefined command. (Thanks to Richard Carlsson.)</p><p>Own Id: OTP-7495</p></li></ul><h2 id="stdlib-1-15-3" class="section-heading"><a href="#stdlib-1-15-3" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 1.15.3</span></h2><h3 id="fixed-bugs-and-malfunctions-127" class="section-heading"><a href="#fixed-bugs-and-malfunctions-127" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>zip:unzip to/from binary with empty directories did not work. (Thanks to
Martin Dvorak.)</p><p>Own Id: OTP-7248</p></li><li><p>The documentation of the control sequence <code class="inline">w</code> of the <code class="inline">io_lib</code> module now
states that floating point numbers are printed accurately.</p><p>Own Id: OTP-7324 Aux Id: OTP-7084</p></li><li><p>zip:unzip was not supporting a flavour of the zip format found in jar-files.</p><p>Own Id: OTP-7382 Aux Id: seq10970</p></li></ul><h3 id="improvements-and-new-features-68" class="section-heading"><a href="#improvements-and-new-features-68" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>An experimental module &quot;re&quot; is added to the emulator which interfaces a
publicly available regular expression library for Perl-like regular
expressions (PCRE). The interface is purely experimental and <em>will</em> be subject
to change.</p><p>The implementation is for reference and testing in connection to the relevant
EEP.</p><p>Own Id: OTP-7181</p></li></ul><h2 id="stdlib-1-15-2" class="section-heading"><a href="#stdlib-1-15-2" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 1.15.2</span></h2><h3 id="fixed-bugs-and-malfunctions-128" class="section-heading"><a href="#fixed-bugs-and-malfunctions-128" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>When inserting many small objects, Dets sometimes crashed when reaching the
maximum number of slots. (Thanks to Daniel Goertzen.)</p><p>Own Id: OTP-7146</p></li><li><p>Processes linked to the Erlang shell did not get an exit signal when the
evaluator process was killed. This bug, introduced in R12B-0, has been fixed.</p><p>Own Id: OTP-7184 Aux Id: OTP-6554</p></li><li><p>Invalid arguments to <a href="ets.html#update_counter/3"><code class="inline">ets:update_counter/3</code></a> were not handled correctly. A
tuple position (<code class="inline">Pos</code>) less than 1 caused the element directly following the
key to be updated (as if no position at all had been specified). All invalid
values for <code class="inline">Pos</code> will now fail with <code class="inline">badarg</code>.</p><p>Own Id: OTP-7226</p></li><li><p>For certain terminals, io:columns/0 could return 0 instead of enotsup. That is
now corrected.</p><p>Own Id: OTP-7229 Aux Id: seq10886</p></li><li><p><code class="inline">qlc:info()</code> can now handle port identifiers, pids, references, and funs.
(Thanks to Wojciech Kaczmare for reporting this bug.)</p><p>When evaluating the <code class="inline">parent_fun</code> messages sent to the process calling
<code class="inline">qlc:cursor()</code> were sometimes erroneously consumed. This bug has been fixed.</p><p>Own Id: OTP-7232</p></li><li><p><code class="inline">erl_parse:abstract()</code> can now handle bit strings.</p><p>Own Id: OTP-7234</p></li></ul><h3 id="improvements-and-new-features-69" class="section-heading"><a href="#improvements-and-new-features-69" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>The <code class="inline">queue</code> module has been rewritten to make it easier to use. Suggestions
and discussion from and with among others Lev Walkin, Anders Ramsell and Rober
Virding in december 2007 on erlang-questions@erlang.org. It was also discussed
to change the internal representation to contain length information which
would speed up <code class="inline">len/1</code> but that change has been postponed. Anyone interested
may write an EEP and try to reach an acceptable compromise for queue overhead
and thereby the speed of all other operations than <code class="inline">len/1</code>. The <code class="inline">queue</code> module
is now optimized for fast and minimal garbage <code class="inline">in/2</code> and <code class="inline">out/1</code> and such. See
the documentation.</p><p>New functions: <code class="inline">is_queue/1</code>, <a href="../../apps/erts/erlang.html#get/1"><code class="inline">get/1</code></a>, <code class="inline">get_r/1</code>, <code class="inline">peek/1</code>,
<code class="inline">peek_r/1</code>, <code class="inline">drop/1</code>, <code class="inline">drop_r/1</code> and <code class="inline">liat/1</code>. <code class="inline">is_queue/1</code> is a new
predicate, <code class="inline">liat/1</code> is a correction of an old misspelling, and the others
(<code class="inline">get</code>*, <code class="inline">peek</code>* and <code class="inline">drop</code>*) are new interface functions.</p><p>Own Id: OTP-7064</p></li><li><p>The functions <code class="inline">io_lib:write/1,2</code> and <code class="inline">io_lib:print/1,4</code> have been changed when
it comes to writing floating point numbers. This change affects the control
sequences <code class="inline">p</code>, <code class="inline">P</code>, <code class="inline">w</code>, and <code class="inline">W</code> of the <code class="inline">io_lib</code> module. (Thanks to Bob
Ippolito for code contribution.)</p><p>Own Id: OTP-7084</p></li><li><p>Updated the documentation for <a href="../../apps/erts/erlang.html#function_exported/3"><code class="inline">erlang:function_exported/3</code></a> and <a href="io.html#format/2"><code class="inline">io:format/2</code></a>
functions to no longer state that those functions are kept mainly for
backwards compatibility.</p><p>Own Id: OTP-7186</p></li><li><p>A new BIF ets:update_element/3. To update individual elements within an
ets-tuple, without having to read, update and write back the entire tuple.</p><p>Own Id: OTP-7200</p></li><li><p><a href="string.html#join/2"><code class="inline">string:join/2</code></a> now accepts an empty list as first argument.</p><p>Own Id: OTP-7231 Aux Id: OTP-6671</p></li><li><p><code class="inline">qlc:info/1,2</code> accepts a new option, <code class="inline">depth</code>. The type <code class="inline">SelectedObjects</code> used
in the description of <a href="qlc.html#table/2"><code class="inline">qlc:table/2</code></a> has been augmented.</p><p>Own Id: OTP-7238</p></li><li><p><a href="../../apps/erts/erlang.html#tuple_size/1"><code class="inline">tuple_size/1</code></a> and <a href="../../apps/erts/erlang.html#byte_size/1"><code class="inline">byte_size/1</code></a> have been
substituted for <a href="../../apps/erts/erlang.html#size/1"><code class="inline">size/1</code></a> in the documentation.</p><p>Own Id: OTP-7244</p></li></ul><h2 id="stdlib-1-15-1" class="section-heading"><a href="#stdlib-1-15-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 1.15.1</span></h2><h3 id="fixed-bugs-and-malfunctions-129" class="section-heading"><a href="#fixed-bugs-and-malfunctions-129" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Ets:select/3 in combination with ets:repair_continuation/2 and ordered_set
data tables could result in function_clause although used as intended. This is
now corrected. Thanks to Paul Mineiro for finding and isolating the bug!</p><p>Own Id: OTP-7025</p></li><li><p>The compiler warning for the deprecated function <a href="../../apps/ftp/ftp.html#close/1"><code class="inline">ftp:close/1</code></a> now mentions
the correct replacement function.</p><p>The warning for the removed functions in the <code class="inline">httpd_util</code> module have been
changed to say they have been removed, not merely deprecated. (Thanks to
Fredrik Thulin.)</p><p>Own Id: OTP-7034 Aux Id: seq10825</p></li><li><p>In <code class="inline">(Expr)#r{}</code> (no fields are updated), <code class="inline">Expr</code> is no longer evaluated more
than once. There is also a test that <code class="inline">Expr</code> is of the correct record type.
(Thanks to Dominic Williams.)</p><p>Own Id: OTP-7078 Aux Id: OTP-4962</p></li><li><p>Documentation bugfixes and clarifications.</p><p>(Thanks to Joern (opendev@gmail.com), Matthias Lang, and Richard Carlsson.)</p><p>Own Id: OTP-7079</p></li><li><p>Duplicated objects were sometimes not deleted from the list of answers when a
QLC table was traversed using a match specification. (Thanks to Dmitri
Girenko.)</p><p>Own Id: OTP-7114</p></li></ul><h3 id="improvements-and-new-features-70" class="section-heading"><a href="#improvements-and-new-features-70" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>The documentation has been updated so as to reflect the last updates of the
Erlang shell as well as the minor modifications of the control sequence <code class="inline">p</code> of
the <code class="inline">io_lib</code> module.</p><p>Superfluous empty lines have been removed from code examples and from Erlang
shell examples.</p><p>Own Id: OTP-6944 Aux Id: OTP-6554, OTP-6911</p></li><li><p><a href="../../apps/erts/erlang.html#tuple_size/1"><code class="inline">tuple_size/1</code></a> and <a href="../../apps/erts/erlang.html#byte_size/1"><code class="inline">byte_size/1</code></a> have been
substituted for <a href="../../apps/erts/erlang.html#size/1"><code class="inline">size/1</code></a>.</p><p>Own Id: OTP-7009</p></li><li><p>It is now possible to hibernate a gen_server/gen_event/gen_fsm. In gen_server
and gen_fsm, hibernation is triggered by returning the atom
'hibernate' instead of a timeout value. In the gen_event case hibernation is
triggered by a event handler returning a tuple with an extra element
containing the atom 'hibernate'.</p><p>Own Id: OTP-7026 Aux Id: seq10817</p></li><li><p>Some undocumented debug functionality has been added to Dets.</p><p>Own Id: OTP-7066</p></li><li><p>The functions <a href="digraph_utils.html#is_tree/1"><code class="inline">digraph_utils:is_tree/1</code></a>, <a href="digraph_utils.html#is_arborescence/1"><code class="inline">digraph_utils:is_arborescence/1</code></a>,
and <a href="digraph_utils.html#arborescence_root/1"><code class="inline">digraph_utils:arborescence_root/1</code></a> are new.</p><p>Own Id: OTP-7081</p></li><li><p>The compiler could generate suboptimal code for record updates if the record
update code consisted of multiple source code lines.</p><p>Own Id: OTP-7101</p></li></ul><h2 id="stdlib-1-15" class="section-heading"><a href="#stdlib-1-15" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 1.15</span></h2><h3 id="fixed-bugs-and-malfunctions-130" class="section-heading"><a href="#fixed-bugs-and-malfunctions-130" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Bugs have been fixed in <code class="inline">qlc</code>:</p><ul><li>Setting the <code class="inline">lookup_fun</code> option of <a href="qlc.html#table/2"><code class="inline">qlc:table/2</code></a> to <code class="inline">undefined</code> could cause
a crash.</li><li>If a QLC restricted some column of a table in such a way that a traversal
using a match specification was possible and the QLC also compared the key
column or some indexed column of the the table with a column of some other
table, <code class="inline">qlc</code> always chose to traverse the table first, never considering
lookup join. This has been changed so that lookup join is always preferred;
if an initial traversal using the match specification is desired, the query
needs to be rewritten introducing an extra QLC with the filter(s)
restricting the column.</li><li>When trying to find candidates for match specifications and lookup, filters
using variables from one generator only are ignored unless they are placed
immediately after the generator and possibly other filters using variables
from the same generator. In particular, filters joining two tables should
not be placed between the generator and the filters using the generator
only.</li><li>The call-back function <code class="inline">TraverseFun</code> used for implementing QLC tables is
allowed to return a term other than a list since STDLIB 1.14 (OTP-5195).
However, when the returned term was a fun <code class="inline">qlc</code> often tried to call the fun
instead of returning it.</li></ul><p>A few minor optimizations have been implemented as well.</p><p>Own Id: OTP-6673</p></li><li><p>A bug concerning the use of parameterized modules from the shell has been
fixed.</p><p>Own Id: OTP-6785</p></li><li><p>A bug regarding the size expression of the bit syntax has been fixed in the
<code class="inline">erl_eval</code> module.</p><p>Own Id: OTP-6787</p></li><li><p>The log_mf_h event handler didn't close the index file when it was done
reading it causing a file descriptor leak.</p><p>Own Id: OTP-6800</p></li><li><p>Definitions for the <code class="inline">filename()</code> and <code class="inline">dirname()</code> types have been added to the
documentation for the <code class="inline">filelib</code> module.</p><p>Own Id: OTP-6870</p></li><li><p>file:write_file/3, file:write/2 and file:read/2 could crash (contrary to
documentation) for odd enough file system problems, e.g write to full file
system. This bug has now been corrected.</p><p>In this process the file module has been rewritten to produce better error
codes. Posix error codes now originate from the OS file system calls or are
generated only for very similar causes (for example 'enomem' is generated if a
memory allocation fails, and 'einval' is generated if the file handle in
Erlang is a file handle but currently invalid).</p><p>More Erlang-ish error codes are now generated. For example <code class="inline">{error,badarg}</code> is
now returned from <a href="../../apps/kernel/file.html#close/1"><code class="inline">file:close/1</code></a> if the argument is not of a file handle type.
See file(3).</p><p>The possibility to write a single byte using <a href="../../apps/kernel/file.html#write/2"><code class="inline">file:write/2</code></a> instead of a list
or binary of one byte, contradictory to the documentation, has been removed.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-6967 Aux Id: OTP-6597 OTP-6291</p></li><li><p>A bug concerning the evaluation of the <code class="inline">++/2</code> operator has been fixed in
<code class="inline">erl_eval</code>. (Thanks to Matthew Dempsky.)</p><p>Own Id: OTP-6977</p></li></ul><h3 id="improvements-and-new-features-71" class="section-heading"><a href="#improvements-and-new-features-71" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>The behaviour of the internal functions gen:call/3,4 has been changed slightly
in the rare case that when the caller was linked to the called server, and the
server crashed during the call; its exit signal was consumed by the
gen:call/3,4 code and converted to an exit exception. This exit signal is no
longer consumed.</p><p>To even notice this change, 1) the calling process has to be linked to the
called server.</p><ol start="2"><li><p>the call must not be remote by name that is it must be local or remote by
pid, local by name or global by name.</p></li><li><p>the calling process has to have set
<a href="../../apps/erts/erlang.html#process_flag/2"><code class="inline">process_flag(trap_exit, true)</code></a>.</p></li><li><p>the server has to crash during the call.</p></li><li><p>the calling process has to be sensitive to getting previously consumed
<code class="inline">{'EXIT',Pid,Reason}</code> messages in its message queue.</p></li></ol><p>The old behaviour was once the only way for a client to notice if the server
died, but has since <code class="inline">erlang:monitor(process, {Name,Node})</code> was introduced and
used in gen:call been regarded as an undesired behaviour if not a bug.</p><p>The affected user APIs are: <code class="inline">gen_server:call/2,3</code>,
<code class="inline">gen_fsm:sync_send_event/2,3</code>, <code class="inline">gen_fsm:sync_send_all_state_event/2,3</code>,
<code class="inline">gen_event:_</code>, <code class="inline">sys:_</code> and maybe a few others that hardly will be noticed.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-3954 Aux Id: Seq 4538</p></li><li><p>When an exception occurs the Erlang shell now displays the class, the reason,
and the stacktrace in a clearer way (rather than dumping the raw EXIT tuples
as before). <a href="proc_lib.html#format/1"><code class="inline">proc_lib:format/1</code></a> displays the exception of crash reports in the
same clearer way.</p><p>The new shell command <code class="inline">catch_exception</code> and the new application configuration
parameter <code class="inline">shell_catch_exception</code> can be used for catching exceptions that
would normally exit the Erlang shell.</p><p>Own Id: OTP-6554 Aux Id: OTP-6289</p></li><li><p>The function <a href="string.html#join/2"><code class="inline">string:join/2</code></a> joins strings in a list with a separator.
Example: '<code class="inline">string:join([&quot;a&quot;, &quot;b&quot;, &quot;c&quot;], &quot;, &quot;) gives &quot;a, b, c&quot;</code>'</p><p>Own Id: OTP-6671</p></li><li><p>The control sequence <code class="inline">P</code> of the <code class="inline">Format</code> argument of the functions
<code class="inline">io:fwrite/2,3</code> and <a href="io_lib.html#fwrite/2"><code class="inline">io_lib:fwrite/2</code></a> now inserts fewer line breaks when
printing tuples and lists. A soft upper limit of 60 on the number of non-white
characters on a line has been introduced.</p><p>Own Id: OTP-6708</p></li><li><p>The new module <code class="inline">array</code> provides a fast functional array implementation.</p><p>Own Id: OTP-6733</p></li><li><p>Functions that have long been deprecated have now been removed from the
following modules: <code class="inline">dict</code>, <code class="inline">erl_eval</code>, <code class="inline">erl_pp</code>, <code class="inline">io</code>, <code class="inline">io_lib</code>, <code class="inline">lists</code>,
<code class="inline">orddict</code>, <code class="inline">ordsets</code>, <code class="inline">sets</code>, and <code class="inline">string</code>.</p><p>The undocumented function <code class="inline">lists:zf/3</code> has also been removed (use a list
comprehension or <code class="inline">lists:zf/2</code> instead).</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-6845</p></li><li><p>Minor documentation corrections for file:pread/2 and file:pread/3.</p><p>Own Id: OTP-6853</p></li><li><p>Contract directives for modules in Kernel and STDLIB.</p><p>Own Id: OTP-6895</p></li><li><p>The <code class="inline">ets:fixtable/2</code> function, which has been deprecated for several releases,
has been removed.</p><p>The <a href="ets.html#info/1"><code class="inline">ets:info/1</code></a> function has been reimplemented as a BIF, which guarantees
that information returned is consistent.</p><p>The <a href="ets.html#info/2"><code class="inline">ets:info/2</code></a> function now fails with reason <code class="inline">badarg</code> if the second
argument is invalid. (Dialyzer can be used to find buggy code where the second
argument is misspelled.)</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-6906</p></li><li><p>The Erlang pretty printer <code class="inline">erl_pp</code> now inserts more newlines in order to
facilitate line coverage analysis by <code class="inline">Cover</code>. (Thanks to Thomas Arts.)</p><p>Own Id: OTP-6911</p></li><li><p>The documentation for ets:safe_fixtable/2, ets:foldl/3, and ets:foldr/3 is now
clearer about what will happen if objects are inserted during table
traversals.</p><p>Own Id: OTP-6928 Aux Id: seq10779</p></li><li><p>It is now possible to extract files in tar files directly into binaries. It is
also possible to add files to tar files directly from binaries.</p><p>Own Id: OTP-6943</p></li><li><p>The functions <code class="inline">keystore/4</code> and <code class="inline">keytake/3</code> are new in the <code class="inline">lists</code> module.</p><p>Own Id: OTP-6953</p></li><li><p>The new <code class="inline">qlc</code> option <code class="inline">tmpdir_usage</code> can be used for outputting messages onto
the error logger when a temporary file is about to be created, or to prohibit
the usage of temporary files altogether.</p><p>Own Id: OTP-6964</p></li></ul><h2 id="stdlib-1-14-5-3" class="section-heading"><a href="#stdlib-1-14-5-3" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 1.14.5.3</span></h2><h3 id="improvements-and-new-features-72" class="section-heading"><a href="#improvements-and-new-features-72" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>The allowed syntax for -type() and -spec() was updated.</p><p>Own Id: OTP-6861 Aux Id: OTP-6834</p></li></ul><h2 id="stdlib-1-14-5-2" class="section-heading"><a href="#stdlib-1-14-5-2" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 1.14.5.2</span></h2><h3 id="improvements-and-new-features-73" class="section-heading"><a href="#improvements-and-new-features-73" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>The compiler will for forward compatibility ignore the -type() and -spec()
attributes that will be introduced in the R12B release.</p><p>Own Id: OTP-6834</p></li></ul><h2 id="stdlib-1-14-5-1" class="section-heading"><a href="#stdlib-1-14-5-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 1.14.5.1</span></h2><h3 id="fixed-bugs-and-malfunctions-131" class="section-heading"><a href="#fixed-bugs-and-malfunctions-131" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>The log_mf_h event handler didn't close the index file when it was done
reading it causing a file descriptor leak.</p><p>Own Id: OTP-6800</p></li></ul><h3 id="improvements-and-new-features-74" class="section-heading"><a href="#improvements-and-new-features-74" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>The dict:size/1 and orddict:size/1 functions have been documented.</p><p>Own Id: OTP-6818</p></li></ul><h2 id="stdlib-1-14-5" class="section-heading"><a href="#stdlib-1-14-5" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 1.14.5</span></h2><h3 id="fixed-bugs-and-malfunctions-132" class="section-heading"><a href="#fixed-bugs-and-malfunctions-132" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Bugs have been fixed in Dets concerning comparison (==) and matching (=:=).</p><p>The STDLIB manual pages have been updated as to more carefully state when
terms are matched and when they are compared.</p><p>Own Id: OTP-4738 Aux Id: OTP-4685</p></li><li><p>The shell has been updated to fix the following flaws: Shell process exit left
you with an unresponsive initial shell if not using oldshell. Starting a
restricted shell with a nonexisting callback module resulted in a shell where
no commands could be used, not even init:stop/0. Fun's could not be used as
parameters to local shell functions (in shell_default or user_default) when
restricted_shell was active.</p><p>Own Id: OTP-6537</p></li><li><p>A bug in QLC's parse transform has been fixed.</p><p>Own Id: OTP-6590</p></li><li><p>A bug concerning <a href="lists.html#sort/1"><code class="inline">lists:sort/1</code></a> and <a href="lists.html#keysort/2"><code class="inline">lists:keysort/2</code></a> and a mix of floating
point numbers and integers has been fixed.</p><p>Own Id: OTP-6606</p></li><li><p>When calling <a href="../../apps/erts/erlang.html#garbage_collect/0"><code class="inline">erlang:garbage_collect/0</code></a> in the Erlang shell not only the
evaluator process (the one returned by calling <a href="../../apps/erts/erlang.html#self/0"><code class="inline">self/0</code></a> in the Erlang shell)
is garbage collected, but also the process holding the history list.</p><p>Own Id: OTP-6659</p></li><li><p>Functions of the <code class="inline">beam_lib</code> module that used to catch exceptions and return a
tuple <code class="inline">{'EXIT',Reason}</code> now exit with the reason <code class="inline">Reason</code>.</p><p>Own Id: OTP-6711</p></li><li><p>The <code class="inline">erl_eval</code> module now calls the non-local function handler whenever an
operator is evaluated (exceptions are <code class="inline">andalso</code>, <code class="inline">orelse</code>, and <code class="inline">catch</code>). The
non-local function handler is now also called when the function or operator
occurs in a guard test (such calls used to be ignored).</p><p>These changes affect the Erlang shell when running in restricted mode: the
callback function <code class="inline">non_local_allowed/3</code> is now called for operators such as
<code class="inline">'!'/2</code>. This means that <code class="inline">non_local_allowed/3</code> may need to
be changed as to let operators through. Note that <code class="inline">erlang:'!'/2</code> as well as
<code class="inline">erlang:send/2,3</code> have to be restricted in order to stop message passing in
the shell.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-6714 Aux Id: seq10374</p></li></ul><h3 id="improvements-and-new-features-75" class="section-heading"><a href="#improvements-and-new-features-75" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>The new compiler option <code class="inline">warn_obsolete_guard</code> can be used for turning on
warnings for calls to old type testing BIFs.</p><p>Own Id: OTP-6585</p></li><li><p>For scripts written using <code class="inline">escript</code>, there is a new function
<a href="escript.html#script_name/0"><code class="inline">escript:script_name/0</code></a>, which can be used to retrieve the pathame of the
script. The documentation has been clarified regarding pre-defined macros such
as ?MODULE and the module name.</p><p>Own Id: OTP-6593</p></li><li><p>Minor Makefile changes.</p><p>Own Id: OTP-6689 Aux Id: OTP-6742</p></li></ul><h2 id="stdlib-1-14-4" class="section-heading"><a href="#stdlib-1-14-4" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 1.14.4</span></h2><h3 id="fixed-bugs-and-malfunctions-133" class="section-heading"><a href="#fixed-bugs-and-malfunctions-133" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>The MD5 calculation of a BEAM file done by <code class="inline">code:module_md5/1</code>,
<a href="beam_lib.html#md5/1"><code class="inline">beam_lib:md5/1</code></a>, and by the compiler for the default value of the <code class="inline">vsn</code>
attribute have all been changed so that its result will be the same on all
platforms; modules containing funs could get different MD5s on different
platforms.</p><p>Own Id: OTP-6459</p></li><li><p>When sorting terms using the <code class="inline">file_sorter</code> module (the option <code class="inline">Format</code> set to
<code class="inline">term</code>), file errors were not always properly handled. This bug has been
fixed.</p><p>The directory supplied with the <code class="inline">tmpdir</code> option is no longer checked unless it
is actually used. The error reason <code class="inline">not_a_directory</code> can no longer be
returned; instead a <code class="inline">file_error</code> tuple is returned</p><p>Own Id: OTP-6526</p></li><li><p>Bugs regarding <code class="inline">try</code>/<code class="inline">catch</code> have been fixed in the <code class="inline">erl_eval</code> module.</p><p>Own Id: OTP-6539</p></li><li><p>When sorting the operands of a join operation, QLC called <code class="inline">file:open/3</code> with
bad arguments. This bug has been fixed.</p><p>Own Id: OTP-6562 Aux Id: seq10606</p></li></ul><h3 id="improvements-and-new-features-76" class="section-heading"><a href="#improvements-and-new-features-76" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>The functions <code class="inline">beam_lib:cmp/1</code> and <a href="beam_lib.html#strip/1"><code class="inline">beam_lib:strip/1</code></a> (and similar functions)
have been updated to handle optional chunks (such as &quot;FunT&quot;) in more general
way in order to be future compatible.</p><p>The function <a href="beam_lib.html#chunks/3"><code class="inline">beam_lib:chunks/3</code></a> has been added.</p><p>The function <a href="beam_lib.html#md5/1"><code class="inline">beam_lib:md5/1</code></a> has been added.</p><p>Own Id: OTP-6443</p></li><li><p>Added base64 as a module to stdlib, encoding and decoding</p><p>Own Id: OTP-6470</p></li><li><p>Added the functions to_upper/1 and to_lower/1 to the string module. These
provide case conversion for ISO/IEC 8859-1 characters (Latin1) and strings.</p><p>Own Id: OTP-6472</p></li><li><p>The callback function <code class="inline">non_local_allowed/3</code> used by the restricted shell can
now return the value <code class="inline">{{restricted,NewFuncSpec,NewArgList},NewState}</code> which
can be used for letting the shell call some other function than the one
specified.</p><p>Own Id: OTP-6497 Aux Id: seq10555</p></li><li><p>There is a new <code class="inline">escript</code> program that can be used for writing scripts in
Erlang. Erlang scripts don't need to be compiled and any arguments can be
passed to them without risk that they are interpreted by the Erlang system.</p><p>Own Id: OTP-6505</p></li><li><p>The <code class="inline">Format</code> argument of the functions <code class="inline">io:fwrite/2,3</code> and <a href="io_lib.html#fwrite/2"><code class="inline">io_lib:fwrite/2</code></a>
is now allowed to be a binary.</p><p>Own Id: OTP-6517</p></li></ul><h2 id="stdlib-1-14-3-1" class="section-heading"><a href="#stdlib-1-14-3-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 1.14.3.1</span></h2><h3 id="fixed-bugs-and-malfunctions-134" class="section-heading"><a href="#fixed-bugs-and-malfunctions-134" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>The control sequences <code class="inline">p</code> and <code class="inline">P</code> of the <code class="inline">Format</code> argument of the functions
<code class="inline">io:fwrite/2,3</code> and <a href="io_lib.html#fwrite/2"><code class="inline">io_lib:fwrite/2</code></a> could cause a <code class="inline">badarg</code> failure when
applied to binaries. This bug was introduced in STDLIB 1.14.3. (Thanks to
Denis Bilenko.)</p><p>Own Id: OTP-6495</p></li></ul><h3 id="improvements-and-new-features-77" class="section-heading"><a href="#improvements-and-new-features-77" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>Added the option {cwd, Dir} to make zip-archives with relative pathnames
without having to do (a global) file:set_cwd.</p><p>Own Id: OTP-6491 Aux Id: seq10551</p></li></ul><h2 id="stdlib-1-14-3" class="section-heading"><a href="#stdlib-1-14-3" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 1.14.3</span></h2><h3 id="fixed-bugs-and-malfunctions-135" class="section-heading"><a href="#fixed-bugs-and-malfunctions-135" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>The <code class="inline">spawn_opt/2,3,4,5</code> option <code class="inline">monitor</code> -- introduced in Kernel 2.11.2 -- is
currently not possible to use when starting a process using <code class="inline">proc_lib</code>, that
is, also when starting a gen_server, gen_fsm etc.</p><p>This limitation has now been properly documented and the behavior of the
<code class="inline">gen_fsm</code>, <code class="inline">gen_server</code>, and <code class="inline">proc_lib</code> <code class="inline">start</code> and <code class="inline">start_link</code> functions
when providing this option has been changed from hanging indefinitely to
failing with reason <code class="inline">badarg</code>.</p><p>(Thanks to Fredrik Linder)</p><p>Own Id: OTP-6345</p></li></ul><h3 id="improvements-and-new-features-78" class="section-heading"><a href="#improvements-and-new-features-78" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>The control sequence <code class="inline">P</code> of the <code class="inline">Format</code> argument of the functions
<code class="inline">io:fwrite/2,3</code> and <a href="io_lib.html#fwrite/2"><code class="inline">io_lib:fwrite/2</code></a> now replaces the tail of binary strings
with <code class="inline">...</code> when the maximum depth has been reached. For instance,
<code class="inline">io:fwrite(&quot;~P&quot;, [&lt;&lt;&quot;a binary string&quot;&gt;&gt;, 3]).</code> prints <code class="inline">&lt;&lt;&quot;a binary&quot;...&gt;&gt;</code>.</p><p>The indentation takes more care not to exceed the right margin, if possible.</p><p>If the maximum depth is reached while printing a tuple, <code class="inline">,...</code> is printed
instead of <code class="inline">|...</code> (this change applies to the control sequence <code class="inline">W</code> as well).</p><p>Own Id: OTP-6354</p></li><li><p>The Erlang shell command <code class="inline">h/0</code> that prints the history list now avoids
printing (huge) terms referred to by <code class="inline">v/1</code> but instead just prints the call to
<code class="inline">v/1</code>.</p><p>Own Id: OTP-6390</p></li></ul><h2 id="stdlib-1-14-2-2" class="section-heading"><a href="#stdlib-1-14-2-2" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 1.14.2.2</span></h2><h3 id="fixed-bugs-and-malfunctions-136" class="section-heading"><a href="#fixed-bugs-and-malfunctions-136" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>The functions <code class="inline">dets:select/1,3</code>, <code class="inline">dets:match/1,3</code>, and <code class="inline">dets:match_object/1,3</code>
have been changed as to never return <code class="inline">{[],Continuation}</code>. This change affects
the corresponding functions in Mnesia.</p><p>Bugs have been fixed in QLC: <code class="inline">qlc:info()</code> could crash if the <code class="inline">tmpdir</code> option
did not designate a valid directory; the results of looking up keys are kept
in RAM, which should improve performance.</p><p>Own Id: OTP-6359</p></li></ul><h2 id="stdlib-1-14-2-1" class="section-heading"><a href="#stdlib-1-14-2-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 1.14.2.1</span></h2><h3 id="fixed-bugs-and-malfunctions-137" class="section-heading"><a href="#fixed-bugs-and-malfunctions-137" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>A bug in <code class="inline">erl_pp:exprs()</code> has been fixed.</p><p>Own Id: OTP-6321 Aux Id: seq10497</p></li></ul><h2 id="stdlib-1-14-2" class="section-heading"><a href="#stdlib-1-14-2" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 1.14.2</span></h2><h3 id="fixed-bugs-and-malfunctions-138" class="section-heading"><a href="#fixed-bugs-and-malfunctions-138" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>The control sequences <code class="inline">p</code> and <code class="inline">P</code> of the <code class="inline">Format</code> argument of the functions
<code class="inline">io:format/2,3</code> and <a href="io_lib.html#format/2"><code class="inline">io_lib:format/2</code></a> did not handle binaries very well. This
bug, introduced in stdlib-1.14, has been fixed.</p><p>Own Id: OTP-6230</p></li><li><p><code class="inline">filelib:wildcard(Wc, PathWithRedundantSlashes)</code>, where
<code class="inline">PathWithRedundantSlashes</code> is a directory path containing redundant slashes,
such as <code class="inline">/tmp/</code> or <code class="inline">//tmp</code>, could return incorrect results. (Thanks to Martin
Bjorklund.)</p><p>Own Id: OTP-6271</p></li><li><p>The Erlang code preprocessor crashed if the predefined macros ?MODULE or
?MODULE_STRING were used before the module declaration. This bug has been
fixed.</p><p>Own Id: OTP-6277</p></li></ul><h3 id="improvements-and-new-features-79" class="section-heading"><a href="#improvements-and-new-features-79" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>Support for faster join of two tables has been added to the <code class="inline">qlc</code> module.
There are two kinds of fast joins: lookup join that uses existing indices, and
merge join that takes two sorted inputs. There is a new <code class="inline">join</code> option that can
be used to force QLC to use a particular kind of join in some QLC expression.</p><p>Several other changes have also been included:</p><ul><li><p>The new <code class="inline">tmpdir</code> option of <code class="inline">cursor/2</code>, <code class="inline">eval/2</code>, <code class="inline">fold/4</code>, and <code class="inline">info/2</code> can
be used to set the directory that join uses for temporary files. The option
also overrides the <code class="inline">tmpdir</code> option of <code class="inline">keysort/3</code> and <code class="inline">sort/2</code>.</p></li><li><p>The new <code class="inline">lookup</code> option can be used to assert that constants are looked up
when evaluating some QLC expression.</p></li><li><p>The <code class="inline">cache</code> and <code class="inline">cache_all</code> options accept new tags: <code class="inline">ets</code>, <code class="inline">list</code>, and
<code class="inline">no</code>. The tag <code class="inline">list</code> caches answers in a list using a temporary file if the
answers cannot be held in RAM. Combining <code class="inline">{cache,list}</code> and <code class="inline">{unique, true}</code>
is equivalent to calling <code class="inline">sort/2</code> with the option <code class="inline">unique</code> set to <code class="inline">true</code>.
The old tags <code class="inline">true</code> (equivalent to <code class="inline">ets</code>) and <code class="inline">false</code> (equivalent to <code class="inline">no</code>)
are recognized for backward compatibility.</p></li><li><p>The new option <code class="inline">max_list_size</code> can be used to set the limit where merge join
starts to use temporary files for large equivalence classes and when answers
cached in lists are put on temporary files.</p></li><li><p>There is a new callback <code class="inline">is_sorted_key</code> to be supplied as an option to
<code class="inline">table/2</code>.</p></li><li><p>QLC analyzes each and every QLC expression when trying to find constants for
the lookup function. Hitherto only QLC expressions with exactly one
generator were analyzed.</p><p>Note that only filters with guard syntax placed immediately after the
generator are analyzed. The restriction to guard filters is an incompatible
change. See <a href="qlc.html"><code class="inline">qlc</code></a> for further details.</p></li><li><p>In a similar way several match specifications for traversal of QLC tables
can be utilized for different generators of one single QLC expression.</p></li><li><p>A bug has been fixed: when caching answers to a sufficiently complex query
it could happen that some answers were not returned.</p></li></ul><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-6038</p></li><li><p>The Erlang pretty printer (<code class="inline">erl_pp</code>) is now much faster when the code is
deeply nested. A few minor bugs have been fixed as well.</p><p>Own Id: OTP-6227 Aux Id: OTP-5924</p></li><li><p>The Erlang shell now tries to garbage collect large binaries. Under certain
circumstances such binaries could otherwise linger on for an indefinite amount
of time.</p><p>Own Id: OTP-6239</p></li><li><p>To help Dialyzer find more bugs, many functions in the Kernel and STDLIB
applications now only accept arguments of the type that is documented.</p><p>For instance, the functions <a href="lists.html#prefix/2"><code class="inline">lists:prefix/2</code></a> and <a href="lists.html#suffix/2"><code class="inline">lists:suffix/2</code></a> are
documented to only accept lists as their arguments, but they actually accepted
anything and returned <code class="inline">false</code>. That has been changed so that the functions
cause an exception if one or both arguments are not lists.</p><p>Also, the <a href="string.html#strip/3"><code class="inline">string:strip/3</code></a> function is documented to take a character argument
that is a character to strip from one or both ends of the string. Given a list
instead of a character, it used to do nothing, but will now cause an
exception.</p><p>Dialyzer will find most cases where those functions are passed arguments of
the wrong type.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-6295</p></li></ul><h2 id="stdlib-1-14-1" class="section-heading"><a href="#stdlib-1-14-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 1.14.1</span></h2><h3 id="fixed-bugs-and-malfunctions-139" class="section-heading"><a href="#fixed-bugs-and-malfunctions-139" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>The functions <code class="inline">c:y/1,2</code> which call <code class="inline">yecc:file/1,2</code> are now listed by
<code class="inline">c:help/0</code>.</p><p>Documentation of <code class="inline">c:y/1,2</code> has been added to <a href="c.html"><code class="inline">c</code></a>.</p><p>The fact that the control sequence character <code class="inline">s</code> recognizes binaries and deep
character lists has been documented in <a href="io.html"><code class="inline">io</code></a>. This feature was added in
R11B-0 (OTP-5403).</p><p>Own Id: OTP-6140</p></li><li><p>The shell command rr() sometimes failed to read record definitions from
file(s). This problem has been fixed.</p><p>Own Id: OTP-6166 Aux Id: OTP-5878</p></li><li><p>The nonlocal function handler in <code class="inline">erl_eval</code>, which is used for implementing
the restricted mode of the Erlang shell, did not handle calls to
<a href="../../apps/erts/erlang.html#apply/3"><code class="inline">erlang:apply/3</code></a> correctly. This bug has been fixed.</p><p>Own Id: OTP-6169 Aux Id: seq10374</p></li><li><p>ets:rename/1 could deadlock, or crash the SMP emulator when the table wasn't a
named table.</p><p>ets:next/2, and ets:prev/2 could return erroneous results on the SMP emulator.</p><p>Own Id: OTP-6198 Aux Id: seq10392, seq10415</p></li><li><p>When closing a Dets table the space management data was sometimes saved in
such a way that opening the table could not be done without repairing the
file. This bug has been fixed.</p><p>Own Id: OTP-6206</p></li></ul><h2 id="stdlib-1-14" class="section-heading"><a href="#stdlib-1-14" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 1.14</span></h2><h3 id="fixed-bugs-and-malfunctions-140" class="section-heading"><a href="#fixed-bugs-and-malfunctions-140" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>A bugfix in QLC: two of the call-back functions used for implementing QLC
tables, <code class="inline">TraverseFun</code> and <code class="inline">LookupFun</code>, are now allowed to return a term other
than a list. Such a term is immediately returned as the results of the current
query, and is useful mostly for returning error tuples.</p><p>Several other minor bugs have been also been fixed.</p><p>Own Id: OTP-5195</p></li><li><p>The STDLIB modules <code class="inline">error_logger_file_h</code> and <code class="inline">error_logger_tty_h</code> now read the
environment variable <code class="inline">utc_log</code> from the SASL application.</p><p>Own Id: OTP-5535</p></li><li><p><a href="ets.html#info/1"><code class="inline">ets:info/1</code></a> has been corrected to behave according to the documentation and
return a list of tuples, not a tuple with tuples.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-5639</p></li><li><p>Referencing a so far undeclared record from the default value of some record
declaration is from now on considered an error by the linter. It is also an
error if the default value of a record declaration uses or binds a variable.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-5878</p></li><li><p>When a file <code class="inline">.hrl</code> file is included using <code class="inline">-include_lib</code>, the include path is
temporarily updated to include the directory the <code class="inline">.hrl</code> file was found in,
which will allow that <code class="inline">.hrl</code> file to itself include files from the same
directory as itself using <code class="inline">-include</code>. (Thanks to Richard Carlsson.)</p><p>Own Id: OTP-5944</p></li><li><p>Corrected <a href="filelib.html#ensure_dir/1"><code class="inline">filelib:ensure_dir/1</code></a> which sometimes returned <code class="inline">true</code> and sometimes
<code class="inline">ok</code> to always return <code class="inline">ok</code> when successful. This goes against the
documentation which said <code class="inline">true</code>, but <code class="inline">ok</code> was judged to be a more logical
return value.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-5960 Aux Id: seq10240</p></li><li><p>The shell now handles records better when used in calls on the form
<code class="inline">{Module, Function}(ArgList)</code>.</p><p>Own Id: OTP-5990 Aux Id: OTP-5876</p></li><li><p>The functions <a href="lists.html#ukeysort/2"><code class="inline">lists:ukeysort/2</code></a> and <a href="lists.html#ukeymerge/3"><code class="inline">lists:ukeymerge/3</code></a> have been changed in
such a way that two tuples are considered equal if their keys match.</p><p>For the sake of consistency, <a href="lists.html#usort/2"><code class="inline">lists:usort/2</code></a> and <a href="lists.html#umerge/3"><code class="inline">lists:umerge/3</code></a> have been
modified too: two elements are considered equal if they compare equal.</p><p>The <code class="inline">file_sorter</code> module has been modified in a similar way: the <code class="inline">unique</code>
option now applies to the key (<code class="inline">keysort()</code> and <code class="inline">keymerge()</code>) and the ordering
function (the option <code class="inline">{order, Order}</code>).</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-6019</p></li><li><p>Correction in documentation for <a href="ets.html#update_counter/3"><code class="inline">ets:update_counter/3</code></a>; failure with <code class="inline">badarg</code>
also if the counter to be updated is the key.</p><p>Own Id: OTP-6072</p></li><li><p>When sorting terms using the <code class="inline">file_sorter</code> module and an ordering fun, the
sort was not always stable. This bug has been fixed.</p><p>Own Id: OTP-6088</p></li></ul><h3 id="improvements-and-new-features-80" class="section-heading"><a href="#improvements-and-new-features-80" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>Improvements of the linter:</p><ul><li>The <code class="inline">compile</code> attribute is recognized after function definitions.</li><li>The new compiler option <code class="inline">nowarn_deprecated_function</code> can be used for turning
off warnings for calls to deprecated functions.</li><li>The new compiler option <code class="inline">{nowarn_unused_function,[{Name,Arity}]}</code> turns off
warnings for unused local functions for the mentioned functions. The new
options <code class="inline">{nowarn_deprecated_function,[{Module,Name,Arity}]}</code> and
<code class="inline">{nowarn_bif_clash,[{Name,Arity}]}</code> work similarly.</li></ul><p>The Erlang code preprocessor <code class="inline">epp</code> now recognizes the <code class="inline">file</code> attribute. This
attribute is meant to be used by tools such as Yecc that generate source code
files.</p><p>Own Id: OTP-5362</p></li><li><p>The formatting option <code class="inline">~s</code> of <code class="inline">io:fwrite</code> and <code class="inline">io_lib:fwrite</code> has been
extended to handle arguments that are binaries or I/O lists.</p><p>Own Id: OTP-5403</p></li><li><p>The control sequences <code class="inline">p</code> and <code class="inline">P</code> of the <code class="inline">Format</code> argument of the functions
<code class="inline">io:format/2,3</code> and <a href="io_lib.html#format/2"><code class="inline">io_lib:format/2</code></a> have been changed as to display the
contents of binaries containing printable characters as strings.</p><p>Own Id: OTP-5485</p></li><li><p>The linter emits warnings for functions exported more than once in <code class="inline">export</code>
attributes.</p><p>Own Id: OTP-5494</p></li><li><p>A manual for STDLIB has been added, <code class="inline">stdlib(6)</code>. It mentions the configuration
parameters for the Erlang shell.</p><p>Own Id: OTP-5530</p></li><li><p>Added the <code class="inline">zip</code> module with functions for reading and creating zip archives.
See <a href="zip.html"><code class="inline">zip</code></a>.</p><p>Own Id: OTP-5786</p></li><li><p>Simple-one-for-one supervisors now store the pids of child processes using
<code class="inline">dict</code> instead of a list. This significantly improves performance when there
are many dynamic supervised child processes. (Thanks to Mickaël Rémond et al.)</p><p>Own Id: OTP-5898</p></li><li><p>When given the new option '<code class="inline">strict_record_tests</code>', the compiler will generate
code that verifies the record type for '<code class="inline">R#record.field</code>' operations in
guards. Code that verifies record types in bodies has already been generated
since R10B, but in this release there will be a '<code class="inline">{badrecord,RecordTag}</code>'
instead of a '<code class="inline">badmatch</code>' if the record verification test fails. See the
documentation for the <code class="inline">compile</code> module for more information.</p><p>The Erlang shell always applies strict record tests.</p><p>Own Id: OTP-5915 Aux Id: OTP-5714</p></li><li><p>The Erlang pretty printer (<code class="inline">erl_pp</code>) now tries to insert line breaks at
appropriate places.</p><p>Own Id: OTP-5924</p></li><li><p>The <code class="inline">public</code> option has been removed from <a href="digraph.html#new/1"><code class="inline">digraph:new/1</code></a>. The reason is that
several functions in the <code class="inline">digraph</code> module are implemented using multiple ETS
accesses, which is not thread safe. (Thanks to Ulf Wiger.)</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-5985</p></li><li><p>The function <a href="lists.html#keyreplace/4"><code class="inline">lists:keyreplace/4</code></a> checks that the fourth argument (<code class="inline">NewTuple</code>)
is a tuple.</p><p>Own Id: OTP-6023</p></li><li><p>Added an example of how to reconstruct source code from debug info (abstract
code) to <a href="beam_lib.html"><code class="inline">beam_lib</code></a>. (Thanks to Mats Cronqvist who wrote the example.)</p><p>Own Id: OTP-6073</p></li><li><p>The new compiler option <code class="inline">warn_unused_record</code> is used for finding unused
locally defined record types.</p><p>Own Id: OTP-6105</p></li></ul><h2 id="stdlib-1-13-12" class="section-heading"><a href="#stdlib-1-13-12" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 1.13.12</span></h2><h3 id="fixed-bugs-and-malfunctions-141" class="section-heading"><a href="#fixed-bugs-and-malfunctions-141" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p><code class="inline">shell_default:xm/1</code> has been added. It calls <a href="../../apps/tools/xref.html#m/1"><code class="inline">xref:m/1</code></a>.</p><p>Own Id: OTP-5405 Aux Id: OTP-4101</p></li><li><p>Warnings are output whenever so far undeclared records are referenced from
some default value of a record declaration. In STDLIB 1.14 (R11B) such forward
references will cause a compilation error.</p><p>Own Id: OTP-5878</p></li><li><p>The linter's check of the <code class="inline">deprecated</code> attribute did not take the compile
option <code class="inline">export_all</code> into account. This bug has been fixed.</p><p>Own Id: OTP-5917</p></li><li><p>The Erlang pretty printer did not handle <code class="inline">try/catch</code> correctly. This bug has
been fixed.</p><p>Own Id: OTP-5926</p></li><li><p>Corrected documentation for <code class="inline">lists:nthtail/3</code>.</p><p>Added documentation for <a href="lists.html#keymap/3"><code class="inline">lists:keymap/3</code></a>.</p><p>Tried to clarify some other type declarations and function descriptions in
<a href="lists.html"><code class="inline">lists</code></a>.</p><p>Corrected documentation for <a href="timer.html#now_diff/2"><code class="inline">timer:now_diff/2</code></a>.</p><p>Fixed broken links in <a href="gen_fsm.html"><code class="inline">gen_fsm</code></a>, <a href="gen_server.html"><code class="inline">gen_server</code></a>, <a href="io_lib.html"><code class="inline">io_lib</code></a> and <code class="inline">lib(3)</code>.</p><p>Own Id: OTP-5931</p></li><li><p>Type checks have been added to functions in <code class="inline">lists.erl</code>.</p><p>Own Id: OTP-5939</p></li></ul><h3 id="improvements-and-new-features-81" class="section-heading"><a href="#improvements-and-new-features-81" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>The new STDLIB module <code class="inline">erl_expand_records</code> expands records in abstract code.
It is used by the Erlang shell, which means that Compiler is no longer used by
the shell.</p><p>Own Id: OTP-5876 Aux Id: OTP-5435</p></li><li><p>The compiler will now warn that the <code class="inline">megaco:format_versions/1</code> function is
deprecated.</p><p>Own Id: OTP-5976</p></li></ul><h2 id="stdlib-1-13-11" class="section-heading"><a href="#stdlib-1-13-11" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 1.13.11</span></h2><h3 id="fixed-bugs-and-malfunctions-142" class="section-heading"><a href="#fixed-bugs-and-malfunctions-142" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>When calling <code class="inline">gen_server:enter_loop</code> with a registered server name, it was
only checked that the registered name existed, not that it actually was the
name of the calling process.</p><p>Own Id: OTP-5854</p></li></ul><h3 id="improvements-and-new-features-82" class="section-heading"><a href="#improvements-and-new-features-82" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>More detail on <a href="beam_lib.html#version/1"><code class="inline">beam_lib:version/1</code></a> in documentation.</p><p>Own Id: OTP-5789</p></li><li><p>The new function <a href="io.html#read/3"><code class="inline">io:read/3</code></a> works like <code class="inline">io:read/1,2</code> but takes a third
argument, <code class="inline">StartLine</code>.</p><p>Own Id: OTP-5813</p></li><li><p>The new function <code class="inline">gen_fsm:enter_loop/4,5,6</code>, similar to
<code class="inline">gen_server:enter_loop/3,4,5</code>, has been added.</p><p>Own Id: OTP-5846 Aux Id: seq10163</p></li><li><p>The function <code class="inline">c:i/1</code> is now exported.</p><p>Own Id: OTP-5848 Aux Id: seq10164</p></li></ul><h2 id="stdlib-1-13-10" class="section-heading"><a href="#stdlib-1-13-10" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 1.13.10</span></h2><h3 id="fixed-bugs-and-malfunctions-143" class="section-heading"><a href="#fixed-bugs-and-malfunctions-143" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>A couple of type errors have been fixed in <code class="inline">sofs</code>.</p><p>Own Id: OTP-5739</p></li><li><p>The pre-processor used to complain that the macro definition
'<code class="inline">-define(S(S), ??S).</code>' was circular, which it isn't. (Thanks to Richard
Carlsson.)</p><p>Own Id: OTP-5777</p></li></ul><h2 id="stdlib-1-13-9" class="section-heading"><a href="#stdlib-1-13-9" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 1.13.9</span></h2><h3 id="fixed-bugs-and-malfunctions-144" class="section-heading"><a href="#fixed-bugs-and-malfunctions-144" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>The linter, QLC and the module <code class="inline">erl_pp</code> did not handle the new '<code class="inline">fun M:F/A</code>'
construct in all situations. This problem has been fixed.</p><p>Own Id: OTP-5644</p></li></ul><h3 id="improvements-and-new-features-83" class="section-heading"><a href="#improvements-and-new-features-83" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>The manual pages for most of the Kernel and some of the STDLIB modules have
been updated, in particular regarding type definitions.</p><p>The documentation of the return value for <code class="inline">erts:info/1</code> has been corrected.</p><p>The documentation for <a href="../../apps/erts/erlang.html#statistics/1"><code class="inline">erlang:statistics/1</code></a> now lists all possible arguments.</p><p>Own Id: OTP-5360</p></li><li><p>Replaced some tuple funs with the new <code class="inline">fun M:F/A</code> construct.</p><p>The high-order functions in the lists module no longer accept bad funs under
any circumstances. '<code class="inline">lists:map(bad_fun, [])</code>' used to return '<code class="inline">[]</code>' but now
causes an exception.</p><p>Unused, broken compatibility code in the <code class="inline">ets</code> module was removed. (Thanks to
Dialyzer.)</p><p>Eliminated 5 discrepancies found by Dialyzer in the Appmon application.</p><p>Own Id: OTP-5633</p></li><li><p>The <code class="inline">c:i/0</code> function will now run in a paged mode if there are more than 100
processes in the system. (Thanks to Ulf Wiger.)</p><p><code class="inline">erlang:system_info(process_count)</code> has been optimized and does now return
exactly the same value as <a href="../../apps/erts/erlang.html#length/1"><code class="inline">length(processes())</code></a>. Previously
<code class="inline">erlang:system_info(process_count)</code> did not include exiting processes which
are included in <a href="../../apps/erts/erlang.html#length/1"><code class="inline">length(processes())</code></a>.</p><p>The <code class="inline">+P</code> flag for <code class="inline">erl</code>, which sets the maximum number of processes allowed to
exist at the same, no longer accepts values higher than 134217727. (You will
still probably run out of memory before you'll be able to reach that limit.)</p><p>Own Id: OTP-5645 Aux Id: seq9984</p></li></ul><h2 id="stdlib-1-13-8" class="section-heading"><a href="#stdlib-1-13-8" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 1.13.8</span></h2><h3 id="fixed-bugs-and-malfunctions-145" class="section-heading"><a href="#fixed-bugs-and-malfunctions-145" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Very minor corrections in <code class="inline">beam_lib</code> and its documentation.</p><p>Own Id: OTP-5589</p></li></ul><h3 id="improvements-and-new-features-84" class="section-heading"><a href="#improvements-and-new-features-84" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>The <a href="../../apps/erts/erlang.html#port_info/1"><code class="inline">erlang:port_info/1</code></a> BIF is now documented. Minor corrections of the
documentation for <a href="../../apps/erts/erlang.html#port_info/2"><code class="inline">erlang:port_info/2</code></a>.</p><p>Added a note to the documentation of the <code class="inline">math</code> module that all functions are
not available on all platforms.</p><p>Added more information about the '<code class="inline">+c</code>' option in the <code class="inline">erl</code> man page in the
ERTS documentation.</p><p>Own Id: OTP-5555</p></li><li><p>The new <code class="inline">fun M:F/A</code> construct creates a fun that refers to the latest version
of <code class="inline">M:F/A</code>. This syntax is meant to replace tuple funs <code class="inline">{M,F}</code> which have many
problems.</p><p>The new type test <a href="../../apps/erts/erlang.html#is_function/2"><code class="inline">is_function(Fun,A)</code></a> (which may be used
in guards) test whether <code class="inline">Fun</code> is a fun that can be applied with <code class="inline">A</code> arguments.
(Currently, <code class="inline">Fun</code> can also be a tuple fun.)</p><p>Own Id: OTP-5584</p></li></ul><h2 id="stdlib-1-13-7" class="section-heading"><a href="#stdlib-1-13-7" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 1.13.7</span></h2><h3 id="fixed-bugs-and-malfunctions-146" class="section-heading"><a href="#fixed-bugs-and-malfunctions-146" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p><a href="filelib.html#wildcard/2"><code class="inline">filelib:wildcard/2</code></a> was broken (it ignored its second argument).</p><p>Also, <code class="inline">filelib:wildcard(&quot;Filename&quot;)</code> (where the argument does not contain any
meta-characters) would always return <code class="inline">[&quot;Filename&quot;]</code>. Corrected so that an
empty list will be returned if <code class="inline">&quot;Filename&quot;</code> does not actually exist. (Same
correction in <a href="filelib.html#wildcard/2"><code class="inline">filelib:wildcard/2</code></a>.) (This change is a slight
incompatibility.)</p><p><code class="inline">filelib:wildcard/1,2</code> will generate a different exception when given bad
patterns such as <code class="inline">&quot;{a,&quot;</code>. The exception used to be caused by
'<a href="../../apps/erts/erlang.html#exit/1"><code class="inline">exit(missing_delimiter)</code></a>' but is now
'<code class="inline">erlang:error({badpattern,missing_delimiter})</code>'.</p><p>Own Id: OTP-5523 Aux Id: seq9824</p></li></ul><h3 id="improvements-and-new-features-85" class="section-heading"><a href="#improvements-and-new-features-85" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>Further improvements of encrypted debug info: New option <code class="inline">encrypt_debug_info</code>
for compiler.</p><p>Own Id: OTP-5541 Aux Id: seq9837</p></li></ul><h2 id="stdlib-1-13-6" class="section-heading"><a href="#stdlib-1-13-6" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 1.13.6</span></h2><h3 id="fixed-bugs-and-malfunctions-147" class="section-heading"><a href="#fixed-bugs-and-malfunctions-147" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>When opening a Dets table read only an attempt was sometimes made to re-hash
the table resulting in an error message. This problem has been fixed.</p><p>Own Id: OTP-5487 Aux Id: OTP-4989</p></li></ul><h3 id="improvements-and-new-features-86" class="section-heading"><a href="#improvements-and-new-features-86" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>It is now possible to encrypt the debug information in Beam files, to help
keep the source code secret. See the documentation for <code class="inline">compile</code> on how to
provide the key for encrypting, and the documentation for <code class="inline">beam_lib</code> on how to
provide the key for decryption so that tools such as the Debugger, Xref, or
Cover can be used.</p><p>The <a href="beam_lib.html#chunks/2"><code class="inline">beam_lib:chunks/2</code></a> functions now accepts an additional chunk type
<code class="inline">compile_info</code> to retrieve the compilation information directly as a term.
(Thanks to Tobias Lindahl.)</p><p>Own Id: OTP-5460 Aux Id: seq9787</p></li></ul><h2 id="stdlib-1-13-5" class="section-heading"><a href="#stdlib-1-13-5" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 1.13.5</span></h2><h3 id="fixed-bugs-and-malfunctions-148" class="section-heading"><a href="#fixed-bugs-and-malfunctions-148" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Closing a Dets table kept in RAM would cause a crash if the file could not be
written. This problem has been fixed by returning an error tuple.</p><p>Own Id: OTP-5402</p></li><li><p><code class="inline">erl_pp</code> now correctly pretty-prints <code class="inline">fun F/A</code>.</p><p>Own Id: OTP-5412</p></li><li><p>The Erlang shell failed if the compiler was not in the code path. This problem
has been fixed, but in order to evaluate records the compiler is still needed.</p><p>Own Id: OTP-5435</p></li><li><p>Corrected the example in the documentation for <a href="ets.html#match/2"><code class="inline">ets:match/2</code></a>. Also clarified
that <a href="ets.html#update_counter/3"><code class="inline">ets:update_counter/3</code></a> updates the counter atomically. (Thanks to Anders
Svensson.)</p><p>Own Id: OTP-5452 Aux Id: seq9770, seq9789</p></li></ul><h3 id="improvements-and-new-features-87" class="section-heading"><a href="#improvements-and-new-features-87" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>The possibility to start the Erlang shell in parallel with the rest of the
system was reintroduced for backwards compatibility in STDLIB 1.13.1. The flag
to be used for this is now called <code class="inline">async_shell_start</code> and has been documented.
New shells started from the JCL menu are not synchronized with <code class="inline">init</code> anymore.
This makes it possible to start a new shell (e.g. for debugging purposes) even
if the initial shell has not come up.</p><p>Own Id: OTP-5406 Aux Id: OTP-5218</p></li><li><p>The compiler will now produce warnings when using the deprecated functions in
the <code class="inline">snmp</code> module.</p><p>Own Id: OTP-5425</p></li><li><p>The function <code class="inline">c:zi/0</code> has been removed. Use <code class="inline">c:i/0</code> instead.</p><p>Own Id: OTP-5432</p></li><li><p>Corrected two minor bugs found by the Dialyzer: Calling a parameterized module
from a restricted shell (i.e. if <a href="shell.html#start_restricted/1"><code class="inline">shell:start_restricted/1</code></a> has been used)
would crash the shell evaluator. A debug printout in <code class="inline">gen_fsm</code> had a clause
that would never match; causing less information to be printed.</p><p>And a somewhat more serious one also found by Dialyzer: <a href="../../apps/kernel/rpc.html#yield/1"><code class="inline">rpc:yield/1</code></a> would
crash unless the call started by <a href="../../apps/kernel/rpc.html#async_call/4"><code class="inline">rpc:async_call/4</code></a> had already finished;
<code class="inline">rpc:nb_yield(Key,infinity)</code> would also crash.</p><p>Cleaned up and removed redundant code found by Dialyzer in
<code class="inline">erlang:dmonitor_p/2</code>.</p><p>Own Id: OTP-5462</p></li></ul><h2 id="stdlib-1-13-4" class="section-heading"><a href="#stdlib-1-13-4" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 1.13.4</span></h2><h3 id="fixed-bugs-and-malfunctions-149" class="section-heading"><a href="#fixed-bugs-and-malfunctions-149" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Bugs in the Erlang shell have been fixed.</p><p>Own Id: OTP-5327</p></li><li><p>Some dead code reported by Dialyzer was eliminated.</p><p>A bug in <code class="inline">dbg</code> when tracing to wrap trace files has been corrected. It failed
to delete any already existing wrap trace files with the same names when
starting a new wrap trace.</p><p>Own Id: OTP-5329</p></li><li><p>The linter could output invalid warnings about bit patterns in record
initializations. This problem has been fixed.</p><p>Own Id: OTP-5338</p></li><li><p><code class="inline">ordsets:is_set(NoList)</code>, where <code class="inline">NoList</code> is any term except a list, would
crash. For consistency with <a href="sets.html#is_set/1"><code class="inline">sets:is_set/1</code></a> and <a href="gb_sets.html#is_set/1"><code class="inline">gb_sets:is_set/1</code></a>, it now
returns <code class="inline">false</code>.</p><p>Own Id: OTP-5341</p></li><li><p>A BIF <a href="../../apps/erts/erlang.html#raise/3"><code class="inline">erlang:raise/3</code></a> has been added. See the manual for details. It is
intended for internal system programming only, advanced error handling.</p><p>Own Id: OTP-5376 Aux Id: OTP-5257</p></li></ul><h3 id="improvements-and-new-features-88" class="section-heading"><a href="#improvements-and-new-features-88" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>The <code class="inline">deprecated</code> attribute is now checked by the linter. See <a href="../../apps/tools/xref.html"><code class="inline">xref</code></a> for a
description of the <code class="inline">deprecated</code> attribute.</p><p>Own Id: OTP-5276</p></li><li><p>The restricted shell will now indicate if the return value from a user
predicate is on an incorrect form.</p><p>Own Id: OTP-5335</p></li></ul><h2 id="stdlib-1-13-3" class="section-heading"><a href="#stdlib-1-13-3" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 1.13.3</span></h2><h3 id="fixed-bugs-and-malfunctions-150" class="section-heading"><a href="#fixed-bugs-and-malfunctions-150" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>Bugs concerning unused and shadowed variables have been fixed in the linter.</p><p>Own Id: OTP-5091</p></li><li><p>A bug in the evaluator that caused the shell to choke on bit syntax
expressions has been fixed.</p><p>Own Id: OTP-5237</p></li><li><p><a href="io.html#format/2"><code class="inline">io:format/2</code></a> et.al no longer crashes for some combinations of precision and
value for format character &quot;g&quot;. Previously it crashed if the precision P was 4
or lower and the absolute value of the float to print was lower than 10^4 but
10^(P-1) or higher. Now it will not crash depending on the value of the float.</p><p>Own Id: OTP-5263</p></li><li><p>Bugs in the handling of the bit syntax have been fixed in the Erlang shell.</p><p>Own Id: OTP-5269</p></li><li><p><a href="gb_sets.html#del_element/2"><code class="inline">gb_sets:del_element/2</code></a> was changed to do the same as <a href="gb_sets.html#delete_any/2"><code class="inline">gb_sets:delete_any/2</code></a>
which was the original intention, not as <a href="gb_sets.html#delete/2"><code class="inline">gb_sets:delete/2</code></a>. Code that relies
on <a href="gb_sets.html#del_element/2"><code class="inline">gb_sets:del_element/2</code></a> causing an error if the element does not exist must
be changed to call <a href="gb_sets.html#delete/2"><code class="inline">gb_sets:delete/2</code></a> instead.</p><p>The documentation was also updated to explicitly document functions that were
only referred to as 'aliases' of a documented function. Also, a list of all
functions common to the <code class="inline">gb_sets</code>, <code class="inline">sets</code>, and <code class="inline">ordsets</code> was added.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-5277</p></li><li><p>Debug messages have been removed from the QLC module.</p><p>Own Id: OTP-5283</p></li></ul><h3 id="improvements-and-new-features-89" class="section-heading"><a href="#improvements-and-new-features-89" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>The size of continuations returned from <code class="inline">dets:match/1,3</code>,
<code class="inline">dets:match_object/1,3</code>, and <code class="inline">dets:select/1,3</code> has been reduced. This affects
the amount of data Mnesia sends between nodes while evaluating QLC queries.</p><p>Own Id: OTP-5232</p></li></ul><h2 id="stdlib-1-13-2" class="section-heading"><a href="#stdlib-1-13-2" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 1.13.2</span></h2><h3 id="improvements-and-new-features-90" class="section-heading"><a href="#improvements-and-new-features-90" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>The <code class="inline">-rsh</code> switch for starting a remote shell (introduced with OTP-5210)
clashed with an already existing switch used by <code class="inline">slave</code>. Therefore the switch
for the remote shell is now instead named <code class="inline">-remsh</code>.</p><p>Own Id: OTP-5248 Aux Id: OTP-5210</p></li></ul><h2 id="stdlib-1-13-1" class="section-heading"><a href="#stdlib-1-13-1" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">STDLIB 1.13.1</span></h2><h3 id="fixed-bugs-and-malfunctions-151" class="section-heading"><a href="#fixed-bugs-and-malfunctions-151" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Fixed Bugs and Malfunctions</span></h3><ul><li><p>The Pman 'trace shell' functionality was broken as has now been fixed.
Furthermore, Pman could not correctly find the pid of the active shell if more
than one shell process was running on the node. This has also been corrected.</p><p>Own Id: OTP-5191</p></li><li><p>When the undocumented feature &quot;parameterized modules&quot; was used, the ?MODULE
macro did not work correctly.</p><p>Own Id: OTP-5224</p></li></ul><h3 id="improvements-and-new-features-91" class="section-heading"><a href="#improvements-and-new-features-91" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Improvements and New Features</span></h3><ul><li><p>You can now start Erlang with the <code class="inline">-rsh</code> flag which gives you a remote initial
shell instead of a local one. Example:</p><pre><code class="text">            erl -sname this_node -rsh other_node@other_host</code></pre><p>Own Id: OTP-5210</p></li><li><p>The man page for the <code class="inline">lists</code> module has been updated with description of the
new <code class="inline">zip</code>, <code class="inline">unzip</code>, and <code class="inline">partition/2</code> functions.</p><p>Own Id: OTP-5213</p></li><li><p>The top level group leader used to be listed as job #1 in the job list in JCL
mode. Since there is no shell associated with this process that can be
connected to, it will no longer be listed.</p><p>Own Id: OTP-5214</p></li><li><p>The possibility to start the Erlang shell in parallel with the rest of the
system has been reintroduced for backwards compatibility. Note that this old
behaviour is error prone and should not be used unless for some reason
necessary.</p><p>Own Id: OTP-5218 Aux Id: seq9534</p></li><li><p>The <code class="inline">shell</code> commands <code class="inline">rr/1,2,3</code> now accepts wildcards when reading record
definitions from BEAM files.</p><p>Own Id: OTP-5226</p></li></ul>

</div>

<div class="bottom-actions" id="bottom-actions">
  <div class="bottom-actions-item">

      <a href="stdlib_app.html" class="bottom-actions-button" rel="prev">
        <span class="subheader">
          ← Previous Page
        </span>
        <span class="title">
STDLIB Application
        </span>
      </a>

  </div>
  <div class="bottom-actions-item">

      <a href="introduction.html" class="bottom-actions-button" rel="next">
        <span class="subheader">
          Next Page →
        </span>
        <span class="title">
Introduction
        </span>
      </a>

  </div>
</div>
    <footer class="footer">
      <p>

        <span class="line">
          <button class="a-main footer-button display-quick-switch" title="Search HexDocs packages">
            Search HexDocs
          </button>

            <a href="stdlib.epub" title="ePub version">
              Download ePub version
            </a>

        </span>
      </p>

      <p class="built-using">
        Built using
        <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.38.1) for the

          <a href="https://erlang.org" title="Erlang" target="_blank" translate="no">Erlang programming language</a>

      </p>
<p>Copyright © 1996-2025 <a href="https://www.ericsson.com">Ericsson AB</a></p>
    </footer>
  </div>
</main>
</div>
  <script defer src="https://cdn.jsdelivr.net/npm/mermaid@11.4.1/dist/mermaid.min.js"></script>
  <script>
  let initialized = false;

  window.addEventListener("exdoc:loaded", () => {
      if (!initialized) {
      mermaid.initialize({
          startOnLoad: false,
          theme: document.body.className.includes("dark") ? "dark" : "default"
      });
      initialized = true;
      }

      let id = 0;
      for (const codeEl of document.querySelectorAll("pre code.mermaid")) {
      const preEl = codeEl.parentElement;
      const graphDefinition = codeEl.textContent;
      const graphEl = document.createElement("div");
      const graphId = "mermaid-graph-" + id++;
      mermaid.render(graphId, graphDefinition).then(({svg, bindFunctions}) => {
          graphEl.innerHTML = svg;
          bindFunctions?.(graphEl);
          preEl.insertAdjacentElement("afterend", graphEl);
          preEl.remove();
      });
      }
  });
  </script>

  </body>
</html>
