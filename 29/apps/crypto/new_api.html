<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.38.1">
    <meta name="project" content="crypto v5.6-rc0">


<meta name="exdoc:full-text-search-url" content="/doc/search.html?v=29&q=">
<meta name="major-vsn" content="29">
<link rel="canonical" href="https://www.erlang.org/docs/29/apps/crypto/new_api.html" />
    <title>New and Old API — crypto v5.6-rc0</title>

    <link rel="stylesheet" href="dist/html-erlang-ZK43ZOAC.css" />

    <script defer src="dist/sidebar_items-703DC2C9.js"></script>
    <script defer src="docs_config.js"></script>
    <script defer src="dist/html-DPJLHKSM.js"></script>

  </head>
  <body>
    <script>(()=>{var t="ex_doc:settings",e="dark";var o="dark",s="light";var E="sidebar_state",n="closed";var r="sidebar_width";var a="sidebar-open";var i=new URLSearchParams(window.location.search),S=i.get("theme")||JSON.parse(localStorage.getItem(t)||"{}").theme;(S===o||S!==s&&window.matchMedia("(prefers-color-scheme: dark)").matches)&&document.body.classList.add(e);var d=sessionStorage.getItem(E),A=d!==n&&!window.matchMedia(`screen and (max-width: ${768}px)`).matches;document.body.classList.toggle(a,A);var c=sessionStorage.getItem(r);c&&document.body.style.setProperty("--sidebarWidth",`${c}px`);var p=/(Macintosh|iPhone|iPad|iPod)/.test(window.navigator.userAgent);document.documentElement.classList.toggle("apple-os",p);})();
</script>

<div class="body-wrapper">

<button id="sidebar-menu" class="sidebar-button sidebar-toggle" aria-label="toggle sidebar" aria-controls="sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<nav id="sidebar" class="sidebar">

  <div class="sidebar-header">
    <div class="sidebar-projectInfo">

        <a href="../../index.html" class="sidebar-projectImage">
          <img src="assets/logo.png" alt="crypto" />
        </a>

      <div>
        <a href="../../index.html" class="sidebar-projectName" translate="no">
crypto
        </a>
        <div class="sidebar-projectVersion" translate="no">
          v5.6-rc0
        </div>
      </div>
    </div>
    <ul id="sidebar-list-nav" class="sidebar-list-nav" role="tablist" data-extras=""></ul>
  </div>
</nav>

<output role="status" id="toast"></output>

<main class="content page-extra" id="main" data-type="extras">
  <div id="content" class="content-inner">
    <div class="top-search">
      <div class="search-settings">
        <form class="search-bar" action="search.html">
          <label class="search-label">
            <span class="sr-only">Search documentation of crypto</span>
            <input name="q" type="text" class="search-input" placeholder="Press / to search" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
          </label>
          <button type="submit" class="search-button" aria-label="Submit Search" tabindex="-1">
            <i class="ri-search-2-line ri-lg" aria-hidden="true"></i>
          </button>
          <button type="button" tabindex="-1" class="search-close-button" aria-hidden="true">
            <i class="ri-close-line ri-lg" title="Cancel search"></i>
          </button>
        </form>
        <div class="autocomplete">
        </div>
        <button class="icon-settings display-settings">
          <i class="ri-settings-3-line"></i>
          <span class="sr-only">Settings</span>
        </button>
      </div>
    </div>

<div id="top-content">
  <div class="heading-with-actions top-heading">
    <h1>New and Old API</h1>


      <a href="https://github.com/erlang/otp/blob/master/lib/crypto/doc/guides/new_api.md#L1" title="View Source" class="icon-action" rel="help">
        <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        <span class="sr-only">View Source</span>
      </a>

  </div>


<p>This chapter describes the new api to encryption and decryption.</p><h2 id="background" class="section-heading"><a href="#background" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Background</span></h2><p>The CRYPTO app has evolved during its lifetime. Since also the OpenSSL cryptolib
has changed the API several times, there are parts of the CRYPTO app that uses a
very old one internally and other parts that uses the latest one. The internal
definitions of e.g cipher names was a bit hard to maintain.</p><p>It turned out that using the old api in the new way (more about that later), and
still keep it backwards compatible, was not possible. Specially as more
precision in the error messages is desired it could not be combined with the old
standard.</p><p>Therefore the old api (see next section) is kept for now but internally
implemented with new primitives.</p><h2 id="the-old-api" class="section-heading"><a href="#the-old-api" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">The old API</span></h2><p>The old functions - deprecated from 23.0 and removed from OTP 24.0 - are for
ciphers:</p><ul><li><code class="inline">block_encrypt/3</code></li><li><code class="inline">block_encrypt/4</code></li><li><code class="inline">block_decrypt/3</code></li><li><code class="inline">block_decrypt/4</code></li><li><code class="inline">stream_init/2</code></li><li><code class="inline">stream_init/3</code></li><li><code class="inline">stream_encrypt/2</code></li><li><code class="inline">stream_decrypt/2</code></li><li><code class="inline">next_iv/2</code></li><li><code class="inline">next_iv/3</code></li></ul><p>for lists of supported algorithms:</p><ul><li><code class="inline">supports/0</code></li></ul><p>and for MACs (Message Authentication Codes):</p><ul><li><code class="inline">cmac/3</code></li><li><code class="inline">cmac/4</code></li><li><code class="inline">hmac/3</code></li><li><code class="inline">hmac/4</code></li><li><code class="inline">hmac_init/2</code></li><li><code class="inline">hmac_update/2</code></li><li><code class="inline">hmac_final/1</code></li><li><code class="inline">hmac_final_n/2</code></li><li><code class="inline">poly1305/2</code></li></ul><h2 id="the-new-api" class="section-heading"><a href="#the-new-api" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">The new API</span></h2><h3 id="encryption-and-decryption" class="section-heading"><a href="#encryption-and-decryption" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Encryption and decryption</span></h3><p>The new functions for encrypting or decrypting one single binary are:</p><ul><li><a href="crypto.html#crypto_one_time/4">crypto_one_time/4</a></li><li><a href="crypto.html#crypto_one_time/5">crypto_one_time/5</a></li><li><a href="crypto.html#crypto_one_time_aead/6">crypto_one_time_aead/6</a></li><li><a href="crypto.html#crypto_one_time_aead/7">crypto_one_time_aead/7</a></li></ul><p>In those functions the internal crypto state is first created and initialized
with the cipher type, the key and possibly other data. Then the single binary is
encrypted or decrypted, the crypto state is de-allocated and the result of the
crypto operation is returned.</p><p>The <code class="inline">crypto_one_time_aead</code> functions are for the ciphers of mode <code class="inline">ccm</code> or <code class="inline">gcm</code>,
and for the cipher <code class="inline">chacha20-poly1305</code>.</p><p>For repeated encryption or decryption of a text divided in parts, where the
internal crypto state is initialized once, and then many binaries are encrypted
or decrypted with the same state, the functions are:</p><ul><li><a href="crypto.html#crypto_init/4">crypto_init/4</a></li><li><a href="crypto.html#crypto_init/3">crypto_init/3</a></li><li><a href="crypto.html#crypto_update/2">crypto_update/2</a></li><li><a href="crypto.html#crypto_final/1">crypto_final/1</a></li></ul><p>The <code class="inline">crypto_init</code> initialies an internal cipher state, and one or more calls of
<code class="inline">crypto_update</code> does the actual encryption or decryption. Note that AEAD ciphers
can't be handled this way due to their nature.</p><p>An example of where those functions are needed, is when handling the TLS
protocol.</p><p>If padding was not enabled, the call to
<a href="crypto.html#crypto_final/1">crypto_final/1</a> may be excluded.</p><p>For information about available algorithms, use:</p><ul><li><a href="crypto.html#supports/1">supports/1</a></li><li><a href="crypto.html#hash_info/1">hash_info/1</a></li><li><a href="crypto.html#cipher_info/1">cipher_info/1</a></li></ul><p>The <code class="inline">next_iv/2</code> and <code class="inline">next_iv/3</code> are not needed since the <code class="inline">crypto_init</code> and
<code class="inline">crypto_update</code> includes this functionality.</p><h3 id="macs-message-authentication-codes" class="section-heading"><a href="#macs-message-authentication-codes" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">MACs (Message Authentication Codes)</span></h3><p>The new functions for calculating a MAC of a single piece of text are:</p><ul><li><a href="crypto.html#mac/3">mac/3</a></li><li><a href="crypto.html#mac/4">mac/4</a></li><li><a href="crypto.html#macN/4">macN/4</a></li><li><a href="crypto.html#macN/5">macN/5</a></li></ul><p>For calculating a MAC of a text divided in parts use:</p><ul><li><a href="crypto.html#mac_init/2">mac_init/2</a></li><li><a href="crypto.html#mac_init/3">mac_init/3</a></li><li><a href="crypto.html#mac_update/2">mac_update/2</a></li><li><a href="crypto.html#mac_final/1">mac_final/1</a></li><li><a href="crypto.html#mac_finalN/2">mac_finalN/2</a></li></ul><h2 id="examples-of-the-new-api" class="section-heading"><a href="#examples-of-the-new-api" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Examples of the new api</span></h2><h3 id="examples-of-crypto_init-4-and-crypto_update-2" class="section-heading"><a href="#examples-of-crypto_init-4-and-crypto_update-2" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Examples of crypto_init/4 and crypto_update/2</span></h3><p>The functions <a href="crypto.html#crypto_init/4">crypto_init/4</a> and
<a href="crypto.html#crypto_update/2">crypto_update/2</a> are intended to be used for
encrypting or decrypting a sequence of blocks. First one call of <code class="inline">crypto_init/4</code>
initialises the crypto context. One or more calls <code class="inline">crypto_update/2</code> does the
actual encryption or decryption for each block.</p><p>This example shows first the encryption of two blocks and then decryptions of
the cipher text, but divided into three blocks just to show that it is possible
to divide the plain text and cipher text differently for some ciphers:</p><pre><code class="makeup erlang" translate="no"><span class="w">	</span><span class="mi">1</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">application</span><span class="p">:</span><span class="nf">start</span><span class="p" data-group-id="0816443898-1">(</span><span class="ss">crypto</span><span class="p" data-group-id="0816443898-1">)</span><span class="p">.</span><span class="w">
	</span><span class="ss">ok</span><span class="w">
	</span><span class="mi">2</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="0816443898-2">&lt;&lt;</span><span class="mi">1</span><span class="p">:</span><span class="mi">128</span><span class="p" data-group-id="0816443898-2">&gt;&gt;</span><span class="p">.</span><span class="w">
	</span><span class="p" data-group-id="0816443898-3">&lt;&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p" data-group-id="0816443898-3">&gt;&gt;</span><span class="w">
	</span><span class="mi">3</span><span class="o">&gt;</span><span class="w"> </span><span class="n">IV</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="0816443898-4">&lt;&lt;</span><span class="mi">0</span><span class="p">:</span><span class="mi">128</span><span class="p" data-group-id="0816443898-4">&gt;&gt;</span><span class="p">.</span><span class="w">
	</span><span class="p" data-group-id="0816443898-5">&lt;&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p" data-group-id="0816443898-5">&gt;&gt;</span><span class="w">
	</span><span class="mi">4</span><span class="o">&gt;</span><span class="w"> </span><span class="n">StateEnc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">crypto</span><span class="p">:</span><span class="nf">crypto_init</span><span class="p" data-group-id="0816443898-6">(</span><span class="ss">aes_128_ctr</span><span class="p">,</span><span class="w"> </span><span class="n">Key</span><span class="p">,</span><span class="w"> </span><span class="n">IV</span><span class="p">,</span><span class="w"> </span><span class="ss">true</span><span class="p" data-group-id="0816443898-6">)</span><span class="p">.</span><span class="w"> </span><span class="c1">% encrypt -&gt; true</span><span class="w">
	</span><span class="p">#</span><span class="n">Ref</span><span class="o">&lt;</span><span class="mf">0.3768901617</span><span class="p">.</span><span class="mf">1128660993.124047</span><span class="o">&gt;</span><span class="w">
	</span><span class="mi">5</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">crypto</span><span class="p">:</span><span class="nf">crypto_update</span><span class="p" data-group-id="0816443898-7">(</span><span class="n">StateEnc</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0816443898-8">&lt;&lt;</span><span class="s">&quot;First bytes&quot;</span><span class="p" data-group-id="0816443898-8">&gt;&gt;</span><span class="p" data-group-id="0816443898-7">)</span><span class="p">.</span><span class="w">
	</span><span class="p" data-group-id="0816443898-9">&lt;&lt;</span><span class="mi">67</span><span class="p">,</span><span class="mi">44</span><span class="p">,</span><span class="mi">216</span><span class="p">,</span><span class="mi">166</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">130</span><span class="p">,</span><span class="mi">203</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">66</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">162</span><span class="p" data-group-id="0816443898-9">&gt;&gt;</span><span class="w">
	</span><span class="mi">6</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">crypto</span><span class="p">:</span><span class="nf">crypto_update</span><span class="p" data-group-id="0816443898-10">(</span><span class="n">StateEnc</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0816443898-11">&lt;&lt;</span><span class="s">&quot;Second bytes&quot;</span><span class="p" data-group-id="0816443898-11">&gt;&gt;</span><span class="p" data-group-id="0816443898-10">)</span><span class="p">.</span><span class="w">
	</span><span class="p" data-group-id="0816443898-12">&lt;&lt;</span><span class="mi">16</span><span class="p">,</span><span class="mi">79</span><span class="p">,</span><span class="mi">94</span><span class="p">,</span><span class="mi">115</span><span class="p">,</span><span class="mi">234</span><span class="p">,</span><span class="mi">197</span><span class="p">,</span><span class="mi">94</span><span class="p">,</span><span class="mi">253</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">144</span><span class="p">,</span><span class="mi">151</span><span class="p">,</span><span class="mi">41</span><span class="p" data-group-id="0816443898-12">&gt;&gt;</span><span class="w">
	</span><span class="mi">7</span><span class="o">&gt;</span><span class="w">
	</span><span class="mi">7</span><span class="o">&gt;</span><span class="w"> </span><span class="n">StateDec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">crypto</span><span class="p">:</span><span class="nf">crypto_init</span><span class="p" data-group-id="0816443898-13">(</span><span class="ss">aes_128_ctr</span><span class="p">,</span><span class="w"> </span><span class="n">Key</span><span class="p">,</span><span class="w"> </span><span class="n">IV</span><span class="p">,</span><span class="w"> </span><span class="ss">false</span><span class="p" data-group-id="0816443898-13">)</span><span class="p">.</span><span class="w"> </span><span class="c1">% decrypt -&gt; false</span><span class="w">
	</span><span class="p">#</span><span class="n">Ref</span><span class="o">&lt;</span><span class="mf">0.3768901617</span><span class="p">.</span><span class="mf">1128660994.124255</span><span class="o">&gt;</span><span class="w">
	</span><span class="mi">8</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">crypto</span><span class="p">:</span><span class="nf">crypto_update</span><span class="p" data-group-id="0816443898-14">(</span><span class="n">StateDec</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0816443898-15">&lt;&lt;</span><span class="mi">67</span><span class="p">,</span><span class="mi">44</span><span class="p">,</span><span class="mi">216</span><span class="p">,</span><span class="mi">166</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">130</span><span class="p">,</span><span class="mi">203</span><span class="p" data-group-id="0816443898-15">&gt;&gt;</span><span class="p" data-group-id="0816443898-14">)</span><span class="p">.</span><span class="w">
	</span><span class="p" data-group-id="0816443898-16">&lt;&lt;</span><span class="s">&quot;First b&quot;</span><span class="p" data-group-id="0816443898-16">&gt;&gt;</span><span class="w">
	</span><span class="mi">9</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">crypto</span><span class="p">:</span><span class="nf">crypto_update</span><span class="p" data-group-id="0816443898-17">(</span><span class="n">StateDec</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0816443898-18">&lt;&lt;</span><span class="mi">5</span><span class="p">,</span><span class="mi">66</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">162</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">79</span><span class="p">,</span><span class="mi">94</span><span class="p">,</span><span class="mi">115</span><span class="p">,</span><span class="mi">234</span><span class="p">,</span><span class="mi">197</span><span class="p">,</span><span class="w">
        </span><span class="mi">94</span><span class="p">,</span><span class="mi">253</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">144</span><span class="p">,</span><span class="mi">151</span><span class="p" data-group-id="0816443898-18">&gt;&gt;</span><span class="p" data-group-id="0816443898-17">)</span><span class="p">.</span><span class="w">
	</span><span class="p" data-group-id="0816443898-19">&lt;&lt;</span><span class="s">&quot;ytesSecond byte&quot;</span><span class="p" data-group-id="0816443898-19">&gt;&gt;</span><span class="w">
	</span><span class="mi">10</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">crypto</span><span class="p">:</span><span class="nf">crypto_update</span><span class="p" data-group-id="0816443898-20">(</span><span class="n">StateDec</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0816443898-21">&lt;&lt;</span><span class="mi">41</span><span class="p" data-group-id="0816443898-21">&gt;&gt;</span><span class="p" data-group-id="0816443898-20">)</span><span class="p">.</span><span class="w">
	</span><span class="p" data-group-id="0816443898-22">&lt;&lt;</span><span class="s">&quot;s&quot;</span><span class="p" data-group-id="0816443898-22">&gt;&gt;</span><span class="w">
	</span><span class="mi">11</span><span class="o">&gt;</span></code></pre><p>Note that the internal data that the <code class="inline">StateEnc</code> and <code class="inline">StateDec</code> references are
destructivly updated by the calls to
<a href="crypto.html#crypto_update/2">crypto_update/2</a>. This is to gain time in the calls
of the nifs interfacing the cryptolib. In a loop where the state is saved in the
loop's state, it also saves one update of the loop state per crypto operation.</p><p>For example, a simple server receiving text parts to encrypt and send the result
back to the one who sent them (the <code class="inline">Requester</code>):</p><pre><code class="makeup erlang" translate="no"><span class="w">	</span><span class="nf">encode</span><span class="p" data-group-id="1038616255-1">(</span><span class="n">Crypto</span><span class="p">,</span><span class="w"> </span><span class="n">Key</span><span class="p">,</span><span class="w"> </span><span class="n">IV</span><span class="p" data-group-id="1038616255-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
	</span><span class="nf">crypto_loop</span><span class="p" data-group-id="1038616255-2">(</span><span class="nc">crypto</span><span class="p">:</span><span class="nf">crypto_init</span><span class="p" data-group-id="1038616255-3">(</span><span class="n">Crypto</span><span class="p">,</span><span class="w"> </span><span class="n">Key</span><span class="p">,</span><span class="w"> </span><span class="n">IV</span><span class="p">,</span><span class="w"> </span><span class="ss">true</span><span class="p" data-group-id="1038616255-3">)</span><span class="p" data-group-id="1038616255-2">)</span><span class="p">.</span><span class="w">

	</span><span class="nf">crypto_loop</span><span class="p" data-group-id="1038616255-4">(</span><span class="n">State</span><span class="p" data-group-id="1038616255-4">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
	</span><span class="k">receive</span><span class="w">
        </span><span class="p" data-group-id="1038616255-5">{</span><span class="n">Text</span><span class="p">,</span><span class="w"> </span><span class="n">Requester</span><span class="p" data-group-id="1038616255-5">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
        </span><span class="n">Requester</span><span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="nc">crypto</span><span class="p">:</span><span class="nf">crypto_update</span><span class="p" data-group-id="1038616255-6">(</span><span class="n">State</span><span class="p">,</span><span class="w"> </span><span class="n">Text</span><span class="p" data-group-id="1038616255-6">)</span><span class="p">,</span><span class="w">
	</span><span class="nf">loop</span><span class="p" data-group-id="1038616255-7">(</span><span class="n">State</span><span class="p" data-group-id="1038616255-7">)</span><span class="w">
	</span><span class="k">end</span><span class="p">.</span></code></pre><h3 id="example-of-crypto_one_time-5" class="section-heading"><a href="#example-of-crypto_one_time-5" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Example of crypto_one_time/5</span></h3><p>The same example as in the
<a href="new_api.html#examples-of-crypto_init-4-and-crypto_update-2">previous section</a>,
but now with one call to <a href="crypto.html#crypto_one_time/5">crypto_one_time/5</a>:</p><pre><code class="makeup erlang" translate="no"><span class="w">	</span><span class="mi">1</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="7750604801-1">&lt;&lt;</span><span class="mi">1</span><span class="p">:</span><span class="mi">128</span><span class="p" data-group-id="7750604801-1">&gt;&gt;</span><span class="p">.</span><span class="w">
	</span><span class="p" data-group-id="7750604801-2">&lt;&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p" data-group-id="7750604801-2">&gt;&gt;</span><span class="w">
	</span><span class="mi">2</span><span class="o">&gt;</span><span class="w"> </span><span class="n">IV</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="7750604801-3">&lt;&lt;</span><span class="mi">0</span><span class="p">:</span><span class="mi">128</span><span class="p" data-group-id="7750604801-3">&gt;&gt;</span><span class="p">.</span><span class="w">
	</span><span class="p" data-group-id="7750604801-4">&lt;&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p" data-group-id="7750604801-4">&gt;&gt;</span><span class="w">
	</span><span class="mi">3</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Txt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="7750604801-5">[</span><span class="p" data-group-id="7750604801-6">&lt;&lt;</span><span class="s">&quot;First bytes&quot;</span><span class="p" data-group-id="7750604801-6">&gt;&gt;</span><span class="p">,</span><span class="p" data-group-id="7750604801-7">&lt;&lt;</span><span class="s">&quot;Second bytes&quot;</span><span class="p" data-group-id="7750604801-7">&gt;&gt;</span><span class="p" data-group-id="7750604801-5">]</span><span class="p">.</span><span class="w">
	</span><span class="p" data-group-id="7750604801-8">[</span><span class="p" data-group-id="7750604801-9">&lt;&lt;</span><span class="s">&quot;First bytes&quot;</span><span class="p" data-group-id="7750604801-9">&gt;&gt;</span><span class="p">,</span><span class="p" data-group-id="7750604801-10">&lt;&lt;</span><span class="s">&quot;Second bytes&quot;</span><span class="p" data-group-id="7750604801-10">&gt;&gt;</span><span class="p" data-group-id="7750604801-8">]</span><span class="w">
	</span><span class="mi">4</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">crypto</span><span class="p">:</span><span class="nf">crypto_one_time</span><span class="p" data-group-id="7750604801-11">(</span><span class="ss">aes_128_ctr</span><span class="p">,</span><span class="w"> </span><span class="n">Key</span><span class="p">,</span><span class="w"> </span><span class="n">IV</span><span class="p">,</span><span class="w"> </span><span class="n">Txt</span><span class="p">,</span><span class="w"> </span><span class="ss">true</span><span class="p" data-group-id="7750604801-11">)</span><span class="p">.</span><span class="w">
	</span><span class="p" data-group-id="7750604801-12">&lt;&lt;</span><span class="mi">67</span><span class="p">,</span><span class="mi">44</span><span class="p">,</span><span class="mi">216</span><span class="p">,</span><span class="mi">166</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">130</span><span class="p">,</span><span class="mi">203</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">66</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">162</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">79</span><span class="p">,</span><span class="mi">94</span><span class="p">,</span><span class="mi">115</span><span class="p">,</span><span class="mi">234</span><span class="p">,</span><span class="w">
	</span><span class="mi">197</span><span class="p">,</span><span class="mi">94</span><span class="p">,</span><span class="mi">253</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">144</span><span class="p">,</span><span class="mi">151</span><span class="p">,</span><span class="mi">41</span><span class="p" data-group-id="7750604801-12">&gt;&gt;</span><span class="w">
	</span><span class="mi">5</span><span class="o">&gt;</span></code></pre><p>The <code class="inline">[&lt;&lt;&quot;First bytes&quot;&gt;&gt;,&lt;&lt;&quot;Second bytes&quot;&gt;&gt;]</code> could of course have been one
single binary: <code class="inline">&lt;&lt;&quot;First bytesSecond bytes&quot;&gt;&gt;</code>.</p><h3 id="example-of-crypto_one_time_aead-6" class="section-heading"><a href="#example-of-crypto_one_time_aead-6" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Example of crypto_one_time_aead/6</span></h3><p>The same example as in the
<a href="new_api.html#example-of-crypto_one_time-5">previous section</a>, but now with one
call to <a href="crypto.html#crypto_one_time_aead/6">crypto_one_time_aead/6</a>:</p><pre><code class="makeup erlang" translate="no"><span class="w">	</span><span class="mi">1</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5862625861-1">&lt;&lt;</span><span class="mi">1</span><span class="p">:</span><span class="mi">128</span><span class="p" data-group-id="5862625861-1">&gt;&gt;</span><span class="p">.</span><span class="w">
	</span><span class="p" data-group-id="5862625861-2">&lt;&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p" data-group-id="5862625861-2">&gt;&gt;</span><span class="w">
	</span><span class="mi">2</span><span class="o">&gt;</span><span class="w"> </span><span class="n">IV</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5862625861-3">&lt;&lt;</span><span class="mi">0</span><span class="p">:</span><span class="mi">128</span><span class="p" data-group-id="5862625861-3">&gt;&gt;</span><span class="p">.</span><span class="w">
	</span><span class="p" data-group-id="5862625861-4">&lt;&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p" data-group-id="5862625861-4">&gt;&gt;</span><span class="w">
	</span><span class="mi">3</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Txt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5862625861-5">[</span><span class="p" data-group-id="5862625861-6">&lt;&lt;</span><span class="s">&quot;First bytes&quot;</span><span class="p" data-group-id="5862625861-6">&gt;&gt;</span><span class="p">,</span><span class="p" data-group-id="5862625861-7">&lt;&lt;</span><span class="s">&quot;Second bytes&quot;</span><span class="p" data-group-id="5862625861-7">&gt;&gt;</span><span class="p" data-group-id="5862625861-5">]</span><span class="p">.</span><span class="w">
	</span><span class="p" data-group-id="5862625861-8">[</span><span class="p" data-group-id="5862625861-9">&lt;&lt;</span><span class="s">&quot;First bytes&quot;</span><span class="p" data-group-id="5862625861-9">&gt;&gt;</span><span class="p">,</span><span class="p" data-group-id="5862625861-10">&lt;&lt;</span><span class="s">&quot;Second bytes&quot;</span><span class="p" data-group-id="5862625861-10">&gt;&gt;</span><span class="p" data-group-id="5862625861-8">]</span><span class="w">
	</span><span class="mi">4</span><span class="o">&gt;</span><span class="w"> </span><span class="n">AAD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="5862625861-11">&lt;&lt;</span><span class="s">&quot;Some additional auth data&quot;</span><span class="p" data-group-id="5862625861-11">&gt;&gt;</span><span class="p">.</span><span class="w">
	</span><span class="p" data-group-id="5862625861-12">&lt;&lt;</span><span class="s">&quot;Some additional auth data&quot;</span><span class="p" data-group-id="5862625861-12">&gt;&gt;</span><span class="w">
	</span><span class="mi">5</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">crypto</span><span class="p">:</span><span class="nf">crypto_one_time_aead</span><span class="p" data-group-id="5862625861-13">(</span><span class="ss">aes_128_gcm</span><span class="p">,</span><span class="w"> </span><span class="n">Key</span><span class="p">,</span><span class="w"> </span><span class="n">IV</span><span class="p">,</span><span class="w"> </span><span class="n">Txt</span><span class="p">,</span><span class="w"> </span><span class="n">AAD</span><span class="p">,</span><span class="w"> </span><span class="ss">true</span><span class="p" data-group-id="5862625861-13">)</span><span class="p">.</span><span class="w">
	</span><span class="p" data-group-id="5862625861-14">{</span><span class="p" data-group-id="5862625861-15">&lt;&lt;</span><span class="mi">240</span><span class="p">,</span><span class="mi">130</span><span class="p">,</span><span class="mi">38</span><span class="p">,</span><span class="mi">96</span><span class="p">,</span><span class="mi">130</span><span class="p">,</span><span class="mi">241</span><span class="p">,</span><span class="mi">189</span><span class="p">,</span><span class="mi">52</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">190</span><span class="p">,</span><span class="mi">179</span><span class="p">,</span><span class="mi">213</span><span class="p">,</span><span class="mi">132</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">72</span><span class="p">,</span><span class="w">
	</span><span class="mi">192</span><span class="p">,</span><span class="mi">103</span><span class="p">,</span><span class="mi">176</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">104</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">71</span><span class="p">,</span><span class="mi">158</span><span class="p" data-group-id="5862625861-15">&gt;&gt;</span><span class="p">,</span><span class="w">
	</span><span class="p" data-group-id="5862625861-16">&lt;&lt;</span><span class="mi">131</span><span class="p">,</span><span class="mi">47</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">91</span><span class="p">,</span><span class="mi">142</span><span class="p">,</span><span class="mi">85</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">244</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">141</span><span class="p">,</span><span class="mi">214</span><span class="p">,</span><span class="mi">71</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">135</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">155</span><span class="p" data-group-id="5862625861-16">&gt;&gt;</span><span class="p" data-group-id="5862625861-14">}</span><span class="w">
	</span><span class="mi">6</span><span class="o">&gt;</span></code></pre><p>The <code class="inline">[&lt;&lt;&quot;First bytes&quot;&gt;&gt;,&lt;&lt;&quot;Second bytes&quot;&gt;&gt;]</code> could of course have been one
single binary: <code class="inline">&lt;&lt;&quot;First bytesSecond bytes&quot;&gt;&gt;</code>.</p><h3 id="example-of-mac_init-mac_update-and-mac_final" class="section-heading"><a href="#example-of-mac_init-mac_update-and-mac_final" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Example of mac_init mac_update and mac_final</span></h3><pre><code class="makeup erlang" translate="no"><span class="w">	</span><span class="mi">1</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p" data-group-id="8555979060-1">&lt;&lt;</span><span class="mi">1</span><span class="p">:</span><span class="mi">128</span><span class="p" data-group-id="8555979060-1">&gt;&gt;</span><span class="p">.</span><span class="w">
	</span><span class="p" data-group-id="8555979060-2">&lt;&lt;</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p" data-group-id="8555979060-2">&gt;&gt;</span><span class="w">
	</span><span class="mi">2</span><span class="o">&gt;</span><span class="w"> </span><span class="n">StateMac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">crypto</span><span class="p">:</span><span class="nf">mac_init</span><span class="p" data-group-id="8555979060-3">(</span><span class="ss">cmac</span><span class="p">,</span><span class="w"> </span><span class="ss">aes_128_cbc</span><span class="p">,</span><span class="w"> </span><span class="n">Key</span><span class="p" data-group-id="8555979060-3">)</span><span class="p">.</span><span class="w">
	</span><span class="p">#</span><span class="n">Ref</span><span class="o">&lt;</span><span class="mf">0.2424664121</span><span class="p">.</span><span class="mf">2781478916.232610</span><span class="o">&gt;</span><span class="w">
	</span><span class="mi">3</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">crypto</span><span class="p">:</span><span class="nf">mac_update</span><span class="p" data-group-id="8555979060-4">(</span><span class="n">StateMac</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8555979060-5">&lt;&lt;</span><span class="s">&quot;First bytes&quot;</span><span class="p" data-group-id="8555979060-5">&gt;&gt;</span><span class="p" data-group-id="8555979060-4">)</span><span class="p">.</span><span class="w">
	</span><span class="p">#</span><span class="n">Ref</span><span class="o">&lt;</span><span class="mf">0.2424664121</span><span class="p">.</span><span class="mf">2781478916.232610</span><span class="o">&gt;</span><span class="w">
	</span><span class="mi">4</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">crypto</span><span class="p">:</span><span class="nf">mac_update</span><span class="p" data-group-id="8555979060-6">(</span><span class="n">StateMac</span><span class="p">,</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="p" data-group-id="8555979060-6">)</span><span class="p">.</span><span class="w">
	</span><span class="p">#</span><span class="n">Ref</span><span class="o">&lt;</span><span class="mf">0.2424664121</span><span class="p">.</span><span class="mf">2781478916.232610</span><span class="o">&gt;</span><span class="w">
	</span><span class="mi">5</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">crypto</span><span class="p">:</span><span class="nf">mac_update</span><span class="p" data-group-id="8555979060-7">(</span><span class="n">StateMac</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8555979060-8">&lt;&lt;</span><span class="s">&quot;last bytes&quot;</span><span class="p" data-group-id="8555979060-8">&gt;&gt;</span><span class="p" data-group-id="8555979060-7">)</span><span class="p">.</span><span class="w">
	</span><span class="p">#</span><span class="n">Ref</span><span class="o">&lt;</span><span class="mf">0.2424664121</span><span class="p">.</span><span class="mf">2781478916.232610</span><span class="o">&gt;</span><span class="w">
	</span><span class="mi">6</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">crypto</span><span class="p">:</span><span class="nf">mac_final</span><span class="p" data-group-id="8555979060-9">(</span><span class="n">StateMac</span><span class="p" data-group-id="8555979060-9">)</span><span class="p">.</span><span class="w">
	</span><span class="p" data-group-id="8555979060-10">&lt;&lt;</span><span class="mi">68</span><span class="p">,</span><span class="mi">191</span><span class="p">,</span><span class="mi">219</span><span class="p">,</span><span class="mi">128</span><span class="p">,</span><span class="mi">84</span><span class="p">,</span><span class="mi">77</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">193</span><span class="p">,</span><span class="mi">197</span><span class="p">,</span><span class="mi">238</span><span class="p">,</span><span class="mi">107</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">214</span><span class="p">,</span><span class="mi">141</span><span class="p">,</span><span class="mi">160</span><span class="p">,</span><span class="w">
	</span><span class="mi">249</span><span class="p" data-group-id="8555979060-10">&gt;&gt;</span><span class="w">
	</span><span class="mi">7</span><span class="o">&gt;</span></code></pre><p>and compare the result with a single calculation just for this example:</p><pre><code class="makeup erlang" translate="no"><span class="w">	</span><span class="mi">7</span><span class="o">&gt;</span><span class="w"> </span><span class="nc">crypto</span><span class="p">:</span><span class="nf">mac</span><span class="p" data-group-id="1426482786-1">(</span><span class="ss">cmac</span><span class="p">,</span><span class="w"> </span><span class="ss">aes_128_cbc</span><span class="p">,</span><span class="w"> </span><span class="n">Key</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;First bytes last bytes&quot;</span><span class="p" data-group-id="1426482786-1">)</span><span class="p">.</span><span class="w">
	</span><span class="p" data-group-id="1426482786-2">&lt;&lt;</span><span class="mi">68</span><span class="p">,</span><span class="mi">191</span><span class="p">,</span><span class="mi">219</span><span class="p">,</span><span class="mi">128</span><span class="p">,</span><span class="mi">84</span><span class="p">,</span><span class="mi">77</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">193</span><span class="p">,</span><span class="mi">197</span><span class="p">,</span><span class="mi">238</span><span class="p">,</span><span class="mi">107</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">214</span><span class="p">,</span><span class="mi">141</span><span class="p">,</span><span class="mi">160</span><span class="p">,</span><span class="w">
	</span><span class="mi">249</span><span class="p" data-group-id="1426482786-2">&gt;&gt;</span><span class="w">
	</span><span class="mi">8</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">v</span><span class="p" data-group-id="1426482786-3">(</span><span class="mi">7</span><span class="p" data-group-id="1426482786-3">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nf">v</span><span class="p" data-group-id="1426482786-4">(</span><span class="mi">6</span><span class="p" data-group-id="1426482786-4">)</span><span class="p">.</span><span class="w">
	</span><span class="ss">true</span><span class="w">
	</span><span class="mi">9</span><span class="o">&gt;</span></code></pre><h2 id="retired-cipher-names" class="section-heading"><a href="#retired-cipher-names" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Retired cipher names</span></h2><p>This table lists the retired cipher names in the first column and suggests names
to replace them with in the second column.</p><p>The new names follows the OpenSSL libcrypto names. The format is
ALGORITM_KEYSIZE_MODE.</p><p>Examples of algorithms are aes, chacha20 and des. The keysize is the number of
bits and examples of the mode are cbc, ctr and gcm. The mode may be followed by
a number depending on the mode. An example is the ccm mode which has a variant
called ccm8 where the so called tag has a length of eight bits.</p><p>The old names had by time lost any common naming convention which the new names
now introduces. The new names include the key length which improves the error
checking in the lower levels of the crypto application.</p><table><thead><tr><th style="text-align: left;"><strong>Instead of:</strong></th><th style="text-align: left;"><strong>Use:</strong></th></tr></thead><tbody><tr><td style="text-align: left;"><code class="inline">aes_cbc128</code></td><td style="text-align: left;"><code class="inline">aes_128_cbc</code></td></tr><tr><td style="text-align: left;"><code class="inline">aes_cbc256</code></td><td style="text-align: left;"><code class="inline">aes_256_cbc</code></td></tr><tr><td style="text-align: left;"><code class="inline">aes_cbc</code></td><td style="text-align: left;"><code class="inline">aes_128_cbc, aes_192_cbc, aes_256_cbc</code></td></tr><tr><td style="text-align: left;"><code class="inline">aes_ccm</code></td><td style="text-align: left;"><code class="inline">aes_128_ccm, aes_192_ccm, aes_256_ccm</code></td></tr><tr><td style="text-align: left;"><code class="inline">aes_cfb128</code></td><td style="text-align: left;"><code class="inline">aes_128_cfb128, aes_192_cfb128, aes_256_cfb128</code></td></tr><tr><td style="text-align: left;"><code class="inline">aes_cfb8</code></td><td style="text-align: left;"><code class="inline">aes_128_cfb8, aes_192_cfb8, aes_256_cfb8</code></td></tr><tr><td style="text-align: left;"><code class="inline">aes_ctr</code></td><td style="text-align: left;"><code class="inline">aes_128_ctr, aes_192_ctr, aes_256_ctr</code></td></tr><tr><td style="text-align: left;"><code class="inline">aes_gcm</code></td><td style="text-align: left;"><code class="inline">aes_128_gcm, aes_192_gcm, aes_256_gcm</code></td></tr><tr><td style="text-align: left;"><code class="inline">des3_cbc</code></td><td style="text-align: left;"><code class="inline">des_ede3_cbc</code></td></tr><tr><td style="text-align: left;"><code class="inline">des3_cbf</code></td><td style="text-align: left;"><code class="inline">des_ede3_cfb</code></td></tr><tr><td style="text-align: left;"><code class="inline">des3_cfb</code></td><td style="text-align: left;"><code class="inline">des_ede3_cfb</code></td></tr><tr><td style="text-align: left;"><code class="inline">des_ede3</code></td><td style="text-align: left;"><code class="inline">des_ede3_cbc</code></td></tr><tr><td style="text-align: left;"><code class="inline">des_ede3_cbf</code></td><td style="text-align: left;"><code class="inline">des_ede3_cfb</code></td></tr></tbody></table>

</div>

<div class="bottom-actions" id="bottom-actions">
  <div class="bottom-actions-item">

      <a href="algorithm_details.html" class="bottom-actions-button" rel="prev">
        <span class="subheader">
          ← Previous Page
        </span>
        <span class="title">
Algorithm Details
        </span>
      </a>

  </div>
  <div class="bottom-actions-item">

  </div>
</div>
    <footer class="footer">
      <p>

        <span class="line">
          <button class="a-main footer-button display-quick-switch" title="Search HexDocs packages">
            Search HexDocs
          </button>

            <a href="crypto.epub" title="ePub version">
              Download ePub version
            </a>

        </span>
      </p>

      <p class="built-using">
        Built using
        <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.38.1) for the

          <a href="https://erlang.org" title="Erlang" target="_blank" translate="no">Erlang programming language</a>

      </p>
<p>Copyright © 1996-2025 <a href="https://www.ericsson.com">Ericsson AB</a></p>
    </footer>
  </div>
</main>
</div>
  <script defer src="https://cdn.jsdelivr.net/npm/mermaid@11.4.1/dist/mermaid.min.js"></script>
  <script>
  let initialized = false;

  window.addEventListener("exdoc:loaded", () => {
      if (!initialized) {
      mermaid.initialize({
          startOnLoad: false,
          theme: document.body.className.includes("dark") ? "dark" : "default"
      });
      initialized = true;
      }

      let id = 0;
      for (const codeEl of document.querySelectorAll("pre code.mermaid")) {
      const preEl = codeEl.parentElement;
      const graphDefinition = codeEl.textContent;
      const graphEl = document.createElement("div");
      const graphId = "mermaid-graph-" + id++;
      mermaid.render(graphId, graphDefinition).then(({svg, bindFunctions}) => {
          graphEl.innerHTML = svg;
          bindFunctions?.(graphEl);
          preEl.insertAdjacentElement("afterend", graphEl);
          preEl.remove();
      });
      }
  });
  </script>

  </body>
</html>
