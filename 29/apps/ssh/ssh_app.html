<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.38.1">
    <meta name="project" content="ssh v5.3.4-rc0">


<meta name="major-vsn" content="29">
<meta name="exdoc:full-text-search-url" content="/doc/search.html?v=29&q=">
<link rel="canonical" href="https://www.erlang.org/doc/apps/ssh/ssh_app.html" />
    <title>SSH Application — ssh v5.3.4-rc0</title>

    <link rel="stylesheet" href="dist/html-erlang-ZK43ZOAC.css" />

    <script defer src="dist/sidebar_items-F5655088.js"></script>
    <script defer src="docs_config.js"></script>
    <script defer src="dist/html-DPJLHKSM.js"></script>

  </head>
  <body>
    <script>(()=>{var t="ex_doc:settings",e="dark";var o="dark",s="light";var E="sidebar_state",n="closed";var r="sidebar_width";var a="sidebar-open";var i=new URLSearchParams(window.location.search),S=i.get("theme")||JSON.parse(localStorage.getItem(t)||"{}").theme;(S===o||S!==s&&window.matchMedia("(prefers-color-scheme: dark)").matches)&&document.body.classList.add(e);var d=sessionStorage.getItem(E),A=d!==n&&!window.matchMedia(`screen and (max-width: ${768}px)`).matches;document.body.classList.toggle(a,A);var c=sessionStorage.getItem(r);c&&document.body.style.setProperty("--sidebarWidth",`${c}px`);var p=/(Macintosh|iPhone|iPad|iPod)/.test(window.navigator.userAgent);document.documentElement.classList.toggle("apple-os",p);})();
</script>

<div class="body-wrapper">

<button id="sidebar-menu" class="sidebar-button sidebar-toggle" aria-label="toggle sidebar" aria-controls="sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<nav id="sidebar" class="sidebar">

  <div class="sidebar-header">
    <div class="sidebar-projectInfo">

        <a href="../../index.html" class="sidebar-projectImage">
          <img src="assets/logo.png" alt="ssh" />
        </a>

      <div>
        <a href="../../index.html" class="sidebar-projectName" translate="no">
ssh
        </a>
        <div class="sidebar-projectVersion" translate="no">
          v5.3.4-rc0
        </div>
      </div>
    </div>
    <ul id="sidebar-list-nav" class="sidebar-list-nav" role="tablist" data-extras=""></ul>
  </div>
</nav>

<output role="status" id="toast"></output>

<main class="content page-extra" id="main" data-type="extras">
  <div id="content" class="content-inner">
    <div class="top-search">
      <div class="search-settings">
        <form class="search-bar" action="search.html">
          <label class="search-label">
            <span class="sr-only">Search documentation of ssh</span>
            <input name="q" type="text" class="search-input" placeholder="Press / to search" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
          </label>
          <button type="submit" class="search-button" aria-label="Submit Search" tabindex="-1">
            <i class="ri-search-2-line ri-lg" aria-hidden="true"></i>
          </button>
          <button type="button" tabindex="-1" class="search-close-button" aria-hidden="true">
            <i class="ri-close-line ri-lg" title="Cancel search"></i>
          </button>
        </form>
        <div class="autocomplete">
        </div>
        <button class="icon-settings display-settings">
          <i class="ri-settings-3-line"></i>
          <span class="sr-only">Settings</span>
        </button>
      </div>
    </div>

<div id="top-content">
  <div class="heading-with-actions top-heading">
    <h1>SSH Application</h1>


      <a href="https://github.com/erlang/otp/blob/master/lib/ssh/doc/ssh_app.md#L1" title="View Source" class="icon-action" rel="help">
        <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        <span class="sr-only">View Source</span>
      </a>

  </div>


<p>The ssh application implements the Secure Shell (SSH) protocol and provides an
SSH File Transfer Protocol (SFTP) client and server.</p><h2 id="description" class="section-heading"><a href="#description" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Description</span></h2><p>The <code class="inline">ssh</code> application is an implementation of the SSH protocol in Erlang. <code class="inline">ssh</code>
offers API functions to write customized SSH clients and servers as well as
making the Erlang shell available over SSH. An SFTP client, <code class="inline">ssh_sftp</code>, and
server, <code class="inline">ssh_sftpd</code>, are also included.</p><h2 id="dependencies" class="section-heading"><a href="#dependencies" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Dependencies</span></h2><p>The <code class="inline">ssh</code> application uses the applications <a href="../../apps/public_key/public_key.html"><code class="inline">public_key</code></a> and <a href="../../apps/crypto/crypto.html"><code class="inline">crypto</code></a> to
handle public keys and encryption. Hence, these applications must be loaded for
the <code class="inline">ssh</code> application to work. The call <a href="ssh.html#start/0"><code class="inline">ssh:start/0</code></a> will do the necessary
calls to <a href="../../apps/kernel/application.html#start/1">application:start/1,2</a> before it starts the
<code class="inline">ssh</code> itself.</p><h2 id="configuration" class="section-heading"><a href="#configuration" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Configuration</span></h2><p>The SSH application uses Configuration Parameters. Where to set them are
described in <a href="../../apps/kernel/config.html">config User's Guide</a> with SSH details in
<a href="configurations.html">Configuration in SSH</a>.</p><p>Some special configuration files from OpenSSH are also used:</p><ul><li><code class="inline">known_hosts</code></li><li><code class="inline">authorized_keys</code></li><li><code class="inline">authorized_keys2</code></li><li><code class="inline">id_dsa</code> <em>(supported but disabled by default)</em></li><li><code class="inline">id_rsa</code> <em>(SHA1 sign/verify are supported but disabled by default from
OTP-24)</em></li><li><code class="inline">id_ecdsa</code></li><li><code class="inline">id_ed25519</code></li><li><code class="inline">id_ed448</code></li><li><code class="inline">ssh_host_dsa_key</code> <em>(supported but disabled by default)</em></li><li><code class="inline">ssh_host_rsa_key</code> <em>(SHA1 sign/verify are supported but disabled by default
from OTP-24)</em></li><li><code class="inline">ssh_host_ecdsa_key</code></li><li><code class="inline">ssh_host_ed25519_key</code></li><li><code class="inline">ssh_host_ed448_key</code></li></ul><p>By default, <code class="inline">ssh</code> looks for <code class="inline">id_*</code>, <code class="inline">known_hosts</code>, and <code class="inline">authorized_keys</code> in
<code class="inline">~/.ssh</code>, and for the ssh_host_*_key files in <code class="inline">/etc/ssh</code>. These locations can
be changed by the options <a href="ssh_file.html#t:user_dir_common_option/0"><code class="inline">user_dir</code></a>
and <a href="ssh_file.html#t:system_dir_daemon_option/0"><code class="inline">system_dir</code></a>. More about where to
set them is described in <a href="configurations.html">Configuration in SSH</a>.</p><p>Public key handling can also be customized through a callback module that
implements the behaviors <a href="ssh_client_key_api.html"><code class="inline">ssh_client_key_api</code></a> and <a href="ssh_server_key_api.html"><code class="inline">ssh_server_key_api</code></a>.</p><p>See also the default callback module documentation in <a href="ssh_file.html"><code class="inline">ssh_file</code></a>.</p><p>Disabled public key algorithms can be enabled with the
<a href="ssh.html#t:preferred_algorithms_common_option/0">preferred_algorithms</a> or
<a href="ssh.html#t:modify_algorithms_common_option/0">modify_algorithms</a> options. See
<a href="configure_algos.html#example-9">Example 9</a> in
<a href="configure_algos.html">Configuring algorithms in SSH</a> for a description.</p><h2 id="public-keys" class="section-heading"><a href="#public-keys" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Public Keys</span></h2><p><code class="inline">id_*</code> are the users private key files. Notice that the public key is part of
the private key so the <code class="inline">ssh</code> application does not use the <code class="inline">id_*.pub</code> files.
These are for the user's convenience when it is needed to convey the user's
public key.</p><p>See <a href="ssh_file.html#FILE-id_STAR">ssh_file</a> for details.</p><h2 id="known-hosts" class="section-heading"><a href="#known-hosts" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Known Hosts</span></h2><p>The <code class="inline">known_hosts</code> file contains a list of approved servers and their public
keys. Once a server is listed, it can be verified without user interaction.</p><p>See <a href="ssh_file.html#FILE-known_hosts">ssh_file</a> for details.</p><h2 id="authorized-keys" class="section-heading"><a href="#authorized-keys" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Authorized Keys</span></h2><p>The <code class="inline">authorized_key</code> file keeps track of the user's authorized public keys. The
most common use of this file is to let users log in without entering their
password, which is supported by the Erlang <code class="inline">ssh</code> daemon.</p><p>See <a href="ssh_file.html#FILE-authorized_keys">ssh_file</a> for details.</p><h2 id="host-keys" class="section-heading"><a href="#host-keys" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Host Keys</span></h2><p>RSA, DSA (if enabled), ECDSA, ED25519 and ED448 host keys are supported and are
expected to be found in files named <code class="inline">ssh_host_rsa_key</code>, <code class="inline">ssh_host_dsa_key</code>,
<code class="inline">ssh_host_ecdsa_key</code>, <code class="inline">ssh_host_ed25519_key</code> and <code class="inline">ssh_host_ed448_key</code>.</p><p>See <a href="ssh_file.html#FILE-ssh_host_STAR_key">ssh_file</a> for details.</p><h2 id="error-logger-and-event-handlers" class="section-heading"><a href="#error-logger-and-event-handlers" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Error Logger and Event Handlers</span></h2><p>The <code class="inline">ssh</code> application uses the default <a href="../../apps/kernel/error_logger.html">OTP error logger</a> to
log unexpected errors or print information about special events.</p><p><a href="" id="supported"></a></p><h2 id="supported-specifications-and-standards" class="section-heading"><a href="#supported-specifications-and-standards" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Supported Specifications and Standards</span></h2><p>The supported SSH version is 2.0.</p><h2 id="algorithms" class="section-heading"><a href="#algorithms" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Algorithms</span></h2><p>The actual set of algorithms may vary depending on which OpenSSL crypto library
that is installed on the machine. For the list on a particular installation, use
the command <a href="ssh.html#default_algorithms/0"><code class="inline">ssh:default_algorithms/0</code></a>. The user may override the default
algorithm configuration both on the server side and the client side. See the
options <a href="ssh.html#t:preferred_algorithms_common_option/0">preferred_algorithms</a> and
<a href="ssh.html#t:modify_algorithms_common_option/0">modify_algorithms</a> in the
<a href="ssh.html#daemon/1">ssh:daemon/1,2,3</a> and <a href="ssh.html#connect/3">ssh:connect/3,4</a>
functions.</p><p>Supported algorithms are (in the default order):</p><p><a href="" id="supported_algos"></a></p><p><strong>Key exchange algorithms</strong></p><ul><li>curve25519-sha256</li><li>curve25519-sha256@libssh.org</li><li>curve448-sha512</li><li>ecdh-sha2-nistp521</li><li>ecdh-sha2-nistp384</li><li>ecdh-sha2-nistp256</li><li>diffie-hellman-group-exchange-sha256</li><li>diffie-hellman-group16-sha512</li><li>diffie-hellman-group18-sha512</li><li>diffie-hellman-group14-sha256</li></ul><p>The following unsecure <code class="inline">SHA1</code> algorithms are now disabled by default:</p><ul><li>(diffie-hellman-group14-sha1)</li><li>(diffie-hellman-group-exchange-sha1)</li><li>(diffie-hellman-group1-sha1)</li></ul><p>They can be enabled with the
<a href="ssh.html#t:preferred_algorithms_common_option/0">preferred_algorithms</a> or
<a href="ssh.html#t:modify_algorithms_common_option/0">modify_algorithms</a> options. Use
for example the Option value
<code class="inline">{modify_algorithms, [{append, [{kex,['diffie-hellman-group1-sha1']}]}]}</code>)</p><p><strong>Public key algorithms</strong></p><ul><li>ssh-ed25519</li><li>ssh-ed448</li><li>ecdsa-sha2-nistp521</li><li>ecdsa-sha2-nistp384</li><li>ecdsa-sha2-nistp256</li><li>rsa-sha2-512</li><li>rsa-sha2-256</li></ul><p>The following unsecure <code class="inline">SHA1</code> algorithms are supported but disabled by
default:</p><ul><li>(ssh-dss)</li><li>(ssh-rsa)</li></ul><p>Disabled public key algorithms can be enabled with the
<a href="ssh.html#t:preferred_algorithms_common_option/0">preferred_algorithms</a> or
<a href="ssh.html#t:modify_algorithms_common_option/0">modify_algorithms</a> options. See
<a href="configure_algos.html#example-9">Example 9</a> in
<a href="configure_algos.html">Configuring algorithms in SSH</a> for a description.</p><p><strong>MAC algorithms</strong></p><ul><li>hmac-sha2-512-etm@openssh.com</li><li>hmac-sha2-256-etm@openssh.com</li><li>hmac-sha2-512</li><li>hmac-sha2-256</li><li>hmac-sha1-etm@openssh.com</li><li>hmac-sha1</li></ul><p>The following unsecure <code class="inline">SHA1</code> algorithm is disabled by default:</p><ul><li>(hmac-sha1-96)</li></ul><p>It can be enabled with the
<a href="ssh.html#t:preferred_algorithms_common_option/0">preferred_algorithms</a> or
<a href="ssh.html#t:modify_algorithms_common_option/0">modify_algorithms</a> options. Use
for example the Option value
<code class="inline">{modify_algorithms, [{append, [{mac,['hmac-sha1-96']}]}]}</code>)</p><p><strong>Encryption algorithms (ciphers)</strong></p><ul><li>aes256-gcm@openssh.com</li><li>aes256-ctr</li><li>aes192-ctr</li><li>aes128-gcm@openssh.com</li><li>aes128-ctr</li><li>chacha20-poly1305@openssh.com</li><li>aes256-cbc</li><li>aes192-cbc</li><li>aes128-cbc</li><li>3des-cbc</li></ul><p>The following unsecure algorithms are disabled by default:</p><ul><li>(AEAD_AES_128_GCM)</li><li>(AEAD_AES_256_GCM)</li></ul><p>See the text at the description of
<a href="ssh_app.html#rfc5647_note">the rfc 5647 further down</a> for more information
regarding AEAD_AES_*_GCM.</p><p>Following the internet de-facto standard, the cipher and mac algorithm
AEAD_AES_128_GCM is selected when the cipher aes128-gcm@openssh.com is
negotiated. The cipher and mac algorithm AEAD_AES_256_GCM is selected when the
cipher aes256-gcm@openssh.com is negotiated.</p><p><strong>Compression algorithms</strong></p><ul><li>none</li><li>zlib@openssh.com</li><li>zlib</li></ul><h2 id="unicode-support" class="section-heading"><a href="#unicode-support" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">Unicode support</span></h2><p>Unicode filenames are supported if the emulator and the underlying OS supports
it. See <a href="../../apps/kernel/file.html"><code class="inline">file</code></a> manual page in Kernel for
information about this subject.</p><p>The shell and the cli both support unicode.</p><h2 id="rfcs" class="section-heading"><a href="#rfcs" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">RFCs</span></h2><p>The following RFCs are supported:</p><ul><li><p><a href="https://tools.ietf.org/html/rfc4251">RFC 4251</a>, The Secure Shell (SSH)
Protocol Architecture.</p><p>Except</p><ul><li>9.4.6 Host-Based Authentication</li><li>9.5.2 Proxy Forwarding</li><li>9.5.3 X11 Forwarding</li></ul></li><li><p><a href="https://tools.ietf.org/html/rfc4252">RFC 4252</a>, The Secure Shell (SSH)
Authentication Protocol.</p><p>Except</p><ul><li>9. Host-Based Authentication: &quot;hostbased&quot;</li></ul></li><li><p><a href="https://tools.ietf.org/html/rfc4253">RFC 4253</a>, The Secure Shell (SSH)
Transport Layer Protocol.</p><p>Except</p><ul><li>8.1. diffie-hellman-group1-sha1</li><li>6.6. Public Key Algorithms<ul><li>ssh-dss</li><li>ssh-rsa</li></ul></li></ul><p>They are disabled by default as they now are regarded insecure, but they can
be enabled with the
<a href="ssh.html#t:preferred_algorithms_common_option/0">preferred_algorithms</a> or
<a href="ssh.html#t:modify_algorithms_common_option/0">modify_algorithms</a> options. See
<a href="configure_algos.html#example-8">Example 8</a> (diffie-hellman-group1-sha1) and
<a href="configure_algos.html#example-9">Example 9</a> (ssh-dss) in
<a href="configure_algos.html">Configuring algorithms in SSH</a> for descriptions.</p></li><li><p><a href="https://tools.ietf.org/html/rfc4254">RFC 4254</a>, The Secure Shell (SSH)
Connection Protocol.</p><p>Except</p><ul><li>6.3. X11 Forwarding</li><li>7. TCP/IP Port Forwarding</li></ul></li><li><p><a href="https://tools.ietf.org/html/rfc4256">RFC 4256</a>, Generic Message Exchange
Authentication for the Secure Shell Protocol (SSH).</p><p>Except</p><ul><li><code class="inline">num-prompts &gt; 1</code></li><li>password changing</li><li>other identification methods than userid-password</li></ul></li><li><p><a href="https://tools.ietf.org/html/rfc4419">RFC 4419</a>, Diffie-Hellman Group Exchange
for the Secure Shell (SSH) Transport Layer Protocol.</p><p>Except</p><ul><li>4.1. diffie-hellman-group-exchange-sha1</li></ul><p>It is disabled by default as it now is regarded insecure, but it can be
enabled with the
<a href="ssh.html#t:preferred_algorithms_common_option/0">preferred_algorithms</a> or
<a href="ssh.html#t:modify_algorithms_common_option/0">modify_algorithms</a> options.</p></li><li><p><a href="https://tools.ietf.org/html/rfc4716">RFC 4716</a>, The Secure Shell (SSH) Public
Key File Format.</p></li><li><p><a href="https://tools.ietf.org/html/rfc5647">RFC 5647</a>, AES Galois Counter Mode for
the Secure Shell Transport Layer Protocol.</p><p><a href="" id="rfc5647_note"></a> There is an ambiguity in the synchronized selection of
cipher and mac algorithm. This is resolved by OpenSSH in the ciphers
aes128-gcm@openssh.com and aes256-gcm@openssh.com which are implemented. If
the explicit ciphers and macs AEAD_AES_128_GCM or AEAD_AES_256_GCM are needed,
they could be enabled with the options
<a href="ssh.html#t:preferred_algorithms_common_option/0">preferred_algorithms</a> or
<a href="ssh.html#t:modify_algorithms_common_option/0">modify_algorithms</a>.</p><section role="note" class="admonition warning"><h4 class="admonition-title warning">Warning</h4><p>If the client or the server is not Erlang/OTP, it is the users
responsibility to check that other implementation has the same
interpretation of AEAD_AES_*_GCM as the Erlang/OTP SSH before enabling
them. The aes*-gcm@openssh.com variants are always safe to use since they
lack the ambiguity.</p></section><p>The second paragraph in section 5.1 is resolved as:</p><ol><li>If the negotiated cipher is AEAD_AES_128_GCM, the mac algorithm is set to
AEAD_AES_128_GCM.</li><li>If the negotiated cipher is AEAD_AES_256_GCM, the mac algorithm is set to
AEAD_AES_256_GCM.</li><li>If the mac algorithm is AEAD_AES_128_GCM, the cipher is set to
AEAD_AES_128_GCM.</li><li>If the mac algorithm is AEAD_AES_256_GCM, the cipher is set to
AEAD_AES_256_GCM.</li></ol><p>The first rule that matches when read in order from the top is applied</p></li><li><p><a href="https://tools.ietf.org/html/rfc5656">RFC 5656</a>, Elliptic Curve Algorithm
Integration in the Secure Shell Transport Layer.</p><p>Except</p><ul><li>5. ECMQV Key Exchange</li><li>6.4. ECMQV Key Exchange and Verification Method Name</li><li>7.2. ECMQV Message Numbers</li><li>10.2. Recommended Curves</li></ul></li><li><p><a href="https://tools.ietf.org/html/rfc6668">RFC 6668</a>, SHA-2 Data Integrity
Verification for the Secure Shell (SSH) Transport Layer Protocol</p><p>Comment: Defines hmac-sha2-256 and hmac-sha2-512</p></li><li><p><a href="https://tools.ietf.org/html/draft-ietf-curdle-ssh-kex-sha2">Draft-ietf-curdle-ssh-kex-sha2 (work in progress)</a>,
Key Exchange (KEX) Method Updates and Recommendations for Secure Shell (SSH).</p><p>Deviations:</p><ul><li><code class="inline">diffie-hellman-group1-sha1</code></li><li><code class="inline">diffie-hellman-group-exchange-sha1</code></li><li><code class="inline">diffie-hellman-group14-sha1</code></li></ul><p>are not enabled by default as they now are regarded insecure, but are still
supported and can be enabled with the options
<a href="ssh.html#t:preferred_algorithms_common_option/0">preferred_algorithms</a> or
<a href="ssh.html#t:modify_algorithms_common_option/0">modify_algorithms</a>.</p></li><li><p><a href="https://tools.ietf.org/html/rfc8332">RFC 8332</a>, Use of RSA Keys with SHA-256
and SHA-512 in the Secure Shell (SSH) Protocol.</p></li><li><p><a href="" id="supported-ext-info"></a> <a href="https://tools.ietf.org/html/rfc8308">RFC 8308</a>,
Extension Negotiation in the Secure Shell (SSH) Protocol.</p><p>Implemented are:</p><ul><li>The Extension Negotiation Mechanism</li><li>The extension <code class="inline">server-sig-algs</code></li></ul></li><li><p><a href="https://tools.ietf.org/html/rfc8731">Secure Shell (SSH) Key Exchange Method Using Curve25519 and Curve448</a></p></li><li><p><a href="https://tools.ietf.org/html/rfc8709">RFC 8709</a> Ed25519 and Ed448 public key
algorithms for the Secure Shell (SSH) protocol</p></li></ul><h2 id="see-also" class="section-heading"><a href="#see-also" class="hover-link"><i class="ri-link-m" aria-hidden="true"></i></a><span class="text">See Also</span></h2><p><a href="../../apps/kernel/application.html"><code class="inline">application</code></a></p>

</div>

<div class="bottom-actions" id="bottom-actions">
  <div class="bottom-actions-item">

  </div>
  <div class="bottom-actions-item">

      <a href="notes.html" class="bottom-actions-button" rel="next">
        <span class="subheader">
          Next Page →
        </span>
        <span class="title">
SSH Release Notes
        </span>
      </a>

  </div>
</div>
    <footer class="footer">
      <p>

        <span class="line">
          <button class="a-main footer-button display-quick-switch" title="Search HexDocs packages">
            Search HexDocs
          </button>

            <a href="ssh.epub" title="ePub version">
              Download ePub version
            </a>

        </span>
      </p>

      <p class="built-using">
        Built using
        <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.38.1) for the

          <a href="https://erlang.org" title="Erlang" target="_blank" translate="no">Erlang programming language</a>

      </p>
<p>Copyright © 1996-2025 <a href="https://www.ericsson.com">Ericsson AB</a></p>
    </footer>
  </div>
</main>
</div>
  <script defer src="https://cdn.jsdelivr.net/npm/mermaid@11.4.1/dist/mermaid.min.js"></script>
  <script>
  let initialized = false;

  window.addEventListener("exdoc:loaded", () => {
      if (!initialized) {
      mermaid.initialize({
          startOnLoad: false,
          theme: document.body.className.includes("dark") ? "dark" : "default"
      });
      initialized = true;
      }

      let id = 0;
      for (const codeEl of document.querySelectorAll("pre code.mermaid")) {
      const preEl = codeEl.parentElement;
      const graphDefinition = codeEl.textContent;
      const graphEl = document.createElement("div");
      const graphId = "mermaid-graph-" + id++;
      mermaid.render(graphId, graphDefinition).then(({svg, bindFunctions}) => {
          graphEl.innerHTML = svg;
          bindFunctions?.(graphEl);
          preEl.insertAdjacentElement("afterend", graphEl);
          preEl.remove();
      });
      }
  });
  </script>

  </body>
</html>
