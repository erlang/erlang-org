<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.38.1">
    <meta name="project" content="runtime_tools v2.2-rc0">


<meta name="exdoc:full-text-search-url" content="/doc/search.html?v=29&q=">
<meta name="major-vsn" content="29">
<link rel="canonical" href="https://www.erlang.org/docs/29/apps/runtime_tools/msacc.html" />
    <title>msacc â€” runtime_tools v2.2-rc0</title>

    <link rel="stylesheet" href="dist/html-erlang-ZK43ZOAC.css" />

    <script defer src="dist/sidebar_items-94A75ABE.js"></script>
    <script defer src="docs_config.js"></script>
    <script defer src="dist/html-DPJLHKSM.js"></script>

  </head>
  <body>
    <script>(()=>{var t="ex_doc:settings",e="dark";var o="dark",s="light";var E="sidebar_state",n="closed";var r="sidebar_width";var a="sidebar-open";var i=new URLSearchParams(window.location.search),S=i.get("theme")||JSON.parse(localStorage.getItem(t)||"{}").theme;(S===o||S!==s&&window.matchMedia("(prefers-color-scheme: dark)").matches)&&document.body.classList.add(e);var d=sessionStorage.getItem(E),A=d!==n&&!window.matchMedia(`screen and (max-width: ${768}px)`).matches;document.body.classList.toggle(a,A);var c=sessionStorage.getItem(r);c&&document.body.style.setProperty("--sidebarWidth",`${c}px`);var p=/(Macintosh|iPhone|iPad|iPod)/.test(window.navigator.userAgent);document.documentElement.classList.toggle("apple-os",p);})();
</script>

<div class="body-wrapper">

<button id="sidebar-menu" class="sidebar-button sidebar-toggle" aria-label="toggle sidebar" aria-controls="sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<nav id="sidebar" class="sidebar">

  <div class="sidebar-header">
    <div class="sidebar-projectInfo">

        <a href="../../index.html" class="sidebar-projectImage">
          <img src="assets/logo.png" alt="runtime_tools" />
        </a>

      <div>
        <a href="../../index.html" class="sidebar-projectName" translate="no">
runtime_tools
        </a>
        <div class="sidebar-projectVersion" translate="no">
          v2.2-rc0
        </div>
      </div>
    </div>
    <ul id="sidebar-list-nav" class="sidebar-list-nav" role="tablist" data-extras=""></ul>
  </div>
</nav>

<output role="status" id="toast"></output>

<main class="content page-module" id="main" data-type="modules">
  <div id="content" class="content-inner">
    <div class="top-search">
      <div class="search-settings">
        <form class="search-bar" action="search.html">
          <label class="search-label">
            <span class="sr-only">Search documentation of runtime_tools</span>
            <input name="q" type="text" class="search-input" placeholder="Press / to search" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
          </label>
          <button type="submit" class="search-button" aria-label="Submit Search" tabindex="-1">
            <i class="ri-search-2-line ri-lg" aria-hidden="true"></i>
          </button>
          <button type="button" tabindex="-1" class="search-close-button" aria-hidden="true">
            <i class="ri-close-line ri-lg" title="Cancel search"></i>
          </button>
        </form>
        <div class="autocomplete">
        </div>
        <button class="icon-settings display-settings">
          <i class="ri-settings-3-line"></i>
          <span class="sr-only">Settings</span>
        </button>
      </div>
    </div>

<div id="top-content">
  <div class="heading-with-actions top-heading">
    <h1>
      <span translate="no">msacc</span> 
      <small class="app-vsn" translate="no">(runtime_tools v2.2-rc0)</small>

    </h1>

      <a href="https://github.com/erlang/otp/blob/master/lib/runtime_tools/src/msacc.erl#L30" title="View Source" class="icon-action" rel="help">
        <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        <span class="sr-only">View Source</span>
      </a>

  </div>


    <section id="moduledoc">
<p>Convenience functions for microstate accounting</p><p>This module implements some convenience functions for analyzing microstate
accounting data. For details about how to use the basic API and what the
different states represent, see
<a href="../../apps/erts/erlang.html#statistics_microstate_accounting"><code class="inline">erlang:statistics(microstate_accounting)</code></a>.</p><p><a href="" id="msacc_print_example"></a></p><p><em>Basic Scenario</em></p><pre><code class="makeup erlang" translate="no"><span class="gp unselectable">1&gt; </span><span class="nc">msacc</span><span class="p">:</span><span class="nf">start</span><span class="p" data-group-id="4138655315-1">(</span><span class="mi">1000</span><span class="p" data-group-id="4138655315-1">)</span><span class="p">.</span><span class="w">
</span><span class="ss">ok</span><span class="gp unselectable">
2&gt; </span><span class="nc">msacc</span><span class="p">:</span><span class="nf">print</span><span class="p" data-group-id="4138655315-2">(</span><span class="p" data-group-id="4138655315-2">)</span><span class="p">.</span><span class="w">
</span><span class="n">Average</span><span class="w"> </span><span class="ss">thread</span><span class="w"> </span><span class="ss">real</span><span class="o">-</span><span class="ss">time</span><span class="w">    </span><span class="p">:</span><span class="w"> </span><span class="mi">1000513</span><span class="w"> </span><span class="ss">us</span><span class="w">
</span><span class="n">Accumulated</span><span class="w"> </span><span class="ss">system</span><span class="w"> </span><span class="ss">run</span><span class="o">-</span><span class="ss">time</span><span class="w"> </span><span class="p">:</span><span class="w">    </span><span class="mi">2213</span><span class="w"> </span><span class="ss">us</span><span class="w">
</span><span class="n">Average</span><span class="w"> </span><span class="ss">scheduler</span><span class="w"> </span><span class="ss">run</span><span class="o">-</span><span class="ss">time</span><span class="w">  </span><span class="p">:</span><span class="w">    </span><span class="mi">1076</span><span class="w"> </span><span class="ss">us</span><span class="w">

        </span><span class="n">Thread</span><span class="w">      </span><span class="ss">aux</span><span class="w"> </span><span class="ss">check_io</span><span class="w"> </span><span class="ss">emulator</span><span class="w">       </span><span class="ss">gc</span><span class="w">    </span><span class="ss">other</span><span class="w">     </span><span class="ss">port</span><span class="w">    </span><span class="ss">sleep</span><span class="w">

</span><span class="n">Stats</span><span class="w"> </span><span class="ss">per</span><span class="w"> </span><span class="nc">thread</span><span class="p">:</span><span class="w">
     </span><span class="nf">async</span><span class="p" data-group-id="4138655315-3">(</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="4138655315-3">)</span><span class="w">    </span><span class="mf">0.00</span><span class="c1">%    0.00%    0.00%    0.00%    0.00%    0.00%  100.00%</span><span class="w">
     </span><span class="nf">async</span><span class="p" data-group-id="4138655315-4">(</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="4138655315-4">)</span><span class="w">    </span><span class="mf">0.00</span><span class="c1">%    0.00%    0.00%    0.00%    0.00%    0.00%  100.00%</span><span class="w">
       </span><span class="nf">aux</span><span class="p" data-group-id="4138655315-5">(</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="4138655315-5">)</span><span class="w">    </span><span class="mf">0.00</span><span class="c1">%    0.00%    0.00%    0.00%    0.00%    0.00%   99.99%</span><span class="w">
 </span><span class="nf">scheduler</span><span class="p" data-group-id="4138655315-6">(</span><span class="w"> </span><span class="mi">1</span><span class="p" data-group-id="4138655315-6">)</span><span class="w">    </span><span class="mf">0.00</span><span class="c1">%    0.03%    0.13%    0.00%    0.01%    0.00%   99.82%</span><span class="w">
 </span><span class="nf">scheduler</span><span class="p" data-group-id="4138655315-7">(</span><span class="w"> </span><span class="mi">2</span><span class="p" data-group-id="4138655315-7">)</span><span class="w">    </span><span class="mf">0.00</span><span class="c1">%    0.00%    0.00%    0.00%    0.03%    0.00%   99.97%</span><span class="w">

</span><span class="n">Stats</span><span class="w"> </span><span class="ss">per</span><span class="w"> </span><span class="nc">type</span><span class="p">:</span><span class="w">
         </span><span class="ss">async</span><span class="w">    </span><span class="mf">0.00</span><span class="c1">%    0.00%    0.00%    0.00%    0.00%    0.00%  100.00%</span><span class="w">
           </span><span class="ss">aux</span><span class="w">    </span><span class="mf">0.00</span><span class="c1">%    0.00%    0.00%    0.00%    0.00%    0.00%   99.99%</span><span class="w">
     </span><span class="ss">scheduler</span><span class="w">    </span><span class="mf">0.00</span><span class="c1">%    0.02%    0.06%    0.00%    0.02%    0.00%   99.89%</span><span class="w">
</span><span class="ss">ok</span></code></pre><p>This first command enables microstate accounting for 1000 milliseconds. See
<a href="#start/0"><code class="inline">start/0</code></a>, <a href="#stop/0"><code class="inline">stop/0</code></a>, <a href="#reset/0"><code class="inline">reset/0</code></a>, and <a href="#start/1"><code class="inline">start/1</code></a> for more details. The second
command prints the statistics gathered during that time. First three general
statistics are printed.</p><ul><li><p><strong>Average real-time</strong> - The average time spent collecting data in the threads.
This should be close to the time which data was collected.</p></li><li><p><strong>System run-time</strong> - The total run-time of all threads in the system. This is
what you get if you call <code class="inline">msacc:stats(total_runtime,Stats).</code></p></li><li><p><strong>Average scheduler run-time</strong> - The average run-time for the schedulers. This
is the average amount of time the schedulers did not sleep.</p></li></ul><p>Then one column per state is printed with a the percentage of time this thread
spent in the state out of it's own real-time. After the thread specific time,
the accumulated time for each type of thread is printed in a similar format.</p><p>Since we have the average real-time and the percentage spent in each state we
can easily calculate the time spent in each state by multiplying
<code class="inline">Average thread real-time</code> with <code class="inline">Thread state %</code>, that is, to get the time Scheduler
1 spent in the emulator state we do <code class="inline">1000513us * 0.13% = 1300us</code>.</p>
    </section>

</div>

  <section id="summary" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#summary">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Summary</span>
    </h1>
<div class="summary-types summary">
  <h2>
    <a href="#types">Types</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:msacc_data/0" data-no-tooltip="" translate="no">msacc_data()</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:msacc_data_counters/0" data-no-tooltip="" translate="no">msacc_data_counters()</a>

      </div>

        <div class="summary-synopsis"><p>A map containing the different microstate accounting states and the number of
microseconds spent in it.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:msacc_data_thread/0" data-no-tooltip="" translate="no">msacc_data_thread()</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:msacc_id/0" data-no-tooltip="" translate="no">msacc_id()</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:msacc_print_options/0" data-no-tooltip="" translate="no">msacc_print_options()</a>

      </div>

        <div class="summary-synopsis"><p>The different options that can be given to <a><code class="inline">print/2</code></a>.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:msacc_state/0" data-no-tooltip="" translate="no">msacc_state()</a>

      </div>

        <div class="summary-synopsis"><p>The different states that a thread can be in. See
<a>erlang:statistics(microstate_accounting)</a>
for details.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:msacc_stats/0" data-no-tooltip="" translate="no">msacc_stats()</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:msacc_stats_counters/0" data-no-tooltip="" translate="no">msacc_stats_counters()</a>

      </div>

        <div class="summary-synopsis"><p>A map containing the different microstate accounting states. Each value in the
map contains another map with the percentage of time that this thread has spent
in the specific state. Both the percentage of <code class="inline">system</code> time and the time for
that specific <code class="inline">thread</code> is part of the map.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:msacc_stats_thread/0" data-no-tooltip="" translate="no">msacc_stats_thread()</a>

      </div>

        <div class="summary-synopsis"><p>A map containing information about a specific thread. The percentages in the map
can be either run-time or real-time depending on if <code class="inline">runtime</code> or <code class="inline">realtime</code> was
requested from <a><code class="inline">stats/2</code></a>. <code class="inline">system</code> is the percentage of total system time for
this specific thread.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:msacc_type/0" data-no-tooltip="" translate="no">msacc_type()</a>

      </div>

    </div>

</div>
<div class="summary-functions summary">
  <h2>
    <a href="#functions">Functions</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#available/0" data-no-tooltip="" translate="no">available()</a>

      </div>

        <div class="summary-synopsis"><p>This function checks whether microstate accounting is available or not.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#from_file/1" data-no-tooltip="" translate="no">from_file(Filename)</a>

      </div>

        <div class="summary-synopsis"><p>Read a file dump produced by <a>to_file(Filename)</a>.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#print/0" data-no-tooltip="" translate="no">print()</a>

      </div>

        <div class="summary-synopsis"><p>Prints the current microstate accounting to standard out. Equivalent to
<a><code class="inline">msacc:print(msacc:stats(), #{}).</code></a></p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#print/1" data-no-tooltip="" translate="no">print(DataOrStats)</a>

      </div>

        <div class="summary-synopsis"><p>Equivalent to <a><code class="inline">print(DataOrStats, #{})</code></a>.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#print/2" data-no-tooltip="" translate="no">print(DataOrStats, Options)</a>

      </div>

        <div class="summary-synopsis"><p>Print the given microstate statistics values to standard out. With many states
this can be verbose. See the top of this reference manual for a brief
description of what the fields mean.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#print/3" data-no-tooltip="" translate="no">print(FileOrDevice, DataOrStats, Options)</a>

      </div>

        <div class="summary-synopsis"><p>Print the given microstate statistics values to the given file or device. The
other arguments behave the same way as for <a><code class="inline">print/2</code></a>.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#reset/0" data-no-tooltip="" translate="no">reset()</a>

      </div>

        <div class="summary-synopsis"><p>Reset microstate accounting counters. Returns whether is was enabled or
disabled.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#start/0" data-no-tooltip="" translate="no">start()</a>

      </div>

        <div class="summary-synopsis"><p>Start microstate accounting. Returns whether it was previously enabled or
disabled.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#start/1" data-no-tooltip="" translate="no">start(Time)</a>

      </div>

        <div class="summary-synopsis"><p>Resets all counters and then starts microstate accounting for the given
milliseconds.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#stats/0" data-no-tooltip="" translate="no">stats()</a>

      </div>

        <div class="summary-synopsis"><p>Returns a runtime system independent version of the microstate statistics data
presented by
<a><code class="inline">erlang:statistics(microstate_accounting)</code></a>.
All counters have been normalized to be in microsecond resolution.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#stats/2" data-no-tooltip="" translate="no">stats/2</a>

      </div>

        <div class="summary-synopsis"><p>Returns the system time for the given microstate statistics values. System time
is the accumulated time of all threads.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#stop/0" data-no-tooltip="" translate="no">stop()</a>

      </div>

        <div class="summary-synopsis"><p>Stop microstate accounting. Returns whether is was previously enabled or
disabled.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#to_file/1" data-no-tooltip="" translate="no">to_file(Filename)</a>

      </div>

        <div class="summary-synopsis"><p>Dumps the current microstate statistics counters to a file that can be parsed
with <a><code class="inline">file:consult/1</code></a>.</p></div>

    </div>

</div>

  </section>


  <section id="types" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#types">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Types</span>
    </h1>
    <div class="types-list">
<section class="detail" id="t:msacc_data/0">

  <div class="detail-header">
    <a href="#t:msacc_data/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">msacc_data()</h1>

        <span class="note">(not exported)</span>

        <span class="note">(since OTP 19.0)</span>


        <a href="https://github.com/erlang/otp/blob/master/lib/runtime_tools/src/msacc.erl#L95" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> msacc_data() :: [<a href="#t:msacc_data_thread/0">msacc_data_thread</a>()].</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:msacc_data_counters/0">

  <div class="detail-header">
    <a href="#t:msacc_data_counters/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">msacc_data_counters()</h1>

        <span class="note">(not exported)</span>

        <span class="note">(since OTP 19.0)</span>


        <a href="https://github.com/erlang/otp/blob/master/lib/runtime_tools/src/msacc.erl#L104" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> msacc_data_counters() :: #{<a href="#t:msacc_state/0">msacc_state</a>() => <a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>()}.</pre>

      </div>

<p>A map containing the different microstate accounting states and the number of
microseconds spent in it.</p>
  </section>
</section>
<section class="detail" id="t:msacc_data_thread/0">

  <div class="detail-header">
    <a href="#t:msacc_data_thread/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">msacc_data_thread()</h1>

        <span class="note">(not exported)</span>

        <span class="note">(since OTP 19.0)</span>


        <a href="https://github.com/erlang/otp/blob/master/lib/runtime_tools/src/msacc.erl#L97" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> msacc_data_thread() ::
          #{'$type' := msacc_data,
            type := <a href="#t:msacc_type/0">msacc_type</a>(),
            id := <a href="#t:msacc_id/0">msacc_id</a>(),
            counters := <a href="#t:msacc_data_counters/0">msacc_data_counters</a>()}.</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:msacc_id/0">

  <div class="detail-header">
    <a href="#t:msacc_id/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">msacc_id()</h1>

        <span class="note">(not exported)</span>

        <span class="note">(since OTP 19.0)</span>


        <a href="https://github.com/erlang/otp/blob/master/lib/runtime_tools/src/msacc.erl#L129" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> msacc_id() :: <a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>().</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:msacc_print_options/0">

  <div class="detail-header">
    <a href="#t:msacc_print_options/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">msacc_print_options()</h1>

        <span class="note">(not exported)</span>

        <span class="note">(since OTP 19.0)</span>


        <a href="https://github.com/erlang/otp/blob/master/lib/runtime_tools/src/msacc.erl#L140" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> msacc_print_options() :: #{system => <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>()}.</pre>

      </div>

<p>The different options that can be given to <a href="#print/2"><code class="inline">print/2</code></a>.</p>
  </section>
</section>
<section class="detail" id="t:msacc_state/0">

  <div class="detail-header">
    <a href="#t:msacc_state/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">msacc_state()</h1>

        <span class="note">(not exported)</span>

        <span class="note">(since OTP 19.0)</span>


        <a href="https://github.com/erlang/otp/blob/master/lib/runtime_tools/src/msacc.erl#L135" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> msacc_state() ::
          alloc | aux | bif | busy_wait | check_io | emulator | ets | gc | gc_fullsweep | nif | other |
          port | send | sleep | timers.</pre>

      </div>

<p>The different states that a thread can be in. See
<a href="../../apps/erts/erlang.html#statistics_microstate_accounting">erlang:statistics(microstate_accounting)</a>
for details.</p>
  </section>
</section>
<section class="detail" id="t:msacc_stats/0">

  <div class="detail-header">
    <a href="#t:msacc_stats/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">msacc_stats()</h1>

        <span class="note">(not exported)</span>

        <span class="note">(since OTP 19.0)</span>


        <a href="https://github.com/erlang/otp/blob/master/lib/runtime_tools/src/msacc.erl#L106" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> msacc_stats() :: [<a href="#t:msacc_stats_thread/0">msacc_stats_thread</a>()].</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:msacc_stats_counters/0">

  <div class="detail-header">
    <a href="#t:msacc_stats_counters/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">msacc_stats_counters()</h1>

        <span class="note">(not exported)</span>

        <span class="note">(since OTP 19.0)</span>


        <a href="https://github.com/erlang/otp/blob/master/lib/runtime_tools/src/msacc.erl#L123" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> msacc_stats_counters() :: #{<a href="#t:msacc_state/0">msacc_state</a>() => #{thread := <a href="../../apps/erts/erlang.html#t:float/0">float</a>(), system := <a href="../../apps/erts/erlang.html#t:float/0">float</a>()}}.</pre>

      </div>

<p>A map containing the different microstate accounting states. Each value in the
map contains another map with the percentage of time that this thread has spent
in the specific state. Both the percentage of <code class="inline">system</code> time and the time for
that specific <code class="inline">thread</code> is part of the map.</p>
  </section>
</section>
<section class="detail" id="t:msacc_stats_thread/0">

  <div class="detail-header">
    <a href="#t:msacc_stats_thread/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">msacc_stats_thread()</h1>

        <span class="note">(not exported)</span>

        <span class="note">(since OTP 19.0)</span>


        <a href="https://github.com/erlang/otp/blob/master/lib/runtime_tools/src/msacc.erl#L113" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> msacc_stats_thread() ::
          #{'$type' := msacc_stats,
            type := <a href="#t:msacc_type/0">msacc_type</a>(),
            id := <a href="#t:msacc_id/0">msacc_id</a>(),
            system := <a href="../../apps/erts/erlang.html#t:float/0">float</a>(),
            counters := <a href="#t:msacc_stats_counters/0">msacc_stats_counters</a>()}.</pre>

      </div>

<p>A map containing information about a specific thread. The percentages in the map
can be either run-time or real-time depending on if <code class="inline">runtime</code> or <code class="inline">realtime</code> was
requested from <a href="#stats/2"><code class="inline">stats/2</code></a>. <code class="inline">system</code> is the percentage of total system time for
this specific thread.</p>
  </section>
</section>
<section class="detail" id="t:msacc_type/0">

  <div class="detail-header">
    <a href="#t:msacc_type/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">msacc_type()</h1>

        <span class="note">(not exported)</span>

        <span class="note">(since OTP 19.0)</span>


        <a href="https://github.com/erlang/otp/blob/master/lib/runtime_tools/src/msacc.erl#L127" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> msacc_type() :: aux | async | dirty_cpu_scheduler | dirty_io_scheduler | poll | scheduler.</pre>

      </div>


  </section>
</section>

    </div>
  </section>

  <section id="functions" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#functions">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Functions</span>
    </h1>
    <div class="functions-list">
<section class="detail" id="available/0">

  <div class="detail-header">
    <a href="#available/0" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">available()</h1>

        <span class="note">(since OTP 19.0)</span>


        <a href="https://github.com/erlang/otp/blob/master/lib/runtime_tools/src/msacc.erl#L145" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> available() -> <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>().</pre>

      </div>

<p>This function checks whether microstate accounting is available or not.</p>
  </section>
</section>
<section class="detail" id="from_file/1">

  <div class="detail-header">
    <a href="#from_file/1" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">from_file(Filename)</h1>

        <span class="note">(since OTP 19.0)</span>


        <a href="https://github.com/erlang/otp/blob/master/lib/runtime_tools/src/msacc.erl#L206" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> from_file(Filename) -> <a href="#t:msacc_data/0">msacc_data</a>() when Filename :: <a href="../../apps/kernel/file.html#t:name_all/0">file:name_all</a>().</pre>

      </div>

<p>Read a file dump produced by <a href="#to_file/1">to_file(Filename)</a>.</p>
  </section>
</section>
<section class="detail" id="print/0">

  <div class="detail-header">
    <a href="#print/0" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">print()</h1>

        <span class="note">(since OTP 19.0)</span>


        <a href="https://github.com/erlang/otp/blob/master/lib/runtime_tools/src/msacc.erl#L216" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> print() -> ok.</pre>

      </div>

<p>Prints the current microstate accounting to standard out. Equivalent to
<a href="#print/1"><code class="inline">msacc:print(msacc:stats(), #{}).</code></a></p>
  </section>
</section>
<section class="detail" id="print/1">

  <div class="detail-header">
    <a href="#print/1" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">print(DataOrStats)</h1>

        <span class="note">(since OTP 19.0)</span>


        <a href="https://github.com/erlang/otp/blob/master/lib/runtime_tools/src/msacc.erl#L223" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> print(DataOrStats) -> ok when DataOrStats :: <a href="#t:msacc_data/0">msacc_data</a>() | <a href="#t:msacc_stats/0">msacc_stats</a>().</pre>

      </div>

<p>Equivalent to <a href="#print/2"><code class="inline">print(DataOrStats, #{})</code></a>.</p>
  </section>
</section>
<section class="detail" id="print/2">

  <div class="detail-header">
    <a href="#print/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">print(DataOrStats, Options)</h1>

        <span class="note">(since OTP 19.0)</span>


        <a href="https://github.com/erlang/otp/blob/master/lib/runtime_tools/src/msacc.erl#L254" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> print(DataOrStats, Options) -> ok
               when DataOrStats :: <a href="#t:msacc_data/0">msacc_data</a>() | <a href="#t:msacc_stats/0">msacc_stats</a>(), Options :: <a href="#t:msacc_print_options/0">msacc_print_options</a>().</pre>

      </div>

<p>Print the given microstate statistics values to standard out. With many states
this can be verbose. See the top of this reference manual for a brief
description of what the fields mean.</p><p>It is possible to print more specific types of statistics by first manipulating
the <code class="inline">DataOrStats</code> using <a href="#stats/2"><code class="inline">stats/2</code></a>. For instance if you want to print the
percentage of run-time for each thread you can do:</p><pre><code class="makeup erlang" translate="no"><span class="nc">msacc</span><span class="p">:</span><span class="nf">print</span><span class="p" data-group-id="0066280001-1">(</span><span class="nc">msacc</span><span class="p">:</span><span class="nf">stats</span><span class="p" data-group-id="0066280001-2">(</span><span class="ss">runtime</span><span class="p">,</span><span class="w"> </span><span class="nc">msacc</span><span class="p">:</span><span class="nf">stats</span><span class="p" data-group-id="0066280001-3">(</span><span class="p" data-group-id="0066280001-3">)</span><span class="p" data-group-id="0066280001-2">)</span><span class="p" data-group-id="0066280001-1">)</span><span class="p">.</span></code></pre><p>If you want to only print run-time per thread type you can do:</p><pre><code class="makeup erlang" translate="no"><span class="nc">msacc</span><span class="p">:</span><span class="nf">print</span><span class="p" data-group-id="8252467048-1">(</span><span class="nc">msacc</span><span class="p">:</span><span class="nf">stats</span><span class="p" data-group-id="8252467048-2">(</span><span class="ss">type</span><span class="p">,</span><span class="w"> </span><span class="nc">msacc</span><span class="p">:</span><span class="nf">stats</span><span class="p" data-group-id="8252467048-3">(</span><span class="ss">runtime</span><span class="p">,</span><span class="w"> </span><span class="nc">msacc</span><span class="p">:</span><span class="nf">stats</span><span class="p" data-group-id="8252467048-4">(</span><span class="p" data-group-id="8252467048-4">)</span><span class="p" data-group-id="8252467048-3">)</span><span class="p" data-group-id="8252467048-2">)</span><span class="p" data-group-id="8252467048-1">)</span><span class="p">.</span></code></pre><p><em>Options</em></p><ul><li><strong><code class="inline">system</code></strong> - Print percentage of time spent in each state out of system time
as well as thread time. Default: false.</li></ul>
  </section>
</section>
<section class="detail" id="print/3">

  <div class="detail-header">
    <a href="#print/3" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">print(FileOrDevice, DataOrStats, Options)</h1>

        <span class="note">(since OTP 19.0)</span>


        <a href="https://github.com/erlang/otp/blob/master/lib/runtime_tools/src/msacc.erl#L266" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> print(FileOrDevice, DataOrStats, Options) -> ok
               when
                   FileOrDevice :: <a href="../../apps/kernel/file.html#t:filename/0">file:filename</a>() | <a href="../../apps/stdlib/io.html#t:device/0">io:device</a>(),
                   DataOrStats :: <a href="#t:msacc_data/0">msacc_data</a>() | <a href="#t:msacc_stats/0">msacc_stats</a>(),
                   Options :: <a href="#t:msacc_print_options/0">msacc_print_options</a>().</pre>

      </div>

<p>Print the given microstate statistics values to the given file or device. The
other arguments behave the same way as for <a href="#print/2"><code class="inline">print/2</code></a>.</p>
  </section>
</section>
<section class="detail" id="reset/0">

  <div class="detail-header">
    <a href="#reset/0" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">reset()</h1>

        <span class="note">(since OTP 19.0)</span>


        <a href="https://github.com/erlang/otp/blob/master/lib/runtime_tools/src/msacc.erl#L177" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> reset() -> <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>().</pre>

      </div>

<p>Reset microstate accounting counters. Returns whether is was enabled or
disabled.</p>
  </section>
</section>
<section class="detail" id="start/0">

  <div class="detail-header">
    <a href="#start/0" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">start()</h1>

        <span class="note">(since OTP 19.0)</span>


        <a href="https://github.com/erlang/otp/blob/master/lib/runtime_tools/src/msacc.erl#L159" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> start() -> <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>().</pre>

      </div>

<p>Start microstate accounting. Returns whether it was previously enabled or
disabled.</p>
  </section>
</section>
<section class="detail" id="start/1">

  <div class="detail-header">
    <a href="#start/1" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">start(Time)</h1>

        <span class="note">(since OTP 19.0)</span>


        <a href="https://github.com/erlang/otp/blob/master/lib/runtime_tools/src/msacc.erl#L187" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> start(Time) -> true when Time :: <a href="../../apps/erts/erlang.html#t:timeout/0">timeout</a>().</pre>

      </div>

<p>Resets all counters and then starts microstate accounting for the given
milliseconds.</p>
  </section>
</section>
<section class="detail" id="stats/0">

  <div class="detail-header">
    <a href="#stats/0" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">stats()</h1>

        <span class="note">(since OTP 19.0)</span>


        <a href="https://github.com/erlang/otp/blob/master/lib/runtime_tools/src/msacc.erl#L304" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> stats() -> <a href="#t:msacc_data/0">msacc_data</a>().</pre>

      </div>

<p>Returns a runtime system independent version of the microstate statistics data
presented by
<a href="../../apps/erts/erlang.html#statistics_microstate_accounting"><code class="inline">erlang:statistics(microstate_accounting)</code></a>.
All counters have been normalized to be in microsecond resolution.</p>
  </section>
</section>
<section class="detail" id="stats/2">

  <div class="detail-header">
    <a href="#stats/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">stats/2</h1>

        <span class="note">(since OTP 19.0)</span>


        <a href="https://github.com/erlang/otp/blob/master/lib/runtime_tools/src/msacc.erl#L343" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> stats(Analysis, Stats) -> <a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>()
               when Analysis :: system_realtime | system_runtime, Stats :: <a href="#t:msacc_data/0">msacc_data</a>();
           (Analysis, Stats) -> <a href="#t:msacc_stats/0">msacc_stats</a>() when Analysis :: realtime | runtime, Stats :: <a href="#t:msacc_data/0">msacc_data</a>();
           (Analysis, StatsOrData) -> <a href="#t:msacc_data/0">msacc_data</a>() | <a href="#t:msacc_stats/0">msacc_stats</a>()
               when Analysis :: type, StatsOrData :: <a href="#t:msacc_data/0">msacc_data</a>() | <a href="#t:msacc_stats/0">msacc_stats</a>().</pre>

      </div>

<p>Returns the system time for the given microstate statistics values. System time
is the accumulated time of all threads.</p><ul><li><p><strong><code class="inline">realtime</code></strong> - Returns all time recorded for all threads.</p></li><li><p><strong><code class="inline">runtime</code></strong> - Returns all time spent doing work for all threads, i.e. all
time not spent in the <code class="inline">sleep</code> state.</p></li></ul><p>Returns fractions of real-time or run-time spent in the various threads from the
given microstate statistics values.</p><p>Returns a list of microstate statistics values where the values for all threads
of the same type has been merged.</p>
  </section>
</section>
<section class="detail" id="stop/0">

  <div class="detail-header">
    <a href="#stop/0" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">stop()</h1>

        <span class="note">(since OTP 19.0)</span>


        <a href="https://github.com/erlang/otp/blob/master/lib/runtime_tools/src/msacc.erl#L168" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> stop() -> <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>().</pre>

      </div>

<p>Stop microstate accounting. Returns whether is was previously enabled or
disabled.</p>
  </section>
</section>
<section class="detail" id="to_file/1">

  <div class="detail-header">
    <a href="#to_file/1" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">to_file(Filename)</h1>

        <span class="note">(since OTP 19.0)</span>


        <a href="https://github.com/erlang/otp/blob/master/lib/runtime_tools/src/msacc.erl#L199" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> to_file(Filename) -> ok | {error, <a href="../../apps/kernel/file.html#t:posix/0">file:posix</a>()} when Filename :: <a href="../../apps/kernel/file.html#t:name_all/0">file:name_all</a>().</pre>

      </div>

<p>Dumps the current microstate statistics counters to a file that can be parsed
with <a href="../../apps/kernel/file.html#consult/1"><code class="inline">file:consult/1</code></a>.</p>
  </section>
</section>

    </div>
  </section>

    <footer class="footer">
      <p>

        <span class="line">
          <button class="a-main footer-button display-quick-switch" title="Search HexDocs packages">
            Search HexDocs
          </button>

            <a href="runtime_tools.epub" title="ePub version">
              Download ePub version
            </a>

        </span>
      </p>

      <p class="built-using">
        Built using
        <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.38.1) for the

          <a href="https://erlang.org" title="Erlang" target="_blank" translate="no">Erlang programming language</a>

      </p>
<p>Copyright Â© 1996-2025 <a href="https://www.ericsson.com">Ericsson AB</a></p>
    </footer>
  </div>
</main>
</div>
  <script defer src="https://cdn.jsdelivr.net/npm/mermaid@11.4.1/dist/mermaid.min.js"></script>
  <script>
  let initialized = false;

  window.addEventListener("exdoc:loaded", () => {
      if (!initialized) {
      mermaid.initialize({
          startOnLoad: false,
          theme: document.body.className.includes("dark") ? "dark" : "default"
      });
      initialized = true;
      }

      let id = 0;
      for (const codeEl of document.querySelectorAll("pre code.mermaid")) {
      const preEl = codeEl.parentElement;
      const graphDefinition = codeEl.textContent;
      const graphEl = document.createElement("div");
      const graphId = "mermaid-graph-" + id++;
      mermaid.render(graphId, graphDefinition).then(({svg, bindFunctions}) => {
          graphEl.innerHTML = svg;
          bindFunctions?.(graphEl);
          preEl.insertAdjacentElement("afterend", graphEl);
          preEl.remove();
      });
      }
  });
  </script>

  </body>
</html>
