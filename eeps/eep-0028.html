<!DOCTYPE html>
<html lang="en">



<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <!-- Allow pinning of website on windows -->
    <meta name="application-name" content="Erlang.org">
    <meta name="msapplication-tooltip" content="The official home of the Erlang Programming Language">
    <meta name="msapplication-starturl" content="/" >

    <!-- Make the site look nicer on facebook -->
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="Erlang.org">
    <meta property="og:title" content="Welcome to Erlang.org">
    <meta property="og:description" content="The official home of the Erlang Programming Language">
    <meta property="og:image" content="https://beta.erlang.org/assets/img/erlang-228x200.png">
    <meta property="og:image:secure_url" content="https://beta.erlang.org/assets/img/erlang-228x200.png">
    <meta property="og:url" content="https://beta.erlang.org/">

    <!-- Twitter metadata -->
    <meta name="twitter:card" content="summary" />
    <meta property="twitter:title" content="Index" />
    <meta name="twitter:site" content="@erlang_org" />

    <!-- Rich data for google search -->
    <script type="application/ld+json">
{"@type":"WebSite","url":"https://erlang.org/","headline":"Eep 0028 - Erlang/OTP","name":"Erlang.org","sameAs":["https://twitter.com/erlang_org","https://github.com/erlang/otp"],"@context":"https://schema.org"}</script>

    <title>Eep 0028 - Erlang/OTP</title>

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- tells iOS browsers to not show telephone numbers as links -->
    <meta name="format-detection" content="telephone=no">

    <meta name="application-name" content="Erlang.org">
    <meta name="description" content="The official home of the Erlang Programming Language">
    <meta name="keywords" content="Erlang programming language functional parallel distributed documentation download community">
    <!-- https://www.rssboard.org/rss-autodiscovery -->
    <link rel="alternate" type="application/atom+xml" title="News Atom Feed" href="https://beta.erlang.org/news.xml" />
    <link rel="alternate" type="application/atom+xml" title="Blog Atom Feed" href="https://beta.erlang.org/blog.xml" />
    
    <link rel="stylesheet" href="/assets/css/main.css">
</head>

<body>
    <header class="navbar navbar-expand-lg navbar-light bg-body">
        <nav class="container">
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <a class="navbar-brand" href="/"><img
                    src="/assets/img/erlang.png" class="img-fluid" width="60" alt="Erlang.org main page"/></a>
            <div class="collapse navbar-collapse fw-bold" id="navbarSupportedContent">
                <ul class="navbar-nav text-uppercase me-auto mb-2 mb-lg-0">
                    <li class="nav-item"><a class="nav-link" href="/downloads">Download</a></li>
                    <li class="nav-item"><a class="nav-link" href="/docs">Documentation</a></li>
                    <li class="nav-item"><a class="nav-link" href="/community">Community</a></li>
                    <li class="nav-item"><a class="nav-link" href="/news">News</a></li>
                    <li class="nav-item"><a class="nav-link" href="/blog">Blog</a></li>
                    <li class="nav-item"><a class="nav-link" href="/eep">EEP</a></li>
                    <li class="nav-item"><a class="nav-link" href="/about">About</a></li>
                </ul>
                <form class="d-flex" role="search" method="get" action="https://duckduckgo.com/">
                    <input type="hidden" name="sites" value="erlang.org">
                    <input class="form-control me-2" id="searchfield" name="q" type="search" placeholder="Search erlang.org"
                        aria-label="Search">
                    <button class="btn btn-outline-primary" type="submit">Search</button>
                </form>
            </div>
        </nav>
    </header>
    <div class="container border-top pt-4">
    <div class="row-lg">
        <div class="col-lg-10 offset-lg-1">
            <div class="card">
                <div class="card-body">
                    <dl class="mb-0 dl-single">
                        <dt>Author:</dt>
                        <dd>
                            Richard A. O&#39;Keefe &lt;ok(at)cs(dot)otago(dot)ac(dot)nz&gt;
                            
                            
                        </dd>
                        
                        <dt>Status:</dt>
                        <dd>Draft </dd>
                        <dt>Type:</dt>
                        <dd>Standards Track</dd>
                        
                        
                        <dt>Created:</dt>
                        <dd>08-Aug-2008</dd>
                        
                        <dt>Erlang-Version:</dt>
                        <dd>R12B-4</dd>
                        
                        
                        
                        
                    </dl>
                </div>
            </div>
            <div class="border-top mt-4">
                
                <h2 id="eep-28-optional-leading-semicolons-for-choices">
        
        
          EEP 28: Optional leading semicolons for choices <a href="#eep-28-optional-leading-semicolons-for-choices">#</a>
        
        
      </h2>
    
      <h1 id="abstract">
        
        
          Abstract <a href="#abstract">#</a>
        
        
      </h1>
    

<p>‘If’, ‘case’, ‘receive’, and ‘try’ clauses may begin with a semicolon.</p>
      <h1 id="specification">
        
        
          Specification <a href="#specification">#</a>
        
        
      </h1>
    

<p>A semicolon is allowed after the keywords ‘if’, ‘of’,
‘receive’ (provided the next word is not ‘after’),
and ‘catch’ (in a ‘try’ expression).</p>

<p>The semicolon has no effect; it is merely there to allow
a layout style which makes it easier to see the semicolons,
easier to ensure that commas are commas and semicolons are
semicolons, and easier to change the order of choices.</p>
      <h1 id="motivation">
        
        
          Motivation <a href="#motivation">#</a>
        
        
      </h1>
    

<p>In his PhD thesis on compiling Prolog, Peter van Roy complained
that commas and semicolons were hard to distinguish.  In response,
I developed a Prolog layout style where commas go at the end of
lines and semicolons go at the beginner, so that a human being
reading the text is never in doubt about which is intended.</p>

<p>Commas and semicolons remain hard to distinguish in Erlang.
It turns out that a semicolons-at-the-front style works well
for Erlang too.</p>

<pre><code class="language-erlang">do_load_driver(Path, Driver, DriverFlags) -&gt;
    case erl_ddll:try_load(Path, Driver,
           [{monitor,pending_driver}]++DriverFlags) of
    {error, inconsistent} -&gt;
        {error,bad_driver_name};
    {error, What} -&gt;
        {error,What};
    {ok, already_loaded} -&gt;
        ok;
    {ok,loaded} -&gt;
        ok;
    {ok, pending_driver, Ref} -&gt;
        receive
        {'DOWN', Ref, driver, _, load_cancelled} -&gt;
            {error, load_cancelled};
        {'UP', Ref, driver, _, permanent} -&gt;
            {error, permanent};
        {'DOWN', Ref, driver, _,
                {load_failure, Failure}} -&gt;
            {error, Failure};
        {'UP', Ref, driver, _, loaded} -&gt;
            ok
        end
    end.
</code></pre>

<p>In this layout style, the visually most salient part is the
beginning of the line, and except for ‘case’, ‘receive’, and
‘end’, <em>every</em> line could be <em>any</em> line.  Indentation alone
is not a reliable guide, because some logical lines have to
be split across multiple physical lines.</p>

<p>My current style is</p>

<pre><code class="language-erlang">do_load_driver(Path, Driver, DriverFlags) -&gt;
    case erl_ddll:try_load(Path, Driver,
           [{monitor,pending_driver}]++DriverFlags)
     of {error, inconsistent} -&gt;
        {error,bad_driver_name}
      ; {error, What} -&gt;
        {error,What}
      ; {ok, already_loaded} -&gt;
        ok
      ; {ok,loaded} -&gt;
        ok
      ; {ok, pending_driver, Ref} -&gt;
        receive
        {'DOWN', Ref, driver, _, load_cancelled} -&gt;
            {error, load_cancelled}
      ; {'UP', Ref, driver, _, permanent} -&gt;
            {error, permanent}
      ; {'DOWN', Ref, driver, _,
                {load_failure, Failure}} -&gt;
            {error, Failure}
      ; {'UP', Ref, driver, _, loaded} -&gt;
            ok
        end
    end.
</code></pre>

<p>Here the leading semicolons make it <em>obvious</em> with even half
an eye where each choice begins, and the line of semicolons
(lining up with the ‘d’ of ‘end’) makes it easy to see the
structure without a ruler.  There is only one snag:  the
first choice has to be different.  It would be more consistent
to write</p>

<pre><code class="language-erlang">do_load_driver(Path, Driver, DriverFlags) -&gt;
    case erl_ddll:try_load(Path, Driver,
           [{monitor,pending_driver}]++DriverFlags) of
      ; {error, inconsistent} -&gt;
        {error,bad_driver_name}
      ; {error, What} -&gt;
        {error,What}
      ; {ok, already_loaded} -&gt;
        ok
      ; {ok,loaded} -&gt;
        ok
      ; {ok, pending_driver, Ref} -&gt;
        receive
          ; {'DOWN', Ref, driver, _, load_cancelled} -&gt;
            {error, load_cancelled}
          ; {'UP', Ref, driver, _, permanent} -&gt;
            {error, permanent}
          ; {'DOWN', Ref, driver, _,
                {load_failure, Failure}} -&gt;
            {error, Failure}
          ; {'UP', Ref, driver, _, loaded} -&gt;
            ok
        end
    end.
</code></pre>

<p>Now each choice has the same structure, and if we wished to
reorder the choices, we could easily do so without adding,
removing, or changing any punctuation.</p>

<p>It is relevant to see what case statements look like in some other
programming languages, to see that this style is quite general.</p>

<ul>
  <li>
    <p>Fortran:</p>

    <pre><code>  SELECT CASE (expression)
  CASE (values and ranges)
      statements
  CASE (values and ranges)
      statements
  CASE DEFAULT
      statements
  END CASE
</code></pre>
  </li>
  <li>
    <p>Ada:</p>

    <pre><code>  case Expression is
  when Discrete_Choice_List =&gt;
      Statements;
  when Discrete_Choice_List =&gt;
      Statements;
  when others =&gt;
      Statements;
  end case;
</code></pre>
  </li>
  <li>
    <p>PL/I:</p>

    <pre><code>  select (Expression);
    when (Values) Statement;
    when (Values) Statement;
    otherwise     Statement;
  end;
</code></pre>
  </li>
</ul>

<p>These all exhibit “comb style”, the ability to rearrange choices
without adding, removing, or changing punctuation or keywords,
and a clear indication at the <em>beginning</em> of each choice.</p>
      <h1 id="rationale">
        
        
          Rationale <a href="#rationale">#</a>
        
        
      </h1>
    

<p>People who like the usual Erlang style should not be forced to
change.  This means that the leading semicolon must be optional,
not required.</p>

<p>Some of the benefits claimed above could be had by allowing
optional trailing semicolons instead of optional leading ones.
However, in Erlang as it stands, the semicolon is an operator,
not a terminator.  There is nothing unusual about allowing an
operator to have a prefix version as well as an infix version.
There isn’t even anything unusual about a prefix operator that
doesn’t do much except clarify things: ‘+’ is the obvious
example.  So allowing a “do-nothing” prefix use of semicolons
in certain contexts is still within the spirit of Erlang.</p>

<p>That apart, the change is about as simple as it could be.
The only doubtful point is whether a semicolon should be
allowed before ‘after’.  But ‘after’ is already a keyword
explaining what comes next, and it can’t be moved around
freely anyway.  Since there seems to be nothing to gain,
let’s not do it.</p>
      <h1 id="backwards-compatibility">
        
        
          Backwards Compatibility <a href="#backwards-compatibility">#</a>
        
        
      </h1>
    

<p>All existing Erlang code remains acceptable with unchanged
semantics.  The leading semicolons are dealt with entirely in
the parser; other language manipulation tools never know that
the semicolons were ever there, so work perfectly with code
using the new style.</p>
      <h1 id="reference-implementation">
        
        
          Reference Implementation <a href="#reference-implementation">#</a>
        
        
      </h1>
    

<p>The auxiliary file <a href="eep-0028-1.diff" title="Diff to apply to erl_parse.yrl">eep-0028-1.diff</a>
is a patch file to be applied to <code>erl_parse.yrl</code>.
The patched file has been checked by yecc, which is happy
with it, and the resulting .erl file compiles cleanly.
However, that’s all the testing that has been done.</p>

<p>All that the implementation does is to change</p>

<pre><code class="language-erlang">.... 'thingy' .....
</code></pre>

<p>to</p>

<pre><code class="language-erlang">.... thingy_kw .....

thingy_kw -&gt; 'thingy'.
thingy_kw -&gt; 'thingy' ';'.
</code></pre>

<p>in several places.  This form of change, rather than</p>

<pre><code class="language-erlang">.... 'thingy' optional_semicolon ....,
</code></pre>

<p>was chosen so that the ‘$n’ forms in the existing rules would
need no revision, so I am confident that no errors were
introduced by this change.</p>
      <h1 id="copyright">
        
        
          Copyright <a href="#copyright">#</a>
        
        
      </h1>
    

<p>This document has been placed in the public domain.</p>

            </div>
        </div>
    </div>
</div>
<script src="/assets/js/prismjs/prism.js"></script>
<script src="/assets/js/prismjs/components/prism-erlang.js"></script>
    <footer class="container-fluid footer text-center border-top border-bottom">
        <div>
            <a href="/downloads.html" title="DOWNLOAD"><img src="/assets/img/download.png" alt="Download Erlang/OTP"></a>
        </div>
        <div>
            <a href="http://www.github.com/erlang/otp"><img
                    src="/assets/img/GitHub-Mark-32px.png" alt="Erlang/OTP on Github"></a>
        </div>
        
        <div>
            <a href="http://www.twitter.com/erlang_org"><img src="/assets/img/twitter.png"
                    width="32" alt="Erlang/OTP twitter"></a>
        </div>
    </footer>
    <script src="/assets/js/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>