<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html xmlns:erl="http://erlang.org" xmlns:fn="http://www.w3.org/2005/02/xpath-functions">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" href="../../otp_doc.css" type="text/css">
<title>Erlang -- Using the Plain Erlang Back-end</title>
</head>
<body>
<div id="container">
<script id="js" type="text/javascript" language="JavaScript" src="../../js/flipmenu/flipmenu.js"></script><script id="js2" type="text/javascript" src="../../js/erlresolvelinks.js"></script><script language="JavaScript" type="text/javascript">
            <!--
              function getWinHeight() {
                var myHeight = 0;
                if( typeof( window.innerHeight ) == 'number' ) {
                  //Non-IE
                  myHeight = window.innerHeight;
                } else if( document.documentElement && ( document.documentElement.clientWidth ||
                                                         document.documentElement.clientHeight ) ) {
                  //IE 6+ in 'standards compliant mode'
                  myHeight = document.documentElement.clientHeight;
                } else if( document.body && ( document.body.clientWidth || document.body.clientHeight ) ) {
                  //IE 4 compatible
                  myHeight = document.body.clientHeight;
                }
                return myHeight;
              }

              function setscrollpos() {
                var objf=document.getElementById('loadscrollpos');
                 document.getElementById("leftnav").scrollTop = objf.offsetTop - getWinHeight()/2;
              }

              function addEvent(obj, evType, fn){
                if (obj.addEventListener){
                obj.addEventListener(evType, fn, true);
                return true;
              } else if (obj.attachEvent){
                var r = obj.attachEvent("on"+evType, fn);
                return r;
              } else {
                return false;
              }
             }

             addEvent(window, 'load', setscrollpos);

             //--></script><div id="leftnav"><div class="innertube">
<div class="erlang-logo-wrapper"><a href="../../index.html"><img alt="Erlang Logo" src="../../erlang-logo.png" class="erlang-logo"></a></div>
<p class="section-title">ic</p>
<p class="section-subtitle">User's Guide</p>
<p class="section-version">Version 4.4.3</p>
<ul class="panel-sections">
<li><a href="users_guide.html">User's Guide</a></li>
<li><a href="index.html">Reference Manual</a></li>
<li><a href="release_notes.html">Release Notes</a></li>
<li><a href="ic.pdf">PDF</a></li>
<li><a href="../../index.html">Top</a></li>
</ul>
<ul class="expand-collapse-items">
<li><a href="javascript:openAllFlips()">Expand All</a></li>
<li><a href="javascript:closeAllFlips()">Contract All</a></li>
</ul>
<h3>Chapters</h3>
<ul class="flipMenu" imagePath="../../js/flipmenu">
<li id="no" title="Using the IC Compiler" expanded="false">Using the IC Compiler<ul>
<li><a href="ch_introduction.html">
              Top of chapter
            </a></li>
<li title="Introduction"><a href="ch_introduction.html#id64202">Introduction</a></li>
<li title="Compilation of IDL Files"><a href="ch_introduction.html#id63078">Compilation of IDL Files</a></li>
</ul>
</li>
<li id="no" title="OMG IDL" expanded="false">OMG IDL<ul>
<li><a href="ch_basic_idl.html">
              Top of chapter
            </a></li>
<li title="OMG IDL - Overview"><a href="ch_basic_idl.html#id62550">OMG IDL - Overview</a></li>
</ul>
</li>
<li id="no" title="IC Protocol" expanded="false">IC Protocol<ul>
<li><a href="ch_ic_protocol.html">
              Top of chapter
            </a></li>
<li title="Introduction"><a href="ch_ic_protocol.html#id66831">Introduction</a></li>
<li title="Language mappings and IDL operations"><a href="ch_ic_protocol.html#id66859">Language mappings and IDL operations</a></li>
<li title="IC Protocol"><a href="ch_ic_protocol.html#id65620">IC Protocol</a></li>
<li title="Gen_server Protocol"><a href="ch_ic_protocol.html#id66972">Gen_server Protocol</a></li>
<li title="Erlang Distribution Protocol"><a href="ch_ic_protocol.html#id67019">Erlang Distribution Protocol</a></li>
</ul>
</li>
<li id="loadscrollpos" title="Using the Plain Erlang Back-end" expanded="true">Using the Plain Erlang Back-end<ul>
<li><a href="ch_erl_plain.html">
              Top of chapter
            </a></li>
<li title="Introduction"><a href="ch_erl_plain.html#id66050">Introduction</a></li>
<li title="Compiling the Code"><a href="ch_erl_plain.html#id66064">Compiling the Code</a></li>
<li title="Writing the Implementation File"><a href="ch_erl_plain.html#id66083">Writing the Implementation File</a></li>
<li title="An Example"><a href="ch_erl_plain.html#id66140">An Example</a></li>
</ul>
</li>
<li id="no" title="Using the Erlang Generic Server Back-end" expanded="false">Using the Erlang Generic Server Back-end<ul>
<li><a href="ch_erl_genserver.html">
              Top of chapter
            </a></li>
<li title="Introduction"><a href="ch_erl_genserver.html#id65189">Introduction</a></li>
<li title="Compiling the Code"><a href="ch_erl_genserver.html#id65207">Compiling the Code</a></li>
<li title="Writing the Implementation File"><a href="ch_erl_genserver.html#id65230">Writing the Implementation File</a></li>
<li title="An Example"><a href="ch_erl_genserver.html#id65287">An Example</a></li>
</ul>
</li>
<li id="no" title="IDL to C mapping" expanded="false">IDL to C mapping<ul>
<li><a href="ch_c_mapping.html">
              Top of chapter
            </a></li>
<li title="Introduction"><a href="ch_c_mapping.html#id67626">Introduction</a></li>
<li title="C Mapping Characteristics"><a href="ch_c_mapping.html#id67079">C Mapping Characteristics</a></li>
<li title="Basic OMG IDL Types"><a href="ch_c_mapping.html#id67239">Basic OMG IDL Types</a></li>
<li title="Constructed OMG IDL Types"><a href="ch_c_mapping.html#id71156">Constructed OMG IDL Types</a></li>
<li title="OMG IDL Constants"><a href="ch_c_mapping.html#id71379">OMG IDL Constants</a></li>
<li title="OMG IDL Operations"><a href="ch_c_mapping.html#id71411">OMG IDL Operations</a></li>
<li title="Exceptions"><a href="ch_c_mapping.html#id73613">Exceptions</a></li>
<li title="Access to Attributes"><a href="ch_c_mapping.html#id73626">Access to Attributes</a></li>
<li title="Summary of Argument/Result Passing for the C-client"><a href="ch_c_mapping.html#id73637">Summary of Argument/Result Passing for the C-client</a></li>
<li title="Supported Memory Allocation Functions"><a href="ch_c_mapping.html#id75243">Supported Memory Allocation Functions</a></li>
<li title="Special Memory Deallocation Functions"><a href="ch_c_mapping.html#id75371">Special Memory Deallocation Functions</a></li>
<li title="Exception Access Functions"><a href="ch_c_mapping.html#id75410">Exception Access Functions</a></li>
<li title="Special Types"><a href="ch_c_mapping.html#id75450">Special Types</a></li>
<li title="A Mapping Example"><a href="ch_c_mapping.html#id75573">A Mapping Example</a></li>
</ul>
</li>
<li id="no" title="The C Client Back-end" expanded="false">The C Client Back-end<ul>
<li><a href="ch_c_client.html">
              Top of chapter
            </a></li>
<li title="Introduction"><a href="ch_c_client.html#id75711">Introduction</a></li>
<li title="Generated Stub Files"><a href="ch_c_client.html#id75736">Generated Stub Files</a></li>
<li title="C Interface Functions"><a href="ch_c_client.html#id75786">C Interface Functions</a></li>
<li title="Generating, Compiling and Linking"><a href="ch_c_client.html#id75863">Generating, Compiling and Linking</a></li>
<li title="An Example"><a href="ch_c_client.html#id75927">An Example</a></li>
</ul>
</li>
<li id="no" title="The C Server Back-end" expanded="false">The C Server Back-end<ul>
<li><a href="ch_c_server.html">
              Top of chapter
            </a></li>
<li title="Introduction"><a href="ch_c_server.html#id76054">Introduction</a></li>
<li title="Generated Stub Files"><a href="ch_c_server.html#id76081">Generated Stub Files</a></li>
<li title="C Skeleton Functions"><a href="ch_c_server.html#id76131">C Skeleton Functions</a></li>
<li title="The Server Loop"><a href="ch_c_server.html#id76190">The Server Loop</a></li>
<li title="Generating, Compiling and Linking"><a href="ch_c_server.html#id76217">Generating, Compiling and Linking</a></li>
<li title="An Example"><a href="ch_c_server.html#id76282">An Example</a></li>
</ul>
</li>
<li id="no" title="CORBA_Environment C Structure" expanded="false">CORBA_Environment C Structure<ul>
<li><a href="ch_c_corba_env.html">
              Top of chapter
            </a></li>
<li title="C Structure"><a href="ch_c_corba_env.html#id76415">C Structure</a></li>
<li title="The CORBA Compatibility Part"><a href="ch_c_corba_env.html#id76486">The CORBA Compatibility Part</a></li>
<li title="The External Part"><a href="ch_c_corba_env.html#id76540">The External Part</a></li>
<li title="The Internal Part"><a href="ch_c_corba_env.html#id76672">The Internal Part</a></li>
<li title="Creating and Initiating the CORBA_Environment Structure"><a href="ch_c_corba_env.html#id76794">Creating and Initiating the CORBA_Environment Structure</a></li>
<li title="Setting System Exceptions"><a href="ch_c_corba_env.html#id77105">Setting System Exceptions</a></li>
</ul>
</li>
<li id="no" title="IDL to Java language Mapping" expanded="false">IDL to Java language Mapping<ul>
<li><a href="ch_java.html">
              Top of chapter
            </a></li>
<li title="Introduction"><a href="ch_java.html#id77217">Introduction</a></li>
<li title="Specialties in the Mapping"><a href="ch_java.html#id77278">Specialties in the Mapping</a></li>
<li title="Basic OMG IDL Types"><a href="ch_java.html#id77304">Basic OMG IDL Types</a></li>
<li title="Constructed OMG IDL Types"><a href="ch_java.html#id77711">Constructed OMG IDL Types</a></li>
<li title="Mapping for Constants"><a href="ch_java.html#id77778">Mapping for Constants</a></li>
<li title="Invocations of Operations"><a href="ch_java.html#id77789">Invocations of Operations</a></li>
<li title="Exceptions"><a href="ch_java.html#id77839">Exceptions</a></li>
<li title="Access to Attributes"><a href="ch_java.html#id77852">Access to Attributes</a></li>
<li title="Summary of Argument/Result Passing for Java"><a href="ch_java.html#id77863">Summary of Argument/Result Passing for Java</a></li>
<li title="Communication Toolbox"><a href="ch_java.html#id77921">Communication Toolbox</a></li>
<li title="The Package com.ericsson.otp.ic"><a href="ch_java.html#id78221">The Package com.ericsson.otp.ic</a></li>
<li title="The Term Class"><a href="ch_java.html#id78621">The Term Class</a></li>
<li title="Stub File Types"><a href="ch_java.html#id78899">Stub File Types</a></li>
<li title="Client Stub Initialization, Methods Exported"><a href="ch_java.html#id78963">Client Stub Initialization, Methods Exported</a></li>
<li title="Server Skeleton Initialization, Server Stub Implementation, Methods Exported"><a href="ch_java.html#id79144">Server Skeleton Initialization, Server Stub Implementation, Methods Exported</a></li>
<li title="A Mapping Example"><a href="ch_java.html#id79274">A Mapping Example</a></li>
<li title="Running the Compiled Code"><a href="ch_java.html#id79359">Running the Compiled Code</a></li>
</ul>
</li>
</ul>
</div></div>
<div id="content">
<div class="innertube">
<h1>4 Using the Plain Erlang Back-end</h1>
  

  <h3><a name="id66050">4.1 
        Introduction</a></h3>
    
    <p>The mapping of OMG IDL to the Erlang programming language when
      Plain Erlang 
      is the back-end of choice is similar to the one used in pure Erlang IDL
      mapping. The only difference is on the generated code and the extended
      use of pragmas for code generation: IDL functions are translated
      to Erlang
      module function calls.</p>
  

  <h3><a name="id66064">4.2 
        Compiling the Code</a></h3>
    
    <p>In the Erlang shell type :</p>
    <p>ic:gen(<span class="code">&lt;filename&gt;, [{be, erl_plain}])</span>.</p>
  

  <h3><a name="id66083">4.3 
        Writing the Implementation File</a></h3>
    
    <p>For each IDL interface <span class="code">&lt;interface name&gt;</span> defined in the IDL file:</p>
    <ul>
      <li>Create the corresponding Erlang file that will hold the
       Erlang implementation of the IDL definitions.  </li>
      <li>Call the implementation file after the scope of the IDL interface, 
       followed by the suffix <span class="code">_impl</span>.</li>
      <li>Export the implementation functions.</li>
    </ul>
    <p>For each function defined in the IDL interface :</p>
    <ul>
      <li>Implement an Erlang function that uses as arguments in the same
       order, as the input arguments described in the IDL file, and returns 
       the value described in the interface.</li>
      <li>When using the function, follow the mapping described in chapter 2.</li>
    </ul>
  

  <h3><a name="id66140">4.4 
        An Example</a></h3>
    
    <p>      <a name="plain_idl"></a>

      In this example, a file "random.idl" is generates code for the plain Erlang
      back-end :</p>
    <ul>
      <li>
        <p>Main file : "plain.idl"</p>
        <div class="example"><pre>module rmod {
 
  interface random {
 
    double produce();
 
    oneway void init(in long seed1, in long seed2, in long seed3);
 
  };
 
};</pre></div>
      </li>
    </ul>
    <p>Compile the file :</p>
    <div class="example"><pre>      Erlang (BEAM) emulator version 4.9
      
      Eshell V4.9  (abort with ^G)
      1&gt; ic:gen(random,[{be, erl_plain}]).
      Erlang IDL compiler version 2.5.1
      ok
      2&gt; </pre></div>
    <p></p>
    <p>When the file "random.idl" is compiled it produces five files: two for 
      the top scope, two for the interface scope, and one for the module
      scope. The header files for top scope and interface
      are empty and not shown here. In this case only the file for the interface 
      <span class="code">rmod_random.erl</span> is important :. 
            <a name="generated%20files"></a>
</p>
    <ul>
      <li>
        <p>Erlang file for interface : "rmod_random.erl"</p>
        <div class="example"><pre>-module(rmod_random).
 
 
 
%% Interface functions
-export([produce/0, init/3]).
 
%%------------------------------------------------------------
%% Operation: produce
%% 
%%   Returns: RetVal
%%
produce() -&gt;
    rmod_random_impl:produce().
 
%%------------------------------------------------------------
%% Operation: init
%% 
%%   Returns: RetVal
%%
init(Seed1, Seed2, Seed3) -&gt;
    rmod_random_impl:init(Seed1, Seed2, Seed3).</pre></div>
      </li>
    </ul>
    <p>The implementation file should be called <span class="code">rmod_random_impl.erl</span> 
      and could look like this:</p>
    <div class="example"><pre>      -module('rmod_random_impl').
      
      -export([produce/0,init/3]).
      
      
      produce()  -&gt;
        random:uniform().
       
      
      init(S1,S2,S3)  -&gt;
        random:seed(S1,S2,S3).</pre></div>
    <p>Compiling the code : </p>
    <div class="example"><pre>2&gt; make:all().
Recompile: rmod_random
Recompile: oe_random
Recompile: rmod_random_impl
up_to_date</pre></div>
    <p></p>
    <p>Running the example : </p>
    <div class="example"><pre>3&gt;  rmod_random:init(1,2,3).
ok
4&gt;  rmod_random:produce().  
1.97963e-4
5&gt; </pre></div>
  
</div>
<div class="footer">
<hr>
<p>Copyright © 1998-2018 Ericsson AB. All Rights Reserved.</p>
</div>
</div>
</div>
<script type="text/javascript">window.__otpTopDocDir = '../../js/';</script><script type="text/javascript" src="../../js/highlight.js"></script>
</body>
</html>
