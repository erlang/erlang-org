<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.37.3">
    <meta name="project" content="kernel v10.2.7.3">


<meta name="major-vsn" content="27">
<meta name="exdoc:full-text-search-url" content="/doc/search.html?v=27&q=">
<link rel="canonical" href="https://www.erlang.org/doc/apps/kernel/gen_tcp.html" />
    <title>gen_tcp — kernel v10.2.7.3</title>

    <link rel="stylesheet" href="dist/html-erlang-FDBURIED.css" />

    <script defer src="dist/sidebar_items-960DC434.js"></script>
    <script defer src="docs_config.js"></script>
    <script defer src="dist/html-ALU6OERS.js"></script>

  </head>
  <body>
    <script>(()=>{var t="ex_doc:settings",e="dark";var o="dark",s="light";var E="sidebar_state",n="closed";var r="sidebar_width";var a="sidebar-open";var i=new URLSearchParams(window.location.search),S=i.get("theme")||JSON.parse(localStorage.getItem(t)||"{}").theme;(S===o||S!==s&&window.matchMedia("(prefers-color-scheme: dark)").matches)&&document.body.classList.add(e);var d=sessionStorage.getItem(E),A=d!==n&&!window.matchMedia(`screen and (max-width: ${768}px)`).matches;document.body.classList.toggle(a,A);var c=sessionStorage.getItem(r);c&&document.body.style.setProperty("--sidebarWidth",`${c}px`);var p=/(Macintosh|iPhone|iPad|iPod)/.test(window.navigator.userAgent);document.documentElement.classList.toggle("apple-os",p);})();
</script>

<div class="body-wrapper">

<button id="sidebar-menu" class="sidebar-button sidebar-toggle" aria-label="toggle sidebar" aria-controls="sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<nav id="sidebar" class="sidebar">

  <div class="sidebar-header">
    <div class="sidebar-projectInfo">

        <a href="../../index.html" class="sidebar-projectImage">
          <img src="assets/logo.png" alt="kernel" />
        </a>

      <div>
        <a href="../../index.html" class="sidebar-projectName" translate="no">
kernel
        </a>
        <div class="sidebar-projectVersion" translate="no">
          v10.2.7.3
        </div>
      </div>
    </div>
    <ul id="sidebar-list-nav" class="sidebar-list-nav" role="tablist" data-extras=""></ul>
  </div>
</nav>

<output role="status" id="toast"></output>

<main class="content page-module" id="main" data-type="modules">
  <div id="content" class="content-inner">
    <div class="top-search">
      <div class="search-settings">
        <form class="search-bar" action="search.html">
          <label class="search-label">
            <span class="sr-only">Search documentation of kernel</span>
            <input name="q" type="text" class="search-input" placeholder="Press / to search" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
          </label>
          <button type="submit" class="search-button" aria-label="Submit Search" tabindex="-1">
            <i class="ri-search-2-line ri-lg" aria-hidden="true"></i>
          </button>
          <button type="button" tabindex="-1" class="search-close-button" aria-hidden="true">
            <i class="ri-close-line ri-lg" title="Cancel search"></i>
          </button>
        </form>
        <div class="autocomplete">
        </div>
        <button class="icon-settings display-settings">
          <i class="ri-settings-3-line"></i>
          <span class="sr-only">Settings</span>
        </button>
      </div>
    </div>

<div id="top-content">
  <div class="heading-with-actions top-heading">
    <h1>
      <span translate="no">gen_tcp</span> 
      <small class="app-vsn" translate="no">(kernel v10.2.7.3)</small>

    </h1>

      <a href="https://github.com/erlang/otp/blob/OTP-27.3.4.6/lib/kernel/src/gen_tcp.erl#L21" title="View Source" class="icon-action" rel="help">
        <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        <span class="sr-only">View Source</span>
      </a>

  </div>


    <section id="moduledoc">
<p>Interface to TCP/IP sockets.</p><p>This module provides functions for communicating over TCP/IP
protocol sockets.</p><p>The following code fragment is a simple example of a client connecting to a
server at port 5678, transferring a binary, and closing the connection:</p><pre><code class="makeup erlang" translate="no"><span class="nf">client</span><span class="p" data-group-id="8913072932-1">(</span><span class="p" data-group-id="8913072932-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="n">SomeHostInNet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;localhost&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1">% to make it runnable on one machine</span><span class="w">
    </span><span class="p" data-group-id="8913072932-2">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">Sock</span><span class="p" data-group-id="8913072932-2">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">gen_tcp</span><span class="p">:</span><span class="nf">connect</span><span class="p" data-group-id="8913072932-3">(</span><span class="n">SomeHostInNet</span><span class="p">,</span><span class="w"> </span><span class="mi">5678</span><span class="p">,</span><span class="w">
                                 </span><span class="p" data-group-id="8913072932-4">[</span><span class="ss">binary</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="8913072932-5">{</span><span class="ss">packet</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="8913072932-5">}</span><span class="p" data-group-id="8913072932-4">]</span><span class="p" data-group-id="8913072932-3">)</span><span class="p">,</span><span class="w">
    </span><span class="ss">ok</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">gen_tcp</span><span class="p">:</span><span class="nf">send</span><span class="p" data-group-id="8913072932-6">(</span><span class="n">Sock</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Some Data&quot;</span><span class="p" data-group-id="8913072932-6">)</span><span class="p">,</span><span class="w">
    </span><span class="ss">ok</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">gen_tcp</span><span class="p">:</span><span class="nf">close</span><span class="p" data-group-id="8913072932-7">(</span><span class="n">Sock</span><span class="p" data-group-id="8913072932-7">)</span><span class="p">.</span></code></pre><p>At the other end, a server is listening on port 5678, accepts the connection,
and receives the binary:</p><pre><code class="makeup erlang" translate="no"><span class="nf">server</span><span class="p" data-group-id="0533769027-1">(</span><span class="p" data-group-id="0533769027-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="p" data-group-id="0533769027-2">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">LSock</span><span class="p" data-group-id="0533769027-2">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">gen_tcp</span><span class="p">:</span><span class="nf">listen</span><span class="p" data-group-id="0533769027-3">(</span><span class="mi">5678</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0533769027-4">[</span><span class="ss">binary</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0533769027-5">{</span><span class="ss">packet</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="0533769027-5">}</span><span class="p">,</span><span class="w">
                                        </span><span class="p" data-group-id="0533769027-6">{</span><span class="ss">active</span><span class="p">,</span><span class="w"> </span><span class="ss">false</span><span class="p" data-group-id="0533769027-6">}</span><span class="p" data-group-id="0533769027-4">]</span><span class="p" data-group-id="0533769027-3">)</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="0533769027-7">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">Sock</span><span class="p" data-group-id="0533769027-7">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">gen_tcp</span><span class="p">:</span><span class="nf">accept</span><span class="p" data-group-id="0533769027-8">(</span><span class="n">LSock</span><span class="p" data-group-id="0533769027-8">)</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="0533769027-9">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">Bin</span><span class="p" data-group-id="0533769027-9">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">do_recv</span><span class="p" data-group-id="0533769027-10">(</span><span class="n">Sock</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0533769027-11">[</span><span class="p" data-group-id="0533769027-11">]</span><span class="p" data-group-id="0533769027-10">)</span><span class="p">,</span><span class="w">
    </span><span class="ss">ok</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">gen_tcp</span><span class="p">:</span><span class="nf">close</span><span class="p" data-group-id="0533769027-12">(</span><span class="n">Sock</span><span class="p" data-group-id="0533769027-12">)</span><span class="p">,</span><span class="w">
    </span><span class="ss">ok</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">gen_tcp</span><span class="p">:</span><span class="nf">close</span><span class="p" data-group-id="0533769027-13">(</span><span class="n">LSock</span><span class="p" data-group-id="0533769027-13">)</span><span class="p">,</span><span class="w">
    </span><span class="n">Bin</span><span class="p">.</span><span class="w">

</span><span class="nf">do_recv</span><span class="p" data-group-id="0533769027-14">(</span><span class="n">Sock</span><span class="p">,</span><span class="w"> </span><span class="n">Bs</span><span class="p" data-group-id="0533769027-14">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="k">case</span><span class="w"> </span><span class="nc">gen_tcp</span><span class="p">:</span><span class="nf">recv</span><span class="p" data-group-id="0533769027-15">(</span><span class="n">Sock</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p" data-group-id="0533769027-15">)</span><span class="w"> </span><span class="k">of</span><span class="w">
        </span><span class="p" data-group-id="0533769027-16">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p" data-group-id="0533769027-16">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
            </span><span class="nf">do_recv</span><span class="p" data-group-id="0533769027-17">(</span><span class="n">Sock</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0533769027-18">[</span><span class="n">Bs</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p" data-group-id="0533769027-18">]</span><span class="p" data-group-id="0533769027-17">)</span><span class="p">;</span><span class="w">
        </span><span class="p" data-group-id="0533769027-19">{</span><span class="ss">error</span><span class="p">,</span><span class="w"> </span><span class="ss">closed</span><span class="p" data-group-id="0533769027-19">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
            </span><span class="p" data-group-id="0533769027-20">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="nf">list_to_binary</span><span class="p" data-group-id="0533769027-21">(</span><span class="n">Bs</span><span class="p" data-group-id="0533769027-21">)</span><span class="p" data-group-id="0533769027-20">}</span><span class="w">
    </span><span class="k">end</span><span class="p">.</span></code></pre><p>For more examples, see section <a href="#module-examples">Examples</a>.</p><section role="note" class="admonition info"><h4 class="admonition-title info">Note</h4><p>Functions that create sockets can take an optional option;
<code class="inline">{inet_backend, Backend}</code> that, if specified, has to be the first option. This
selects the implementation backend towards the platform's socket API.</p><p>This is a <em>temporary</em> option that will be ignored in a future release.</p><p>The default is <code class="inline">Backend = inet</code> that selects the traditional <code class="inline">inet_drv.c</code>
driver. The other choice is <code class="inline">Backend = socket</code> that selects the new <a href="socket.html"><code class="inline">socket</code></a>
module and its NIF implementation.</p><p>The system default can be changed when the node is started with the
application <code class="inline">kernel</code>'s configuration variable <code class="inline">inet_backend</code>.</p><p>For <code class="inline">gen_tcp</code> with <code class="inline">inet_backend = socket</code> we have tried to be as &quot;compatible&quot;
as possible which has sometimes been impossible. Here is a list of cases when
the behaviour of inet-backend <code class="inline">inet</code> (default) and <code class="inline">socket</code> are different:</p><ul><li><p><a href="#non_blocking_send">Non-blocking send</a></p><p>If a user calling <a href="#send/2"><code class="inline">gen_tcp:send/2</code></a> with <code class="inline">inet_backend = inet</code>,
tries to send more data than there is room for in the OS buffers, the &quot;rest
data&quot; is buffered by the inet driver (and later sent in the background). The
effect for the user is that the call is non-blocking.</p><p>This is <em>not</em> the effect when <code class="inline">inet_backend = socket</code>, since there is no
buffering. Instead the user hangs either until all data has been sent or the
<code class="inline">send_timeout</code> timeout has been reached.</p></li><li><p><a href="#shutdown/2"><code class="inline">shutdown/2</code></a> may hide errors</p><p>The call does not involve the receive process state, and is done
right on the underlying socket.  On for example Linux, it is a known
misbehaviour that it skips some checks so doing shutdown on a
listen socket returns <code class="inline">ok</code> while the logical result should have been
<code class="inline">{error, enotconn}</code>.  The <code class="inline">inet_drv.c</code> driver did an extra check
and simulated the correct error, but with <code class="inline">Backend = socket</code>
it would introduce overhead to involve the receive process.</p></li><li><p>The option <a href="inet.html#option-nodelay">nodelay</a> is a TCP specific option that
is <em>not</em> compatible with <code class="inline">domain = local</code>.</p><p>When using <code class="inline">inet_backend = socket</code>, trying to create a socket (via listen or
connect) with <code class="inline">domain = local</code> (for example with option {ifaddr,
{local,&quot;/tmp/test&quot;}}) <em>will fail</em> with <code class="inline">{error, enotsup}</code>.</p><p>This does not actually work for <code class="inline">inet_backend = inet</code> either, but in that
case the error is simply <em>ignored</em>, which is a <em>bad</em> idea. We have chosen to
<em>not</em> ignore this error for <code class="inline">inet_backend = socket</code>.</p></li><li><p><a href="#async_shutdown_write">Async shutdown write</a></p><p>Calling <a href="#shutdown/2">gen_tcp:shutdown(Socket, write | read_write)</a> on a
socket created with <code class="inline">inet_backend = socket</code> will take <em>immediate</em> effect,
unlike for a socket created with <code class="inline">inet_backend = inet</code>.</p><p>See <a href="#async_shutdown_write">async shutdown write</a> for more info.</p></li><li><p>Windows require sockets (domain = <code class="inline">inet | inet6</code>) to be bound.</p><p><em>Currently</em> all sockets created on Windows with <code class="inline">inet_backend = socket</code> will
be bound. If the user does not provide an address, gen_tcp will try to
'figure out' an address itself.</p></li></ul></section><h2 id="module-examples" class="section-heading">
  <a href="#module-examples" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Examples</span>
</h2>
<p>The following example illustrates use of option <code class="inline">{active,once}</code> and multiple
accepts by implementing a server as a number of worker processes doing accept on
a single listening socket. Function <code class="inline">start/2</code> takes the number of worker
processes and the port number on which to listen for incoming connections. If
<code class="inline">LPort</code> is specified as <code class="inline">0</code>, an ephemeral port number is used, which is why the
start function returns the actual port number allocated:</p><pre><code class="makeup erlang" translate="no"><span class="nf">start</span><span class="p" data-group-id="6985929201-1">(</span><span class="n">Num</span><span class="p">,</span><span class="n">LPort</span><span class="p" data-group-id="6985929201-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="k">case</span><span class="w"> </span><span class="nc">gen_tcp</span><span class="p">:</span><span class="nf">listen</span><span class="p" data-group-id="6985929201-2">(</span><span class="n">LPort</span><span class="p">,</span><span class="p" data-group-id="6985929201-3">[</span><span class="p" data-group-id="6985929201-4">{</span><span class="ss">active</span><span class="p">,</span><span class="w"> </span><span class="ss">false</span><span class="p" data-group-id="6985929201-4">}</span><span class="p">,</span><span class="p" data-group-id="6985929201-5">{</span><span class="ss">packet</span><span class="p">,</span><span class="mi">2</span><span class="p" data-group-id="6985929201-5">}</span><span class="p" data-group-id="6985929201-3">]</span><span class="p" data-group-id="6985929201-2">)</span><span class="w"> </span><span class="k">of</span><span class="w">
        </span><span class="p" data-group-id="6985929201-6">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">ListenSock</span><span class="p" data-group-id="6985929201-6">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
            </span><span class="nf">start_servers</span><span class="p" data-group-id="6985929201-7">(</span><span class="n">Num</span><span class="p">,</span><span class="n">ListenSock</span><span class="p" data-group-id="6985929201-7">)</span><span class="p">,</span><span class="w">
            </span><span class="p" data-group-id="6985929201-8">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="n">Port</span><span class="p" data-group-id="6985929201-8">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">inet</span><span class="p">:</span><span class="nf">port</span><span class="p" data-group-id="6985929201-9">(</span><span class="n">ListenSock</span><span class="p" data-group-id="6985929201-9">)</span><span class="p">,</span><span class="w">
            </span><span class="n">Port</span><span class="p">;</span><span class="w">
        </span><span class="p" data-group-id="6985929201-10">{</span><span class="ss">error</span><span class="p">,</span><span class="n">Reason</span><span class="p" data-group-id="6985929201-10">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
            </span><span class="p" data-group-id="6985929201-11">{</span><span class="ss">error</span><span class="p">,</span><span class="n">Reason</span><span class="p" data-group-id="6985929201-11">}</span><span class="w">
    </span><span class="k">end</span><span class="p">.</span><span class="w">

</span><span class="nf">start_servers</span><span class="p" data-group-id="6985929201-12">(</span><span class="mi">0</span><span class="p">,</span><span class="p">_</span><span class="p" data-group-id="6985929201-12">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="ss">ok</span><span class="p">;</span><span class="w">
</span><span class="nf">start_servers</span><span class="p" data-group-id="6985929201-13">(</span><span class="n">Num</span><span class="p">,</span><span class="n">LS</span><span class="p" data-group-id="6985929201-13">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="nf">spawn</span><span class="p" data-group-id="6985929201-14">(</span><span class="o">?</span><span class="n">MODULE</span><span class="p">,</span><span class="ss">server</span><span class="p">,</span><span class="p" data-group-id="6985929201-15">[</span><span class="n">LS</span><span class="p" data-group-id="6985929201-15">]</span><span class="p" data-group-id="6985929201-14">)</span><span class="p">,</span><span class="w">
    </span><span class="nf">start_servers</span><span class="p" data-group-id="6985929201-16">(</span><span class="n">Num</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">LS</span><span class="p" data-group-id="6985929201-16">)</span><span class="p">.</span><span class="w">

</span><span class="nf">server</span><span class="p" data-group-id="6985929201-17">(</span><span class="n">LS</span><span class="p" data-group-id="6985929201-17">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="k">case</span><span class="w"> </span><span class="nc">gen_tcp</span><span class="p">:</span><span class="nf">accept</span><span class="p" data-group-id="6985929201-18">(</span><span class="n">LS</span><span class="p" data-group-id="6985929201-18">)</span><span class="w"> </span><span class="k">of</span><span class="w">
        </span><span class="p" data-group-id="6985929201-19">{</span><span class="ss">ok</span><span class="p">,</span><span class="n">S</span><span class="p" data-group-id="6985929201-19">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
            </span><span class="nf">loop</span><span class="p" data-group-id="6985929201-20">(</span><span class="n">S</span><span class="p" data-group-id="6985929201-20">)</span><span class="p">,</span><span class="w">
            </span><span class="nf">server</span><span class="p" data-group-id="6985929201-21">(</span><span class="n">LS</span><span class="p" data-group-id="6985929201-21">)</span><span class="p">;</span><span class="w">
        </span><span class="n">Other</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
            </span><span class="nc">io</span><span class="p">:</span><span class="nf">format</span><span class="p" data-group-id="6985929201-22">(</span><span class="s">&quot;accept returned </span><span class="si">~w</span><span class="s"> - goodbye!</span><span class="si">~n</span><span class="s">&quot;</span><span class="p">,</span><span class="p" data-group-id="6985929201-23">[</span><span class="n">Other</span><span class="p" data-group-id="6985929201-23">]</span><span class="p" data-group-id="6985929201-22">)</span><span class="p">,</span><span class="w">
            </span><span class="ss">ok</span><span class="w">
    </span><span class="k">end</span><span class="p">.</span><span class="w">

</span><span class="nf">loop</span><span class="p" data-group-id="6985929201-24">(</span><span class="n">S</span><span class="p" data-group-id="6985929201-24">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="nc">inet</span><span class="p">:</span><span class="nf">setopts</span><span class="p" data-group-id="6985929201-25">(</span><span class="n">S</span><span class="p">,</span><span class="p" data-group-id="6985929201-26">[</span><span class="p" data-group-id="6985929201-27">{</span><span class="ss">active</span><span class="p">,</span><span class="ss">once</span><span class="p" data-group-id="6985929201-27">}</span><span class="p" data-group-id="6985929201-26">]</span><span class="p" data-group-id="6985929201-25">)</span><span class="p">,</span><span class="w">
    </span><span class="k">receive</span><span class="w">
        </span><span class="p" data-group-id="6985929201-28">{</span><span class="ss">tcp</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Data</span><span class="p" data-group-id="6985929201-28">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
            </span><span class="n">Answer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">process</span><span class="p" data-group-id="6985929201-29">(</span><span class="n">Data</span><span class="p" data-group-id="6985929201-29">)</span><span class="p">,</span><span class="w"> </span><span class="c1">% Not implemented in this example</span><span class="w">
            </span><span class="nc">gen_tcp</span><span class="p">:</span><span class="nf">send</span><span class="p" data-group-id="6985929201-30">(</span><span class="n">S</span><span class="p">,</span><span class="n">Answer</span><span class="p" data-group-id="6985929201-30">)</span><span class="p">,</span><span class="w">
            </span><span class="nf">loop</span><span class="p" data-group-id="6985929201-31">(</span><span class="n">S</span><span class="p" data-group-id="6985929201-31">)</span><span class="p">;</span><span class="w">
        </span><span class="p" data-group-id="6985929201-32">{</span><span class="ss">tcp_closed</span><span class="p">,</span><span class="n">S</span><span class="p" data-group-id="6985929201-32">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
            </span><span class="nc">io</span><span class="p">:</span><span class="nf">format</span><span class="p" data-group-id="6985929201-33">(</span><span class="s">&quot;Socket </span><span class="si">~w</span><span class="s"> closed [</span><span class="si">~w</span><span class="s">]</span><span class="si">~n</span><span class="s">&quot;</span><span class="p">,</span><span class="p" data-group-id="6985929201-34">[</span><span class="n">S</span><span class="p">,</span><span class="nf">self</span><span class="p" data-group-id="6985929201-35">(</span><span class="p" data-group-id="6985929201-35">)</span><span class="p" data-group-id="6985929201-34">]</span><span class="p" data-group-id="6985929201-33">)</span><span class="p">,</span><span class="w">
            </span><span class="ss">ok</span><span class="w">
    </span><span class="k">end</span><span class="p">.</span></code></pre><p>Example of a simple client:</p><pre><code class="makeup erlang" translate="no"><span class="nf">client</span><span class="p" data-group-id="4762258130-1">(</span><span class="n">PortNo</span><span class="p">,</span><span class="n">Message</span><span class="p" data-group-id="4762258130-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="p" data-group-id="4762258130-2">{</span><span class="ss">ok</span><span class="p">,</span><span class="n">Sock</span><span class="p" data-group-id="4762258130-2">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">gen_tcp</span><span class="p">:</span><span class="nf">connect</span><span class="p" data-group-id="4762258130-3">(</span><span class="s">&quot;localhost&quot;</span><span class="p">,</span><span class="n">PortNo</span><span class="p">,</span><span class="p" data-group-id="4762258130-4">[</span><span class="p" data-group-id="4762258130-5">{</span><span class="ss">active</span><span class="p">,</span><span class="ss">false</span><span class="p" data-group-id="4762258130-5">}</span><span class="p">,</span><span class="w">
                                                    </span><span class="p" data-group-id="4762258130-6">{</span><span class="ss">packet</span><span class="p">,</span><span class="mi">2</span><span class="p" data-group-id="4762258130-6">}</span><span class="p" data-group-id="4762258130-4">]</span><span class="p" data-group-id="4762258130-3">)</span><span class="p">,</span><span class="w">
    </span><span class="nc">gen_tcp</span><span class="p">:</span><span class="nf">send</span><span class="p" data-group-id="4762258130-7">(</span><span class="n">Sock</span><span class="p">,</span><span class="n">Message</span><span class="p" data-group-id="4762258130-7">)</span><span class="p">,</span><span class="w">
    </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">gen_tcp</span><span class="p">:</span><span class="nf">recv</span><span class="p" data-group-id="4762258130-8">(</span><span class="n">Sock</span><span class="p">,</span><span class="mi">0</span><span class="p" data-group-id="4762258130-8">)</span><span class="p">,</span><span class="w">
    </span><span class="nc">gen_tcp</span><span class="p">:</span><span class="nf">close</span><span class="p" data-group-id="4762258130-9">(</span><span class="n">Sock</span><span class="p" data-group-id="4762258130-9">)</span><span class="p">,</span><span class="w">
    </span><span class="n">A</span><span class="p">.</span></code></pre><p>The <code class="inline">send</code> call does not accept a time-out option because time-outs on send is
handled through socket option <code class="inline">send_timeout</code>. The behavior of a send operation
with no receiver is mainly defined by the underlying TCP stack and the network
infrastructure. To write code that handles a hanging receiver that can
eventually cause the sender to hang on a <code class="inline">send</code> do like the following.</p><p>Consider a process that receives data from a client process to be forwarded to a
server on the network. The process is connected to the server through TCP/IP and
does not get any acknowledge for each message it sends, but has to rely on the
send time-out option to detect that the other end is unresponsive. Option
<code class="inline">send_timeout</code> can be used when connecting:</p><pre><code class="makeup erlang" translate="no"><span class="p">.</span><span class="p">.</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="8930678526-1">{</span><span class="ss">ok</span><span class="p">,</span><span class="n">Sock</span><span class="p" data-group-id="8930678526-1">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">gen_tcp</span><span class="p">:</span><span class="nf">connect</span><span class="p" data-group-id="8930678526-2">(</span><span class="n">HostAddress</span><span class="p">,</span><span class="w"> </span><span class="n">Port</span><span class="p">,</span><span class="w">
                            </span><span class="p" data-group-id="8930678526-3">[</span><span class="p" data-group-id="8930678526-4">{</span><span class="ss">active</span><span class="p">,</span><span class="ss">false</span><span class="p" data-group-id="8930678526-4">}</span><span class="p">,</span><span class="w">
                             </span><span class="p" data-group-id="8930678526-5">{</span><span class="ss">send_timeout</span><span class="p">,</span><span class="w"> </span><span class="mi">5000</span><span class="p" data-group-id="8930678526-5">}</span><span class="p">,</span><span class="w">
                             </span><span class="p" data-group-id="8930678526-6">{</span><span class="ss">packet</span><span class="p">,</span><span class="mi">2</span><span class="p" data-group-id="8930678526-6">}</span><span class="p" data-group-id="8930678526-3">]</span><span class="p" data-group-id="8930678526-2">)</span><span class="p">,</span><span class="w">
                </span><span class="nf">loop</span><span class="p" data-group-id="8930678526-7">(</span><span class="n">Sock</span><span class="p" data-group-id="8930678526-7">)</span><span class="p">,</span><span class="w"> </span><span class="c1">% See below</span><span class="w">
</span><span class="p">.</span><span class="p">.</span><span class="p">.</span></code></pre><p>In the loop where requests are handled, send time-outs can now be detected:</p><pre><code class="makeup erlang" translate="no"><span class="nf">loop</span><span class="p" data-group-id="4481988269-1">(</span><span class="n">Sock</span><span class="p" data-group-id="4481988269-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
    </span><span class="k">receive</span><span class="w">
        </span><span class="p" data-group-id="4481988269-2">{</span><span class="n">Client</span><span class="p">,</span><span class="w"> </span><span class="ss">send_data</span><span class="p">,</span><span class="w"> </span><span class="n">Binary</span><span class="p" data-group-id="4481988269-2">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
            </span><span class="k">case</span><span class="w"> </span><span class="nc">gen_tcp</span><span class="p">:</span><span class="nf">send</span><span class="p" data-group-id="4481988269-3">(</span><span class="n">Sock</span><span class="p">,</span><span class="p" data-group-id="4481988269-4">[</span><span class="n">Binary</span><span class="p" data-group-id="4481988269-4">]</span><span class="p" data-group-id="4481988269-3">)</span><span class="w"> </span><span class="k">of</span><span class="w">
                </span><span class="p" data-group-id="4481988269-5">{</span><span class="ss">error</span><span class="p">,</span><span class="w"> </span><span class="ss">timeout</span><span class="p" data-group-id="4481988269-5">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
                    </span><span class="nc">io</span><span class="p">:</span><span class="nf">format</span><span class="p" data-group-id="4481988269-6">(</span><span class="s">&quot;Send timeout, closing!</span><span class="si">~n</span><span class="s">&quot;</span><span class="p">,</span><span class="w">
                              </span><span class="p" data-group-id="4481988269-7">[</span><span class="p" data-group-id="4481988269-7">]</span><span class="p" data-group-id="4481988269-6">)</span><span class="p">,</span><span class="w">
                    </span><span class="nf">handle_send_timeout</span><span class="p" data-group-id="4481988269-8">(</span><span class="p" data-group-id="4481988269-8">)</span><span class="p">,</span><span class="w"> </span><span class="c1">% Not implemented here</span><span class="w">
                    </span><span class="n">Client</span><span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="p" data-group-id="4481988269-9">{</span><span class="nf">self</span><span class="p" data-group-id="4481988269-10">(</span><span class="p" data-group-id="4481988269-10">)</span><span class="p">,</span><span class="p" data-group-id="4481988269-11">{</span><span class="ss">error_sending</span><span class="p">,</span><span class="w"> </span><span class="ss">timeout</span><span class="p" data-group-id="4481988269-11">}</span><span class="p" data-group-id="4481988269-9">}</span><span class="p">,</span><span class="w">
                    </span><span class="c1">%% Usually, it&#39;s a good idea to give up in case of a</span><span class="w">
                    </span><span class="c1">%% send timeout, as you never know how much actually</span><span class="w">
                    </span><span class="c1">%% reached the server, maybe only a packet header?!</span><span class="w">
                    </span><span class="nc">gen_tcp</span><span class="p">:</span><span class="nf">close</span><span class="p" data-group-id="4481988269-12">(</span><span class="n">Sock</span><span class="p" data-group-id="4481988269-12">)</span><span class="p">;</span><span class="w">
                </span><span class="p" data-group-id="4481988269-13">{</span><span class="ss">error</span><span class="p">,</span><span class="w"> </span><span class="n">OtherSendError</span><span class="p" data-group-id="4481988269-13">}</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
                    </span><span class="nc">io</span><span class="p">:</span><span class="nf">format</span><span class="p" data-group-id="4481988269-14">(</span><span class="s">&quot;Some other error on socket (</span><span class="si">~p</span><span class="s">), closing&quot;</span><span class="p">,</span><span class="w">
                              </span><span class="p" data-group-id="4481988269-15">[</span><span class="n">OtherSendError</span><span class="p" data-group-id="4481988269-15">]</span><span class="p" data-group-id="4481988269-14">)</span><span class="p">,</span><span class="w">
                    </span><span class="n">Client</span><span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="p" data-group-id="4481988269-16">{</span><span class="nf">self</span><span class="p" data-group-id="4481988269-17">(</span><span class="p" data-group-id="4481988269-17">)</span><span class="p">,</span><span class="p" data-group-id="4481988269-18">{</span><span class="ss">error_sending</span><span class="p">,</span><span class="w"> </span><span class="n">OtherSendError</span><span class="p" data-group-id="4481988269-18">}</span><span class="p" data-group-id="4481988269-16">}</span><span class="p">,</span><span class="w">
                    </span><span class="nc">gen_tcp</span><span class="p">:</span><span class="nf">close</span><span class="p" data-group-id="4481988269-19">(</span><span class="n">Sock</span><span class="p" data-group-id="4481988269-19">)</span><span class="p">;</span><span class="w">
                </span><span class="ss">ok</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
                    </span><span class="n">Client</span><span class="w"> </span><span class="o">!</span><span class="w"> </span><span class="p" data-group-id="4481988269-20">{</span><span class="nf">self</span><span class="p" data-group-id="4481988269-21">(</span><span class="p" data-group-id="4481988269-21">)</span><span class="p">,</span><span class="w"> </span><span class="ss">data_sent</span><span class="p" data-group-id="4481988269-20">}</span><span class="p">,</span><span class="w">
                    </span><span class="nf">loop</span><span class="p" data-group-id="4481988269-22">(</span><span class="n">Sock</span><span class="p" data-group-id="4481988269-22">)</span><span class="w">
            </span><span class="k">end</span><span class="w">
    </span><span class="k">end</span><span class="p">.</span></code></pre><p>Usually it suffices to detect time-outs on receive, as most protocols include
some sort of acknowledgment from the server, but if the protocol is strictly one
way, option <code class="inline">send_timeout</code> comes in handy.</p>
    </section>

</div>

  <section id="summary" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#summary">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Summary</span>
    </h1>
<div class="summary-types summary">
  <h2>
    <a href="#types">Types</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:connect_option/0" data-no-tooltip="" translate="no">connect_option()</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:listen_option/0" data-no-tooltip="" translate="no">listen_option()</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:option/0" data-no-tooltip="" translate="no">option()</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:option_name/0" data-no-tooltip="" translate="no">option_name()</a>

      </div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:pktoptions_value/0" data-no-tooltip="" translate="no">pktoptions_value()</a>

      </div>

        <div class="summary-synopsis"><p>Value from socket option <a href="#t:option_name/0"><code class="inline">pktoptions</code></a>.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:socket/0" data-no-tooltip="" translate="no">socket()</a>

      </div>

        <div class="summary-synopsis"><p>As returned by <a href="#accept/1"><code class="inline">accept/1,2</code></a> and <a href="#connect/3"><code class="inline">connect/3,4</code></a>.</p></div>

    </div>

</div>
<div class="summary-functions summary">
  <h2>
    <a href="#functions">Functions</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#accept/1" data-no-tooltip="" translate="no">accept(ListenSocket)</a>

      </div>

        <div class="summary-synopsis"><p>Equivalent to <a href="#accept/2"><code class="inline">accept(ListenSocket, infinity)</code></a>.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#accept/2" data-no-tooltip="" translate="no">accept(ListenSocket, Timeout)</a>

      </div>

        <div class="summary-synopsis"><p>Accept an incoming connection request on a listen socket.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#close/1" data-no-tooltip="" translate="no">close(Socket)</a>

      </div>

        <div class="summary-synopsis"><p>Close a TCP socket.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#connect/2" data-no-tooltip="" translate="no">connect(SockAddr, Opts)</a>

      </div>

        <div class="summary-synopsis"><p>Equivalent to <a href="#connect/3"><code class="inline">connect(SockAddr, Opts, infinity)</code></a>.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#connect/3" data-no-tooltip="" translate="no">connect/3</a>

      </div>

        <div class="summary-synopsis"><p>Create a socket connected to the specified address.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#connect/4" data-no-tooltip="" translate="no">connect(Address, Port, Opts, Timeout)</a>

      </div>

        <div class="summary-synopsis"><p>Create a socket connected to the specified address.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#controlling_process/2" data-no-tooltip="" translate="no">controlling_process(Socket, Pid)</a>

      </div>

        <div class="summary-synopsis"><p>Change the controlling process (owner) of a socket.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#listen/2" data-no-tooltip="" translate="no">listen(Port, Options)</a>

      </div>

        <div class="summary-synopsis"><p>Create a listen socket.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#recv/2" data-no-tooltip="" translate="no">recv(Socket, Length)</a>

      </div>

        <div class="summary-synopsis"><p>Equivalent to <a href="#recv/3"><code class="inline">recv(Socket, Length, infinity)</code></a>.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#recv/3" data-no-tooltip="" translate="no">recv(Socket, Length, Timeout)</a>

      </div>

        <div class="summary-synopsis"><p>Receive a packet, from a socket in <em>passive mode</em>.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#send/2" data-no-tooltip="" translate="no">send(Socket, Packet)</a>

      </div>

        <div class="summary-synopsis"><p>Send a packet on a socket.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#shutdown/2" data-no-tooltip="" translate="no">shutdown(Socket, How)</a>

      </div>

        <div class="summary-synopsis"><p>Close the socket in one or both directions.</p></div>

    </div>

</div>

  </section>


  <section id="types" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#types">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Types</span>
    </h1>
    <div class="types-list">
<section class="detail" id="t:connect_option/0">

  <div class="detail-header">
    <a href="#t:connect_option/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">connect_option()</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-27.3.4.6/lib/kernel/src/gen_tcp.erl#L365" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> connect_option() ::
          {fd, Fd :: <a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>()} |
          <a href="inet.html#t:address_family/0">inet:address_family</a>() |
          {ifaddr, <a href="socket.html#t:sockaddr_in/0">socket:sockaddr_in</a>() | <a href="socket.html#t:sockaddr_in6/0">socket:sockaddr_in6</a>() | <a href="inet.html#t:socket_address/0">inet:socket_address</a>()} |
          {ip, <a href="inet.html#t:socket_address/0">inet:socket_address</a>()} |
          {port, <a href="inet.html#t:port_number/0">inet:port_number</a>()} |
          {tcp_module, <a href="../../apps/erts/erlang.html#t:module/0">module</a>()} |
          {netns, <a href="file.html#t:filename_all/0">file:filename_all</a>()} |
          {bind_to_device, <a href="../../apps/erts/erlang.html#t:binary/0">binary</a>()} |
          <a href="#t:option/0">option</a>().</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:listen_option/0">

  <div class="detail-header">
    <a href="#t:listen_option/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">listen_option()</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-27.3.4.6/lib/kernel/src/gen_tcp.erl#L376" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> listen_option() ::
          {fd, Fd :: <a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>()} |
          <a href="inet.html#t:address_family/0">inet:address_family</a>() |
          {ifaddr, <a href="socket.html#t:sockaddr_in/0">socket:sockaddr_in</a>() | <a href="socket.html#t:sockaddr_in6/0">socket:sockaddr_in6</a>() | <a href="inet.html#t:socket_address/0">inet:socket_address</a>()} |
          {ip, <a href="inet.html#t:socket_address/0">inet:socket_address</a>()} |
          {port, <a href="inet.html#t:port_number/0">inet:port_number</a>()} |
          {backlog, B :: <a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>()} |
          {tcp_module, <a href="../../apps/erts/erlang.html#t:module/0">module</a>()} |
          {netns, <a href="file.html#t:filename_all/0">file:filename_all</a>()} |
          {bind_to_device, <a href="../../apps/erts/erlang.html#t:binary/0">binary</a>()} |
          <a href="#t:option/0">option</a>().</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:option/0">

  <div class="detail-header">
    <a href="#t:option/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">option()</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-27.3.4.6/lib/kernel/src/gen_tcp.erl#L260" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> option() ::
          {active, true | false | once | -32768..32767} |
          {buffer, <a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>()} |
          {debug, <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>()} |
          {delay_send, <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>()} |
          {deliver, port | term} |
          {dontroute, <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>()} |
          {exit_on_close, <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>()} |
          {exclusiveaddruse, <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>()} |
          {header, <a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>()} |
          {high_msgq_watermark, <a href="../../apps/erts/erlang.html#t:pos_integer/0">pos_integer</a>()} |
          {high_watermark, <a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>()} |
          {keepalive, <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>()} |
          {linger, {<a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>(), <a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>()}} |
          {low_msgq_watermark, <a href="../../apps/erts/erlang.html#t:pos_integer/0">pos_integer</a>()} |
          {low_watermark, <a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>()} |
          {mode, list | binary} |
          list | binary |
          {nodelay, <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>()} |
          {packet,
           0 | 1 | 2 | 4 | raw | sunrm | asn1 | cdr | fcgi | line | tpkt | http | httph | http_bin |
           httph_bin} |
          {packet_size, <a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>()} |
          {priority, <a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>()} |
          {raw, Protocol :: <a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>(), OptionNum :: <a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>(), ValueBin :: <a href="../../apps/erts/erlang.html#t:binary/0">binary</a>()} |
          {recbuf, <a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>()} |
          {reuseaddr, <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>()} |
          {reuseport, <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>()} |
          {reuseport_lb, <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>()} |
          {send_timeout, <a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>() | infinity} |
          {send_timeout_close, <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>()} |
          {show_econnreset, <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>()} |
          {sndbuf, <a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>()} |
          {tos, <a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>()} |
          {tclass, <a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>()} |
          {ttl, <a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>()} |
          {recvtos, <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>()} |
          {recvtclass, <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>()} |
          {recvttl, <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>()} |
          {ipv6_v6only, <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>()}.</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:option_name/0">

  <div class="detail-header">
    <a href="#t:option_name/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">option_name()</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-27.3.4.6/lib/kernel/src/gen_tcp.erl#L323" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> option_name() ::
          active | buffer | debug | delay_send | deliver | dontroute | exit_on_close |
          exclusiveaddruse | header | high_msgq_watermark | high_watermark | keepalive | linger |
          low_msgq_watermark | low_watermark | mode | nodelay | packet | packet_size | priority |
          {raw,
           Protocol :: <a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>(),
           OptionNum :: <a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>(),
           ValueSpec :: (ValueSize :: <a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>()) | (ValueBin :: <a href="../../apps/erts/erlang.html#t:binary/0">binary</a>())} |
          recbuf | reuseaddr | reuseport | reuseport_lb | send_timeout | send_timeout_close |
          show_econnreset | sndbuf | tos | tclass | ttl | recvtos | recvtclass | recvttl | pktoptions |
          ipv6_v6only.</pre>

      </div>


  </section>
</section>
<section class="detail" id="t:pktoptions_value/0">

  <div class="detail-header">
    <a href="#t:pktoptions_value/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">pktoptions_value()</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-27.3.4.6/lib/kernel/src/gen_tcp.erl#L320" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> pktoptions_value() :: {pktoptions, <a href="inet.html#t:ancillary_data/0">inet:ancillary_data</a>()}.</pre>

      </div>

<p>Value from socket option <a href="#t:option_name/0"><code class="inline">pktoptions</code></a>.</p><p>If the platform implements the IPv4 option <code class="inline">IP_PKTOPTIONS</code>,
or the IPv6 option <code class="inline">IPV6_PKTOPTIONS</code> or <code class="inline">IPV6_2292PKTOPTIONS</code> for the socket;
this value is returned from <a href="inet.html#getopts/2"><code class="inline">inet:getopts/2</code></a> when called with the option name
<a href="#t:option_name/0"><code class="inline">pktoptions</code></a>.</p><section role="note" class="admonition info"><h4 class="admonition-title info">Note</h4><p>This option appears to be VERY Linux specific, and its existence in future
Linux kernel versions is also worrying since the option is part of RFC 2292
which is since long (2003) obsoleted by RFC 3542 that <em>explicitly</em> removes
this possibility to get packet information from a stream socket. For
comparison: it has existed in FreeBSD but is now removed, at least since
FreeBSD 10.</p></section>
  </section>
</section>
<section class="detail" id="t:socket/0">

  <div class="detail-header">
    <a href="#t:socket/0" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">socket()</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-27.3.4.6/lib/kernel/src/gen_tcp.erl#L391" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> socket() :: <a href="inet.html#t:socket/0">inet:socket</a>().</pre>

      </div>

<p>As returned by <a href="#accept/1"><code class="inline">accept/1,2</code></a> and <a href="#connect/3"><code class="inline">connect/3,4</code></a>.</p>
  </section>
</section>

    </div>
  </section>

  <section id="functions" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#functions">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Functions</span>
    </h1>
    <div class="functions-list">
<section class="detail" id="accept/1">

  <div class="detail-header">
    <a href="#accept/1" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">accept(ListenSocket)</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-27.3.4.6/lib/kernel/src/gen_tcp.erl#L719" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> accept(ListenSocket) -> {ok, Socket} | {error, Reason}
                when
                    ListenSocket :: <a href="#t:socket/0">socket</a>(),
                    Socket :: <a href="#t:socket/0">socket</a>(),
                    Reason :: closed | system_limit | <a href="inet.html#t:posix/0">inet:posix</a>().</pre>

      </div>

<p>Equivalent to <a href="#accept/2"><code class="inline">accept(ListenSocket, infinity)</code></a>.</p>
  </section>
</section>
<section class="detail" id="accept/2">

  <div class="detail-header">
    <a href="#accept/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">accept(ListenSocket, Timeout)</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-27.3.4.6/lib/kernel/src/gen_tcp.erl#L766" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> accept(ListenSocket, Timeout) -> {ok, Socket} | {error, Reason}
                when
                    ListenSocket :: <a href="#t:socket/0">socket</a>(),
                    Timeout :: <a href="../../apps/erts/erlang.html#t:timeout/0">timeout</a>(),
                    Socket :: <a href="#t:socket/0">socket</a>(),
                    Reason :: closed | timeout | system_limit | <a href="inet.html#t:posix/0">inet:posix</a>().</pre>

      </div>

<p>Accept an incoming connection request on a listen socket.</p><p><code class="inline">Socket</code> must be a socket returned from <a href="#listen/2"><code class="inline">listen/2</code></a>. <code class="inline">Timeout</code> specifies
a time-out value in milliseconds. Defaults to <code class="inline">infinity</code>.</p><p>Returns:</p><ul><li><code class="inline">{ok, Socket}</code> if a connection is established</li><li><code class="inline">{error, closed}</code> if <code class="inline">ListenSocket</code> is closed</li><li><code class="inline">{error, timeout}</code> if no connection is established within <code class="inline">Timeout</code></li><li><code class="inline">{error, system_limit}</code> if all available ports in the Erlang emulator
are in  use</li><li>A POSIX error value if something else goes wrong, see <a href="inet.html"><code class="inline">inet</code></a>
about possible values</li></ul><p>To send packets (outbound) on the returned <code class="inline">Socket</code>, use <a href="#send/2"><code class="inline">send/2</code></a>.
Packets sent from the peer (inbound) are delivered as messages
to the socket owner; the process that created the socket.
Unless <code class="inline">{active, false}</code> is specified in the option list when creating
the <a href="#listen/2">listening socket</a>.</p><p>See <a href="#connect/4"><code class="inline">connect/4</code></a> about <em>active mode</em> socket messages and <em>passive mode</em>.</p><section role="note" class="admonition info"><h4 class="admonition-title info">Note</h4><p>The <code class="inline">accept</code> call <em>doesn't have to be</em> issued from the socket owner process.
Using version 5.5.3 and higher of the emulator, multiple simultaneous accept
calls can be issued from different processes, which allows for a pool of
acceptor processes handling incoming connections.</p></section>
  </section>
</section>
<section class="detail" id="close/1">

  <div class="detail-header">
    <a href="#close/1" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">close(Socket)</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-27.3.4.6/lib/kernel/src/gen_tcp.erl#L855" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> close(Socket) -> ok when Socket :: <a href="#t:socket/0">socket</a>().</pre>

      </div>

<p>Close a TCP socket.</p><p>Note that in most implementations of TCP, doing a <code class="inline">close</code> does not guarantee
that the data sent is delivered to the recipient.  It is guaranteed that
the recepient will see all sent data before getting the close, but the
sender gets no indication of that.</p><p>If the sender needs to know that the recepient has received all data
there are two common ways to achieve this:</p><ol><li>Use <a href="#shutdown/2"><code class="inline">gen_tcp:shutdown(Sock, write)</code></a> to signal that no more
data is to be sent and wait for the other side to acknowledge seeing
its read side being closed, by closing its write side, which shows
as a socket close on this side.</li><li>Implement an acknowledgement in the protocol on top of TCP
that both connection ends adhere to, indicating that all data
has been seen.  The socket option <a href="inet.html#option-packet"><code class="inline">{packet, N}</code></a>
may be useful.</li></ol>
  </section>
</section>
<section class="detail" id="connect/2">

  <div class="detail-header">
    <a href="#connect/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">connect(SockAddr, Opts)</h1>

        <span class="note">(since OTP 24.3)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-27.3.4.6/lib/kernel/src/gen_tcp.erl#L412" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> connect(SockAddr, Opts) -> {ok, Socket} | {error, Reason}
                 when
                     SockAddr :: <a href="socket.html#t:sockaddr_in/0">socket:sockaddr_in</a>() | <a href="socket.html#t:sockaddr_in6/0">socket:sockaddr_in6</a>(),
                     Opts :: [<a href="inet.html#t:inet_backend/0">inet:inet_backend</a>() | <a href="#t:connect_option/0">connect_option</a>()],
                     Socket :: <a href="#t:socket/0">socket</a>(),
                     Reason :: <a href="inet.html#t:posix/0">inet:posix</a>().</pre>

      </div>

<p>Equivalent to <a href="#connect/3"><code class="inline">connect(SockAddr, Opts, infinity)</code></a>.</p>
  </section>
</section>
<section class="detail" id="connect/3">

  <div class="detail-header">
    <a href="#connect/3" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">connect/3</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-27.3.4.6/lib/kernel/src/gen_tcp.erl#L446" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> connect(Address, Port, Opts) -> {ok, Socket} | {error, Reason}
                 when
                     Address :: <a href="inet.html#t:socket_address/0">inet:socket_address</a>() | <a href="inet.html#t:hostname/0">inet:hostname</a>(),
                     Port :: <a href="inet.html#t:port_number/0">inet:port_number</a>(),
                     Opts :: [<a href="inet.html#t:inet_backend/0">inet:inet_backend</a>() | <a href="#t:connect_option/0">connect_option</a>()],
                     Socket :: <a href="#t:socket/0">socket</a>(),
                     Reason :: <a href="inet.html#t:posix/0">inet:posix</a>();
             (SockAddr, Opts, Timeout) -> {ok, Socket} | {error, Reason}
                 when
                     SockAddr :: <a href="socket.html#t:sockaddr_in/0">socket:sockaddr_in</a>() | <a href="socket.html#t:sockaddr_in6/0">socket:sockaddr_in6</a>(),
                     Opts :: [<a href="inet.html#t:inet_backend/0">inet:inet_backend</a>() | <a href="#t:connect_option/0">connect_option</a>()],
                     Timeout :: <a href="../../apps/erts/erlang.html#t:timeout/0">timeout</a>(),
                     Socket :: <a href="#t:socket/0">socket</a>(),
                     Reason :: timeout | <a href="inet.html#t:posix/0">inet:posix</a>().</pre>

      </div>

<p>Create a socket connected to the specified address.</p><h3 id="connect/3-with-arguments-address-and-port" class="section-heading">
  <a href="#connect/3-with-arguments-address-and-port" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">With arguments <code class="inline">Address</code> and <code class="inline">Port</code></span>
</h3>
<p>Equivalent to <a href="#connect/4"><code class="inline">connect(Address, Port, Opts, infinity)</code></a>.</p><h3 id="connect/3-with-argument-sockaddr-since-otp-24-3" class="section-heading">
  <a href="#connect/3-with-argument-sockaddr-since-otp-24-3" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">With argument <code class="inline">SockAddr</code> <strong>(since OTP 24.3)</strong></span>
</h3>
<p>Connects to a remote listen socket specified by <code class="inline">SockAddr</code>
where <a href="socket.html#t:sockaddr_in6/0"><code class="inline">socket:sockaddr_in6/0</code></a> for example allows specifying
the <code class="inline">scope_id</code> for link local IPv6 addresses.</p><p><a href="socket.html#t:sockaddr_in/0">IPv4 addresses</a> on the same
<a href="../../apps/erts/erlang.html#t:map/0"><code class="inline">map/0</code></a> format is also allowed.</p><p>Equivalent to <a href="#connect/4"><code class="inline">connect/4</code></a>, besides the format of the destination address.</p>
  </section>
</section>
<section class="detail" id="connect/4">

  <div class="detail-header">
    <a href="#connect/4" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">connect(Address, Port, Opts, Timeout)</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-27.3.4.6/lib/kernel/src/gen_tcp.erl#L575" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> connect(Address, Port, Opts, Timeout) -> {ok, Socket} | {error, Reason}
                 when
                     Address :: <a href="inet.html#t:socket_address/0">inet:socket_address</a>() | <a href="inet.html#t:hostname/0">inet:hostname</a>(),
                     Port :: <a href="inet.html#t:port_number/0">inet:port_number</a>(),
                     Opts :: [<a href="inet.html#t:inet_backend/0">inet:inet_backend</a>() | <a href="#t:connect_option/0">connect_option</a>()],
                     Timeout :: <a href="../../apps/erts/erlang.html#t:timeout/0">timeout</a>(),
                     Socket :: <a href="#t:socket/0">socket</a>(),
                     Reason :: timeout | <a href="inet.html#t:posix/0">inet:posix</a>().</pre>

      </div>

<p>Create a socket connected to the specified address.</p><p>Creates a socket and connects it to a server on TCP port <code class="inline">Port</code>
on the host with IP address <code class="inline">Address</code>, that may also be a hostname.</p><h3 id="connect/4-opts-connect-options" class="section-heading">
  <a href="#connect/4-opts-connect-options" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text"><code class="inline">Opts</code> (connect options)</span>
</h3>
<ul><li><p><strong><code class="inline">{ip, Address}</code></strong> - If the local host has many IP addresses,
this option specifies which one to use.</p></li><li><p><strong><code class="inline">{ifaddr, Address}</code></strong> - Same as <code class="inline">{ip, Address}</code>.</p><p>However, if <code class="inline">Address</code> instead is a <a href="socket.html#t:sockaddr_in/0"><code class="inline">socket:sockaddr_in/0</code></a> or
<a href="socket.html#t:sockaddr_in6/0"><code class="inline">socket:sockaddr_in6/0</code></a> this takes precedence over any value
previously set with the <code class="inline">ip</code> and <code class="inline">port</code> options. If these options
(<code class="inline">ip</code> or/and <code class="inline">port</code>) however comes <em>after</em> this option,
they may be used to <em>update</em> the corresponding fields of this option
(for <code class="inline">ip</code>, the <code class="inline">addr</code> field, and for <code class="inline">port</code>, the <code class="inline">port</code> field).</p></li><li><p><strong><code class="inline">{fd, integer() &gt;= 0}</code></strong> - If a socket has somehow been connected without
using <code class="inline">gen_tcp</code>, use this option to pass the file descriptor for it.
If <code class="inline">{ip, Address}</code> and/or <code class="inline">{port, port_number()}</code> is combined
with this option, the <code class="inline">fd</code> is bound to the specified interface
and port before connecting. If these options are not specified,
it is assumed that the <code class="inline">fd</code> is already bound appropriately.</p></li><li><p><strong><code class="inline">inet</code></strong> - Sets up the socket for IPv4.</p></li><li><p><strong><code class="inline">inet6</code></strong> - Sets up the socket for IPv6.</p></li><li><p><strong><code class="inline">local</code></strong> - Sets up a Unix Domain Socket. See <a href="inet.html#t:local_address/0"><code class="inline">inet:local_address/0</code></a></p></li><li><p><strong><code class="inline">{port, Port}</code></strong> - Specifies which local port number to use.</p></li><li><p><strong><code class="inline">{tcp_module, module()}</code></strong> - Overrides which callback module is used.
Defaults to <code class="inline">inet_tcp</code> for IPv4 and <code class="inline">inet6_tcp</code> for IPv6.</p></li><li><p><strong><code class="inline">{protocol, tcp|mptcp}</code></strong> - With <code class="inline">mptcp</code> creates the socket
with protocol IPPROTO_MPTCP, if that is defined on the system.
Other than that the socket is regarded as a <code class="inline">tcp</code> socket.
If IPPROTO_MPTCP is not defined, <code class="inline">{error, eprotonosupport}</code>
is returned. <code class="inline">tcp</code> is the default value.</p></li><li><p><strong><a href="#t:option/0"><code class="inline">option/0</code></a></strong> - See <a href="inet.html#setopts/2"><code class="inline">inet:setopts/2</code></a>.</p></li></ul><h3 id="connect/4-socket-data" class="section-heading">
  <a href="#connect/4-socket-data" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Socket Data</span>
</h3>
<p>Packets can be sent to the peer (outbound) with
<a href="#send/2"><code class="inline">send(Socket, Packet)</code></a>.  Packets sent from the peer
(inbound) are delivered as messages to the socket owner;
the process that created the socket, unless <code class="inline">{active, false}</code>
is specified in the <code class="inline">Options</code> list.</p><h4>Active mode socket messages</h4><ul><li><p><strong><code class="inline">{tcp, Socket, Data}</code></strong> - Inbound data from the socket.</p></li><li><p><strong><code class="inline">{tcp_passive, Socket}</code></strong> -
The socket was in <code class="inline">{active, N}</code> mode (see <a href="inet.html#setopts/2"><code class="inline">inet:setopts/2</code></a> for details)
and its message counter reached <code class="inline">0</code>, indicating that
the socket has transitioned to passive (<code class="inline">{active, false}</code>) mode.</p></li><li><p><strong><code class="inline">{tcp_closed, Socket}</code></strong> - The socket was closed.</p></li><li><p><strong><code class="inline">{tcp_error, Socket, Reason}</code></strong> A socket error occurred.</p></li></ul><h4>Passive mode</h4><p>If <code class="inline">{active, false}</code> is specified in the option list for the socket,
packets and errors are retrieved by calling <a href="#recv/3"><code class="inline">recv/2,3</code></a>
(<a href="#send/2"><code class="inline">send/2</code></a> may also return errors).</p><h4>Timeout</h4><p>The optional <code class="inline">Timeout</code> parameter specifies a connect time-out in milliseconds.
Defaults to <code class="inline">infinity</code>.</p><section role="note" class="admonition info"><h4 class="admonition-title info">Note</h4><p>Keep in mind that if the underlying OS <code class="inline">connect()</code> call returns a timeout,
<code class="inline">gen_tcp:connect</code> will also return a timeout (i.e. <code class="inline">{error, etimedout}</code>),
even if a larger <code class="inline">Timeout</code> was specified (for example <code class="inline">infinity</code>).</p></section><section role="note" class="admonition info"><h4 class="admonition-title info">Note</h4><p>The default values for options specified to <code class="inline">connect</code> can be affected by the
Kernel configuration parameter <code class="inline">inet_default_connect_options</code>.
For details, see <a href="inet.html"><code class="inline">inet</code></a>.</p></section>
  </section>
</section>
<section class="detail" id="controlling_process/2">

  <div class="detail-header">
    <a href="#controlling_process/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">controlling_process(Socket, Pid)</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-27.3.4.6/lib/kernel/src/gen_tcp.erl#L1016" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> controlling_process(Socket, Pid) -> ok | {error, Reason}
                             when
                                 Socket :: <a href="#t:socket/0">socket</a>(),
                                 Pid :: <a href="../../apps/erts/erlang.html#t:pid/0">pid</a>(),
                                 Reason :: closed | not_owner | badarg | <a href="inet.html#t:posix/0">inet:posix</a>().</pre>

      </div>

<p>Change the controlling process (owner) of a socket.</p><p>Assigns a new controlling process <code class="inline">Pid</code> to <code class="inline">Socket</code>. The controlling process
is the process that the socket sends messages to.  If this function
is called from any other process than the current controlling process,
<code class="inline">{error, not_owner}</code> is returned.</p><p>If the process identified by <code class="inline">Pid</code> is not an existing local <a href="../../apps/erts/erlang.html#t:pid/0"><code class="inline">pid/0</code></a>,
<code class="inline">{error, badarg}</code> is returned. <code class="inline">{error, badarg}</code> may also be returned
in some cases when <code class="inline">Socket</code> is closed during the execution of this function.</p><p>If the socket is in <em>active mode</em>, this function will transfer any messages
from the socket in the mailbox of the caller to the new controlling process.</p><p>If any other process is interacting with the socket during the transfer,
it may not work correctly and messages may remain in the caller's mailbox.
For instance, changing the sockets active mode during the transfer
could cause this.</p>
  </section>
</section>
<section class="detail" id="listen/2">

  <div class="detail-header">
    <a href="#listen/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">listen(Port, Options)</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-27.3.4.6/lib/kernel/src/gen_tcp.erl#L689" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> listen(Port, Options) -> {ok, ListenSocket} | {error, Reason}
                when
                    Port :: <a href="inet.html#t:port_number/0">inet:port_number</a>(),
                    Options :: [<a href="inet.html#t:inet_backend/0">inet:inet_backend</a>() | <a href="#t:listen_option/0">listen_option</a>()],
                    ListenSocket :: <a href="#t:socket/0">socket</a>(),
                    Reason :: system_limit | <a href="inet.html#t:posix/0">inet:posix</a>().</pre>

      </div>

<p>Create a listen socket.</p><p>Creates a socket and sets it to listen on port <code class="inline">Port</code> on the local host.</p><p>If <code class="inline">Port == 0</code>, the underlying OS assigns an available (ephemeral)
port number, use <a href="inet.html#port/1"><code class="inline">inet:port/1</code></a> to retrieve it.</p><p>The following options are available:</p><ul><li><p><strong><code class="inline">list</code></strong> - Received <code class="inline">Packet</code>s are delivered as lists of bytes,
<code class="inline">[</code><a href="../../apps/erts/erlang.html#t:byte/0"><code class="inline">byte/0</code></a><code class="inline">]</code>.</p></li><li><p><strong><code class="inline">binary</code></strong> - Received <code class="inline">Packet</code>s are delivered as <a href="../../apps/erts/erlang.html#t:binary/0"><code class="inline">binary/0</code></a>s.</p></li><li><p><strong><code class="inline">{backlog, B}</code></strong> - <code class="inline">B ::</code> <a href="../../apps/erts/erlang.html#t:non_neg_integer/0"><code class="inline">non_neg_integer/0</code></a>. The backlog value
defines the maximum length that the queue of pending connections
can grow to. Defaults to <code class="inline">5</code>.</p></li><li><p><strong><code class="inline">inet6</code></strong> - Sets up the socket for IPv6.</p></li><li><p><strong><code class="inline">inet</code></strong> - Sets up the socket for IPv4.</p></li><li><p><strong><code class="inline">{fd, Fd}</code></strong> - If a socket has somehow been created without using
<code class="inline">gen_tcp</code>, use this option to pass the file descriptor for it.</p></li><li><p><strong><code class="inline">{ip, Address}</code></strong> - If the host has many IP addresses, this option
specifies which one to listen on.</p></li><li><p><strong><code class="inline">{port, Port}</code></strong> - Specifies which local port number to use.</p></li><li><p><strong><code class="inline">{ifaddr, Address}</code></strong> - Same as <code class="inline">{ip, Address}</code>.</p><p>However, if this instead is an <a href="socket.html#t:sockaddr_in/0"><code class="inline">socket:sockaddr_in/0</code></a> or
<a href="socket.html#t:sockaddr_in6/0"><code class="inline">socket:sockaddr_in6/0</code></a> this takes precedence over any value
previously set with the <code class="inline">ip</code> and <code class="inline">port</code> options. If these options
(<code class="inline">ip</code> or/and <code class="inline">port</code>) however comes <em>after</em> this option,
they may be used to <em>update</em> their corresponding fields of this option
(for <code class="inline">ip</code>, the <code class="inline">addr</code> field, and for <code class="inline">port</code>, the <code class="inline">port</code> field).</p></li><li><p><strong><code class="inline">{tcp_module, module()}</code></strong> - Overrides which callback module is used.
Defaults to <code class="inline">inet_tcp</code> for IPv4 and <code class="inline">inet6_tcp</code> for IPv6.</p></li><li><p><strong><code class="inline">{protocol, tcp|mptcp}</code></strong> - With <code class="inline">mptcp</code> creates the socket
with protocol IPPROTO_MPTCP, if that is defined on the system.
Other than that the socket is regarded as a <code class="inline">tcp</code> socket.
If IPPROTO_MPTCP is not defined, <code class="inline">{error, eprotonosupport}</code>
is returned. <code class="inline">tcp</code> is the default value.</p></li><li><p><strong><a href="#t:option/0"><code class="inline">option/0</code></a></strong> - See <a href="inet.html#setopts/2"><code class="inline">inet:setopts/2</code></a>.</p></li></ul><p>The returned socket <code class="inline">ListenSocket</code> should be used when calling
<a href="#accept/1"><code class="inline">accept/1,2</code></a> to accept an incoming connection request.</p><section role="note" class="admonition info"><h4 class="admonition-title info">Note</h4><p>The default values for options specified to <code class="inline">listen</code> can be affected by the
Kernel configuration parameter <code class="inline">inet_default_listen_options</code>. For details, see
<a href="inet.html"><code class="inline">inet</code></a>.</p></section>
  </section>
</section>
<section class="detail" id="recv/2">

  <div class="detail-header">
    <a href="#recv/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">recv(Socket, Length)</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-27.3.4.6/lib/kernel/src/gen_tcp.erl#L926" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> recv(Socket, Length) -> {ok, Packet} | {error, Reason}
              when
                  Socket :: <a href="#t:socket/0">socket</a>(),
                  Length :: <a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>(),
                  Packet :: <a href="../../apps/erts/erlang.html#t:string/0">string</a>() | <a href="../../apps/erts/erlang.html#t:binary/0">binary</a>() | HttpPacket,
                  Reason :: closed | <a href="inet.html#t:posix/0">inet:posix</a>(),
                  HttpPacket :: <a href="../../apps/erts/erlang.html#t:term/0">term</a>().</pre>

      </div>

<p>Equivalent to <a href="#recv/3"><code class="inline">recv(Socket, Length, infinity)</code></a>.</p>
  </section>
</section>
<section class="detail" id="recv/3">

  <div class="detail-header">
    <a href="#recv/3" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">recv(Socket, Length, Timeout)</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-27.3.4.6/lib/kernel/src/gen_tcp.erl#L966" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> recv(Socket, Length, Timeout) -> {ok, Packet} | {error, Reason}
              when
                  Socket :: <a href="#t:socket/0">socket</a>(),
                  Length :: <a href="../../apps/erts/erlang.html#t:non_neg_integer/0">non_neg_integer</a>(),
                  Timeout :: <a href="../../apps/erts/erlang.html#t:timeout/0">timeout</a>(),
                  Packet :: <a href="../../apps/erts/erlang.html#t:string/0">string</a>() | <a href="../../apps/erts/erlang.html#t:binary/0">binary</a>() | HttpPacket,
                  Reason :: closed | timeout | <a href="inet.html#t:posix/0">inet:posix</a>(),
                  HttpPacket :: <a href="../../apps/erts/erlang.html#t:term/0">term</a>().</pre>

      </div>

<p>Receive a packet, from a socket in <em>passive mode</em>.</p><p>A closed socket is indicated by the return value <code class="inline">{error, closed}</code>.
If the socket is not in passive mode, the return value is <code class="inline">{error, einval}</code>.</p><p>Argument <code class="inline">Length</code> is only meaningful when the socket is in <code class="inline">raw</code> mode and
denotes the number of bytes to read.  If <code class="inline">Length</code> is <code class="inline">0</code>, all available
bytes are returned. If <code class="inline">Length &gt; 0</code>, exactly <code class="inline">Length</code> bytes are returned,
or an error; except if the socket is closed from the other side,
then the last read before the one returning <code class="inline">{error, closed}</code>
may return less than <code class="inline">Length</code> bytes of data.</p><p>The optional <code class="inline">Timeout</code> parameter specifies a time-out in milliseconds.
Defaults to <code class="inline">infinity</code>.</p><p>Any process can receive data from a passive socket, even if that process is not
the controlling process of the socket. However, only one process can call this
function on a socket at any given time. Using simultaneous calls to <code class="inline">recv</code> is
not recommended as the behavior depends on the socket implementation,
and could return errors such as <code class="inline">{error, ealready}</code>.</p>
  </section>
</section>
<section class="detail" id="send/2">

  <div class="detail-header">
    <a href="#send/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">send(Socket, Packet)</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-27.3.4.6/lib/kernel/src/gen_tcp.erl#L904" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> send(Socket, Packet) -> ok | {error, Reason}
              when
                  Socket :: <a href="#t:socket/0">socket</a>(),
                  Packet :: <a href="../../apps/erts/erlang.html#t:iodata/0">iodata</a>(),
                  Reason :: closed | {timeout, RestData} | <a href="inet.html#t:posix/0">inet:posix</a>(),
                  RestData :: <a href="../../apps/erts/erlang.html#t:binary/0">binary</a>() | <a href="../../apps/erts/erlang.html#t:iovec/0">erlang:iovec</a>().</pre>

      </div>

<p>Send a packet on a socket.</p><p>There is no <a href="#send/2"><code class="inline">send/2</code></a> call with a time-out option; use socket option
<code class="inline">send_timeout</code> if time-outs are desired.  See section
<a href="#module-examples">Examples</a>.</p><p>The return value <code class="inline">{error, {timeout, RestData}}</code> can only be returned when
<code class="inline">inet_backend = socket</code>.</p><p><a href="" id="non_blocking_send"></a></p><section role="note" class="admonition info"><h4 class="admonition-title info">Note</h4><h4>Non-blocking send.</h4><p>If the user tries to send more data than there is room for in the OS send
buffers, the 'rest data' is stored in (inet driver) internal buffers and later
sent in the background. The function immediately returns ok (<em>not</em> informing
the caller that some date isn'nt sent yet). Any issue while
sending the 'rest data' may be returned later.</p><p>When using <code class="inline">inet_backend = socket</code>, the behaviour is different. There is
<em>no</em> buffering, instead the caller will &quot;hang&quot; until all of the data
has been sent or the send timeout (as specified by the <code class="inline">send_timeout</code>
option) expires (the function can &quot;hang&quot; even when using the <code class="inline">inet</code>
backend if the internal buffers are full).</p><p>If this happens when using <code class="inline">packet =/= raw</code>, a partial packet has been
written. A new packet therefore <em>mustn't</em> be written at this point,
as there is no way for the peer to distinguish this from data in
the current packet. Instead, set the <code class="inline">packet</code> option to <code class="inline">raw</code>, send the
rest data (as raw data) and then set <code class="inline">packet</code> back to the correct type.</p></section>
  </section>
</section>
<section class="detail" id="shutdown/2">

  <div class="detail-header">
    <a href="#shutdown/2" class="detail-link" data-no-tooltip="" aria-label="Link to this function">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">shutdown(Socket, How)</h1>


        <a href="https://github.com/erlang/otp/blob/OTP-27.3.4.6/lib/kernel/src/gen_tcp.erl#L818" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-spec</span> shutdown(Socket, How) -> ok | {error, Reason}
                  when Socket :: <a href="#t:socket/0">socket</a>(), How :: read | write | read_write, Reason :: <a href="inet.html#t:posix/0">inet:posix</a>().</pre>

      </div>

<p>Close the socket in one or both directions.</p><p><code class="inline">How == write</code> means closing the socket for writing, reading from it is still
possible.</p><p>If <code class="inline">How == read</code> or there is no outgoing data buffered in the <code class="inline">Socket</code> port, the
shutdown is performed immediately and any error encountered is returned in
<code class="inline">Reason</code>.</p><p>If there is data buffered in the socket port, shutdown isn't performed
on the socket until that buffered data has been written to the OS
protocol stack.  If any errors are encountered, the socket is closed
and <code class="inline">{error, closed}</code> is returned by the next <a href="#recv/2"><code class="inline">recv/2</code></a> or <a href="#send/2"><code class="inline">send/2</code></a> call.</p><p>Option <code class="inline">{exit_on_close, false}</code> is useful if the peer performs a shurdown
of its write side.  Then the socket stays open for writing after
receive has indicated that the socket was closed.</p><p><a href="" id="async_shutdown_write"></a></p><section role="note" class="admonition info"><h4 class="admonition-title info">Note</h4><p>Async shutdown write (<code class="inline">How :: write | read_write</code>).</p><p>If the shutdown attempt is made while the inet driver is sending
buffered data in the background, the shutdown is postponed until
all buffered data has been sent.  This function immediately returns <code class="inline">ok</code>,
and the caller <em>isn't</em> informed (that the shutdown has been postponed).</p><p>When using <code class="inline">inet_backend = socket</code>, the behaviour is different. A shutdown
with <code class="inline">How :: write | read_write</code> will always be performed <em>immediately</em>.</p></section>
  </section>
</section>

    </div>
  </section>

    <footer class="footer">
      <p>

        <span class="line">
          <button class="a-main footer-button display-quick-switch" title="Search HexDocs packages">
            Search HexDocs
          </button>

            <a href="kernel.epub" title="ePub version">
              Download ePub version
            </a>

        </span>
      </p>

      <p class="built-using">
        Built using
        <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.37.3) for the

          <a href="https://erlang.org" title="Erlang" target="_blank" translate="no">Erlang programming language</a>

      </p>
<p>Copyright © 1996-2025 <a href="https://www.ericsson.com">Ericsson AB</a></p>
    </footer>
  </div>
</main>
</div>
  <script defer src="https://cdn.jsdelivr.net/npm/mermaid@11.4.1/dist/mermaid.min.js"></script>
  <script>
  let initialized = false;

  window.addEventListener("exdoc:loaded", () => {
      if (!initialized) {
      mermaid.initialize({
          startOnLoad: false,
          theme: document.body.className.includes("dark") ? "dark" : "default"
      });
      initialized = true;
      }

      let id = 0;
      for (const codeEl of document.querySelectorAll("pre code.mermaid")) {
      const preEl = codeEl.parentElement;
      const graphDefinition = codeEl.textContent;
      const graphEl = document.createElement("div");
      const graphId = "mermaid-graph-" + id++;
      mermaid.render(graphId, graphDefinition).then(({svg, bindFunctions}) => {
          graphEl.innerHTML = svg;
          bindFunctions?.(graphEl);
          preEl.insertAdjacentElement("afterend", graphEl);
          preEl.remove();
      });
      }
  });
  </script>

  </body>
</html>
