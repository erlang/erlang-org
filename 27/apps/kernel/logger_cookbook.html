<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.37.3">
    <meta name="project" content="kernel v10.2.7.1">


<meta name="exdoc:full-text-search-url" content="/doc/search.html?v=27&q=">
<meta name="major-vsn" content="27">
<link rel="canonical" href="https://www.erlang.org/docs/27/apps/kernel/logger_cookbook.html" />
    <title>Logging Cookbook — kernel v10.2.7.1</title>

    <link rel="stylesheet" href="dist/html-erlang-FDBURIED.css" />

    <script defer src="dist/sidebar_items-F62B6984.js"></script>
    <script defer src="docs_config.js"></script>
    <script defer src="dist/html-ALU6OERS.js"></script>

  </head>
  <body>
    <script>(()=>{var t="ex_doc:settings",e="dark";var o="dark",s="light";var E="sidebar_state",n="closed";var r="sidebar_width";var a="sidebar-open";var i=new URLSearchParams(window.location.search),S=i.get("theme")||JSON.parse(localStorage.getItem(t)||"{}").theme;(S===o||S!==s&&window.matchMedia("(prefers-color-scheme: dark)").matches)&&document.body.classList.add(e);var d=sessionStorage.getItem(E),A=d!==n&&!window.matchMedia(`screen and (max-width: ${768}px)`).matches;document.body.classList.toggle(a,A);var c=sessionStorage.getItem(r);c&&document.body.style.setProperty("--sidebarWidth",`${c}px`);var p=/(Macintosh|iPhone|iPad|iPod)/.test(window.navigator.userAgent);document.documentElement.classList.toggle("apple-os",p);})();
</script>

<div class="body-wrapper">

<button id="sidebar-menu" class="sidebar-button sidebar-toggle" aria-label="toggle sidebar" aria-controls="sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<nav id="sidebar" class="sidebar">

  <div class="sidebar-header">
    <div class="sidebar-projectInfo">

        <a href="../../index.html" class="sidebar-projectImage">
          <img src="assets/logo.png" alt="kernel" />
        </a>

      <div>
        <a href="../../index.html" class="sidebar-projectName" translate="no">
kernel
        </a>
        <div class="sidebar-projectVersion" translate="no">
          v10.2.7.1
        </div>
      </div>
    </div>
    <ul id="sidebar-list-nav" class="sidebar-list-nav" role="tablist" data-extras=""></ul>
  </div>
</nav>

<output role="status" id="toast"></output>

<main class="content page-extra" id="main" data-type="extras">
  <div id="content" class="content-inner">
    <div class="top-search">
      <div class="search-settings">
        <form class="search-bar" action="search.html">
          <label class="search-label">
            <span class="sr-only">Search documentation of kernel</span>
            <input name="q" type="text" class="search-input" placeholder="Press / to search" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
          </label>
          <button type="submit" class="search-button" aria-label="Submit Search" tabindex="-1">
            <i class="ri-search-2-line ri-lg" aria-hidden="true"></i>
          </button>
          <button type="button" tabindex="-1" class="search-close-button" aria-hidden="true">
            <i class="ri-close-line ri-lg" title="Cancel search"></i>
          </button>
        </form>
        <div class="autocomplete">
        </div>
        <button class="icon-settings display-settings">
          <i class="ri-settings-3-line"></i>
          <span class="sr-only">Settings</span>
        </button>
      </div>
    </div>

<div id="top-content">
  <div class="heading-with-actions top-heading">
    <h1>Logging Cookbook</h1>


      <a href="https://github.com/garazdawi/otp/blob/OTP-27.3.4.1/lib/kernel/doc/guides/logger_cookbook.md#L1" title="View Source" class="icon-action" rel="help">
        <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        <span class="sr-only">View Source</span>
      </a>

  </div>

<p>Using and especially configuring Logger can be difficult at times as there are
many different options that can be changed and often more than one way to
achieve the same result. This User's Guide tries to help by giving many
different examples of how you can use logger.</p><p>For more examples of practical use-cases of using Logger, Fred Hebert's blog
post
<a href="https://ferd.ca/erlang-otp-21-s-new-logger.html">Erlang/OTP 21's new logger</a> is
a great starting point.</p><section role="note" class="admonition info"><h4 class="admonition-title info">Note</h4><p>If you find that some common Logger usage is missing from this guide, please
open a pull request on github with the suggested addition</p></section><h2 id="get-logger-information" class="section-heading">
  <a href="#get-logger-information" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Get Logger information</span>
</h2>
<h3 id="print-the-primary-logger-configurations" class="section-heading">
  <a href="#print-the-primary-logger-configurations" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Print the primary Logger configurations.</span>
</h3>
<pre><code class="makeup erlang" translate="no"><span class="gp unselectable">1&gt; </span><span class="nc">logger</span><span class="p">:</span><span class="nf">i</span><span class="p" data-group-id="8832544218-1">(</span><span class="ss">primary</span><span class="p" data-group-id="8832544218-1">)</span><span class="p">.</span><span class="w">
</span><span class="n">Primary</span><span class="w"> </span><span class="nc">configuration</span><span class="p">:</span><span class="w">
    </span><span class="n">Level</span><span class="p">:</span><span class="w"> </span><span class="ss">notice</span><span class="w">
    </span><span class="n">Filter</span><span class="w"> </span><span class="n">Default</span><span class="p">:</span><span class="w"> </span><span class="ss">log</span><span class="w">
    </span><span class="n">Filters</span><span class="p">:</span><span class="w">
        </span><span class="p" data-group-id="8832544218-2">(</span><span class="ss">none</span><span class="p" data-group-id="8832544218-2">)</span></code></pre><p>It is also possible to fetch the configuration using
<a href="logger.html#get_primary_config/0"><code class="inline">logger:get_primary_config()</code></a>.</p><h4>See also</h4><ul><li><a href="logger.html#i/0">logger:i()</a></li><li><a href="logger_chapter.html#configuration">Configuration</a> in the Logging User's Guide</li></ul><h3 id="print-the-configuration-of-all-handlers" class="section-heading">
  <a href="#print-the-configuration-of-all-handlers" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Print the configuration of all handlers.</span>
</h3>
<pre><code class="makeup erlang" translate="no"><span class="gp unselectable">2&gt; </span><span class="nc">logger</span><span class="p">:</span><span class="nf">i</span><span class="p" data-group-id="0507136689-1">(</span><span class="ss">handlers</span><span class="p" data-group-id="0507136689-1">)</span><span class="p">.</span><span class="w">
</span><span class="n">Handler</span><span class="w"> </span><span class="nc">configuration</span><span class="p">:</span><span class="w">
    </span><span class="n">Id</span><span class="p">:</span><span class="w"> </span><span class="ss">default</span><span class="w">
        </span><span class="n">Module</span><span class="p">:</span><span class="w"> </span><span class="ss">logger_std_h</span><span class="w">
        </span><span class="n">Level</span><span class="p">:</span><span class="w">  </span><span class="ss">all</span><span class="w">
        </span><span class="n">Formatter</span><span class="p">:</span><span class="w">
            </span><span class="n">Module</span><span class="p">:</span><span class="w"> </span><span class="ss">logger_formatter</span><span class="w">
            </span><span class="n">Config</span><span class="p">:</span><span class="w">
                </span><span class="nc">legacy_header</span><span class="p">:</span><span class="w"> </span><span class="ss">true</span><span class="w">
                </span><span class="nc">single_line</span><span class="p">:</span><span class="w"> </span><span class="ss">false</span><span class="w">
        </span><span class="n">Filter</span><span class="w"> </span><span class="n">Default</span><span class="p">:</span><span class="w"> </span><span class="ss">stop</span><span class="w">
        </span><span class="n">Filters</span><span class="p">:</span><span class="w">
            </span><span class="n">Id</span><span class="p">:</span><span class="w"> </span><span class="ss">remote_gl</span><span class="w">
                </span><span class="n">Fun</span><span class="p">:</span><span class="w"> </span><span class="k">fun</span><span class="w"> </span><span class="nc">logger_filters</span><span class="p">:</span><span class="ss">remote_gl</span><span class="p">/</span><span class="mi">2</span><span class="w">
                </span><span class="n">Arg</span><span class="p">:</span><span class="w"> </span><span class="ss">stop</span><span class="w">
            </span><span class="n">Id</span><span class="p">:</span><span class="w"> </span><span class="ss">domain</span><span class="w">
                </span><span class="n">Fun</span><span class="p">:</span><span class="w"> </span><span class="k">fun</span><span class="w"> </span><span class="nc">logger_filters</span><span class="p">:</span><span class="ss">domain</span><span class="p">/</span><span class="mi">2</span><span class="w">
                </span><span class="n">Arg</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="0507136689-2">{</span><span class="ss">log</span><span class="p">,</span><span class="ss">super</span><span class="p">,</span><span class="p" data-group-id="0507136689-3">[</span><span class="ss">otp</span><span class="p">,</span><span class="ss">sasl</span><span class="p" data-group-id="0507136689-3">]</span><span class="p" data-group-id="0507136689-2">}</span><span class="w">
            </span><span class="n">Id</span><span class="p">:</span><span class="w"> </span><span class="ss">no_domain</span><span class="w">
                </span><span class="n">Fun</span><span class="p">:</span><span class="w"> </span><span class="k">fun</span><span class="w"> </span><span class="nc">logger_filters</span><span class="p">:</span><span class="ss">domain</span><span class="p">/</span><span class="mi">2</span><span class="w">
                </span><span class="n">Arg</span><span class="p">:</span><span class="w"> </span><span class="p" data-group-id="0507136689-4">{</span><span class="ss">log</span><span class="p">,</span><span class="ss">undefined</span><span class="p">,</span><span class="p" data-group-id="0507136689-5">[</span><span class="p" data-group-id="0507136689-5">]</span><span class="p" data-group-id="0507136689-4">}</span><span class="w">
        </span><span class="n">Handler</span><span class="w"> </span><span class="n">Config</span><span class="p">:</span><span class="w">
            </span><span class="nc">burst_limit_enable</span><span class="p">:</span><span class="w"> </span><span class="ss">true</span><span class="w">
            </span><span class="nc">burst_limit_max_count</span><span class="p">:</span><span class="w"> </span><span class="mi">500</span><span class="w">
            </span><span class="nc">burst_limit_window_time</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="w">
            </span><span class="nc">drop_mode_qlen</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="w">
            </span><span class="nc">filesync_repeat_interval</span><span class="p">:</span><span class="w"> </span><span class="ss">no_repeat</span><span class="w">
            </span><span class="nc">flush_qlen</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="w">
            </span><span class="nc">overload_kill_enable</span><span class="p">:</span><span class="w"> </span><span class="ss">false</span><span class="w">
            </span><span class="nc">overload_kill_mem_size</span><span class="p">:</span><span class="w"> </span><span class="mi">3000000</span><span class="w">
            </span><span class="nc">overload_kill_qlen</span><span class="p">:</span><span class="w"> </span><span class="mi">20000</span><span class="w">
            </span><span class="nc">overload_kill_restart_after</span><span class="p">:</span><span class="w"> </span><span class="mi">5000</span><span class="w">
            </span><span class="nc">sync_mode_qlen</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w">
            </span><span class="nc">type</span><span class="p">:</span><span class="w"> </span><span class="ss">standard_io</span></code></pre><p>You can also print the configuration of a specific handler using
<a href="logger.html#i/1"><code class="inline">logger:i(HandlerName)</code></a>, or fetch the configuration using
<a href="logger.html#get_handler_config/0"><code class="inline">logger:get_handler_config()</code></a>, or
<a href="logger.html#get_handler_config/1"><code class="inline">logger:get_handler_config(HandlerName)</code></a> for a
specific handler.</p><h4>See also</h4><ul><li><a href="logger.html#i/0"><code class="inline">logger:i()</code></a></li><li><a href="logger_chapter.html#configuration">Configuration</a> in the Logging User's Guide</li></ul><h2 id="configure-the-logger" class="section-heading">
  <a href="#configure-the-logger" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Configure the Logger</span>
</h2>
<h3 id="where-did-my-progress-reports-go" class="section-heading">
  <a href="#where-did-my-progress-reports-go" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Where did my progress reports go?</span>
</h3>
<p>In OTP-21 the default primary log level is <code class="inline">notice</code>. The means that many log
messages are by default not printed. This includes the progress reports of
supervisors. In order to get progress reports you need to raise the primary log
level to <code class="inline">info</code></p><pre><code class="makeup erlang" translate="no"><span class="sc">$ </span><span class="ss">erl</span><span class="w"> </span><span class="o">-</span><span class="ss">kernel</span><span class="w"> </span><span class="ss">logger_level</span><span class="w"> </span><span class="ss">info</span><span class="w">
</span><span class="o">=</span><span class="n">PROGRESS</span><span class="w"> </span><span class="n">REPORT</span><span class="o">==</span><span class="o">==</span><span class="w"> </span><span class="mi">4</span><span class="o">-</span><span class="n">Nov</span><span class="o">-</span><span class="mi">2019</span><span class="p">:</span><span class="p">:</span><span class="mi">16</span><span class="p">:</span><span class="mi">33</span><span class="p">:</span><span class="mf">11.742069</span><span class="w"> </span><span class="o">==</span><span class="o">=</span><span class="w">
    </span><span class="nc">application</span><span class="p">:</span><span class="w"> </span><span class="ss">kernel</span><span class="w">
    </span><span class="nc">started_at</span><span class="p">:</span><span class="w"> </span><span class="ss">nonode@nohost</span><span class="w">
</span><span class="o">=</span><span class="n">PROGRESS</span><span class="w"> </span><span class="n">REPORT</span><span class="o">==</span><span class="o">==</span><span class="w"> </span><span class="mi">4</span><span class="o">-</span><span class="n">Nov</span><span class="o">-</span><span class="mi">2019</span><span class="p">:</span><span class="p">:</span><span class="mi">16</span><span class="p">:</span><span class="mi">33</span><span class="p">:</span><span class="mf">11.746546</span><span class="w"> </span><span class="o">==</span><span class="o">=</span><span class="w">
    </span><span class="nc">application</span><span class="p">:</span><span class="w"> </span><span class="ss">stdlib</span><span class="w">
    </span><span class="nc">started_at</span><span class="p">:</span><span class="w"> </span><span class="ss">nonode@nohost</span><span class="w">
</span><span class="n">Eshell</span><span class="w"> </span><span class="n">V10</span><span class="p">.</span><span class="mf">5.3</span><span class="w">  </span><span class="p" data-group-id="8443247556-1">(</span><span class="ss">abort</span><span class="w"> </span><span class="ss">with</span><span class="w"> </span><span class="err">^</span><span class="n">G</span><span class="p" data-group-id="8443247556-1">)</span><span class="w">
</span><span class="mi">1</span><span class="o">&gt;</span></code></pre><h2 id="configure-logger-formatter" class="section-heading">
  <a href="#configure-logger-formatter" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Configure Logger formatter</span>
</h2>
<p>In order to fit better into your existing logging infrastructure Logger can
format its logging messages any way you want to. Either you can use the built-in
formatter, or you can build your own.</p><h3 id="single-line-configuration" class="section-heading">
  <a href="#single-line-configuration" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Single line configuration</span>
</h3>
<p>Since single line logging is the default of the built-in formatter you only have
to provide the empty map as the configuration. The example below uses the
<code class="inline">sys.config</code> to change the formatter configuration.</p><pre><code class="makeup erlang" translate="no"><span class="sc">$ </span><span class="ss">cat</span><span class="w"> </span><span class="ss">sys</span><span class="p">.</span><span class="ss">config</span><span class="w">
</span><span class="p" data-group-id="0443670120-1">[</span><span class="p" data-group-id="0443670120-2">{</span><span class="ss">kernel</span><span class="p">,</span><span class="w">
  </span><span class="p" data-group-id="0443670120-3">[</span><span class="p" data-group-id="0443670120-4">{</span><span class="ss">logger</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="0443670120-5">[</span><span class="p" data-group-id="0443670120-6">{</span><span class="ss">handler</span><span class="p">,</span><span class="w"> </span><span class="ss">default</span><span class="p">,</span><span class="w"> </span><span class="ss">logger_std_h</span><span class="p">,</span><span class="w">
      </span><span class="p" data-group-id="0443670120-7">#{</span><span class="w"> </span><span class="ss">formatter</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p" data-group-id="0443670120-8">{</span><span class="ss">logger_formatter</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="0443670120-9">#{</span><span class="w"> </span><span class="p" data-group-id="0443670120-9">}</span><span class="p" data-group-id="0443670120-8">}</span><span class="p" data-group-id="0443670120-7">}</span><span class="p" data-group-id="0443670120-6">}</span><span class="p" data-group-id="0443670120-5">]</span><span class="p" data-group-id="0443670120-4">}</span><span class="p" data-group-id="0443670120-3">]</span><span class="p" data-group-id="0443670120-2">}</span><span class="p" data-group-id="0443670120-1">]</span><span class="p">.</span><span class="w">
</span><span class="sc">$ </span><span class="ss">erl</span><span class="w"> </span><span class="o">-</span><span class="ss">config</span><span class="w"> </span><span class="ss">sys</span><span class="w">
</span><span class="n">Eshell</span><span class="w"> </span><span class="n">V10</span><span class="p">.</span><span class="mf">5.1</span><span class="w">  </span><span class="p" data-group-id="0443670120-10">(</span><span class="ss">abort</span><span class="w"> </span><span class="ss">with</span><span class="w"> </span><span class="err">^</span><span class="n">G</span><span class="p" data-group-id="0443670120-10">)</span><span class="gp unselectable">
1&gt; </span><span class="nc">logger</span><span class="p">:</span><span class="nf">error</span><span class="p" data-group-id="0443670120-11">(</span><span class="s">&quot;Oh noes, an error&quot;</span><span class="p" data-group-id="0443670120-11">)</span><span class="p">.</span><span class="w">
</span><span class="mi">1962</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">03</span><span class="n">T11</span><span class="p">:</span><span class="mi">07</span><span class="p">:</span><span class="mf">47.466763</span><span class="o">-</span><span class="mi">04</span><span class="p">:</span><span class="mi">00</span><span class="w"> </span><span class="nc">error</span><span class="p">:</span><span class="w"> </span><span class="n">Oh</span><span class="w"> </span><span class="ss">noes</span><span class="p">,</span><span class="w"> </span><span class="ss">an</span><span class="w"> </span><span class="ss">error</span></code></pre><p>However, if you just want to change it for the current session you can also do
that.</p><pre><code class="makeup erlang" translate="no"><span class="gp unselectable">1&gt; </span><span class="nc">logger</span><span class="p">:</span><span class="nf">set_handler_config</span><span class="p" data-group-id="4341934647-1">(</span><span class="ss">default</span><span class="p">,</span><span class="w"> </span><span class="ss">formatter</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="4341934647-2">{</span><span class="ss">logger_formatter</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="4341934647-3">#{</span><span class="p" data-group-id="4341934647-3">}</span><span class="p" data-group-id="4341934647-2">}</span><span class="p" data-group-id="4341934647-1">)</span><span class="p">.</span><span class="w">
</span><span class="ss">ok</span><span class="gp unselectable">
2&gt; </span><span class="nc">logger</span><span class="p">:</span><span class="nf">error</span><span class="p" data-group-id="4341934647-4">(</span><span class="s">&quot;Oh noes, another error&quot;</span><span class="p" data-group-id="4341934647-4">)</span><span class="p">.</span><span class="w">
</span><span class="mi">1962</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">04</span><span class="n">T15</span><span class="p">:</span><span class="mi">34</span><span class="p">:</span><span class="mf">02.648713</span><span class="o">-</span><span class="mi">04</span><span class="p">:</span><span class="mi">00</span><span class="w"> </span><span class="nc">error</span><span class="p">:</span><span class="w"> </span><span class="n">Oh</span><span class="w"> </span><span class="ss">noes</span><span class="p">,</span><span class="w"> </span><span class="ss">another</span><span class="w"> </span><span class="ss">error</span></code></pre><h4>See also</h4><ul><li><a href="logger_formatter.html#t:config/0">logger_formatter's Configuration</a></li><li><a href="logger_chapter.html#formatters">Formatters</a> in the Logging User's Guide</li><li><a href="logger.html#set_handler_config/3"><code class="inline">logger:set_handler_config/3</code></a></li></ul><h3 id="add-file-and-line-number-to-log-entries" class="section-heading">
  <a href="#add-file-and-line-number-to-log-entries" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Add file and line number to log entries</span>
</h3>
<p>You can change what is printed to the log by using the formatter template:</p><pre><code class="makeup erlang" translate="no"><span class="sc">$ </span><span class="ss">cat</span><span class="w"> </span><span class="ss">sys</span><span class="p">.</span><span class="ss">config</span><span class="w">
</span><span class="p" data-group-id="6832400752-1">[</span><span class="p" data-group-id="6832400752-2">{</span><span class="ss">kernel</span><span class="p">,</span><span class="w">
  </span><span class="p" data-group-id="6832400752-3">[</span><span class="p" data-group-id="6832400752-4">{</span><span class="ss">logger</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="6832400752-5">[</span><span class="p" data-group-id="6832400752-6">{</span><span class="ss">handler</span><span class="p">,</span><span class="w"> </span><span class="ss">default</span><span class="p">,</span><span class="w"> </span><span class="ss">logger_std_h</span><span class="p">,</span><span class="w">
      </span><span class="p" data-group-id="6832400752-7">#{</span><span class="w"> </span><span class="ss">formatter</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p" data-group-id="6832400752-8">{</span><span class="ss">logger_formatter</span><span class="p">,</span><span class="w">
        </span><span class="p" data-group-id="6832400752-9">#{</span><span class="w"> </span><span class="ss">template</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p" data-group-id="6832400752-10">[</span><span class="ss">time</span><span class="p">,</span><span class="s">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">file</span><span class="p">,</span><span class="s">&quot;:&quot;</span><span class="p">,</span><span class="ss">line</span><span class="p">,</span><span class="s">&quot; &quot;</span><span class="p">,</span><span class="ss">level</span><span class="p">,</span><span class="s">&quot;: &quot;</span><span class="p">,</span><span class="ss">msg</span><span class="p">,</span><span class="s">&quot;\n&quot;</span><span class="p" data-group-id="6832400752-10">]</span><span class="w"> </span><span class="p" data-group-id="6832400752-9">}</span><span class="p" data-group-id="6832400752-8">}</span><span class="p" data-group-id="6832400752-7">}</span><span class="p" data-group-id="6832400752-6">}</span><span class="p" data-group-id="6832400752-5">]</span><span class="p" data-group-id="6832400752-4">}</span><span class="p" data-group-id="6832400752-3">]</span><span class="p" data-group-id="6832400752-2">}</span><span class="p" data-group-id="6832400752-1">]</span><span class="p">.</span><span class="w">
</span><span class="sc">$ </span><span class="ss">erl</span><span class="w"> </span><span class="o">-</span><span class="ss">config</span><span class="w"> </span><span class="ss">sys</span><span class="w">
</span><span class="n">Eshell</span><span class="w"> </span><span class="n">V10</span><span class="p">.</span><span class="mf">5.1</span><span class="w">  </span><span class="p" data-group-id="6832400752-11">(</span><span class="ss">abort</span><span class="w"> </span><span class="ss">with</span><span class="w"> </span><span class="err">^</span><span class="n">G</span><span class="p" data-group-id="6832400752-11">)</span><span class="gp unselectable">
1&gt; </span><span class="nc">logger</span><span class="p">:</span><span class="nf">error</span><span class="p" data-group-id="6832400752-12">(</span><span class="s">&quot;Oh noes, more errors&quot;</span><span class="p">,</span><span class="p" data-group-id="6832400752-13">#{</span><span class="w"> </span><span class="ss">file</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s">&quot;shell.erl&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">line</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p" data-group-id="6832400752-13">}</span><span class="p" data-group-id="6832400752-12">)</span><span class="p">.</span><span class="w">
</span><span class="mi">1962</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">05</span><span class="n">T07</span><span class="p">:</span><span class="mi">37</span><span class="p">:</span><span class="mf">44.104241</span><span class="o">+</span><span class="mi">02</span><span class="p">:</span><span class="mi">00</span><span class="w"> </span><span class="ss">shell</span><span class="p">.</span><span class="nc">erl</span><span class="p">:</span><span class="mi">1</span><span class="w"> </span><span class="nc">error</span><span class="p">:</span><span class="w"> </span><span class="n">Oh</span><span class="w"> </span><span class="ss">noes</span><span class="p">,</span><span class="w"> </span><span class="ss">more</span><span class="w"> </span><span class="ss">errors</span></code></pre><p>Note that file and line have to be added in the metadata by the caller of
<a href="logger.html#log/3"><code class="inline">logger:log/3</code></a> as otherwise Logger will not know from where it was called. The
file and line number are automatically added if you use the <code class="inline">?LOG_ERROR</code> macros
in <code class="inline">kernel/include/logger.hrl</code>.</p><h4>See also</h4><ul><li><a href="logger_formatter.html#t:config/0">logger_formatter's Configuration</a></li><li><a href="logger_formatter.html#t:template/0">logger_formatter's Template</a></li><li><a href="logger.html#module-macros">Logger Macros</a></li><li><a href="logger_chapter.html#metadata">Metadata</a> in the Logging User's Guide</li></ul><h2 id="configuring-handlers" class="section-heading">
  <a href="#configuring-handlers" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Configuring handlers</span>
</h2>
<h3 id="print-logs-to-a-file" class="section-heading">
  <a href="#print-logs-to-a-file" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Print logs to a file</span>
</h3>
<p>Instead of printing the logs to stdout we print them to a rotating file log.</p><pre><code class="makeup erlang" translate="no"><span class="sc">$ </span><span class="ss">cat</span><span class="w"> </span><span class="ss">sys</span><span class="p">.</span><span class="ss">config</span><span class="w">
</span><span class="p" data-group-id="3005755753-1">[</span><span class="p" data-group-id="3005755753-2">{</span><span class="ss">kernel</span><span class="p">,</span><span class="w">
  </span><span class="p" data-group-id="3005755753-3">[</span><span class="p" data-group-id="3005755753-4">{</span><span class="ss">logger</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="3005755753-5">[</span><span class="p" data-group-id="3005755753-6">{</span><span class="ss">handler</span><span class="p">,</span><span class="w"> </span><span class="ss">default</span><span class="p">,</span><span class="w"> </span><span class="ss">logger_std_h</span><span class="p">,</span><span class="w">
      </span><span class="p" data-group-id="3005755753-7">#{</span><span class="w"> </span><span class="ss">config</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p" data-group-id="3005755753-8">#{</span><span class="w"> </span><span class="ss">file</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s">&quot;log/erlang.log&quot;</span><span class="p">,</span><span class="w">
                      </span><span class="ss">max_no_bytes</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="mi">4096</span><span class="p">,</span><span class="w">
                      </span><span class="ss">max_no_files</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="mi">5</span><span class="p" data-group-id="3005755753-8">}</span><span class="p">,</span><span class="w">
         </span><span class="ss">formatter</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p" data-group-id="3005755753-9">{</span><span class="ss">logger_formatter</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="3005755753-10">#{</span><span class="p" data-group-id="3005755753-10">}</span><span class="p" data-group-id="3005755753-9">}</span><span class="p" data-group-id="3005755753-7">}</span><span class="p" data-group-id="3005755753-6">}</span><span class="p" data-group-id="3005755753-5">]</span><span class="p" data-group-id="3005755753-4">}</span><span class="p" data-group-id="3005755753-3">]</span><span class="p" data-group-id="3005755753-2">}</span><span class="p" data-group-id="3005755753-1">]</span><span class="p">.</span><span class="w">
</span><span class="sc">$ </span><span class="ss">erl</span><span class="w"> </span><span class="o">-</span><span class="ss">config</span><span class="w"> </span><span class="ss">sys</span><span class="w">
</span><span class="n">Eshell</span><span class="w"> </span><span class="n">V10</span><span class="p">.</span><span class="mf">5.1</span><span class="w">  </span><span class="p" data-group-id="3005755753-11">(</span><span class="ss">abort</span><span class="w"> </span><span class="ss">with</span><span class="w"> </span><span class="err">^</span><span class="n">G</span><span class="p" data-group-id="3005755753-11">)</span><span class="gp unselectable">
1&gt; </span><span class="nc">logger</span><span class="p">:</span><span class="nf">error</span><span class="p" data-group-id="3005755753-12">(</span><span class="s">&quot;Oh noes, even more errors&quot;</span><span class="p" data-group-id="3005755753-12">)</span><span class="p">.</span><span class="w">
</span><span class="ss">ok</span><span class="gp unselectable">
2&gt; </span><span class="nc">erlang</span><span class="p">:</span><span class="nf">halt</span><span class="p" data-group-id="3005755753-13">(</span><span class="p" data-group-id="3005755753-13">)</span><span class="p">.</span><span class="w">
</span><span class="sc">$ </span><span class="ss">cat</span><span class="w"> </span><span class="ss">log</span><span class="o">/</span><span class="ss">erlang</span><span class="p">.</span><span class="ss">log</span><span class="w">
</span><span class="mi">2019</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">07</span><span class="n">T11</span><span class="p">:</span><span class="mi">47</span><span class="p">:</span><span class="mf">16.837958</span><span class="o">+</span><span class="mi">02</span><span class="p">:</span><span class="mi">00</span><span class="w"> </span><span class="nc">error</span><span class="p">:</span><span class="w"> </span><span class="n">Oh</span><span class="w"> </span><span class="ss">noes</span><span class="p">,</span><span class="w"> </span><span class="ss">even</span><span class="w"> </span><span class="ss">more</span><span class="w"> </span><span class="ss">errors</span></code></pre><h4>See also</h4><ul><li><a href="logger_std_h.html"><code class="inline">logger_std_h</code></a></li><li><a href="logger_chapter.html#handlers">Handlers</a> in the Logging User's Guide</li></ul><h3 id="debug-only-handler" class="section-heading">
  <a href="#debug-only-handler" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Debug only handler</span>
</h3>
<p>Add a handler that prints <code class="inline">debug</code> log events to a file, while the default
handler prints only up to <code class="inline">notice</code> level events to standard out.</p><pre><code class="makeup erlang" translate="no"><span class="sc">$ </span><span class="ss">cat</span><span class="w"> </span><span class="ss">sys</span><span class="p">.</span><span class="ss">config</span><span class="w">
</span><span class="p" data-group-id="1265200639-1">[</span><span class="p" data-group-id="1265200639-2">{</span><span class="ss">kernel</span><span class="p">,</span><span class="w">
  </span><span class="p" data-group-id="1265200639-3">[</span><span class="p" data-group-id="1265200639-4">{</span><span class="ss">logger_level</span><span class="p">,</span><span class="w"> </span><span class="ss">all</span><span class="p" data-group-id="1265200639-4">}</span><span class="p">,</span><span class="w">
   </span><span class="p" data-group-id="1265200639-5">{</span><span class="ss">logger</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="1265200639-6">[</span><span class="p" data-group-id="1265200639-7">{</span><span class="ss">handler</span><span class="p">,</span><span class="w"> </span><span class="ss">default</span><span class="p">,</span><span class="w"> </span><span class="ss">logger_std_h</span><span class="p">,</span><span class="w">
      </span><span class="p" data-group-id="1265200639-8">#{</span><span class="w"> </span><span class="ss">level</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ss">notice</span><span class="w"> </span><span class="p" data-group-id="1265200639-8">}</span><span class="p" data-group-id="1265200639-7">}</span><span class="p">,</span><span class="w">
     </span><span class="p" data-group-id="1265200639-9">{</span><span class="ss">handler</span><span class="p">,</span><span class="w"> </span><span class="ss">debug</span><span class="p">,</span><span class="w"> </span><span class="ss">logger_std_h</span><span class="p">,</span><span class="w">
      </span><span class="p" data-group-id="1265200639-10">#{</span><span class="w"> </span><span class="ss">filters</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p" data-group-id="1265200639-11">[</span><span class="p" data-group-id="1265200639-12">{</span><span class="ss">debug</span><span class="p">,</span><span class="p" data-group-id="1265200639-13">{</span><span class="k">fun</span><span class="w"> </span><span class="nc">logger_filters</span><span class="p">:</span><span class="ss">level</span><span class="p">/</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="1265200639-14">{</span><span class="ss">stop</span><span class="p">,</span><span class="w"> </span><span class="ss">neq</span><span class="p">,</span><span class="w"> </span><span class="ss">debug</span><span class="p" data-group-id="1265200639-14">}</span><span class="p" data-group-id="1265200639-13">}</span><span class="p" data-group-id="1265200639-12">}</span><span class="p" data-group-id="1265200639-11">]</span><span class="p">,</span><span class="w">
         </span><span class="ss">config</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p" data-group-id="1265200639-15">#{</span><span class="w"> </span><span class="ss">file</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s">&quot;log/debug.log&quot;</span><span class="w"> </span><span class="p" data-group-id="1265200639-15">}</span><span class="w"> </span><span class="p" data-group-id="1265200639-10">}</span><span class="p" data-group-id="1265200639-9">}</span><span class="w">
    </span><span class="p" data-group-id="1265200639-6">]</span><span class="p" data-group-id="1265200639-5">}</span><span class="p" data-group-id="1265200639-3">]</span><span class="p" data-group-id="1265200639-2">}</span><span class="p" data-group-id="1265200639-1">]</span><span class="p">.</span><span class="w">
</span><span class="sc">$ </span><span class="ss">erl</span><span class="w"> </span><span class="o">-</span><span class="ss">config</span><span class="w"> </span><span class="ss">sys</span><span class="w">
</span><span class="n">Eshell</span><span class="w"> </span><span class="n">V10</span><span class="p">.</span><span class="mf">5.1</span><span class="w">  </span><span class="p" data-group-id="1265200639-16">(</span><span class="ss">abort</span><span class="w"> </span><span class="ss">with</span><span class="w"> </span><span class="err">^</span><span class="n">G</span><span class="p" data-group-id="1265200639-16">)</span><span class="gp unselectable">
1&gt; </span><span class="nc">logger</span><span class="p">:</span><span class="nf">error</span><span class="p" data-group-id="1265200639-17">(</span><span class="s">&quot;Oh noes, even more errors&quot;</span><span class="p" data-group-id="1265200639-17">)</span><span class="p">.</span><span class="w">
</span><span class="o">=</span><span class="n">ERROR</span><span class="w"> </span><span class="n">REPORT</span><span class="o">==</span><span class="o">==</span><span class="w"> </span><span class="mi">9</span><span class="o">-</span><span class="n">Oct</span><span class="o">-</span><span class="mi">2019</span><span class="p">:</span><span class="p">:</span><span class="mi">14</span><span class="p">:</span><span class="mi">40</span><span class="p">:</span><span class="mf">54.784162</span><span class="w"> </span><span class="o">==</span><span class="o">=</span><span class="w">
</span><span class="n">Oh</span><span class="w"> </span><span class="ss">noes</span><span class="p">,</span><span class="w"> </span><span class="ss">even</span><span class="w"> </span><span class="ss">more</span><span class="w"> </span><span class="ss">errors</span><span class="w">
</span><span class="ss">ok</span><span class="gp unselectable">
2&gt; </span><span class="nc">logger</span><span class="p">:</span><span class="nf">debug</span><span class="p" data-group-id="1265200639-18">(</span><span class="s">&quot;A debug event&quot;</span><span class="p" data-group-id="1265200639-18">)</span><span class="p">.</span><span class="w">
</span><span class="ss">ok</span><span class="gp unselectable">
3&gt; </span><span class="nc">erlang</span><span class="p">:</span><span class="nf">halt</span><span class="p" data-group-id="1265200639-19">(</span><span class="p" data-group-id="1265200639-19">)</span><span class="p">.</span><span class="w">
</span><span class="sc">$ </span><span class="ss">cat</span><span class="w"> </span><span class="ss">log</span><span class="o">/</span><span class="ss">debug</span><span class="p">.</span><span class="ss">log</span><span class="w">
</span><span class="mi">2019</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">09</span><span class="n">T14</span><span class="p">:</span><span class="mi">41</span><span class="p">:</span><span class="mf">03.680541</span><span class="o">+</span><span class="mi">02</span><span class="p">:</span><span class="mi">00</span><span class="w"> </span><span class="nc">debug</span><span class="p">:</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="ss">debug</span><span class="w"> </span><span class="ss">event</span></code></pre><p>In the configuration above we first raise the primary log level to max in order
for the debug log events to get to the handlers. Then we configure the default
handler to only log notice and below events, the default log level for a handler
is <code class="inline">all</code>. Then the debug handler is configured with a filter to stop any log
message that is not a debug level message.</p><p>It is also possible to do the same changes in an already running system using
the <code class="inline">logger</code> module. Then you do like this:</p><pre><code class="makeup erlang" translate="no"><span class="sc">$ </span><span class="ss">erl</span><span class="gp unselectable">
1&gt; </span><span class="nc">logger</span><span class="p">:</span><span class="nf">set_handler_config</span><span class="p" data-group-id="7195397048-1">(</span><span class="ss">default</span><span class="p">,</span><span class="w"> </span><span class="ss">level</span><span class="p">,</span><span class="w"> </span><span class="ss">notice</span><span class="p" data-group-id="7195397048-1">)</span><span class="p">.</span><span class="w">
</span><span class="ss">ok</span><span class="gp unselectable">
2&gt; </span><span class="nc">logger</span><span class="p">:</span><span class="nf">add_handler</span><span class="p" data-group-id="7195397048-2">(</span><span class="ss">debug</span><span class="p">,</span><span class="w"> </span><span class="ss">logger_std_h</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="7195397048-3">#{</span><span class="w">
  </span><span class="ss">filters</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p" data-group-id="7195397048-4">[</span><span class="p" data-group-id="7195397048-5">{</span><span class="ss">debug</span><span class="p">,</span><span class="p" data-group-id="7195397048-6">{</span><span class="k">fun</span><span class="w"> </span><span class="nc">logger_filters</span><span class="p">:</span><span class="ss">level</span><span class="p">/</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="7195397048-7">{</span><span class="ss">stop</span><span class="p">,</span><span class="w"> </span><span class="ss">neq</span><span class="p">,</span><span class="w"> </span><span class="ss">debug</span><span class="p" data-group-id="7195397048-7">}</span><span class="p" data-group-id="7195397048-6">}</span><span class="p" data-group-id="7195397048-5">}</span><span class="p" data-group-id="7195397048-4">]</span><span class="p">,</span><span class="w">
  </span><span class="ss">config</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p" data-group-id="7195397048-8">#{</span><span class="w"> </span><span class="ss">file</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="s">&quot;log/debug.log&quot;</span><span class="w"> </span><span class="p" data-group-id="7195397048-8">}</span><span class="w"> </span><span class="p" data-group-id="7195397048-3">}</span><span class="p" data-group-id="7195397048-2">)</span><span class="p">.</span><span class="w">
</span><span class="ss">ok</span><span class="gp unselectable">
3&gt; </span><span class="nc">logger</span><span class="p">:</span><span class="nf">set_primary_config</span><span class="p" data-group-id="7195397048-9">(</span><span class="ss">level</span><span class="p">,</span><span class="w"> </span><span class="ss">all</span><span class="p" data-group-id="7195397048-9">)</span><span class="p">.</span><span class="w">
</span><span class="ss">ok</span></code></pre><p>It is important that you do not raise the primary log level before adjusting the
default handler's level as otherwise your standard out may be flooded by debug
log messages.</p><h4>See also</h4><ul><li><a href="logger_std_h.html"><code class="inline">logger_std_h</code></a></li><li><a href="logger_chapter.html#filters">Filters</a> in the Logging User's Guide</li></ul><h2 id="logging" class="section-heading">
  <a href="#logging" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Logging</span>
</h2>
<h3 id="what-to-log-and-how" class="section-heading">
  <a href="#what-to-log-and-how" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">What to log and how</span>
</h3>
<p>The simplest way to log something is by using the Logger macros and give a
report to the macro. For example if you want to log an error:</p><pre><code class="makeup erlang" translate="no"><span class="o">?</span><span class="n">LOG_ERROR</span><span class="p" data-group-id="1509581935-1">(</span><span class="p" data-group-id="1509581935-2">#{</span><span class="w"> </span><span class="ss">what</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ss">http_error</span><span class="p">,</span><span class="w"> </span><span class="ss">status</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="mi">418</span><span class="p">,</span><span class="w"> </span><span class="ss">src</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="n">ClientIP</span><span class="p">,</span><span class="w"> </span><span class="ss">dst</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="n">ServerIP</span><span class="w"> </span><span class="p" data-group-id="1509581935-2">}</span><span class="p" data-group-id="1509581935-1">)</span><span class="p">.</span></code></pre><p>This will print the following in the default log:</p><pre><code class="text">=ERROR REPORT==== 10-Oct-2019::12:13:10.089073 ===
    dst: {8,8,4,4}
    src: {8,8,8,8}
    status: 418
    what: http_error</code></pre><p>or the below if you use a single line formatter:</p><pre><code class="text">2019-10-10T12:14:11.921843+02:00 error: dst: {8,8,4,4}, src: {8,8,8,8}, status: 418, what: http_error</code></pre><h4>See also</h4><ul><li><a href="logger_chapter.html#log-message">Log Message</a> in the Logging User's Guide</li></ul><h3 id="report-call-backs-and-printing-of-events" class="section-heading">
  <a href="#report-call-backs-and-printing-of-events" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Report call-backs and printing of events</span>
</h3>
<p>If you want to do structured logging, but still want to have some control of how
the final log message is formatted you can give a <code class="inline">report_cb</code> as part of the
metadata with your log event.</p><pre><code class="makeup erlang" translate="no"><span class="n">ReportCB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">fun</span><span class="p" data-group-id="4499817546-1">(</span><span class="p" data-group-id="4499817546-2">#{</span><span class="w"> </span><span class="ss">what</span><span class="w"> </span><span class="p">:=</span><span class="w"> </span><span class="n">What</span><span class="p">,</span><span class="w"> </span><span class="ss">status</span><span class="w"> </span><span class="p">:=</span><span class="w"> </span><span class="n">Status</span><span class="p">,</span><span class="w"> </span><span class="ss">src</span><span class="w"> </span><span class="p">:=</span><span class="w"> </span><span class="n">Src</span><span class="p">,</span><span class="w"> </span><span class="ss">dst</span><span class="w"> </span><span class="p">:=</span><span class="w"> </span><span class="n">Dst</span><span class="w"> </span><span class="p" data-group-id="4499817546-2">}</span><span class="p" data-group-id="4499817546-1">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w">
                   </span><span class="p" data-group-id="4499817546-3">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="o">#</span><span class="ss">hostent</span><span class="p" data-group-id="4499817546-4">{</span><span class="w"> </span><span class="ss">h_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SrcName</span><span class="w"> </span><span class="p" data-group-id="4499817546-4">}</span><span class="p" data-group-id="4499817546-3">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">inet</span><span class="p">:</span><span class="nf">gethostbyaddr</span><span class="p" data-group-id="4499817546-5">(</span><span class="n">Src</span><span class="p" data-group-id="4499817546-5">)</span><span class="p">,</span><span class="w">
                   </span><span class="p" data-group-id="4499817546-6">{</span><span class="ss">ok</span><span class="p">,</span><span class="w"> </span><span class="o">#</span><span class="ss">hostent</span><span class="p" data-group-id="4499817546-7">{</span><span class="w"> </span><span class="ss">h_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DstName</span><span class="w"> </span><span class="p" data-group-id="4499817546-7">}</span><span class="p" data-group-id="4499817546-6">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">inet</span><span class="p">:</span><span class="nf">gethostbyaddr</span><span class="p" data-group-id="4499817546-8">(</span><span class="n">Dst</span><span class="p" data-group-id="4499817546-8">)</span><span class="p">,</span><span class="w">
                   </span><span class="p" data-group-id="4499817546-9">{</span><span class="s">&quot;What: </span><span class="si">~p</span><span class="si">~n</span><span class="s">Status: </span><span class="si">~p</span><span class="si">~n</span><span class="s">Src: </span><span class="si">~s</span><span class="s"> (</span><span class="si">~s</span><span class="s">)</span><span class="si">~n</span><span class="s">Dst: </span><span class="si">~s</span><span class="s"> (</span><span class="si">~s</span><span class="s">)</span><span class="si">~n</span><span class="s">&quot;</span><span class="p">,</span><span class="w">
                    </span><span class="p" data-group-id="4499817546-10">[</span><span class="n">What</span><span class="p">,</span><span class="w"> </span><span class="n">Status</span><span class="p">,</span><span class="w"> </span><span class="nc">inet</span><span class="p">:</span><span class="nf">ntoa</span><span class="p" data-group-id="4499817546-11">(</span><span class="n">Src</span><span class="p" data-group-id="4499817546-11">)</span><span class="p">,</span><span class="w"> </span><span class="n">SrcName</span><span class="p">,</span><span class="w"> </span><span class="nc">inet</span><span class="p">:</span><span class="nf">ntoa</span><span class="p" data-group-id="4499817546-12">(</span><span class="n">Dst</span><span class="p" data-group-id="4499817546-12">)</span><span class="p">,</span><span class="w"> </span><span class="n">DstName</span><span class="p" data-group-id="4499817546-10">]</span><span class="p" data-group-id="4499817546-9">}</span><span class="w">
           </span><span class="k">end</span><span class="p">,</span><span class="w">
</span><span class="o">?</span><span class="n">LOG_ERROR</span><span class="p" data-group-id="4499817546-13">(</span><span class="p" data-group-id="4499817546-14">#{</span><span class="w"> </span><span class="ss">what</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="ss">http_error</span><span class="p">,</span><span class="w"> </span><span class="ss">status</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="mi">418</span><span class="p">,</span><span class="w"> </span><span class="ss">src</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="n">ClientIP</span><span class="p">,</span><span class="w"> </span><span class="ss">dst</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="n">ServerIP</span><span class="w"> </span><span class="p" data-group-id="4499817546-14">}</span><span class="p">,</span><span class="w">
           </span><span class="p" data-group-id="4499817546-15">#{</span><span class="w"> </span><span class="ss">report_cb</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="n">ReportCB</span><span class="w"> </span><span class="p" data-group-id="4499817546-15">}</span><span class="p" data-group-id="4499817546-13">)</span><span class="p">.</span></code></pre><p>This will print the following:</p><pre><code class="text">=ERROR REPORT==== 10-Oct-2019::13:29:02.230863 ===
What: http_error
Status: 418
Src: 8.8.8.8 (dns.google)
Dst: 192.121.151.106 (erlang.org)</code></pre><p>Note that the order that things are printed have changed, and also I added a
reverse-dns lookup of the IP address. This will not print as nicely when using a
single line formatter, however you can also use a report_cb fun with 2 arguments
where the second argument is the formatting options.</p><h4>See also</h4><ul><li><a href="logger_chapter.html#log-message">Log Message</a> in the Logging User's Guide</li><li><a href="logger.html#t:report_cb/0">Logger Report Callbacks</a></li></ul><h2 id="filters" class="section-heading">
  <a href="#filters" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Filters</span>
</h2>
<p>Filters are used to remove or change log events before they reach the handlers.</p><h3 id="process-filters" class="section-heading">
  <a href="#process-filters" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Process filters</span>
</h3>
<p>If we only want debug messages from a specific process it is possible to do this
with a filter like this:</p><pre><code class="makeup erlang" translate="no"><span class="c1">%% Initial setup to use a filter for the level filter instead of the primary level</span><span class="w">
</span><span class="n">PrimaryLevel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">maps</span><span class="p">:</span><span class="nf">get</span><span class="p" data-group-id="7582700781-1">(</span><span class="ss">level</span><span class="p">,</span><span class="w"> </span><span class="nc">logger</span><span class="p">:</span><span class="nf">get_primary_config</span><span class="p" data-group-id="7582700781-2">(</span><span class="p" data-group-id="7582700781-2">)</span><span class="p" data-group-id="7582700781-1">)</span><span class="p">,</span><span class="w">
</span><span class="ss">ok</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">logger</span><span class="p">:</span><span class="nf">add_primary_filter</span><span class="p" data-group-id="7582700781-3">(</span><span class="ss">primary_level</span><span class="p">,</span><span class="w">
    </span><span class="p" data-group-id="7582700781-4">{</span><span class="k">fun</span><span class="w"> </span><span class="nc">logger_filters</span><span class="p">:</span><span class="ss">level</span><span class="p">/</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="7582700781-5">{</span><span class="ss">log</span><span class="p">,</span><span class="w"> </span><span class="ss">gteq</span><span class="p">,</span><span class="w"> </span><span class="n">PrimaryLevel</span><span class="p" data-group-id="7582700781-5">}</span><span class="p" data-group-id="7582700781-4">}</span><span class="p" data-group-id="7582700781-3">)</span><span class="p">,</span><span class="w">
</span><span class="nc">logger</span><span class="p">:</span><span class="nf">set_primary_config</span><span class="p" data-group-id="7582700781-6">(</span><span class="ss">filter_default</span><span class="p">,</span><span class="w"> </span><span class="ss">stop</span><span class="p" data-group-id="7582700781-6">)</span><span class="p">,</span><span class="w">
</span><span class="nc">logger</span><span class="p">:</span><span class="nf">set_primary_config</span><span class="p" data-group-id="7582700781-7">(</span><span class="ss">level</span><span class="p">,</span><span class="w"> </span><span class="ss">all</span><span class="p" data-group-id="7582700781-7">)</span><span class="p">,</span><span class="w">

</span><span class="c1">%% Test that things work as they should</span><span class="w">
</span><span class="nc">logger</span><span class="p">:</span><span class="nf">notice</span><span class="p" data-group-id="7582700781-8">(</span><span class="s">&quot;Notice should be logged&quot;</span><span class="p" data-group-id="7582700781-8">)</span><span class="p">,</span><span class="w">
</span><span class="nc">logger</span><span class="p">:</span><span class="nf">debug</span><span class="p" data-group-id="7582700781-9">(</span><span class="s">&quot;Should not be logged&quot;</span><span class="p" data-group-id="7582700781-9">)</span><span class="p">,</span><span class="w">

</span><span class="c1">%% Add the filter to allow PidToLog to send debug events</span><span class="w">
</span><span class="n">PidToLog</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">self</span><span class="p" data-group-id="7582700781-10">(</span><span class="p" data-group-id="7582700781-10">)</span><span class="p">,</span><span class="w">
</span><span class="n">PidFilter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">fun</span><span class="p" data-group-id="7582700781-11">(</span><span class="n">LogEvent</span><span class="p">,</span><span class="w"> </span><span class="p">_</span><span class="p" data-group-id="7582700781-11">)</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="n">PidToLog</span><span class="w"> </span><span class="o">=:=</span><span class="w"> </span><span class="nf">self</span><span class="p" data-group-id="7582700781-12">(</span><span class="p" data-group-id="7582700781-12">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="n">LogEvent</span><span class="p">;</span><span class="w">
               </span><span class="p" data-group-id="7582700781-13">(</span><span class="p">_</span><span class="n">LogEvent</span><span class="p">,</span><span class="w"> </span><span class="p">_</span><span class="p" data-group-id="7582700781-13">)</span><span class="w"> </span><span class="p">-&gt;</span><span class="w"> </span><span class="ss">ignore</span><span class="w"> </span><span class="k">end</span><span class="p">,</span><span class="w">
</span><span class="ss">ok</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nc">logger</span><span class="p">:</span><span class="nf">add_primary_filter</span><span class="p" data-group-id="7582700781-14">(</span><span class="ss">pid</span><span class="p">,</span><span class="w"> </span><span class="p" data-group-id="7582700781-15">{</span><span class="n">PidFilter</span><span class="p">,</span><span class="p" data-group-id="7582700781-16">[</span><span class="p" data-group-id="7582700781-16">]</span><span class="p" data-group-id="7582700781-15">}</span><span class="p" data-group-id="7582700781-14">)</span><span class="p">,</span><span class="w">
</span><span class="nc">logger</span><span class="p">:</span><span class="nf">debug</span><span class="p" data-group-id="7582700781-17">(</span><span class="s">&quot;Debug should be logged&quot;</span><span class="p" data-group-id="7582700781-17">)</span><span class="p">.</span></code></pre><p>There is a bit of setup needed to allow filters to decide whether a specific
process should be allowed to log. This is because the default primary log level
is notice and it is enforced before the primary filters. So in order for the pid
filter to be useful we have to raise the primary log level to <code class="inline">all</code> and then add
a level filter that only lets certain messages at or greater than notice
through. When the setup is done, it is simple to add a filter that allows a
certain pid through.</p><p>Note that doing the primary log level filtering through a filter and not through
the level is quite a lot more expensive, so make sure to test that your system
can handle the extra load before you enable it on a production node.</p><h4>See also</h4><ul><li><a href="logger_chapter.html#filters">Filters</a> in the Logging User's Guide</li><li><a href="logger_filters.html#level/2"><code class="inline">logger_filters:level/2</code></a></li><li><a href="logger.html#set_primary_config/2"><code class="inline">logger:set_primary_config/2</code></a></li></ul><h3 id="domains" class="section-heading">
  <a href="#domains" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Domains</span>
</h3>
<p>Domains are used to specify which subsystem a certain log event originates from.
The default handler will by default only log events with the domain <code class="inline">[otp]</code> or
without a domain. If you would like to include SSL log events into the default
handler log you could do this:</p><pre><code class="makeup erlang" translate="no"><span class="gp unselectable">1&gt; </span><span class="nc">logger</span><span class="p">:</span><span class="nf">add_handler_filter</span><span class="p" data-group-id="2658961052-1">(</span><span class="ss">default</span><span class="p">,</span><span class="ss">ssl_domain</span><span class="p">,</span><span class="w">
  </span><span class="p" data-group-id="2658961052-2">{</span><span class="k">fun</span><span class="w"> </span><span class="nc">logger_filters</span><span class="p">:</span><span class="ss">domain</span><span class="p">/</span><span class="mi">2</span><span class="p">,</span><span class="p" data-group-id="2658961052-3">{</span><span class="ss">log</span><span class="p">,</span><span class="ss">sub</span><span class="p">,</span><span class="p" data-group-id="2658961052-4">[</span><span class="ss">otp</span><span class="p">,</span><span class="ss">ssl</span><span class="p" data-group-id="2658961052-4">]</span><span class="p" data-group-id="2658961052-3">}</span><span class="p" data-group-id="2658961052-2">}</span><span class="p" data-group-id="2658961052-1">)</span><span class="p">.</span><span class="gp unselectable">
2&gt; </span><span class="nc">application</span><span class="p">:</span><span class="nf">ensure_all_started</span><span class="p" data-group-id="2658961052-5">(</span><span class="ss">ssl</span><span class="p" data-group-id="2658961052-5">)</span><span class="p">.</span><span class="w">
</span><span class="p" data-group-id="2658961052-6">{</span><span class="ss">ok</span><span class="p">,</span><span class="p" data-group-id="2658961052-7">[</span><span class="ss">crypto</span><span class="p">,</span><span class="ss">asn1</span><span class="p">,</span><span class="ss">public_key</span><span class="p">,</span><span class="ss">ssl</span><span class="p" data-group-id="2658961052-7">]</span><span class="p" data-group-id="2658961052-6">}</span><span class="gp unselectable">
3&gt; </span><span class="nc">ssl</span><span class="p">:</span><span class="nf">connect</span><span class="p" data-group-id="2658961052-8">(</span><span class="s">&quot;www.erlang.org&quot;</span><span class="p">,</span><span class="mi">443</span><span class="p">,</span><span class="p" data-group-id="2658961052-9">[</span><span class="p" data-group-id="2658961052-10">{</span><span class="ss">log_level</span><span class="p">,</span><span class="ss">debug</span><span class="p" data-group-id="2658961052-10">}</span><span class="p" data-group-id="2658961052-9">]</span><span class="p" data-group-id="2658961052-8">)</span><span class="p">.</span><span class="w">
</span><span class="c1">%% lots of text</span></code></pre><h4>See also</h4><ul><li><a href="logger_chapter.html#filters">Filters</a> in the Logging User's Guide</li><li><a href="logger_filters.html#domain/2"><code class="inline">logger_filters:domain/2</code></a></li><li><a href="logger.html#set_primary_config/2"><code class="inline">logger:set_primary_config/2</code></a></li></ul>
</div>

<div class="bottom-actions" id="bottom-actions">
  <div class="bottom-actions-item">

      <a href="logger_chapter.html" class="bottom-actions-button" rel="prev">
        <span class="subheader">
          ← Previous Page
        </span>
        <span class="title">
Logging
        </span>
      </a>

  </div>
  <div class="bottom-actions-item">

      <a href="eep48_chapter.html" class="bottom-actions-button" rel="next">
        <span class="subheader">
          Next Page →
        </span>
        <span class="title">
EEP-48: Documentation storage and format
        </span>
      </a>

  </div>
</div>
    <footer class="footer">
      <p>

        <span class="line">
          <button class="a-main footer-button display-quick-switch" title="Search HexDocs packages">
            Search HexDocs
          </button>

            <a href="kernel.epub" title="ePub version">
              Download ePub version
            </a>

        </span>
      </p>

      <p class="built-using">
        Built using
        <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.37.3) for the

          <a href="https://erlang.org" title="Erlang" target="_blank" translate="no">Erlang programming language</a>

      </p>
<p>Copyright © 1996-2025 <a href="https://www.ericsson.com">Ericsson AB</a></p>
    </footer>
  </div>
</main>
</div>
  <script defer src="https://cdn.jsdelivr.net/npm/mermaid@11.4.1/dist/mermaid.min.js"></script>
  <script>
  let initialized = false;

  window.addEventListener("exdoc:loaded", () => {
      if (!initialized) {
      mermaid.initialize({
          startOnLoad: false,
          theme: document.body.className.includes("dark") ? "dark" : "default"
      });
      initialized = true;
      }

      let id = 0;
      for (const codeEl of document.querySelectorAll("pre code.mermaid")) {
      const preEl = codeEl.parentElement;
      const graphDefinition = codeEl.textContent;
      const graphEl = document.createElement("div");
      const graphId = "mermaid-graph-" + id++;
      mermaid.render(graphId, graphDefinition).then(({svg, bindFunctions}) => {
          graphEl.innerHTML = svg;
          bindFunctions?.(graphEl);
          preEl.insertAdjacentElement("afterend", graphEl);
          preEl.remove();
      });
      }
  });
  </script>

  </body>
</html>
