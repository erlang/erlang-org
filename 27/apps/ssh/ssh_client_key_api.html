<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.37.3">
    <meta name="project" content="ssh v5.2.11.4">


<meta name="major-vsn" content="27">
<meta name="exdoc:full-text-search-url" content="/doc/search.html?v=27&q=">
<link rel="canonical" href="https://www.erlang.org/doc/apps/ssh/ssh_client_key_api.html" />
    <title>ssh_client_key_api — ssh v5.2.11.4</title>

    <link rel="stylesheet" href="dist/html-erlang-FDBURIED.css" />

    <script defer src="dist/sidebar_items-CB7FE887.js"></script>
    <script defer src="docs_config.js"></script>
    <script defer src="dist/html-ALU6OERS.js"></script>

  </head>
  <body>
    <script>(()=>{var t="ex_doc:settings",e="dark";var o="dark",s="light";var E="sidebar_state",n="closed";var r="sidebar_width";var a="sidebar-open";var i=new URLSearchParams(window.location.search),S=i.get("theme")||JSON.parse(localStorage.getItem(t)||"{}").theme;(S===o||S!==s&&window.matchMedia("(prefers-color-scheme: dark)").matches)&&document.body.classList.add(e);var d=sessionStorage.getItem(E),A=d!==n&&!window.matchMedia(`screen and (max-width: ${768}px)`).matches;document.body.classList.toggle(a,A);var c=sessionStorage.getItem(r);c&&document.body.style.setProperty("--sidebarWidth",`${c}px`);var p=/(Macintosh|iPhone|iPad|iPod)/.test(window.navigator.userAgent);document.documentElement.classList.toggle("apple-os",p);})();
</script>

<div class="body-wrapper">

<button id="sidebar-menu" class="sidebar-button sidebar-toggle" aria-label="toggle sidebar" aria-controls="sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<nav id="sidebar" class="sidebar">

  <div class="sidebar-header">
    <div class="sidebar-projectInfo">

        <a href="../../index.html" class="sidebar-projectImage">
          <img src="assets/logo.png" alt="ssh" />
        </a>

      <div>
        <a href="../../index.html" class="sidebar-projectName" translate="no">
ssh
        </a>
        <div class="sidebar-projectVersion" translate="no">
          v5.2.11.4
        </div>
      </div>
    </div>
    <ul id="sidebar-list-nav" class="sidebar-list-nav" role="tablist" data-extras=""></ul>
  </div>
</nav>

<output role="status" id="toast"></output>

<main class="content page-behaviour" id="main" data-type="modules">
  <div id="content" class="content-inner">
    <div class="top-search">
      <div class="search-settings">
        <form class="search-bar" action="search.html">
          <label class="search-label">
            <span class="sr-only">Search documentation of ssh</span>
            <input name="q" type="text" class="search-input" placeholder="Press / to search" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
          </label>
          <button type="submit" class="search-button" aria-label="Submit Search" tabindex="-1">
            <i class="ri-search-2-line ri-lg" aria-hidden="true"></i>
          </button>
          <button type="button" tabindex="-1" class="search-close-button" aria-hidden="true">
            <i class="ri-close-line ri-lg" title="Cancel search"></i>
          </button>
        </form>
        <div class="autocomplete">
        </div>
        <button class="icon-settings display-settings">
          <i class="ri-settings-3-line"></i>
          <span class="sr-only">Settings</span>
        </button>
      </div>
    </div>

<div id="top-content">
  <div class="heading-with-actions top-heading">
    <h1>
      <span translate="no">ssh_client_key_api</span> <small>behaviour</small>
      <small class="app-vsn" translate="no">(ssh v5.2.11.4)</small>

    </h1>

      <a href="https://github.com/erlang/otp/blob/OTP-27.3.4.6/lib/ssh/src/ssh_client_key_api.erl#L21" title="View Source" class="icon-action" rel="help">
        <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        <span class="sr-only">View Source</span>
      </a>

  </div>


    <section id="moduledoc">
<p>-behaviour(ssh_client_key_api).</p><p>Behavior describing the API for public key handling of an SSH client. By
implementing the callbacks defined in this behavior, the public key handling of
an SSH client can be customized. By default the <code class="inline">ssh</code> application implements
this behavior with help of the standard OpenSSH files, see the
<a href="ssh_app.html">ssh</a> application manual.</p>
    </section>

</div>

  <section id="summary" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#summary">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Summary</span>
    </h1>
<div class="summary-types summary">
  <h2>
    <a href="#types">Types</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#t:client_key_cb_options/1" data-no-tooltip="" translate="no">client_key_cb_options(T)</a>

      </div>

        <div class="summary-synopsis"><p>Options provided to <a href="ssh.html#connect/3">ssh:connect/3,4</a>.</p></div>

    </div>

</div>
<div class="summary-callbacks summary">
  <h2>
    <a href="#callbacks">Callbacks</a>
  </h2>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#c:add_host_key/3" data-no-tooltip="" translate="no">add_host_key(Host, PublicKey, Options)</a>

      </div>

        <div class="summary-synopsis"><p>This function is retired in favour for
<a href="#c:add_host_key/4"><code class="inline">Module:add_host_key/4</code></a> which is the preferred API
function. The calling SSH application will still try the
<a href="#c:add_host_key/3"><code class="inline">add_host_key/3</code></a> if the call to
<a href="#c:add_host_key/4"><code class="inline">add_host_key/4</code></a> failed.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#c:add_host_key/4" data-no-tooltip="" translate="no">add_host_key(Host, Port, PublicKey, Options)</a>

      </div>

        <div class="summary-synopsis"><p>Adds a host key to the set of trusted host keys.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#c:is_host_key/4" data-no-tooltip="" translate="no">is_host_key(Key, Host, Algorithm, Options)</a>

      </div>

        <div class="summary-synopsis"><p>This function is retired in favour for
<a href="#c:is_host_key/5"><code class="inline">Module:is_host_key/5</code></a> which is the preferred API function.
The calling SSH application will still try the
<a href="#c:is_host_key/4"><code class="inline">is_host_key/4</code></a> if the call to
<a href="#c:is_host_key/5"><code class="inline">is_host_key/5</code></a> failed.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#c:is_host_key/5" data-no-tooltip="" translate="no">is_host_key(Key, Host, Port, Algorithm, Options)</a>

      </div>

        <div class="summary-synopsis"><p>Checks if a host key is trusted.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#c:sign/3" data-no-tooltip="" translate="no">sign(PubKeyBlob, SigData, Options)</a>

      </div>

        <div class="summary-synopsis"><p>Sign the SigData with the <em>private</em> key corresponding to PubKeyBlob.</p></div>

    </div>

    <div class="summary-row">
      <div class="summary-signature">
        <a href="#c:user_key/2" data-no-tooltip="" translate="no">user_key(Algorithm, Options)</a>

      </div>

        <div class="summary-synopsis"><p>Fetches the users <em>public key</em> matching the <code class="inline">Algorithm</code>. Some key callback
modules may return <code class="inline">{ssh2_pubkey, PubKeyBlob :: binary()}</code>.</p></div>

    </div>

</div>

  </section>


  <section id="types" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#types">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Types</span>
    </h1>
    <div class="types-list">
<section class="detail" id="t:client_key_cb_options/1">

  <div class="detail-header">
    <a href="#t:client_key_cb_options/1" class="detail-link" data-no-tooltip="" aria-label="Link to this type">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">client_key_cb_options(T)</h1>

        <span class="note">(since OTP R16B)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-27.3.4.6/lib/ssh/src/ssh_client_key_api.erl#L51" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-type</span> client_key_cb_options(T) :: [{key_cb_private, [T]} | <a href="ssh.html#t:client_option/0">ssh:client_option</a>()].</pre>

      </div>

<p>Options provided to <a href="ssh.html#connect/3">ssh:connect/3,4</a>.</p><p>The option list given in the <a href="ssh.html#t:key_cb_common_option/0"><code class="inline">key_cb</code></a> option
is available with the key <code class="inline">key_cb_private</code>.</p>
  </section>
</section>

    </div>
  </section>

  <section id="callbacks" class="details-list">
    <h1 class="section-heading">
      <a class="hover-link" href="#callbacks">
        <i class="ri-link-m" aria-hidden="true"></i>
      </a>
      <span class="text">Callbacks</span>
    </h1>
    <div class="callbacks-list">
<section class="detail" id="c:add_host_key/3">

  <div class="detail-header">
    <a href="#c:add_host_key/3" class="detail-link" data-no-tooltip="" aria-label="Link to this callback">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">add_host_key(Host, PublicKey, Options)</h1>

        <span class="note">(since OTP R16B)</span>

        <span class="note">(optional)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-27.3.4.6/lib/ssh/src/ssh_client_key_api.erl#L165" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-callback</span> add_host_key(Host :: <a href="../../apps/erts/erlang.html#t:string/0">string</a>(),
                       PublicKey :: <a href="../../apps/public_key/public_key.html#t:public_key/0">public_key:public_key</a>(),
                       Options :: <a href="#t:client_key_cb_options/1">client_key_cb_options</a>(<a href="../../apps/erts/erlang.html#t:any/0">any</a>())) ->
                          ok | {error, <a href="../../apps/erts/erlang.html#t:term/0">term</a>()}.</pre>

      </div>

<p>This function is retired in favour for
<a href="#c:add_host_key/4"><code class="inline">Module:add_host_key/4</code></a> which is the preferred API
function. The calling SSH application will still try the
<a href="#c:add_host_key/3"><code class="inline">add_host_key/3</code></a> if the call to
<a href="#c:add_host_key/4"><code class="inline">add_host_key/4</code></a> failed.</p><p>Adds a host key to the set of trusted host keys.</p>
  </section>
</section>
<section class="detail" id="c:add_host_key/4">

  <div class="detail-header">
    <a href="#c:add_host_key/4" class="detail-link" data-no-tooltip="" aria-label="Link to this callback">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">add_host_key(Host, Port, PublicKey, Options)</h1>

        <span class="note">(since OTP R16B)</span>

        <span class="note">(optional)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-27.3.4.6/lib/ssh/src/ssh_client_key_api.erl#L144" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-callback</span> add_host_key(Host :: <a href="../../apps/kernel/inet.html#t:ip_address/0">inet:ip_address</a>() | <a href="../../apps/kernel/inet.html#t:hostname/0">inet:hostname</a>() | [<a href="../../apps/kernel/inet.html#t:ip_address/0">inet:ip_address</a>() | <a href="../../apps/kernel/inet.html#t:hostname/0">inet:hostname</a>()],
                       Port :: <a href="../../apps/kernel/inet.html#t:port_number/0">inet:port_number</a>(),
                       PublicKey :: <a href="../../apps/public_key/public_key.html#t:public_key/0">public_key:public_key</a>(),
                       Options :: <a href="#t:client_key_cb_options/1">client_key_cb_options</a>(<a href="../../apps/erts/erlang.html#t:any/0">any</a>())) ->
                          ok | {error, <a href="../../apps/erts/erlang.html#t:term/0">term</a>()}.</pre>

      </div>

<p>Adds a host key to the set of trusted host keys.</p><p>This function is preferred to the old
<a href="#c:add_host_key/3"><code class="inline">Module:add_host_key/3</code></a> since it also uses the peer host
port number and may return an error message.</p><p>The OTP/SSH application first calls this function in the callback module, and
then the old <a href="#c:add_host_key/3"><code class="inline">Module:add_host_key/3</code></a> for compatibility.</p>
  </section>
</section>
<section class="detail" id="c:is_host_key/4">

  <div class="detail-header">
    <a href="#c:is_host_key/4" class="detail-link" data-no-tooltip="" aria-label="Link to this callback">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">is_host_key(Key, Host, Algorithm, Options)</h1>

        <span class="note">(since OTP R16B)</span>

        <span class="note">(optional)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-27.3.4.6/lib/ssh/src/ssh_client_key_api.erl#L94" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-callback</span> is_host_key(Key :: <a href="../../apps/public_key/public_key.html#t:public_key/0">public_key:public_key</a>(),
                      Host :: <a href="../../apps/erts/erlang.html#t:string/0">string</a>(),
                      Algorithm :: <a href="ssh.html#t:pubkey_alg/0">ssh:pubkey_alg</a>(),
                      Options :: <a href="#t:client_key_cb_options/1">client_key_cb_options</a>(<a href="../../apps/erts/erlang.html#t:any/0">any</a>())) ->
                         <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>().</pre>

      </div>

<p>This function is retired in favour for
<a href="#c:is_host_key/5"><code class="inline">Module:is_host_key/5</code></a> which is the preferred API function.
The calling SSH application will still try the
<a href="#c:is_host_key/4"><code class="inline">is_host_key/4</code></a> if the call to
<a href="#c:is_host_key/5"><code class="inline">is_host_key/5</code></a> failed.</p><p>Checks if a host key is trusted.</p>
  </section>
</section>
<section class="detail" id="c:is_host_key/5">

  <div class="detail-header">
    <a href="#c:is_host_key/5" class="detail-link" data-no-tooltip="" aria-label="Link to this callback">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">is_host_key(Key, Host, Port, Algorithm, Options)</h1>

        <span class="note">(since OTP 23.0)</span>

        <span class="note">(optional)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-27.3.4.6/lib/ssh/src/ssh_client_key_api.erl#L72" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-callback</span> is_host_key(Key :: <a href="../../apps/public_key/public_key.html#t:public_key/0">public_key:public_key</a>(),
                      Host :: <a href="../../apps/kernel/inet.html#t:ip_address/0">inet:ip_address</a>() | <a href="../../apps/kernel/inet.html#t:hostname/0">inet:hostname</a>() | [<a href="../../apps/kernel/inet.html#t:ip_address/0">inet:ip_address</a>() | <a href="../../apps/kernel/inet.html#t:hostname/0">inet:hostname</a>()],
                      Port :: <a href="../../apps/kernel/inet.html#t:port_number/0">inet:port_number</a>(),
                      Algorithm :: <a href="ssh.html#t:pubkey_alg/0">ssh:pubkey_alg</a>(),
                      Options :: <a href="#t:client_key_cb_options/1">client_key_cb_options</a>(<a href="../../apps/erts/erlang.html#t:any/0">any</a>())) ->
                         <a href="../../apps/erts/erlang.html#t:boolean/0">boolean</a>() | {error, <a href="../../apps/erts/erlang.html#t:term/0">term</a>()}.</pre>

      </div>

<p>Checks if a host key is trusted.</p><p>This function is preferred to the old
<a href="#c:is_host_key/4"><code class="inline">Module:is_host_key/4</code></a> since it also uses the peer host
port number and may return an error message.</p><p>The OTP/SSH application first calls this function in the callback module, and
then the old <a href="#c:is_host_key/4"><code class="inline">Module:is_host_key/4</code></a> for compatibility.</p>
  </section>
</section>
<section class="detail" id="c:sign/3">

  <div class="detail-header">
    <a href="#c:sign/3" class="detail-link" data-no-tooltip="" aria-label="Link to this callback">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">sign(PubKeyBlob, SigData, Options)</h1>

        <span class="note">(since OTP 23.0)</span>

        <span class="note">(optional)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-27.3.4.6/lib/ssh/src/ssh_client_key_api.erl#L183" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-callback</span> sign(PubKeyBlob :: <a href="../../apps/erts/erlang.html#t:binary/0">binary</a>(), SigData :: <a href="../../apps/erts/erlang.html#t:binary/0">binary</a>(), Options :: <a href="#t:client_key_cb_options/1">client_key_cb_options</a>(<a href="../../apps/erts/erlang.html#t:any/0">any</a>())) ->
                  Blob :: <a href="../../apps/erts/erlang.html#t:binary/0">binary</a>().</pre>

      </div>

<p>Sign the SigData with the <em>private</em> key corresponding to PubKeyBlob.</p>
  </section>
</section>
<section class="detail" id="c:user_key/2">

  <div class="detail-header">
    <a href="#c:user_key/2" class="detail-link" data-no-tooltip="" aria-label="Link to this callback">
      <i class="ri-link-m" aria-hidden="true"></i>
    </a>
    <div class="heading-with-actions">
      <h1 class="signature" translate="no">user_key(Algorithm, Options)</h1>

        <span class="note">(since OTP R16B)</span>


        <a href="https://github.com/erlang/otp/blob/OTP-27.3.4.6/lib/ssh/src/ssh_client_key_api.erl#L118" class="icon-action" rel="help" aria-label="View Source">
          <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        </a>

    </div>
  </div>

  <section class="docstring">

      <div class="specs">

          <pre translate="no"><span class="attribute">-callback</span> user_key(Algorithm :: <a href="ssh.html#t:pubkey_alg/0">ssh:pubkey_alg</a>(), Options :: <a href="#t:client_key_cb_options/1">client_key_cb_options</a>(<a href="../../apps/erts/erlang.html#t:any/0">any</a>())) ->
                      {ok, <a href="../../apps/public_key/public_key.html#t:private_key/0">public_key:private_key</a>()} |
                      {ok, {ssh2_pubkey, PubKeyBlob :: <a href="../../apps/erts/erlang.html#t:binary/0">binary</a>()}} |
                      {error, <a href="../../apps/erts/erlang.html#t:string/0">string</a>()}.</pre>

      </div>

<p>Fetches the users <em>public key</em> matching the <code class="inline">Algorithm</code>. Some key callback
modules may return <code class="inline">{ssh2_pubkey, PubKeyBlob :: binary()}</code>.</p><section role="note" class="admonition info"><h4 class="admonition-title info">Note</h4><p>The private key contains the public key.</p></section>
  </section>
</section>

    </div>
  </section>

    <footer class="footer">
      <p>

        <span class="line">
          <button class="a-main footer-button display-quick-switch" title="Search HexDocs packages">
            Search HexDocs
          </button>

            <a href="ssh.epub" title="ePub version">
              Download ePub version
            </a>

        </span>
      </p>

      <p class="built-using">
        Built using
        <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.37.3) for the

          <a href="https://erlang.org" title="Erlang" target="_blank" translate="no">Erlang programming language</a>

      </p>
<p>Copyright © 1996-2025 <a href="https://www.ericsson.com">Ericsson AB</a></p>
    </footer>
  </div>
</main>
</div>
  <script defer src="https://cdn.jsdelivr.net/npm/mermaid@11.4.1/dist/mermaid.min.js"></script>
  <script>
  let initialized = false;

  window.addEventListener("exdoc:loaded", () => {
      if (!initialized) {
      mermaid.initialize({
          startOnLoad: false,
          theme: document.body.className.includes("dark") ? "dark" : "default"
      });
      initialized = true;
      }

      let id = 0;
      for (const codeEl of document.querySelectorAll("pre code.mermaid")) {
      const preEl = codeEl.parentElement;
      const graphDefinition = codeEl.textContent;
      const graphEl = document.createElement("div");
      const graphId = "mermaid-graph-" + id++;
      mermaid.render(graphId, graphDefinition).then(({svg, bindFunctions}) => {
          graphEl.innerHTML = svg;
          bindFunctions?.(graphEl);
          preEl.insertAdjacentElement("afterend", graphEl);
          preEl.remove();
      });
      }
  });
  </script>

  </body>
</html>
