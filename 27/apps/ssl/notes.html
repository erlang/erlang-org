<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="ExDoc v0.37.3">
    <meta name="project" content="ssl v11.2.12.1">


<meta name="exdoc:full-text-search-url" content="/doc/search.html?v=27&q=">
<meta name="major-vsn" content="27">
<link rel="canonical" href="https://www.erlang.org/docs/27/apps/ssl/notes.html" />
    <title>SSL Release Notes — ssl v11.2.12.1</title>

    <link rel="stylesheet" href="dist/html-erlang-FDBURIED.css" />

    <script defer src="dist/sidebar_items-29A63FCF.js"></script>
    <script defer src="docs_config.js"></script>
    <script defer src="dist/html-ALU6OERS.js"></script>

  </head>
  <body>
    <script>(()=>{var t="ex_doc:settings",e="dark";var o="dark",s="light";var E="sidebar_state",n="closed";var r="sidebar_width";var a="sidebar-open";var i=new URLSearchParams(window.location.search),S=i.get("theme")||JSON.parse(localStorage.getItem(t)||"{}").theme;(S===o||S!==s&&window.matchMedia("(prefers-color-scheme: dark)").matches)&&document.body.classList.add(e);var d=sessionStorage.getItem(E),A=d!==n&&!window.matchMedia(`screen and (max-width: ${768}px)`).matches;document.body.classList.toggle(a,A);var c=sessionStorage.getItem(r);c&&document.body.style.setProperty("--sidebarWidth",`${c}px`);var p=/(Macintosh|iPhone|iPad|iPod)/.test(window.navigator.userAgent);document.documentElement.classList.toggle("apple-os",p);})();
</script>

<div class="body-wrapper">

<button id="sidebar-menu" class="sidebar-button sidebar-toggle" aria-label="toggle sidebar" aria-controls="sidebar">
  <i class="ri-menu-line ri-lg" title="Collapse/expand sidebar"></i>
</button>

<nav id="sidebar" class="sidebar">

  <div class="sidebar-header">
    <div class="sidebar-projectInfo">

        <a href="../../index.html" class="sidebar-projectImage">
          <img src="assets/logo.png" alt="ssl" />
        </a>

      <div>
        <a href="../../index.html" class="sidebar-projectName" translate="no">
ssl
        </a>
        <div class="sidebar-projectVersion" translate="no">
          v11.2.12.1
        </div>
      </div>
    </div>
    <ul id="sidebar-list-nav" class="sidebar-list-nav" role="tablist" data-extras=""></ul>
  </div>
</nav>

<output role="status" id="toast"></output>

<main class="content page-extra" id="main" data-type="extras">
  <div id="content" class="content-inner">
    <div class="top-search">
      <div class="search-settings">
        <form class="search-bar" action="search.html">
          <label class="search-label">
            <span class="sr-only">Search documentation of ssl</span>
            <input name="q" type="text" class="search-input" placeholder="Press / to search" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
          </label>
          <button type="submit" class="search-button" aria-label="Submit Search" tabindex="-1">
            <i class="ri-search-2-line ri-lg" aria-hidden="true"></i>
          </button>
          <button type="button" tabindex="-1" class="search-close-button" aria-hidden="true">
            <i class="ri-close-line ri-lg" title="Cancel search"></i>
          </button>
        </form>
        <div class="autocomplete">
        </div>
        <button class="icon-settings display-settings">
          <i class="ri-settings-3-line"></i>
          <span class="sr-only">Settings</span>
        </button>
      </div>
    </div>

<div id="top-content">
  <div class="heading-with-actions top-heading">
    <h1>SSL Release Notes</h1>


      <a href="https://github.com/garazdawi/otp/blob/OTP-27.3.4.1/lib/ssl/doc/notes.md#L1" title="View Source" class="icon-action" rel="help">
        <i class="ri-code-s-slash-line" aria-hidden="true"></i>
        <span class="sr-only">View Source</span>
      </a>

  </div>

<p>This document describes the changes made to the SSL application.</p><h2 id="ssl-11-2-12-1" class="section-heading">
  <a href="#ssl-11-2-12-1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 11.2.12.1</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>hs_keylog callback properly handle alert in initial states, where encryption is not yet used.  Also add keylog callback invocation for corner-case where server alert is encrypted with application secrets as client is already in connection state.</p><p>Own Id: OTP-19635 Aux Id: ERIERL-1235, <a href="https://github.com/erlang/otp/pull/9849" title="">PR-9849</a></p></li></ul><h3 id="improvements-and-new-features" class="section-heading">
  <a href="#improvements-and-new-features" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>The documentation for SSL option <code class="inline">verify_fun</code> has been improved.</p><p>Own Id: OTP-19676 Aux Id: <a href="https://github.com/erlang/otp/pull/9691" title="">PR-9691</a></p></li></ul><h2 id="ssl-11-2-12" class="section-heading">
  <a href="#ssl-11-2-12" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 11.2.12</span>
</h2>
<h3 id="improvements-and-new-features-1" class="section-heading">
  <a href="#improvements-and-new-features-1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Lower log level for user cancelation as this is not an error case. Also handle possible undecrypted close alert  during TLS-1.3 handshake.</p><p>Own Id: OTP-19592 Aux Id: <a href="https://github.com/erlang/otp/pull/9566" title="">PR-9566</a></p></li></ul><h2 id="ssl-11-2-11" class="section-heading">
  <a href="#ssl-11-2-11" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 11.2.11</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-1" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Correct the debug functionality for NSS keylogging for TLS-1.3 introduced in OTP-27.3.1 so that TLS-1.3 key updates items always get correct counter value and each item is logged as one single line.</p><p>Own Id: OTP-19569 Aux Id: <a href="https://github.com/erlang/otp/pull/9661" title="">PR-9661</a></p></li></ul><h2 id="ssl-11-2-10" class="section-heading">
  <a href="#ssl-11-2-10" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 11.2.10</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-2" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-2" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Correct handling of unassigned signature algorithms to properly ignore them instead of failing the handshake.</p><p>Own Id: OTP-19529 Aux Id: <a href="https://github.com/erlang/otp/issues/9483" title="">GH-9483</a>, <a href="https://github.com/erlang/otp/pull/9486" title="">PR-9486</a></p></li><li><p>Update key mechanism in 
CRL cache so that CRL DP with same
URI path component becomes distinguishable from each other.</p><p>Own Id: OTP-19549 Aux Id: <a href="https://github.com/erlang/otp/issues/8891" title="">GH-8891</a>, <a href="https://github.com/erlang/otp/pull/9612" title="">PR-9612</a></p></li></ul><h3 id="improvements-and-new-features-2" class="section-heading">
  <a href="#improvements-and-new-features-2" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Add callback for NSS keylogging so that it can work as expected for all scenarios.</p><p>Own Id: OTP-19391 Aux Id: <a href="https://github.com/erlang/otp/pull/9221" title="">PR-9221</a></p></li></ul><h2 id="ssl-11-2-9" class="section-heading">
  <a href="#ssl-11-2-9" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 11.2.9</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-3" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-3" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>The function for selecting the best server  certificate and key pair has been enhanced when several options are available to ensure that the fallback will not always be chosen.</p><p>Own Id: OTP-19423 Aux Id: <a href="https://github.com/erlang/otp/pull/9185" title="">PR-9185</a></p></li><li><p>Avoided duplicating a few algorithms in default values caused by an interoperability workaround not needed in this case.</p><p>Own Id: OTP-19428 Aux Id: <a href="https://github.com/erlang/otp/pull/9288" title="">PR-9288</a></p></li><li><p>Fixed two alert bugs, which could result in a crash instead of an alert.</p><p>Own Id: OTP-19433 Aux Id: <a href="https://github.com/erlang/otp/pull/9308" title="">PR-9308</a></p></li></ul><h2 id="ssl-11-2-8" class="section-heading">
  <a href="#ssl-11-2-8" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 11.2.8</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-4" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-4" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Setting protocol version to a lower value then supported by default in server API function called after ssl:listen/2 could result in wrong default values being used and connections failing with insufficient security.</p><p>Own Id: OTP-19457 Aux Id: <a href="https://github.com/erlang/otp/pull/9418" title="">PR-9418</a></p></li><li><p>Improve error handling of server name indication fun. This implies that if the <code class="inline">sni_fun</code> returns <code class="inline">undefined</code> we will attempt connection with original option values, if it returns <code class="inline">unrecognized</code> we end the connection with UNRECOGNIZED_NAME alert and if provided options fail option verification we will end the connection with a HANDSHAKE_FAILURE and an error log.</p><p>Own Id: OTP-19467 Aux Id: <a href="https://github.com/erlang/otp/pull/9387" title="">PR-9387</a>, ERIERL-1189</p></li></ul><h2 id="ssl-11-2-7" class="section-heading">
  <a href="#ssl-11-2-7" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 11.2.7</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-5" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-5" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>An initiated handshake should always be closed with an alert, some corner cases have been fixed so that this should always be the case.</p><p>Own Id: OTP-19411 Aux Id: <a href="https://github.com/erlang/otp/pull/9273" title="">PR-9273</a>, ERIERL-1174</p></li><li><p>Correct option handling to work properly for paused handshaking. Could result in unwanted alerts or or error messages.</p><p>Own Id: OTP-19445 Aux Id: <a href="https://github.com/erlang/otp/issues/9177" title="">GH-9177</a>, <a href="https://github.com/erlang/otp/pull/9322" title="">PR-9322</a></p></li></ul><h2 id="ssl-11-2-6" class="section-heading">
  <a href="#ssl-11-2-6" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 11.2.6</span>
</h2>
<h3 id="improvements-and-new-features-3" class="section-heading">
  <a href="#improvements-and-new-features-3" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Enhanced return value spec for active messages from the TLS connection socket.</p><p>Own Id: OTP-19387 Aux Id: <a href="https://github.com/erlang/otp/pull/9067" title="">PR-9067</a></p></li></ul><h2 id="ssl-11-2-5" class="section-heading">
  <a href="#ssl-11-2-5" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 11.2.5</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-6" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-6" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Avoid generating an internal alert for case that should have been an orderly shutdown by the supervisor.</p><p>Own Id: OTP-19311 Aux Id: <a href="https://github.com/erlang/otp/pull/8980" title="">PR-8980</a></p></li><li><p>If present, extended key-usage TLS (SSL) role check (<code class="inline">pk-clientAuth</code>, <code class="inline">pk-serverAuth</code>) should always be performed for peer-cert. An intermediate CA cert may relax the requirement if <code class="inline">AnyExtendedKeyUsage</code> purpose is present.</p><p>In OTP-25.3.2.8, OTP-26.2 and OTP-27.0 these requirements became too relaxed. There where two problems, firstly the peer cert extension was only checked if it was marked critical, and secondly the CA cert check did not assert the relaxed <code class="inline">AnyExtendedKeyUsage</code> purpose.</p><p>This could result in that certificates might be misused for purposes not intended by the certificate authority.</p><p>Thanks to Bryan Paxton for reporting the issue.</p><p>Own Id: OTP-19352 Aux Id: <a href="https://github.com/erlang/otp/pull/9130" title="">PR-9130</a>, CVE-2024-53846, OTP-19240</p></li></ul><h3 id="improvements-and-new-features-4" class="section-heading">
  <a href="#improvements-and-new-features-4" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Back port certificate_authorities option for TLS-1.3 servers to pre TLS-1.3 servers to enable them to disable the sending of certificate authorities in their certificate request. This will have same affect as the the TLS-1.3 server option although it is handled by a different mechanism in these versions, where the functionality is described to be more of a guidance, although some pre TLS clients have proven to make it mandatory as in TLS-1.3 extension handling.</p><p>Own Id: OTP-19325 Aux Id: <a href="https://github.com/erlang/otp/pull/9001" title="">PR-9001</a>, ERIERL-1147</p></li></ul><h2 id="ssl-11-2-4" class="section-heading">
  <a href="#ssl-11-2-4" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 11.2.4</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-7" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-7" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Refactor trying to also make some optimizations introduced a bug in signature algorithms checks in OTP-26.2.1. This could manifest itself in not being able to negotiate connections using certificates needing to use some TLS-1.2 compatibility legacy signature schemes.</p><p>Own Id: OTP-19249 Aux Id: ERIERL-1137, <a href="https://github.com/erlang/otp/pull/8866" title="">PR-8866</a></p></li><li><p>Correct timeout handling for termination code run for own alerts, so that intended timeout is used instead of falling back to OS TCP-stack timeout that is unreasonably long on some platforms.</p><p>Own Id: OTP-19274 Aux Id: <a href="https://github.com/erlang/otp/pull/8901" title="">PR-8901</a></p></li><li><p>Fix assertion so that works as intended.
This could result in that some TLS-1.2 clients would fail to connect to the the erlang server.  Bug introduced in OTP-27.1.1</p><p>Own Id: OTP-19288 Aux Id: <a href="https://github.com/erlang/otp/issues/8908" title="">GH-8908</a>, <a href="https://github.com/erlang/otp/pull/8916" title="">PR-8916</a></p></li></ul><h2 id="ssl-11-2-3" class="section-heading">
  <a href="#ssl-11-2-3" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 11.2.3</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-8" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-8" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Starting from TLS-1.3 some server handshake alerts might arrive after ssl:connection/2,3,4 has returned. If the socket is in active mode the controlling process will get the alert message, but passive sockets would only get {error, closed} on next call to ssl:recv/2,3 or ssl/setopts/2. Passive sockets calls will now return  {error,  error_alert()}  instead.</p><p>Own Id: OTP-19236 Aux Id: <a href="https://github.com/erlang/otp/pull/8261" title="">PR-8261</a></p></li><li><p>Servers configured to support only version (pre TLS-1.2) should ignore hello version extension, as it is an unknown extension to them, this will result in that new clients that do not support the old server version will get an insufficient security alert from the server and not a protocol version alert, this is consistent with how old servers not able to support higher protocol versions work.</p><p>Own Id: OTP-19257</p></li></ul><h2 id="ssl-11-2-2" class="section-heading">
  <a href="#ssl-11-2-2" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 11.2.2</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-9" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-9" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>A race in the kTLS flavour of SSL distribution has been fixed so that <code class="inline">inet_drv.c</code> doesn't read ahead too much data, which could cause the kTLS encryption to be activated too late when some encrypted data had already been read into the <code class="inline">inet_drv.c</code> buffer as unencrypted.</p><p>Own Id: OTP-19175 Aux Id: <a href="https://github.com/erlang/otp/issues/8561" title="">GH-8561</a>, <a href="https://github.com/erlang/otp/pull/8690" title="">PR-8690</a></p></li></ul><h3 id="improvements-and-new-features-5" class="section-heading">
  <a href="#improvements-and-new-features-5" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>All TLS-1.3 terminations are now graceful (previous TLS version terminations already were).</p><p>Own Id: OTP-17848</p></li><li><p>It is now possible to use a verification fun of arity 4, giving the user fun access to both encoded and decoded versions of the certificate. This is desirable as a workaround for encoding errors preventing re-encoding from being reliable. This also saves some work load if the encoded version is needed.</p><p>Note that calling <a href="../../apps/public_key/public_key.html#pkix_path_validation/3"><code class="inline">public_key:pkix_path_validation/3</code></a> with only decoded certs is not recommended, due to the decoding workarounds, although it will work as long as the workarounds are not needed.</p><p>If the decoded version is needed before thecall to <a href="../../apps/public_key/public_key.html"><code class="inline">public_key</code></a> it is recommend to use the combined_cert- type to avoid double decoding.  Note that the path validation algorithm itself always needs both the encoded and decoded versions of the certs.</p><p>The ssl implementation will now benefit from using this function instead of emulating the verify_fun/4.</p><p>Own Id: OTP-19169</p></li><li><p>Compiler warnings for some removed functions have been corrected to point out the correct replacement functions.</p><p>Own Id: OTP-19186 Aux Id: <a href="https://github.com/erlang/otp/pull/8709" title="">PR-8709</a></p></li><li><p>Include more information in logging of SNI (Server Name Indication) mismatch error.</p><p>Own Id: OTP-19187</p></li></ul><h2 id="ssl-11-2-1" class="section-heading">
  <a href="#ssl-11-2-1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 11.2.1</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-10" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-10" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Check  for TLS-1.3 support should check minimum requirements.</p><p>Own Id: OTP-19094 Aux Id: <a href="https://github.com/erlang/otp/issues/8489" title="">GH-8489</a></p></li><li><p>If both TLS-1.3 and TLS-1.2 is supported
and TLS-1.2 negotiated convert TLS-1.3 ECDSA schemes to TLS-1.2 hash and signature pairs for increased interoperability.</p><p>Own Id: OTP-19107 Aux Id: <a href="https://github.com/erlang/otp/issues/8376" title="">GH-8376</a></p></li><li><p>TLS-1.3 negotiation now uses SNI based options correctly instead of ignoring them.</p><p>Own Id: OTP-19140</p></li></ul><h3 id="improvements-and-new-features-6" class="section-heading">
  <a href="#improvements-and-new-features-6" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Make it easier to distinguish between a invalid signature and unsupported signature.</p><p>Own Id: OTP-19091</p></li><li><p>Enhance ALERT logs to help understand what causes the alert.</p><p>Own Id: OTP-19092 Aux Id: <a href="https://github.com/erlang/otp/issues/8482" title="">GH-8482</a></p></li><li><p>When the default value for signature_algs is used, default the signature_algs_cert to the default value + rsa_pkcs1_sha1 to allow this algorithms for certificates but not for the TLS protocol. This is for better interoperability.  If signature_algs is set explicitly signature_algs_cert must also be set explicitly if they should be different.</p><p>Own Id: OTP-19152 Aux Id: <a href="https://github.com/erlang/otp/issues/8588" title="">GH-8588</a></p></li></ul><h2 id="ssl-11-2" class="section-heading">
  <a href="#ssl-11-2" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 11.2</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-11" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-11" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Starting a TLS server without sufficient credentials (certificate or anonymous cipher) would work, but it was impossible to connect to it.</p><p>This has been corrected to return an error instead of starting the server.</p><p>Own Id: OTP-18887 Aux Id: <a href="https://github.com/erlang/otp/issues/7493" title="">GH-7493</a>, <a href="https://github.com/erlang/otp/pull/7918" title="">PR-7918</a></p></li><li><p>ASN.1 decoding errors are handled in more places to ensure that errors are returned instead of cause a crash.</p><p>Own Id: OTP-18969 Aux Id: <a href="https://github.com/erlang/otp/issues/8058" title="">GH-8058</a>, <a href="https://github.com/erlang/otp/pull/8256" title="">PR-8256</a></p></li><li><p>Improved error checking on the API functions.</p><p>Own Id: OTP-18992 Aux Id: <a href="https://github.com/erlang/otp/issues/8066" title="">GH-8066</a>, <a href="https://github.com/erlang/otp/pull/8156" title="">PR-8156</a></p></li></ul><h3 id="improvements-and-new-features-7" class="section-heading">
  <a href="#improvements-and-new-features-7" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>The <code class="inline">ssl</code> client can negotiate and handle certificate status request (OCSP stapling support on the client side).</p><p>Thanks to voltone for interop testing and related discussions.</p><p>Own Id: OTP-18606 Aux Id: OTP-16875,OTP-16448</p></li><li><p>Memory consumption has been reduced and performance increased by refactoring internal data structures and their usage.</p><p>Own Id: OTP-18665 Aux Id: <a href="https://github.com/erlang/otp/pull/7447" title="">PR-7447</a></p></li><li><p>Added <a href="ssl_crl_cache_api.html#c:lookup/2"><code class="inline">ssl_crl_cache_api:lookup/2</code></a> as an optional <code class="inline">-callback</code> attribute.</p><p>Own Id: OTP-18788 Aux Id: <a href="https://github.com/erlang/otp/pull/7700" title="">PR-7700</a></p></li><li><p>Key customization support has been extended to allow flexibility for implementers of  for instance hardware security modules (HSM) or trusted platform modules (TPM).</p><p>Own Id: OTP-18876 Aux Id: <a href="https://github.com/erlang/otp/pull/7898" title="">PR-7898</a>, <a href="https://github.com/erlang/otp/pull/7475" title="">PR-7475</a></p></li><li><p>The <a href="../../apps/stdlib/proc_lib.html#set_label/1"><code class="inline">proc_lib:set_label/1</code></a> function is now used to increase observability of <code class="inline">ssl</code> processes.</p><p>Own Id: OTP-18879</p></li><li><p>Brainpool elliptic curves are now supported in TLS-1.3.</p><p>Own Id: OTP-18884 Aux Id: <a href="https://github.com/erlang/otp/pull/8056" title="">PR-8056</a></p></li><li><p>The documentation has been migrated to use Markdown and ExDoc.</p><p>Own Id: OTP-18955 Aux Id: <a href="https://github.com/erlang/otp/pull/8026" title="">PR-8026</a></p></li><li><p>For security reasons, the CBC ciphers are now longer included in the list of default ciphers for TLS-1.2.</p><p><strong><em> POTENTIAL INCOMPATIBILITY </em></strong></p><p>Own Id: OTP-19025 Aux Id: <a href="https://github.com/erlang/otp/pull/8250" title="">PR-8250</a></p></li><li><p>There is a new <code class="inline">cert_policy_opts</code> option to configure certificate policy options for the certificate path validation.</p><p>Own Id: OTP-19027 Aux Id: <a href="https://github.com/erlang/otp/pull/8255" title="">PR-8255</a></p></li></ul><h2 id="ssl-11-1-4-7" class="section-heading">
  <a href="#ssl-11-1-4-7" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 11.1.4.7</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-12" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-12" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>An initiated handshake should always be closed with an alert, some corner cases have been fixed so that this should always be the case.</p><p>Own Id: OTP-19411 Aux Id: PR-9273, ERIERL-1174</p></li><li><p>Correct option handling to work properly for paused handshaking. Could result in unwanted alerts or or error messages.</p><p>Own Id: OTP-19445 Aux Id: GH-9177, PR-9322</p></li></ul><h2 id="ssl-11-1-4-6" class="section-heading">
  <a href="#ssl-11-1-4-6" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 11.1.4.6</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-13" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-13" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>If present, extended key-usage TLS (SSL) role check (<code class="inline">pk-clientAuth</code>, <code class="inline">pk-serverAuth</code>) should always be performed for peer-cert. An intermediate CA cert may relax the requirement if <code class="inline">AnyExtendedKeyUsage</code> purpose is present.</p><p>In OTP-25.3.2.8, OTP-26.2 and OTP-27.0 these requirements became too relaxed. There where two problems, firstly the peer cert extension was only checked if it was marked critical, and secondly the CA cert check did not assert the relaxed <code class="inline">AnyExtendedKeyUsage</code> purpose.</p><p>This could result in that certificates might be misused for purposes not intended by the certificate authority.</p><p>Thanks to Bryan Paxton for reporting the issue.</p><p>Own Id: OTP-19352 Aux Id: PR-9130, CVE-2024-53846, OTP-19240</p></li></ul><h2 id="ssl-11-1-4-5" class="section-heading">
  <a href="#ssl-11-1-4-5" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 11.1.4.5</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-14" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-14" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Avoid generating an internal alert for case that should have been an orderly shutdown by the supervisor.</p><p>Own Id: OTP-19311 Aux Id: PR-8980</p></li></ul><h3 id="improvements-and-new-features-8" class="section-heading">
  <a href="#improvements-and-new-features-8" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Back port certificate_authorities option for TLS-1.3 servers to pre TLS-1.3 servers to enable them to disable the sending of certificate authorities in their certificate request. This will have same affect as the the TLS-1.3 server option although it is handled by a different mechanism in these versions, where the functionality is described to be more of a guidance, although some pre TLS clients have proven to make it mandatory as in TLS-1.3 extension handling.</p><p>Own Id: OTP-19325 Aux Id: PR-9001, ERIERL-1147</p></li></ul><h2 id="ssl-11-1-4-4" class="section-heading">
  <a href="#ssl-11-1-4-4" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 11.1.4.4</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-15" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-15" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Starting from TLS-1.3 some server handshake alerts might arrive after ssl:connection/2,3,4 has returned. If the socket is in active mode the controlling process will get the alert message, but passive sockets would only get {error, closed} on next call to ssl:recv/2,3 or ssl/setopts/2. Passive sockets calls will now return {error, error_alert()} instead.</p><p>Own Id: OTP-19236 Aux Id: PR-8261</p></li><li><p>Refactor trying to also make some optimizations introduced a bug in signature algorithms checks in OTP-26.2.1. This could manifest itself in not being able to negotiate connections using certificates needing to use some TLS-1.2 compatibility legacy signature schemes.</p><p>Own Id: OTP-19249 Aux Id: ERIERL-1137, PR-8866</p></li><li><p>Servers configured to support only version (pre TLS-1.2) should ignore hello version extension, as it is an unknown extension to them, this will result in that new clients that do not support the old server version will get an insufficient security alert from the server and not a protocol version alert, this is consistent with how old servers not able to support higher protocol versions work.</p><p>Own Id: OTP-19257 Aux Id: ERIERL-1131</p></li><li><p>Correct timeout handling for termination code run for own alerts, so that intended timeout is used instead of falling back to OS TCP-stack timeout that is unreasonably long on some platforms.</p><p>Own Id: OTP-19274 Aux Id: PR-8901</p></li></ul><h2 id="ssl-11-1-4-3" class="section-heading">
  <a href="#ssl-11-1-4-3" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 11.1.4.3</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-16" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-16" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>A race in the kTLS flavour of SSL distribution has been fixed so inet_drv.c doesn't read ahead too much data which could cause the kTLS encryption to be activated too late when some encrypted data had already been read into the inet_drv.c buffer as unencrypted.</p><p>Own Id: OTP-19175 Aux Id: GH-8561, PR-8690</p></li></ul><h3 id="improvements-and-new-features-9" class="section-heading">
  <a href="#improvements-and-new-features-9" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Make sure all TLS-1.3 terminations are graceful (previous TLS version terminations already are).</p><p>Own Id: OTP-17848</p></li><li><p>Include more information in logging of SNI (Server Name Indication) mismatch error.</p><p>Own Id: OTP-19187</p></li></ul><h2 id="ssl-11-1-4-2" class="section-heading">
  <a href="#ssl-11-1-4-2" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 11.1.4.2</span>
</h2>
<h3 id="improvements-and-new-features-10" class="section-heading">
  <a href="#improvements-and-new-features-10" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>When the default value for signature_algs is used, default the signature_algs_cert to the default value + rsa_pkcs1_sha1 to allow this algorithms for certificates but not for the TLS protocol. This is for better interoperability. If signature_algs is set explicitly signature_algs_cert must also be set explicitly if they should be different.</p><p>Own Id: OTP-19152 Aux Id: GH-8588</p></li></ul><h2 id="ssl-11-1-4-1" class="section-heading">
  <a href="#ssl-11-1-4-1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 11.1.4.1</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-17" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-17" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Check for TLS-1.3 support should check minimum requirements.</p><p>Own Id: OTP-19094 Aux Id: GH-8489</p></li><li><p>If both TLS-1.3 and TLS-1.2 is supported and TLS-1.2 negotiated convert TLS-1.3 ECDSA schemes to TLS-1.2 hash and signature pairs for increased interoperability.</p><p>Own Id: OTP-19107 Aux Id: GH-8376</p></li><li><p>TLS-1.3 negotiation now uses SNI based options correctly instead of ignoring them.</p><p>Own Id: OTP-19140</p></li></ul><h3 id="improvements-and-new-features-11" class="section-heading">
  <a href="#improvements-and-new-features-11" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Make it easier to distinguish between a invalid signature and unsupported signature.</p><p>Own Id: OTP-19091</p></li><li><p>Enhance ALERT logs to help understand what causes the alert.</p><p>Own Id: OTP-19092 Aux Id: GH-8482</p></li></ul><h2 id="ssl-11-1-4" class="section-heading">
  <a href="#ssl-11-1-4" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 11.1.4</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-18" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-18" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Fix certificate authorities check so that CA closest to peer is not lost. It could manifest itself in a failed connection as the client failed to realize it had a valid certificate chain to send to the server.</p><p>Own Id: OTP-19065 Aux Id: GH-8356, PR-8367</p></li><li><p>ssl:signature_algs/2 did not list some legacy algorithm schemes correctly when listing all algorithms available.</p><p>Own Id: OTP-19067 Aux Id: PR-8379</p></li></ul><h2 id="ssl-11-1-3" class="section-heading">
  <a href="#ssl-11-1-3" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 11.1.3</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-19" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-19" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Cleanup and close all connections in DTLS when the listen socket owner dies.</p><p>Improved IPv6 handling in DTLS.</p><p>Own Id: OTP-19037 Aux Id: GH-7951 GH-7955</p></li><li><p>Fixed a crash in dtls accept.</p><p>Own Id: OTP-19059 Aux Id: GH-8338</p></li></ul><h2 id="ssl-11-1-2" class="section-heading">
  <a href="#ssl-11-1-2" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 11.1.2</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-20" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-20" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>ssl:prf/5, will start working instead of hanging in a TLS-1.3 context if called appropriately. Note that the implementation has changed and in OTP-27 a more adequate API will be documented.</p><p>Own Id: OTP-18890 Aux Id: GH-7911</p></li><li><p>Server name verification didn't work if a connection was made with IP-address as a string.</p><p>Own Id: OTP-18909 Aux Id: GH-7968</p></li><li><p>The fallback after &quot;dh&quot; ssl option was undefined was to get &quot;dh&quot; from ssl options again. This is clearly wrong and now changed to the documented fallback &quot;dhfile&quot; ssl option.</p><p>Own Id: OTP-18919 Aux Id: PR-7984</p></li><li><p>Correct default value selection for DTLS. Will only affect users linked with really old version of cryptolib library.</p><p>Own Id: OTP-18962 Aux Id: GH-8079</p></li><li><p>Adhere elliptic curves with RFC 8422 pre TLS-1.3, that is Edwards curves are added to curves that can be used for key exchange, and documentation and implementation of eccs/0,1 are aligned.</p><p>Own Id: OTP-18991</p></li></ul><h3 id="improvements-and-new-features-12" class="section-heading">
  <a href="#improvements-and-new-features-12" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Improve alert reason when ecdhe_rsa key_exchange does not have any common curves to use</p><p>Own Id: OTP-18985</p></li></ul><h2 id="ssl-11-1-1" class="section-heading">
  <a href="#ssl-11-1-1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 11.1.1</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-21" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-21" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Legacy name handling could cause interop problems between TLS-1.3/1.2 client and TLS-1.2 server.</p><p>Own Id: OTP-18917 Aux Id: GH-7978</p></li></ul><h2 id="ssl-11-1" class="section-heading">
  <a href="#ssl-11-1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 11.1</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-22" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-22" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>ssl application will validate id-kp-serverAuth and id-kp-clientAuth extended
key usage only in end entity certificates. public_key application will
disallow &quot;anyExtendedKeyUsage&quot; for CA certificates that includes the extended
key usage extension and marks it critical.</p><p>Own Id: OTP-18739</p></li><li><p>Replaced unintentional Erlang Public License 1.1 headers in some files with
the intended Apache License 2.0 header.</p><p>Own Id: OTP-18815 Aux Id: PR-7780</p></li><li><p>Correct handling of TLS-1.3 legacy scheme names, could cause interop failures
for TLS-1.2 clients.</p><p>Own Id: OTP-18817</p></li><li><p>Add missing export for connection_info() API type.</p><p>Own Id: OTP-18886</p></li></ul><h3 id="improvements-and-new-features-13" class="section-heading">
  <a href="#improvements-and-new-features-13" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Fixed <code class="inline">server name indication</code> which was not handled properly.</p><p>Own Id: OTP-18836 Aux Id: GH-7795</p></li><li><p>Align documentation and implementation</p><p>Own Id: OTP-18853 Aux Id: PR-7841</p></li><li><p>Improve connection setup by optimizing certificate lookup.</p><p>Own Id: OTP-18893 Aux Id: PR-7920 PR-7921</p></li></ul><h2 id="ssl-11-0-3" class="section-heading">
  <a href="#ssl-11-0-3" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 11.0.3</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-23" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-23" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Avoid function clause error in ssl:getopts/2 by handling that inet:getopts may
return an empty list during some circumstances, such as the socket being in a
closing state.</p><p>Own Id: OTP-18697 Aux Id: GH-7506</p></li><li><p>The API function `ssl:recv/3` has been tightened to disallow negative
length, which has never been documented to work, but was passed through and
caused strange errors.</p><p>Own Id: OTP-18700 Aux Id: GH-7507</p></li><li><p>When a client initiated renegotiation was rejected and the client socket was
in active mode the expected error message to the controlling process was not
sent.</p><p>Own Id: OTP-18712 Aux Id: GH-7431</p></li></ul><h3 id="improvements-and-new-features-14" class="section-heading">
  <a href="#improvements-and-new-features-14" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Add some guidance for signature algorithms configuration in ssl applications
users guide.</p><p>Own Id: OTP-18631</p></li></ul><h2 id="ssl-11-0-2" class="section-heading">
  <a href="#ssl-11-0-2" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 11.0.2</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-24" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-24" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Added keylog information to all protocol versions in
<a href="ssl.html#connection_information/2"><code class="inline">ssl:connection_information/2</code></a>.</p><p>Own Id: OTP-18643 Aux Id: ERIERL-932</p></li></ul><h3 id="improvements-and-new-features-15" class="section-heading">
  <a href="#improvements-and-new-features-15" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Add RFC-6083 considerations for DTLS to enable gen_sctp based callback for the
transport.</p><p>Own Id: OTP-18618 Aux Id: ERIERL-932</p></li></ul><h2 id="ssl-11-0-1" class="section-heading">
  <a href="#ssl-11-0-1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 11.0.1</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-25" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-25" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Make sure that selection of client certificates handle both TLS-1.3 and
TLS-1.2 names correctly. Could cause valid client certificate to not be
selected, and an empty client certificate message to be sent to server.</p><p>Own Id: OTP-18588 Aux Id: GH-7264, PR-7277</p></li><li><p>Improved <a href="ssl.html#format_error/1"><code class="inline">ssl:format_error/1</code></a> to handle more error tuples.</p><p>Own Id: OTP-18596 Aux Id: GH-7247</p></li><li><p>Fixed hanging <code class="inline">ssl:connect</code> when ssl application is not started.</p><p>Own Id: OTP-18603 Aux Id: GH-7297</p></li><li><p>Correct handling of retransmission timers, current behavior could cause
unwanted delays.</p><p>Own Id: OTP-18632 Aux Id: PR-7300, GH-7301</p></li></ul><h2 id="ssl-11-0" class="section-heading">
  <a href="#ssl-11-0" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 11.0</span>
</h2>
<h3 id="improvements-and-new-features-16" class="section-heading">
  <a href="#improvements-and-new-features-16" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Remove less that 256 bit ECC from default supported ECC pre TLS-1.3</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-14771</p></li><li><p>Improved error checking and handling of ssl options.</p><p>Own Id: OTP-15903</p></li><li><p>With this change, stateless tickets generated by server with anti_replay
option enabled can be used for creating ClientHello throughout ticket
lifetime. Without this change, usability was limited to WindowSize number of
seconds configured for anti_replay option.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-18168 Aux Id: PR-6019, GH-6014</p></li><li><p>Support for Kernel TLS (kTLS), has been added to the SSL application, for TLS
distribution (<code class="inline">-proto_dist inet_tls</code>), the SSL option <code class="inline">{ktls, true}</code>. Using
this for general SSL sockets is uncomfortable, undocumented and not
recommended since it requires very platform dependent raw options.</p><p>This, for now, only works for some not too old Linux distributions. Roughly, a
kernel 5.2.0 or later with support for UserLand Protocols and the kernel
module <code class="inline">tls</code> is required.</p><p>Own Id: OTP-18235 Aux Id: PR-6104, PR-5840</p></li><li><p>With this change, TLS 1.3 server can be configured to include client
certificate in session ticket.</p><p>Own Id: OTP-18253</p></li><li><p>With this change, it is possible to configure encryption seed to be used with
TLS1.3 stateless tickets. This enables using tickets on different server
instances.</p><p>Own Id: OTP-18254 Aux Id: PR-5982</p></li><li><p>Debugging enhancements.</p><p>Own Id: OTP-18312</p></li><li><p>With this change, maybe keyword atom is not used as function name in ssl code.</p><p>Own Id: OTP-18335</p></li><li><p>Replace size/1 with either tuple_size/1 or byte_size/1</p><p>The <a href="../../apps/erts/erlang.html#size/1"><code class="inline">size/1</code></a> BIF is not optimized by the JIT, and its use can
result in worse types for Dialyzer.</p><p>When one knows that the value being tested must be a tuple,
<a href="../../apps/erts/erlang.html#tuple_size/1"><code class="inline">tuple_size/1</code></a> should always be preferred.</p><p>When one knows that the value being tested must be a binary,
<a href="../../apps/erts/erlang.html#byte_size/1"><code class="inline">byte_size/1</code></a> should be preferred. However,
<a href="../../apps/erts/erlang.html#byte_size/1"><code class="inline">byte_size/1</code></a> also accepts a bitstring (rounding up size to a
whole number of bytes), so one must make sure that the call to <code class="inline">byte_size/</code> is
preceded by a call to <a href="../../apps/erts/erlang.html#is_binary/1"><code class="inline">is_binary/1</code></a> to ensure that bitstrings
are rejected. Note that the compiler removes redundant calls to
<a href="../../apps/erts/erlang.html#is_binary/1"><code class="inline">is_binary/1</code></a>, so if one is not sure whether previous code
had made sure that the argument is a binary, it does not harm to add an
<a href="../../apps/erts/erlang.html#is_binary/1"><code class="inline">is_binary/1</code></a> test immediately before the call to
<a href="../../apps/erts/erlang.html#byte_size/1"><code class="inline">byte_size/1</code></a>.</p><p>Own Id: OTP-18405 Aux Id:
GH-6672,PR-6702,PR-6768,PR-6700,PR-6769,PR-6812,PR-6814</p></li><li><p>For security reasons remove support for SHA1 and DSA algorithms from default
values.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-18438 Aux Id: GH-6679</p></li><li><p>Mitigate memory usage from large certificate chains by lowering the maximum
handshake size. This should not effect the common cases, if needed it can be
configured to a higher value.</p><p>Own Id: OTP-18453</p></li><li><p>Change the client default verify option to verify_peer. Note that this makes
it mandatory to also supply trusted CA certificates or explicitly set verify
to verify_none. This also applies when using the so called anonymous test
cipher suites defined in TLS versions pre TLS-1.3.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-18455 Aux Id: GH-5899</p></li><li><p>Erlang distribution code in Kernel and SSL has been refactored a bit to
facilitate debugging and re-usability, which shouldn't have any noticeable
effects on behaviour or performance.</p><p>Own Id: OTP-18456</p></li><li><p>Add encoding and decoding of use_srtp hello extension to facilitate for DTLS
users to implement SRTP functionality.</p><p>Own Id: OTP-18459</p></li><li><p>Refactors the (<code class="inline">ssl</code> application to use macros for TLS and DTLS versions
instead of hard-coded tuple numbers. This change improves the maintainability
of <code class="inline">ssl</code></p><p>Own Id: OTP-18465 Aux Id: GH-7065</p></li><li><p>If the function ssl:renegotiate/1 is called on connection that is running
TLS-1.3 return an error instead of hanging or timing out.</p><p>Own Id: OTP-18507</p></li><li><p>If a user cancel alert with level warning is received during handshake make it
be handled the same regardless of TLS version. If it is received in connection
in TLS-1.3 regard it as an error as it is inappropriate.</p><p>In TLS-1.3 all error alerts are considered FATAL regardless of legacy alert
type. But make sure legacy type is printed in logs to not confuse users that
are expecting the same legacy type as sent by peer.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-18531</p></li><li><p>Make <code class="inline">fail_if_no_peer_cert</code> default true if verify_peer is set on the server,
otherwise the server will accept the connection if verify_peer is set and the
user have forgot to set the fail_if_no_peer_cert and the client did not send a
certificate.</p><p>Own Id: OTP-18567</p></li><li><p>To make it easier to configure signature algorithms with algorithms that are
moved from the default add the API function signature_algs/2 that lists
possible values. Also make sha224 a non default value.</p><p>Own Id: OTP-18572</p></li></ul><h2 id="ssl-10-9-1-7" class="section-heading">
  <a href="#ssl-10-9-1-7" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.9.1.7</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-26" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-26" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Avoid generating an internal alert for case that should have been an orderly shutdown by the supervisor.</p><p>Own Id: OTP-19311 Aux Id: PR-8980</p></li><li><p>If present, extended key-usage TLS (SSL) role check (<code class="inline">pk-clientAuth</code>, <code class="inline">pk-serverAuth</code>) should always be performed for peer-cert. An intermediate CA cert may relax the requirement if <code class="inline">AnyExtendedKeyUsage</code> purpose is present.</p><p>In OTP-25.3.2.8, OTP-26.2 and OTP-27.0 these requirements became too relaxed. There where two problems, firstly the peer cert extension was only checked if it was marked critical, and secondly the CA cert check did not assert the relaxed <code class="inline">AnyExtendedKeyUsage</code> purpose.</p><p>This could result in that certificates might be misused for purposes not intended by the certificate authority.</p><p>Thanks to Bryan Paxton for reporting the issue.</p><p>Own Id: OTP-19352 Aux Id: PR-9130, CVE-2024-53846, OTP-19240</p></li></ul><h2 id="ssl-10-9-1-6" class="section-heading">
  <a href="#ssl-10-9-1-6" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.9.1.6</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-27" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-27" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Starting from TLS-1.3 some server handshake alerts might arrive after ssl:connection/2,3,4 has returned. If the socket is in active mode the controlling process will get the alert message, but passive sockets would only get {error, closed} on next call to ssl:recv/2,3 or ssl/setopts/2. Passive sockets calls will now return {error, error_alert()} instead.</p><p>Own Id: OTP-19236 Aux Id: PR-8261</p></li><li><p>Servers configured to support only version (pre TLS-1.2) should ignore hello version extension, as it is an unknown extension to them, this will result in that new clients that do not support the old server version will get an insufficient security alert from the server and not a protocol version alert, this is consistent with how old servers not able to support higher protocol versions work.</p><p>Own Id: OTP-19257 Aux Id: ERIERL-1131</p></li><li><p>Correct timeout handling for termination code run for own alerts, so that intended timeout is used instead of falling back to OS TCP-stack timeout that is unreasonably long on some platforms.</p><p>Own Id: OTP-19274 Aux Id: PR-8901</p></li></ul><h2 id="ssl-10-9-1-5" class="section-heading">
  <a href="#ssl-10-9-1-5" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.9.1.5</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-28" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-28" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>TLS-1.3 negotiation now uses SNI based options correctly instead of ignoring them.</p><p>Own Id: OTP-19140</p></li></ul><h2 id="ssl-10-9-1-4" class="section-heading">
  <a href="#ssl-10-9-1-4" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.9.1.4</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-29" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-29" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Fix certificate authorities check so that CA closest to peer is not lost. It could manifest itself in a failed connection as the client failed to realize it had a valid certificate chain to send to the server.</p><p>Own Id: OTP-19065 Aux Id: GH-8356, PR-8367</p></li></ul><h2 id="ssl-10-9-1-3" class="section-heading">
  <a href="#ssl-10-9-1-3" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.9.1.3</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-30" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-30" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>ssl application will validate id-kp-serverAuth and id-kp-clientAuth extended
key usage only in end entity certificates. public_key application will
disallow &quot;anyExtendedKeyUsage&quot; for CA certificates that includes the extended
key usage extension and marks it critical.</p><p>Own Id: OTP-18739</p></li><li><p>Add missing export for connection_info() API type.</p><p>Own Id: OTP-18886</p></li></ul><h2 id="ssl-10-9-1-2" class="section-heading">
  <a href="#ssl-10-9-1-2" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.9.1.2</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-31" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-31" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>The API function `ssl:recv/3` has been tightened to disallow negative
length, which has never been documented to work, but was passed through and
caused strange errors.</p><p>Own Id: OTP-18700 Aux Id: GH-7507</p></li><li><p>When a client initiated renegotiation was rejected and the client socket was
in active mode the expected error message to the controlling process was not
sent.</p><p>Own Id: OTP-18712 Aux Id: GH-7431</p></li></ul><h2 id="ssl-10-9-1-1" class="section-heading">
  <a href="#ssl-10-9-1-1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.9.1.1</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-32" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-32" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Added keylog information to all protocol versions in
<a href="ssl.html#connection_information/2"><code class="inline">ssl:connection_information/2</code></a>.</p><p>Own Id: OTP-18643 Aux Id: ERIERL-932</p></li></ul><h3 id="improvements-and-new-features-17" class="section-heading">
  <a href="#improvements-and-new-features-17" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Add RFC-6083 considerations for DTLS to enable gen_sctp based callback for the
transport.</p><p>Own Id: OTP-18618 Aux Id: ERIERL-932</p></li></ul><h2 id="ssl-10-9-1" class="section-heading">
  <a href="#ssl-10-9-1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.9.1</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-33" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-33" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>With this change, ssl:connection_information/2 returns correct keylog data
after TLS1.3 key update.</p><p>Own Id: OTP-18489</p></li><li><p>Client signature algorithm list input order is now honored again , it was
accidently reversed by a previous fix.</p><p>Own Id: OTP-18550</p></li></ul><h2 id="ssl-10-9" class="section-heading">
  <a href="#ssl-10-9" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.9</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-34" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-34" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Fixed that new <code class="inline">dtls</code> connections from the same client ip port combination
works. If there is a process waiting for accept the new connection will
connect to that, otherwise it will try to re-connect to the old server
connection.</p><p>Own Id: OTP-18371 Aux Id: GH-6160</p></li><li><p>When shutting down a node that uses SSL distribution (<code class="inline">-proto_dist inet_tls</code>),
a confusing error message about an unexpected process exit was printed. This
particular message is no longer generated.</p><p>Own Id: OTP-18443 Aux Id: PR-6810</p></li></ul><h3 id="improvements-and-new-features-18" class="section-heading">
  <a href="#improvements-and-new-features-18" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>fixes the type spec for ssl:format_error/1</p><p>Own Id: OTP-18366 Aux Id: PR-6565, GH-6506</p></li><li><p>Replace size/1 with either tuple_size/1 or byte_size/1</p><p>The <a href="../../apps/erts/erlang.html#size/1"><code class="inline">size/1</code></a> BIF is not optimized by the JIT, and its use can
result in worse types for Dialyzer.</p><p>When one knows that the value being tested must be a tuple,
<a href="../../apps/erts/erlang.html#tuple_size/1"><code class="inline">tuple_size/1</code></a> should always be preferred.</p><p>When one knows that the value being tested must be a binary,
<a href="../../apps/erts/erlang.html#byte_size/1"><code class="inline">byte_size/1</code></a> should be preferred. However,
<a href="../../apps/erts/erlang.html#byte_size/1"><code class="inline">byte_size/1</code></a> also accepts a bitstring (rounding up size to a
whole number of bytes), so one must make sure that the call to <code class="inline">byte_size/</code> is
preceded by a call to <a href="../../apps/erts/erlang.html#is_binary/1"><code class="inline">is_binary/1</code></a> to ensure that bitstrings
are rejected. Note that the compiler removes redundant calls to
<a href="../../apps/erts/erlang.html#is_binary/1"><code class="inline">is_binary/1</code></a>, so if one is not sure whether previous code
had made sure that the argument is a binary, it does not harm to add an
<a href="../../apps/erts/erlang.html#is_binary/1"><code class="inline">is_binary/1</code></a> test immediately before the call to
<a href="../../apps/erts/erlang.html#byte_size/1"><code class="inline">byte_size/1</code></a>.</p><p>Own Id: OTP-18432 Aux Id:
GH-6672,PR-6793,PR-6784,PR-6787,PR-6785,PR-6682,PR-6800,PR-6797,PR-6798,PR-6799,PR-6796,PR-6813,PR-6671,PR-6673,PR-6684,PR-6694,GH-6677,PR-6696,PR-6670,PR-6674</p></li></ul><h2 id="ssl-10-8-7" class="section-heading">
  <a href="#ssl-10-8-7" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.8.7</span>
</h2>
<h3 id="improvements-and-new-features-19" class="section-heading">
  <a href="#improvements-and-new-features-19" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Maximize compatibility by ignoring change_cipher_spec during handshake even if
middle_box_mode is not negotiated (mandated by client)</p><p>Own Id: OTP-18433 Aux Id: GH-6772</p></li><li><p>Move assert of middlebox message after an hello_retry_request to maximize
interoperability. Does not changes semantics of the protocol only allows
unexpected message delay from server.</p><p>Own Id: OTP-18467 Aux Id: GH-6807</p></li></ul><h2 id="ssl-10-8-6" class="section-heading">
  <a href="#ssl-10-8-6" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.8.6</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-35" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-35" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>With this change, tls_sender process is hibernated after sufficient
inactivity.</p><p>Own Id: OTP-18314 Aux Id: GH-6373</p></li><li><p>Correct handling of legacy schemes so that ECDSA certs using sha1 may be used
for some TLS-1.3 configurations.</p><p>Own Id: OTP-18332 Aux Id: GH-6435, PR-6435, ERL-6435</p></li><li><p>With this change, tls_sender does not cause logger crash upon key update.</p><p>Own Id: OTP-18349</p></li></ul><h3 id="improvements-and-new-features-20" class="section-heading">
  <a href="#improvements-and-new-features-20" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Enhance warning message</p><p>Own Id: OTP-18257 Aux Id: GH-6307</p></li><li><p>Provide server option to make certificate_authorities extension in the TLS-1.3
servers certificate request optional. This will allow clients to send
incomplete chains that may be reconstructable and thereby verifiable by the
server, but that would not adhere to the certificate_authorities extension.</p><p>Own Id: OTP-18267 Aux Id: PR-6228, GH-6106</p></li><li><p>If the <code class="inline">verify_fun</code> handles four arguments the DER cert will be supplied as
one of the arguments.</p><p>Own Id: OTP-18302 Aux Id: ERIERL-867</p></li></ul><h2 id="ssl-10-8-5" class="section-heading">
  <a href="#ssl-10-8-5" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.8.5</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-36" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-36" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Fixes handling of symlinks in cacertfile option.</p><p>Own Id: OTP-18266 Aux Id: GH-6328</p></li></ul><h2 id="ssl-10-8-4" class="section-heading">
  <a href="#ssl-10-8-4" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.8.4</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-37" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-37" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Reject unexpected application data in all relevant places for all TLS
versions. Also, handle TLS-1.3 middlebox compatibility with more care. This
will make malicious connections fail early and further, mitigate possible DoS
attacks, that would be caught by the handshake timeout.</p><p>Thanks to Aina Toky Rasoamanana and Olivier Levillain from Télécom SudParis
for alerting us of the issues in our implementation.</p><p>Own Id: OTP-18044</p></li><li><p>With this change, value of cacertfile option will be adjusted before loading
certs from the file. Adjustments include converting relative paths to absolute
and converting symlinks to actual file path.</p><p>Thanks to Marcus Johansson</p><p>Own Id: OTP-18099 Aux Id: PR-6287</p></li><li><p>In TLS-1.3, if chain certs are missing (so server auth domain adherence can
not be determined) send peer cert and hope the server is able to recreate a
chain in its auth domain.</p><p>Own Id: OTP-18191 Aux Id: GH-6105</p></li><li><p>Make sure periodical refresh of CA certificate files repopulates cache
properly.</p><p>Own Id: OTP-18195</p></li><li><p>Correct internal CRL cache functions to use internal format consistently.</p><p>Own Id: OTP-18203 Aux Id: PR-5996</p></li><li><p>Incorrect handling of client middlebox negotiation for TLS-1.3 could result in
that a TLS-1.3 server would not use middlebox mode although the client was
expecting it too and failing the negotiation with unexpected message.</p><p>Own Id: OTP-18219 Aux Id: GH-6241, PR-6249</p></li><li><p>If the &quot;User&quot; process, the process starting the TLS connection, gets killed in
the middle of spawning the dynamic connection tree make sure we do not leave
any processes behind.</p><p>Own Id: OTP-18233 Aux Id: GH-6244, PR-6270</p></li></ul><h3 id="improvements-and-new-features-21" class="section-heading">
  <a href="#improvements-and-new-features-21" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>A vulnerability has been discovered and corrected. It is registered as
CVE-2022-37026 &quot;Client Authentication Bypass&quot;. Corrections have been released
on the supported tracks with patches 23.3.4.15, 24.3.4.2, and 25.0.2. The
vulnerability might also exist in older OTP versions. We recommend that
impacted users upgrade to one of these versions or later on the respective
tracks. OTP 25.1 would be an even better choice. Impacted are those who are
running an ssl/tls/dtls server using the ssl application either directly or
indirectly via other applications. For example via inets (httpd), cowboy, etc.
Note that the vulnerability only affects servers that request client
certification, that is sets the option {verify, verify_peer}.</p><p>Own Id: OTP-18241</p></li></ul><h2 id="ssl-10-8-3" class="section-heading">
  <a href="#ssl-10-8-3" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.8.3</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-38" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-38" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>The link to crypto:engine_load refered the function with wrong arity.</p><p>Own Id: OTP-18173</p></li></ul><h2 id="ssl-10-8-2" class="section-heading">
  <a href="#ssl-10-8-2" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.8.2</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-39" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-39" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Improved handling of unexpected messages during the handshake, taking the
right action for unexpected messages.</p><p>Own Id: OTP-18145</p></li></ul><h2 id="ssl-10-8-1" class="section-heading">
  <a href="#ssl-10-8-1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.8.1</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-40" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-40" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>When a TLS-1.3 enabled client tried to talk to a TLS-1.2 server that coalesces
TLS-1.2 handshake message over one TLS record, the connection could fail due
to some message being handled in the wrong state, this has been fixed.</p><p>Own Id: OTP-18087 Aux Id: GH-5961</p></li><li><p>Correctly handles supported protocol version change from default to something
else by sni_fun supplied to ssl:handshake/[2,3] together with a TCP-socket
(so called upgrade).</p><p>Own Id: OTP-18100 Aux Id: GH-5985</p></li><li><p>Also, TLS-1.3 should respond with a protocol version alert if previous
versions, that are supported but not configured, are attempted.</p><p>Own Id: OTP-18129 Aux Id: GH-5950</p></li></ul><h2 id="ssl-10-8" class="section-heading">
  <a href="#ssl-10-8" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.8</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-41" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-41" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>When a TLS-1.3 enabled client tried to talk to a TLS-1.2 server that coalesces
TLS-1.2 handshake message over one TLS record, the connection could fail due
to some message being handled in the wrong state, this has been fixed.</p><p>Own Id: OTP-18087 Aux Id: GH-5961</p></li><li><p>Fixed tls-1.3 session ticket lifetime which was discarded to quickly before.</p><p>Own Id: OTP-18092 Aux Id: PR-5959</p></li></ul><h3 id="improvements-and-new-features-22" class="section-heading">
  <a href="#improvements-and-new-features-22" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>With this change, it is possible to provide several certificates. Most
appropriate will be selected based on negotiated properties.</p><p>Own Id: OTP-15993 Aux Id: GH-4143</p></li><li><p>Add options for users to be able to set spawn_opts for TLS processes (sender
and receiver) this may be useful for tuning trade-offs between CPU and Memory
usage.</p><p>Own Id: OTP-17855 Aux Id: PR-5328</p></li><li><p>Allow key file passwords to be input as a single binary, that is we change the
data type to be the more for the purpose logical data type iodata() instead of
string().</p><p>Own Id: OTP-17890</p></li><li><p>Logging enhancement, add location information to the warning log message.</p><p>Own Id: OTP-18000 Aux Id: PR-5790</p></li><li><p>Now also accepts the signature_algs_cert option in TLS-1.2 configuration.</p><p>Own Id: OTP-18014</p></li><li><p>Handle certificate selection correctly for server fallback and certificate
authorities considerations.</p><p>Own Id: OTP-18045 Aux Id: ERIERL-792, OTP-15993</p></li><li><p>Enhance handling of handshake decoding errors, especially for certificate
authorities extension to ensure graceful termination.</p><p>Own Id: OTP-18085</p></li></ul><h2 id="ssl-10-7-3-9" class="section-heading">
  <a href="#ssl-10-7-3-9" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.7.3.9</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-42" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-42" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>When a client initiated renegotiation was rejected and the client socket was
in active mode the expected error message to the controlling process was not
sent.</p><p>Own Id: OTP-18712 Aux Id: GH-7431</p></li></ul><h2 id="ssl-10-7-3-8" class="section-heading">
  <a href="#ssl-10-7-3-8" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.7.3.8</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-43" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-43" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Added keylog information to all protocol versions in
<a href="ssl.html#connection_information/2"><code class="inline">ssl:connection_information/2</code></a>.</p><p>Own Id: OTP-18643 Aux Id: ERIERL-932</p></li></ul><h3 id="improvements-and-new-features-23" class="section-heading">
  <a href="#improvements-and-new-features-23" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Add RFC-6083 considerations for DTLS to enable gen_sctp based callback for the
transport.</p><p>Own Id: OTP-18618 Aux Id: ERIERL-932</p></li></ul><h2 id="ssl-10-7-3-7" class="section-heading">
  <a href="#ssl-10-7-3-7" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.7.3.7</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-44" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-44" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Client signature algorithm list input order is now honored again , it was
accidently reversed by a previous fix.</p><p>Own Id: OTP-18550</p></li></ul><h2 id="ssl-10-7-3-6" class="section-heading">
  <a href="#ssl-10-7-3-6" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.7.3.6</span>
</h2>
<h3 id="improvements-and-new-features-24" class="section-heading">
  <a href="#improvements-and-new-features-24" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Maximize compatibility by ignoring change_cipher_spec during handshake even if
middle_box_mode is not negotiated (mandated by client)</p><p>Own Id: OTP-18433 Aux Id: GH-6772</p></li><li><p>Move assert of middlebox message after an hello_retry_request to maximize
interoperability. Does not changes semantics of the protocol only allows
unexpected message delay from server.</p><p>Own Id: OTP-18467 Aux Id: GH-6807</p></li></ul><h2 id="ssl-10-7-3-5" class="section-heading">
  <a href="#ssl-10-7-3-5" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.7.3.5</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-45" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-45" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Fixes handling of symlinks in cacertfile option.</p><p>Own Id: OTP-18266 Aux Id: GH-6328</p></li></ul><h2 id="ssl-10-7-3-4" class="section-heading">
  <a href="#ssl-10-7-3-4" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.7.3.4</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-46" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-46" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>With this change, value of cacertfile option will be adjusted before loading
certs from the file. Adjustments include converting relative paths to absolute
and converting symlinks to actual file path.</p><p>Thanks to Marcus Johansson</p><p>Own Id: OTP-18099 Aux Id: PR-6287</p></li><li><p>Incorrect handling of client middlebox negotiation for TLS-1.3 could result in
that a TLS-1.3 server would not use middlebox mode although the client was
expecting it too and failing the negotiation with unexpected message.</p><p>Own Id: OTP-18219 Aux Id: GH-6241, PR-6249</p></li><li><p>If the &quot;User&quot; process, the process starting the TLS connection, gets killed in
the middle of spawning the dynamic connection tree make sure we do not leave
any processes behind.</p><p>Own Id: OTP-18233 Aux Id: GH-6244, PR-6270</p></li></ul><h2 id="ssl-10-7-3-3" class="section-heading">
  <a href="#ssl-10-7-3-3" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.7.3.3</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-47" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-47" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Reject unexpected application data in all relevant places for all TLS
versions. Also, handle TLS-1.3 middlebox compatibility with more care. This
will make malicious connections fail early and further, mitigate possible DoS
attacks, that would be caught by the handshake timeout.</p><p>Thanks to Aina Toky Rasoamanana and Olivier Levillain from Télécom SudParis
for alerting us of the issues in our implementation.</p><p>Own Id: OTP-18044</p></li><li><p>The link to crypto:engine_load refered the function with wrong arity.</p><p>Own Id: OTP-18173</p></li><li><p>Make sure periodical refresh of CA certificate files repopulates cache
properly.</p><p>Own Id: OTP-18195</p></li></ul><h2 id="ssl-10-7-3-2" class="section-heading">
  <a href="#ssl-10-7-3-2" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.7.3.2</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-48" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-48" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Improved handling of unexpected messages during the handshake, taking the
right action for unexpected messages.</p><p>Own Id: OTP-18145</p></li></ul><h2 id="ssl-10-7-3-1" class="section-heading">
  <a href="#ssl-10-7-3-1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.7.3.1</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-49" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-49" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>When a TLS-1.3 enabled client tried to talk to a TLS-1.2 server that coalesces
TLS-1.2 handshake message over one TLS record, the connection could fail due
to some message being handled in the wrong state, this has been fixed.</p><p>Own Id: OTP-18087 Aux Id: GH-5961</p></li><li><p>Fixed tls-1.3 session ticket lifetime which was discarded to quickly before.</p><p>Own Id: OTP-18092 Aux Id: PR-5959</p></li><li><p>Correctly handles supported protocol version change from default to something
else by sni_fun supplied to ssl:handshake/[2,3] together with a TCP-socket
(so called upgrade).</p><p>Own Id: OTP-18100 Aux Id: GH-5985</p></li><li><p>Also, TLS-1.3 should respond with a protocol version alert if previous
versions, that are supported but not configured, are attempted.</p><p>Own Id: OTP-18129 Aux Id: GH-5950</p></li></ul><h3 id="improvements-and-new-features-25" class="section-heading">
  <a href="#improvements-and-new-features-25" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Enhance handling of handshake decoding errors, especially for certificate
authorities extension to ensure graceful termination.</p><p>Own Id: OTP-18085</p></li></ul><h2 id="ssl-10-7-3" class="section-heading">
  <a href="#ssl-10-7-3" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.7.3</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-50" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-50" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Client certification could fail if TLS-1.3 enabled client negotiated TLS-1.2
connection with the server, this is due to the wrong version being used when
decoding the certificate request message from the server.</p><p>Own Id: OTP-18028 Aux Id: GH-5835</p></li><li><p>socket option packet_size was not handled in ssl:setops/2 and ssl:getotps/2</p><p>Own Id: OTP-18062 Aux Id: GH-5898</p></li><li><p>Remove legacy code to fix interoperability with new socket inet_backend.</p><p>Own Id: OTP-18071 Aux Id: GH-5930</p></li></ul><h2 id="ssl-10-7-2" class="section-heading">
  <a href="#ssl-10-7-2" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.7.2</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-51" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-51" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>With this change, potential hanging of pre TLS1.3 client receiving OSCP staple
message is avoided.</p><p>Own Id: OTP-17994</p></li></ul><h2 id="ssl-10-7-1" class="section-heading">
  <a href="#ssl-10-7-1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.7.1</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-52" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-52" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Client certification could fail for TLS-1.3 servers that did not include the
certificate_authorities extension in its certificate request message.</p><p>Own Id: OTP-17971 Aux Id: GH-5783</p></li></ul><h2 id="ssl-10-7" class="section-heading">
  <a href="#ssl-10-7" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.7</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-53" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-53" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Improved error handling.</p><p>Own Id: OTP-17759 Aux Id: GH-5367</p></li><li><p>Before this change, net_kernel used with TLS distribution might be leaking
processes in case of connectivity issues.</p><p>Own Id: OTP-17815 Aux Id: GH-5332</p></li><li><p>Fix makefile dependency bugs.</p><p>Own Id: OTP-17847 Aux Id: PR-5574 GH-5548</p></li><li><p>Make sure the TLS sender process handles explicit calls to
erlang:disconnect_node properly, avoiding potential hanging problems in
net_kernel.</p><p>Own Id: OTP-17929 Aux Id: GH-5708</p></li></ul><h3 id="improvements-and-new-features-26" class="section-heading">
  <a href="#improvements-and-new-features-26" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Add support for TLS-1.3 certificate_authorities extension. And process
certificate_authorities field in pre-TLS-1.3 certificate requests.</p><p>Own Id: OTP-15719</p></li><li><p>Support password fun for protected keyfiles in ssl:connect function.</p><p>Own Id: OTP-17816 Aux Id: PR-5607</p></li><li><p>Add in some cases earlier detection of possible DoS attacks by malicious
clients sending unexpected TLS messages instead of the client hello. Note that
such attacks are already mitigated by providing a timeout for the TLS
handshake.</p><p>Own Id: OTP-17903</p></li></ul><h2 id="ssl-10-6-1" class="section-heading">
  <a href="#ssl-10-6-1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.6.1</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-54" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-54" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Improve SNI (server name indication) handling so that protocol version can be
selected with regards to SNI. Also, make sure that
ssl:connection_information/1 returns the correct SNI value.</p><p>Own Id: OTP-17794 Aux Id: GH-5341, GH-4450</p></li><li><p>Fixed cipher suite listing functions so that the listing of all cipher suites
will be complete. Another fix for cipher suite handling in OTP-24.1
accidentally excludes a few cipher suites from the listing of all cipher
suites.</p><p>Own Id: OTP-17829 Aux Id: ERIERL-708</p></li><li><p>Reenable legacy cipher suite TLS_RSA_WITH_3DES_EDE_CBC_SHA for explicit
configuration in TLS-1.2, not supported by default.</p><p>Own Id: OTP-17879 Aux Id: GH-5624</p></li></ul><h3 id="improvements-and-new-features-27" class="section-heading">
  <a href="#improvements-and-new-features-27" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Avoid unnecessary logs by better adjusting the tls_sender process to the new
supervisor structure in OTP-24.2</p><p>Own Id: OTP-17831</p></li></ul><h2 id="ssl-10-6" class="section-heading">
  <a href="#ssl-10-6" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.6</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-55" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-55" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Allow re-connect on DTLS sockets</p><p>Can happen when a computer reboots and connects from the same client port
without the server noticing should be allowed according to RFC.</p><p>Own Id: OTP-17411 Aux Id: ERL-1203, GH-4393</p></li><li><p>Fix tls and non-tls distribution to use erl_epmd:address_please to figure out
if IPv4 or IPv6 addresses should be used when connecting to the remote node.</p><p>Before this fix, a dns lookup of the remote node hostname determined which IP
version was to be used which meant that the hostname had to resolve to a valid
ip address.</p><p>Own Id: OTP-17809 Aux Id: PR-5337 GH-5334</p></li></ul><h3 id="improvements-and-new-features-28" class="section-heading">
  <a href="#improvements-and-new-features-28" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Use supervisor significant child to manage tls connection process and tls
sender process dependency.</p><p>Own Id: OTP-17417</p></li><li><p>Random generation adjustment for TLS1.3</p><p>Own Id: OTP-17699</p></li><li><p>Allow any {03,XX} TLS record version in the client hello for maximum
interoperability</p><p>Own Id: OTP-17761 Aux Id: GH-5380</p></li></ul><h2 id="ssl-10-5-3" class="section-heading">
  <a href="#ssl-10-5-3" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.5.3</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-56" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-56" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Correct typo of ECC curve name in signature algorithm handling. Will make the
signature algorithm ecdsa_secp521r1_sha512 succeed.</p><p>Own Id: OTP-17756 Aux Id: GH-5383, PR-5397</p></li><li><p>Suppress authenticity warning when option verify_none is explicitly supplied.</p><p>Own Id: OTP-17757 Aux Id: GH-5352, PR-5395</p></li></ul><h2 id="ssl-10-5-2" class="section-heading">
  <a href="#ssl-10-5-2" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.5.2</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-57" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-57" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Fix TLS-1.2 RSA-PSS negotiation and also fix broken certificate request
message for pre-TLS-1.3 servers.</p><p>Own Id: OTP-17688 Aux Id: GH-5255</p></li><li><p>Fix CRL issuer verification that under some circumstances could fail with a
function_clause error.</p><p>Own Id: OTP-17723 Aux Id: GH-5300</p></li></ul><h2 id="ssl-10-5-1" class="section-heading">
  <a href="#ssl-10-5-1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.5.1</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-58" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-58" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Before that change, TLS downgrade could occasionally fail when data intended
for downgraded socket were delivered together with CLOSE_NOTIFY alert to ssl
app.</p><p>Own Id: OTP-17393</p></li><li><p>Avoid re-encoding of decoded certificates. This could cause unexpected
failures as some subtle encoding errors can be tolerated when decoding but
hence creating another sequence of bytes if the decoded value is re-encoded.</p><p>Own Id: OTP-17657</p></li><li><p>Fix possible process leak when the process doing ssl:transport_accept dies
before initiating the TLS handshake.</p><p>Own Id: OTP-17666 Aux Id: GH-5239</p></li><li><p>Fix dtls memory leak, the replay window code was broken.</p><p>Own Id: OTP-17670 Aux Id: GH-5224</p></li></ul><h2 id="ssl-10-5" class="section-heading">
  <a href="#ssl-10-5" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.5</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-59" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-59" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Fix Makefile dependency generation to work no matter what the <code class="inline">ERL_TOP</code> folder
is called.</p><p>Own Id: OTP-17423 Aux Id: GH-4823 PR-4829</p></li><li><p>If trying to downgrade a TLS-1.3 connection to a plain TCP connection,
possible TLS-1.3 session ticket messages will be ignored in the &quot;downgrade&quot;
state while waiting for the close notify alert.</p><p>Own Id: OTP-17517 Aux Id: GH-5009</p></li><li><p>Corrected error handling to correctly generate an insufficient security alert
when there are no suitable groups that can be negotiated in TLS-1.3 instead of
crashing resulting in an internal error alert.</p><p>Own Id: OTP-17521</p></li><li><p>Properly handle default session data storage.</p><p>When a client tries to reuse an expired session the default server storage
handling would crash losing other session data. This would cause a error
report and possible loss of abbreviated handshakes.</p><p>Own Id: OTP-17635 Aux Id: GH-5192</p></li></ul><h3 id="improvements-and-new-features-29" class="section-heading">
  <a href="#improvements-and-new-features-29" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Add support for RSA-PSS-PSS signatures and signature_algorithms_cert in
TLS-1.2. This is a TLS-1.3 RFC requirement to backport this functionality.</p><p>Own Id: OTP-16590 Aux Id: ERL-625, GH-5029</p></li><li><p>Use inet:monitor/1 to monitor listen-sockets so that we are compatible with
the new socket backend for gen_tcp.</p><p>Own Id: OTP-17392 Aux Id: PR-5050</p></li><li><p>Enhance ssl:prf/4 handling and testing</p><p>Own Id: OTP-17464</p></li><li><p>Enhanced cipher suite filtering functionality, making sure TLS-1.3 and TLS-1.2
cipher suites can be supported correctly together even when TLS-1.2 anonymous
ciphers are included.</p><p>Own Id: OTP-17501 Aux Id: GH-4978</p></li><li><p>Enhance gracefulness especially in TLS-1.3</p><p>Own Id: OTP-17530</p></li></ul><h2 id="ssl-10-4-2" class="section-heading">
  <a href="#ssl-10-4-2" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.4.2</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-60" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-60" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Handle cross-signed root certificates when old root expired as reported in
GH-4877.</p><p>Own Id: OTP-17475 Aux Id: GH-4877</p></li><li><p>The signature selection algorithm has been changed to also verify if the
client supports signatures using the elliptic curve of the server's
public/private key pair. This change fixes #4958.</p><p>Own Id: OTP-17529 Aux Id: PR-4979, GH-4958</p></li></ul><h3 id="improvements-and-new-features-30" class="section-heading">
  <a href="#improvements-and-new-features-30" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Slight optimization of certificate decoding.</p><p>Own Id: OTP-17150 Aux Id: GH-4877</p></li></ul><h2 id="ssl-10-4-1" class="section-heading">
  <a href="#ssl-10-4-1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.4.1</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-61" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-61" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Fix cache invalidation problem for CA certs provided by the cacertfile option.</p><p>Own Id: OTP-17435 Aux Id: ERIERL-653</p></li></ul><h2 id="ssl-10-4" class="section-heading">
  <a href="#ssl-10-4" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.4</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-62" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-62" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Missing runtime dependencies has been added to this application.</p><p>Own Id: OTP-17243 Aux Id: PR-4557</p></li><li><p>TLS handshake should fail if OCSP staple is requested but missing. Note that
OCSP support is still considered experimental and only partially implemented.</p><p>Own Id: OTP-17343</p></li></ul><h3 id="improvements-and-new-features-31" class="section-heading">
  <a href="#improvements-and-new-features-31" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Removed ssl:ssl_accept/1,2,3 and ssl:cipher:suites/0,1 use ssl:handshake/1,2,3
and ssl:cipher_suites/2,3 instead.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-16974</p></li><li><p>Make TLS handshakes in Erlang distribution concurrent.</p><p>Own Id: OTP-17044 Aux Id: PR-2654</p></li><li><p>Randomize internal <code class="inline">{active,n}</code> optimization when running Erlang distribution
over TLS to spread RAM/CPU spike that may occur when starting up a big
cluster.</p><p>Own Id: OTP-17117 Aux Id: PR-2933</p></li><li><p>TLS connections now support EdDSA certificates.</p><p>Own Id: OTP-17142 Aux Id: PR-4756, GH-4637, GH-4650</p></li><li><p>Enhance documentation and logging of certificate handling.</p><p>Own Id: OTP-17384 Aux Id: GH-4800</p></li></ul><h2 id="ssl-10-3-1-5" class="section-heading">
  <a href="#ssl-10-3-1-5" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.3.1.5</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-63" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-63" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Correct corner case of unexpected message handling for pre TLS-1.3 versions,
could cause &quot;late failure&quot; and make the server dependent on its handshake
timeout to prevent possible DoS attacks.</p><p>Own Id: OTP-18224</p></li></ul><h2 id="ssl-10-3-1-4" class="section-heading">
  <a href="#ssl-10-3-1-4" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.3.1.4</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-64" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-64" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>The link to crypto:engine_load refered the function with wrong arity.</p><p>Own Id: OTP-18173</p></li></ul><h2 id="ssl-10-3-1-3" class="section-heading">
  <a href="#ssl-10-3-1-3" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.3.1.3</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-65" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-65" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Improved handling of unexpected messages during the handshake, taking the
right action for unexpected messages.</p><p>Own Id: OTP-18145</p></li></ul><h2 id="ssl-10-3-1-2" class="section-heading">
  <a href="#ssl-10-3-1-2" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.3.1.2</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-66" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-66" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Handle cross-signed root certificates when old root expired as reported in
GH-4877.</p><p>Own Id: OTP-17475 Aux Id: GH-4877</p></li><li><p>The signature selection algorithm has been changed to also verify if the
client supports signatures using the elliptic curve of the server's
public/private key pair. This change fixes #4958.</p><p>Own Id: OTP-17529 Aux Id: PR-4979, GH-4958</p></li></ul><h3 id="improvements-and-new-features-32" class="section-heading">
  <a href="#improvements-and-new-features-32" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Slight optimization of certificate decoding.</p><p>Own Id: OTP-17150 Aux Id: GH-4877</p></li></ul><h2 id="ssl-10-3-1-1" class="section-heading">
  <a href="#ssl-10-3-1-1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.3.1.1</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-67" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-67" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Fix cache invalidation problem for CA certs provided by the cacertfile option.</p><p>Own Id: OTP-17435 Aux Id: ERIERL-653</p></li></ul><h2 id="ssl-10-3-1" class="section-heading">
  <a href="#ssl-10-3-1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.3.1</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-68" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-68" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Retain backwards compatible behavior of verify_fun when handling incomplete
chains that are not verifiable.</p><p>Own Id: OTP-17296 Aux Id: GH-4682</p></li><li><p>Avoid server session handler crash, this will increase session ruse
opportunities.</p><p>Own Id: OTP-17348 Aux Id: ERIERL-641</p></li></ul><h2 id="ssl-10-3" class="section-heading">
  <a href="#ssl-10-3" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.3</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-69" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-69" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Fix CRL handling that previously could fail to find the issuer cert under some
circumstances.</p><p>Own Id: OTP-17261 Aux Id: GH-4589</p></li><li><p>TLS-1.3 client could, under some circumstances, select an incorrect algorithm
to sign the certificate verification message causing a TLS Decrypt Alert being
issued by the server.</p><p>Own Id: OTP-17281 Aux Id: GH-4620</p></li><li><p>Correct handling of default values for emulated socket options and retain the
order of the ssl options list to ensure backwards compatible behavior if
options should be set more than once.</p><p>Own Id: OTP-17282</p></li></ul><h3 id="improvements-and-new-features-33" class="section-heading">
  <a href="#improvements-and-new-features-33" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Enhance pre TLS-1.3 session handling so the client and server side handling is
completely separated and client disregards oldest session when reaching max
limit of the session table.</p><p>Own Id: OTP-16876</p></li><li><p>This change implements the early data feature for TLS 1.3 clients.</p><p>TLS 1.3 allows clients to send data in the first flight using a Pre-Shared Key
to authenticate the server and to encrypt the early data.</p><p>Own Id: OTP-16985</p></li><li><p>This change implements the early data feature for TLS 1.3 servers.</p><p>Own Id: OTP-17042</p></li></ul><h2 id="ssl-10-2-4-4" class="section-heading">
  <a href="#ssl-10-2-4-4" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.2.4.4</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-70" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-70" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Improved handling of unexpected messages during the handshake, taking the
right action for unexpected messages.</p><p>Own Id: OTP-18145</p></li></ul><h2 id="ssl-10-2-4-3" class="section-heading">
  <a href="#ssl-10-2-4-3" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.2.4.3</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-71" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-71" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Fix cache invalidation problem for CA certs provided by the cacertfile option.</p><p>Own Id: OTP-17435 Aux Id: ERIERL-653</p></li></ul><h2 id="ssl-10-2-4-2" class="section-heading">
  <a href="#ssl-10-2-4-2" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.2.4.2</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-72" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-72" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Fix handling of emulated socket options, the previous patch was incomplete,</p><p>Own Id: OTP-17305</p></li></ul><h2 id="ssl-10-2-4-1" class="section-heading">
  <a href="#ssl-10-2-4-1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.2.4.1</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-73" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-73" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Backport of OTP-17282</p><p>Correct handling of default values for emulated socket options and retain the
order of the ssl options list to ensure backwards compatible behavior if
options should be set more than once.</p><p>Own Id: OTP-17289 Aux Id: GH-4585</p></li></ul><h2 id="ssl-10-2-4" class="section-heading">
  <a href="#ssl-10-2-4" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.2.4</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-74" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-74" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Enhance logging option log_level to support none and all, also restore
backwards compatibility for log_alert option.</p><p>Own Id: OTP-17228 Aux Id: ERIERL-614</p></li></ul><h2 id="ssl-10-2-3" class="section-heading">
  <a href="#ssl-10-2-3" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.2.3</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-75" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-75" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Avoid race when the first two upgrade server handshakes (that is servers that
use a gen_tcp socket as input to ssl:handshake/2,3) start close to each other.
Could lead to that one of the handshakes would fail.</p><p>Own Id: OTP-17190 Aux Id: ERIERL-606</p></li></ul><h2 id="ssl-10-2-2" class="section-heading">
  <a href="#ssl-10-2-2" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.2.2</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-76" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-76" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Avoid that upgrade (from TCP to TLS) servers starts multiple session cache
handlers for the same server. This applies to Erlang distribution over TLS
servers.</p><p>Own Id: OTP-17139 Aux Id: ERL-1458, OTP-16239</p></li><li><p>Legacy cipher suites defined before TLS-1.2 (but still supported) should be
possible to use in TLS-1.2. They where accidentally excluded for available
cipher suites for TLS-1.2 in OTP-23.2.2.</p><p>Own Id: OTP-17174 Aux Id: ERIERL-597</p></li></ul><h3 id="improvements-and-new-features-34" class="section-heading">
  <a href="#improvements-and-new-features-34" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Enable Erlang distribution over TLS to run TLS-1.3, although TLS-1.2 will
still be default.</p><p>Own Id: OTP-16239 Aux Id: ERL-1458, OTP-17139</p></li></ul><h2 id="ssl-10-2-1" class="section-heading">
  <a href="#ssl-10-2-1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.2.1</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-77" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-77" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Fix CVE-2020-35733 this only affects ssl-10.2 (OTP-23.2). This vulnerability
could enable a man in the middle attack using a fake chain to a known trusted
ROOT. Also limits alternative chain handling, for handling of possibly
extraneous certs, to improve memory management.</p><p>Own Id: OTP-17098</p></li></ul><h3 id="improvements-and-new-features-35" class="section-heading">
  <a href="#improvements-and-new-features-35" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Add support for AES CCM based cipher suites defined in RFC 7251</p><p>Also Correct cipher suite name conversion to OpenSSL names. A few names where
corrected earlier in OTP-16267 For backwards compatible reasons we support
usage of openSSL names for cipher suites. Mostly anonymous suites names where
incorrect, but also some legacy suites.</p><p>Own Id: OTP-17100</p></li></ul><h2 id="ssl-10-2" class="section-heading">
  <a href="#ssl-10-2" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.2</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-78" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-78" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>SSL's Erlang Distribution Protocol modules inet_tls_dist and inet6_tls_dist
lacked a callback function, so the start flag &quot;-dist_listen false&quot; did not
work, which has now been fixed.</p><p>Own Id: OTP-15126 Aux Id: ERL-1375</p></li><li><p>Correct OpenSSL names for newer cipher suites using DHE in their name that
accidentally got the wrong value when fixing other older names using EDH
instead.</p><p>Own Id: OTP-16267 Aux Id: ERIERL-571, ERIERL-477</p></li><li><p>This change improves the handling of DTLS listening dockets, making it
possible to open multiple listeners on the same port with different IP
addresses.</p><p>Own Id: OTP-16849 Aux Id: ERL-1339</p></li><li><p>Fix a bug that causes cross-build failure.</p><p>This change excludes the ssl.d dependency file from the source tarballs.</p><p>Own Id: OTP-16921</p></li><li><p>This change fixes ssl:peername/1 when called on a DTLS client socket.</p><p>Own Id: OTP-16923 Aux Id: ERL-1341, PR-2786</p></li><li><p>Retain emulation of active once on a closed socket to behave as before 23.1</p><p>Own Id: OTP-17018 Aux Id: ERL-1409</p></li><li><p>Corrected server session cache entry deletion pre TLS-1.3. May increase
session reuse.</p><p>Own Id: OTP-17019 Aux Id: ERL-1412</p></li></ul><h3 id="improvements-and-new-features-36" class="section-heading">
  <a href="#improvements-and-new-features-36" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Handle extraneous certs in certificate chains as well as chains that are
incomplete but can be reconstructed or unordered chains. The cert and certfile
options will now accept a list of certificates so that the user may specify
the chain explicitly.</p><p>Also, the default value of the depth option has been increased to allow longer
chains by default.</p><p>Own Id: OTP-16277</p></li><li><p>This change implements optional NSS-style keylog in
ssl:connection_information/2 for debugging purposes.</p><p>The keylog contains various TLS secrets that can be loaded in Wireshark to
decrypt TLS packets.</p><p>Own Id: OTP-16445 Aux Id: PR-2823</p></li><li><p>Use new gen_statem feature of changing callback mode to improve code
maintainability.</p><p>Own Id: OTP-16529</p></li><li><p>The handling of Service Name Indication has been aligned with RFC8446.</p><p>Own Id: OTP-16762</p></li><li><p>Add explicit session reuse option to TLS clients for pre TLS-1.3 sessions.
Also, add documentation to Users Guide for such sessions.</p><p>Own Id: OTP-16893</p></li></ul><h2 id="ssl-10-1" class="section-heading">
  <a href="#ssl-10-1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.1</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-79" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-79" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>If a passive socket is created, ssl:recv/2,3 is never called and then the peer
closes the socket the controlling process will no longer receive an active
close message.</p><p>Own Id: OTP-16697 Aux Id: ERIERL-496</p></li><li><p>Data deliver with ssl:recv/2,3 could fail for when using packet mode. This has
been fixed by correcting the flow control handling of passive sockets when
packet mode is used.</p><p>Own Id: OTP-16764</p></li><li><p>This change fixes a potential man-in-the-middle vulnerability when the ssl
client is configured to automatically handle session tickets
({session_tickets, auto}).</p><p>Own Id: OTP-16765</p></li><li><p>Fix the internal handling of options 'verify' and 'verify_fun'.</p><p>This change fixes a vulnerability when setting the ssl option 'verify' to
verify_peer in a continued handshake won't take any effect resulting in the
acceptance of expired peer certificates.</p><p>Own Id: OTP-16767 Aux Id: ERIERL-512</p></li><li><p>This change fixes the handling of stateless session tickets when anti-replay
is enabled.</p><p>Own Id: OTP-16776 Aux Id: ERL-1316</p></li><li><p>Fix a crash due to the faulty handling of stateful session tickets received by
servers expecting stateless session tickets.</p><p>This change also improves the handling of faulty/invalid tickets.</p><p>Own Id: OTP-16777 Aux Id: ERL-1317</p></li><li><p>Correct flow ctrl checks from OTP-16764 to work as intended. Probably will not
have a noticeable affect but will make connections more well behaved under
some circumstances.</p><p>Own Id: OTP-16837 Aux Id: ERL-1319, OTP-16764</p></li><li><p>Distribution over TLS could exhibit livelock-like behaviour when there is a
constant stream of distribution messages. Distribution data is now chunked
every 16 Mb to avoid that.</p><p>Own Id: OTP-16851 Aux Id: PR-2703</p></li></ul><h3 id="improvements-and-new-features-37" class="section-heading">
  <a href="#improvements-and-new-features-37" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Implement the cookie extension for TLS 1.3.</p><p>Own Id: OTP-15855</p></li><li><p>Experimental OCSP client support.</p><p>Own Id: OTP-16448</p></li><li><p>TLS 1.0 -TLS-1.2 sessions tables now have a absolute max value instead of
using a shrinking mechanism when reaching the limit. To avoid out of memory
problems under heavy load situations. Note that this change infers that
implementations of ssl_session_cache_api needs to implement the size function
(introduce in OTP 19) for session reuse to be optimally utilized.</p><p>Own Id: OTP-16802 Aux Id: ERIERL-516</p></li></ul><h2 id="ssl-10-0" class="section-heading">
  <a href="#ssl-10-0" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 10.0</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-80" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-80" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Fix a bug that causes cross-build failure.</p><p>This change excludes the ssl.d dependency file from the source tar balls.</p><p>Own Id: OTP-16562 Aux Id: ERL-1168</p></li><li><p>Correct translation of OpenSSL legacy names for two legacy cipher suites</p><p>Own Id: OTP-16573 Aux Id: ERIERL-477</p></li><li><p>Correct documentation for PSK identity and SRP username.</p><p>Own Id: OTP-16585</p></li><li><p>Make sure client hostname check is run when client uses its own verify_fun</p><p>Own Id: OTP-16626 Aux Id: ERL-1232</p></li><li><p>Improved signature selection mechanism in TLS 1.3 for increased
interoperability.</p><p>Own Id: OTP-16638 Aux Id: ERL-1206</p></li></ul><h3 id="improvements-and-new-features-38" class="section-heading">
  <a href="#improvements-and-new-features-38" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Drop support for SSL-3.0. Support for this legacy TLS version has not been
enabled by default since OTP 19. Now all code to support it has been removed,
that is SSL-3.0 protocol version can not be used and is considered invalid.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-14790</p></li><li><p>Added support for RSA-PSS signature schemes</p><p>Own Id: OTP-15247</p></li><li><p>Improve interoperability by implementing the middlebox compatibility mode.</p><p>The middlebox compatibility mode makes the TLS 1.3 handshake look more like a
TLS 1.2 handshake and increases the chance of successfully establishing TLS
1.3 connections through legacy middleboxes.</p><p>Own Id: OTP-15589</p></li><li><p>Utilize new properties of
<a href="../../apps/erts/erlang.html#dist_ctrl_get_data/1"><code class="inline">erlang:dist_ctrl_get_data()</code></a> for performance
improvement of Erlang distribution over TLS.</p><p>Own Id: OTP-16127 Aux Id: OTP-15618</p></li><li><p>Calls of deprecated functions in the
<a href="../../apps/crypto/new_api.html#the-old-api">Old Crypto API</a> are replaced by calls of
their <a href="../../apps/crypto/new_api.html#the-new-api">substitutions</a>.</p><p>Own Id: OTP-16346</p></li><li><p>Implement cipher suite TLS_AES_128_CCM_8_SHA256.</p><p>Own Id: OTP-16391</p></li><li><p>This change adds TLS-1.3 to the list of default supported versions. That is,
TLS-1.3 and TLS-1.2 are configured when ssl option 'versions' is not
explicitly set.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-16400</p></li><li><p>Refactored the internal handling of deprecated and removed functions.</p><p>Own Id: OTP-16469</p></li><li><p>Extended ssl:versions so that it lists supported, available and implemented
TLS/DTLS versions.</p><p>Own Id: OTP-16519</p></li><li><p>Added new option exclusive for ssl:cipher_suites/2,3</p><p>Own Id: OTP-16532</p></li><li><p>Avoid DoS attack against stateful session_tickets by making session ticket ids
unpredictable.</p><p>Own Id: OTP-16533</p></li><li><p>Add support for the max_fragment_length extension (RFC 6066).</p><p>Own Id: OTP-16547 Aux Id: PR-2547</p></li><li><p>Add srp_username in ssl:connection_info, update the document with types of
this function.</p><p>Own Id: OTP-16584</p></li></ul><h2 id="ssl-9-6-2-3" class="section-heading">
  <a href="#ssl-9-6-2-3" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 9.6.2.3</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-81" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-81" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Correct flow ctrl checks from OTP-16764 to work as intended. Probably will not
have a noticeable affect but will make connections more well behaved under
some circumstances.</p><p>Own Id: OTP-16837 Aux Id: ERL-1319, OTP-16764</p></li><li><p>Fix a bug that causes cross-build failure.</p><p>This change excludes the ssl.d dependency file from the source tar balls.</p><p>Own Id: OTP-16921</p></li></ul><h2 id="ssl-9-6-2-2" class="section-heading">
  <a href="#ssl-9-6-2-2" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 9.6.2.2</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-82" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-82" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Data deliver with ssl:recv/2,3 could fail for when using packet mode. This has
been fixed by correcting the flow control handling of passive sockets when
packet mode is used.</p><p>Own Id: OTP-16764</p></li><li><p>Fix the internal handling of options 'verify' and 'verify_fun'.</p><p>This change fixes a vulnerability when setting the ssl option 'verify' to
verify_peer in a continued handshake won't take any effect resulting in the
acceptance of expired peer certificates.</p><p>Own Id: OTP-16767 Aux Id: ERIERL-512</p></li></ul><h2 id="ssl-9-6-2-1" class="section-heading">
  <a href="#ssl-9-6-2-1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 9.6.2.1</span>
</h2>
<h3 id="improvements-and-new-features-39" class="section-heading">
  <a href="#improvements-and-new-features-39" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>If a passive socket is created, ssl:recv/2,3 is never called and then the peer
closes the socket the controlling process will no longer receive an active
close message.</p><p>Own Id: OTP-16697 Aux Id: ERIERL-496</p></li></ul><h2 id="ssl-9-6-2" class="section-heading">
  <a href="#ssl-9-6-2" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 9.6.2</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-83" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-83" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Fix timing bug that could cause ssl sockets to become unresponsive after an
ssl:recv/3 call timed out</p><p>Own Id: OTP-16619 Aux Id: ERL-1213</p></li></ul><h2 id="ssl-9-6-1" class="section-heading">
  <a href="#ssl-9-6-1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 9.6.1</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-84" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-84" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Correct error handling when the partial_chain fun claims a certificate to be
the trusted cert that is not part of the chain. This bug would hide the
appropriate alert generating an &quot;INTERNAL_ERROR&quot; alert instead.</p><p>Own Id: OTP-16567 Aux Id: ERIERL-481</p></li></ul><h2 id="ssl-9-6" class="section-heading">
  <a href="#ssl-9-6" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 9.6</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-85" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-85" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Correct handling of TLS record limit in TLS-1.3. The max value differs from
previous versions. Also the payload data max record check was broken, that is
record overflow problems could occur if user sent large amounts of data.</p><p>Own Id: OTP-16258</p></li><li><p>Correct close handling for DTLS</p><p>Own Id: OTP-16348 Aux Id: ERL-1110</p></li><li><p>Fix ssl:getstat/1-2 to also work for DTLS sockets</p><p>Own Id: OTP-16352 Aux Id: ERL-1099</p></li><li><p>Correct internal handling och socket active mode to avoid reviving TCP data
aimed for a downgraded TLS socket.</p><p>Own Id: OTP-16425</p></li><li><p>When using the host name as fallback for SNI (server name indication) strip a
possible trailing dot that is allowed in a host name but not in the SNI. Also
if the server receives a SNI with a trailing dot send an UNRECOGNIZED_NAME
alert.</p><p>Own Id: OTP-16437 Aux Id: ERL-1135</p></li><li><p>Immediately remove session entries if handshake is abruptly closed at
transport level.</p><p>Own Id: OTP-16479</p></li></ul><h3 id="improvements-and-new-features-40" class="section-heading">
  <a href="#improvements-and-new-features-40" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Implementation of the key and initialization vector update feature, and
general hardening of TLS 1.3.</p><p>There are cryptographic limits on the amount of plaintext which can be safely
encrypted under a given set of keys.</p><p>This change enforces those limits by triggering automatic key updates on TLS
1.3 connections.</p><p>Own Id: OTP-15856</p></li><li><p>Add support for TLS 1.3 Session Tickets (stateful and stateless). This allows
session resumption using keying material from a previous successful handshake.</p><p>Own Id: OTP-16253</p></li><li><p>Add support for key exchange with Edward curves and PSS-RSA padding in
signature verification.</p><p>Own Id: OTP-16528</p></li></ul><h2 id="ssl-9-5-3" class="section-heading">
  <a href="#ssl-9-5-3" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 9.5.3</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-86" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-86" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Enhance error handling, all ALERTS shall be handled gracefully and not cause a
crash.</p><p>Own Id: OTP-16413 Aux Id: ERL-1136</p></li><li><p>Enhance alert logging, in some places the role indication of the alert origin
was missing. So the log would say undefined instead of client or server.</p><p>Own Id: OTP-16424</p></li><li><p>Two different optimizations did not work together and resulted in the possible
breakage of connections using stream ciphers (that is RC4). Reworked the
implementation to avoid this.</p><p>Own Id: OTP-16426 Aux Id: ERL-1136</p></li></ul><h2 id="ssl-9-5-2" class="section-heading">
  <a href="#ssl-9-5-2" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 9.5.2</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-87" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-87" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Fix the handling of GREASE values sent by web browsers when establishing TLS
1.3 connections. This change improves handling of GREASE values in various
protocol elements sent in a TLS 1.3 ClientHello.</p><p>Own Id: OTP-16388 Aux Id: ERL-1130</p></li><li><p>Correct DTLS listen emulation, could cause problems with opening a new DTLS
listen socket for a port previously used by a now closed DTLS listen socket.</p><p>Own Id: OTP-16396 Aux Id: ERL-1118</p></li></ul><h2 id="ssl-9-5-1" class="section-heading">
  <a href="#ssl-9-5-1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 9.5.1</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-88" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-88" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Add missing alert handling clause for TLS record handling. Could sometimes
cause confusing error behaviors of TLS connections.</p><p>Own Id: OTP-16357 Aux Id: ERL-1166</p></li><li><p>Fix handling of ssl:recv that happens during a renegotiation. Using the
passive receive function ssl:recv/[2,3] during a renegotiation would fail the
connection with unexpected msg.</p><p>Own Id: OTP-16361</p></li></ul><h2 id="ssl-9-5" class="section-heading">
  <a href="#ssl-9-5" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 9.5</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-89" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-89" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Corrected CRL handling which could cause CRL verification to fail. This could
happen when the CRL distribution point explicitly specifies the CRL issuer,
that is not using the fallback.</p><p>Own Id: OTP-16156 Aux Id: ERL-1030</p></li><li><p>Correct handling of unordered chains so that it works as expected</p><p>Own Id: OTP-16293</p></li><li><p>Fix bug causing ssl application to crash when handshake is paused and
ClientHello contains extensions for session resumption
(psk_key_exchange_modes, pre_shared_key).</p><p>Own Id: OTP-16295 Aux Id: ERL-1095</p></li><li><p>Fix connectivity problems with legacy servers when client is configured to
support a range of protocol versions including TLS 1.3.</p><p>Own Id: OTP-16303</p></li></ul><h3 id="improvements-and-new-features-41" class="section-heading">
  <a href="#improvements-and-new-features-41" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Improve session handling for TLS-1.3 compatibility mode and cleaner internal
handling so that removal of old session data can be more efficient, hopefully
mitigating problems with big session tables during heavy load.</p><p>Own Id: OTP-15524 Aux Id: OTP-15352</p></li><li><p>Correct handling of DTLS listen socket emulation. Could cause failure to
create new listen socket after process that owned previous listen socket died.</p><p>Own Id: OTP-15809 Aux Id: ERL-917</p></li><li><p>Add detailed info in ALERT description when client does not send a requested
cert.</p><p>Own Id: OTP-16266</p></li></ul><h2 id="ssl-9-4" class="section-heading">
  <a href="#ssl-9-4" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 9.4</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-90" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-90" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Handling of zero size fragments in TLS could cause an infinite loop. This has
now been corrected.</p><p>Own Id: OTP-15328 Aux Id: ERIERL-379</p></li><li><p>DTLS record check needs to consider that a resent hello message can have a
different version than the negotiated.</p><p>Own Id: OTP-15807 Aux Id: ERL-920</p></li></ul><h3 id="improvements-and-new-features-42" class="section-heading">
  <a href="#improvements-and-new-features-42" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Basic support for TLS 1.3 Client for experimental use. For more information
see the Standards Compliance chapter of the User's Guide.</p><p>Own Id: OTP-15431</p></li><li><p>Correct solution for retaining tcp flow control OTP-15802 (ERL-934) as to not
break ssl:recv as reported in (ERL-938)</p><p>Own Id: OTP-15823 Aux Id: ERL-934, ERL-938</p></li><li><p>Enhance dialyzer specs to reflect implementation better and avoid dialyzer
warnings for the user that wants to use TLS with unix domain sockets.</p><p>Own Id: OTP-15851 Aux Id: PR-2235</p></li><li><p>Add support for ECDSA signature algorithms in TLS 1.3.</p><p>Own Id: OTP-15854</p></li><li><p>Correct error handling of TLS downgrade, possible return values form
ssl:close/2 when downgrading is {ok, Port} or {error, Reason}, it could
happen that only ok was returned instead of {error, closed} when downgrade
failed due to that the peer closed the TCP connection.</p><p>Own Id: OTP-16027</p></li></ul><h2 id="ssl-9-3-5" class="section-heading">
  <a href="#ssl-9-3-5" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 9.3.5</span>
</h2>
<h3 id="improvements-and-new-features-43" class="section-heading">
  <a href="#improvements-and-new-features-43" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Enhance error handling for erroneous alerts from the peer.</p><p>Own Id: OTP-15943</p></li></ul><h2 id="ssl-9-3-4" class="section-heading">
  <a href="#ssl-9-3-4" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 9.3.4</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-91" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-91" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Fix handling of certificate decoding problems in TLS 1.3 similarly as in TLS
1.2.</p><p>Own Id: OTP-15900</p></li><li><p>Hibernation now works as expected in all cases, was accidentally broken by
optimization efforts.</p><p>Own Id: OTP-15910</p></li><li><p>Fix interoperability problems with openssl when the TLS 1.3 server is
configured with the option signature_algs_cert.</p><p>Own Id: OTP-15913</p></li></ul><h2 id="ssl-9-3-3" class="section-heading">
  <a href="#ssl-9-3-3" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 9.3.3</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-92" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-92" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Correct handshake handling, might cause strange symptoms such as ASN.1
certificate decoding issues.</p><p>Own Id: OTP-15879 Aux Id: ERL-968</p></li><li><p>Fix handling of the signature_algorithms_cert extension in the ClientHello
handshake message.</p><p>Own Id: OTP-15887 Aux Id: ERL-973</p></li><li><p>Handle new ClientHello extensions when handshake is paused by the {handshake,
hello} ssl option.</p><p>Own Id: OTP-15888 Aux Id: ERL-975</p></li></ul><h2 id="ssl-9-3-2" class="section-heading">
  <a href="#ssl-9-3-2" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 9.3.2</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-93" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-93" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Returned &quot;alert error string&quot; is now same as logged alert string</p><p>Own Id: OTP-15844</p></li><li><p>Fix returned extension map fields to follow the documentation.</p><p>Own Id: OTP-15862 Aux Id: ERL-951</p></li><li><p>Avoid DTLS crash due to missing gen_server return value in DTLS packet demux
process.</p><p>Own Id: OTP-15864 Aux Id: ERL-962</p></li></ul><h2 id="ssl-9-3-1" class="section-heading">
  <a href="#ssl-9-3-1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 9.3.1</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-94" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-94" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Missing check of size of user_data_buffer made internal socket behave as an
active socket instead of active N. This could cause memory problems.</p><p>Own Id: OTP-15825 Aux Id: ERL-934, OTP-15823</p></li></ul><h2 id="ssl-9-3" class="section-heading">
  <a href="#ssl-9-3" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 9.3</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-95" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-95" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>The distribution handshake with TLS distribution (<code class="inline">inet_tls_dist</code>) does now
utilize the socket option <code class="inline">{nodelay, true}</code>, which decreases the distribution
setup time significantly.</p><p>Own Id: OTP-14792</p></li><li><p>Correct shutdown reason to avoid an incorrect crash report</p><p>Own Id: OTP-15710 Aux Id: ERL-893</p></li><li><p>Enhance documentation and type specifications.</p><p>Own Id: OTP-15746 Aux Id: ERIERL-333</p></li></ul><h3 id="improvements-and-new-features-44" class="section-heading">
  <a href="#improvements-and-new-features-44" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>TLS-1.0, TLS-1.1 and DTLS-1.0 are now considered legacy and not supported by
default</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-14865</p></li><li><p>Use new logger API in ssl. Introduce log levels and verbose debug logging for
SSL.</p><p>Own Id: OTP-15055</p></li><li><p>Add new API function str_to_suite/1, cipher_suites/3 (list cipher suites as
rfc or OpenSSL name strings) and suite_to_openssl_str/1</p><p>Own Id: OTP-15483 Aux Id: ERL-924</p></li><li><p>Basic support for TLS 1.3 Server for experimental use. The client is not yet
functional, for more information see the Standards Compliance chapter of the
User's Guide.</p><p>Own Id: OTP-15591</p></li><li><p>Add support for PSK CCM ciphers from RFC 6655</p><p>Own Id: OTP-15626</p></li></ul><h2 id="ssl-9-2-3-7" class="section-heading">
  <a href="#ssl-9-2-3-7" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 9.2.3.7</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-96" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-96" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Data deliver with ssl:recv/2,3 could fail for when using packet mode. This has
been fixed by correcting the flow control handling of passive sockets when
packet mode is used.</p><p>Own Id: OTP-16764</p></li></ul><h2 id="ssl-9-2-3-6" class="section-heading">
  <a href="#ssl-9-2-3-6" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 9.2.3.6</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-97" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-97" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Fix timing bug that could cause ssl sockets to become unresponsive after an
ssl:recv/3 call timed out</p><p>Own Id: OTP-16619 Aux Id: ERL-1213</p></li></ul><h2 id="ssl-9-2-3-5" class="section-heading">
  <a href="#ssl-9-2-3-5" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 9.2.3.5</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-98" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-98" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Handling of zero size fragments in TLS could cause an infinite loop. This has
now been corrected.</p><p>Own Id: OTP-15328 Aux Id: ERIERL-379</p></li></ul><h2 id="ssl-9-2-3-4" class="section-heading">
  <a href="#ssl-9-2-3-4" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 9.2.3.4</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-99" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-99" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Hibernation now works as expected in all cases, was accidentally broken by
optimization efforts.</p><p>Own Id: OTP-15910</p></li></ul><h2 id="ssl-9-2-3-3" class="section-heading">
  <a href="#ssl-9-2-3-3" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 9.2.3.3</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-100" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-100" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Correct handshake handling, might cause strange symptoms such as ASN.1
certificate decoding issues.</p><p>Own Id: OTP-15879 Aux Id: ERL-968</p></li></ul><h2 id="ssl-9-2-3-2" class="section-heading">
  <a href="#ssl-9-2-3-2" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 9.2.3.2</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-101" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-101" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Returned &quot;alert error string&quot; is now same as logged alert string</p><p>Own Id: OTP-15844</p></li></ul><h2 id="ssl-9-2-3-1" class="section-heading">
  <a href="#ssl-9-2-3-1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 9.2.3.1</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-102" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-102" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Correct solution for retaining tcp flow control OTP-15802 (ERL-934) as to not
break ssl:recv as reported in (ERL-938)</p><p>Own Id: OTP-15823 Aux Id: ERL-934, ERL-938</p></li></ul><h2 id="ssl-9-2-3" class="section-heading">
  <a href="#ssl-9-2-3" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 9.2.3</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-103" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-103" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Missing check of size of user_data_buffer made internal socket behave as an
active socket instead of active N. This could cause memory problems.</p><p>Own Id: OTP-15802 Aux Id: ERL-934</p></li></ul><h3 id="improvements-and-new-features-45" class="section-heading">
  <a href="#improvements-and-new-features-45" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Back port of bug fix ERL-893 from OTP-22 and document enhancements that will
solve dialyzer warnings for users of the ssl application.</p><p>This change also affects public_key, eldap (and inet doc).</p><p>Own Id: OTP-15785 Aux Id: ERL-929, ERL-893, PR-2215</p></li></ul><h2 id="ssl-9-2-2" class="section-heading">
  <a href="#ssl-9-2-2" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 9.2.2</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-104" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-104" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>With the default BEAST Mitigation strategy for TLS 1.0 an empty TLS fragment
could be sent after a one-byte fragment. This glitch has been fixed.</p><p>Own Id: OTP-15054 Aux Id: ERIERL-346</p></li></ul><h2 id="ssl-9-2-1" class="section-heading">
  <a href="#ssl-9-2-1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 9.2.1</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-105" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-105" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>The timeout for a passive receive was sometimes not cancelled and later caused
a server crash. This bug has now been corrected.</p><p>Own Id: OTP-14701 Aux Id: ERL-883, ERL-884</p></li><li><p>Add tag for passive message (active N) in cb_info to retain transport
transparency.</p><p>Own Id: OTP-15679 Aux Id: ERL-861</p></li></ul><h2 id="ssl-9-2" class="section-heading">
  <a href="#ssl-9-2" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 9.2</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-106" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-106" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Fix bug that an incorrect return value for gen_statem could be created when
alert was a result of handling renegotiation info extension</p><p>Own Id: OTP-15502</p></li><li><p>Correct check for 3des_ede_cbc, could cause ssl to claim to support
3des_ede_cbc when cryptolib does not.</p><p>Own Id: OTP-15539</p></li><li><p>Improved DTLS error handling, avoids unexpected connection failure in rare
cases.</p><p>Own Id: OTP-15561</p></li><li><p>Corrected active once emulation bug that could cause the ssl_closed meassage
to not be sent. Bug introduced by OTP-15449</p><p>Own Id: OTP-15666 Aux Id: ERIERL-316,</p></li></ul><h3 id="improvements-and-new-features-46" class="section-heading">
  <a href="#improvements-and-new-features-46" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Add client option {reuse_session, SessionID::binary()} that can be used
together with new option value {reuse_sessions, save}. This makes it
possible to reuse a session from a specific connection establishment.</p><p>Own Id: OTP-15369</p></li><li><p>The Reason part of of the error return from the functions connect and
handshake has a better and documented format. This will sometimes differ from
previous returned reasons, however those where only documented as term() and
should for that reason not be relied on.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-15423</p></li><li><p>Refactor of state handling to improve TLS application data throughput and
reduce CPU overhead</p><p>Own Id: OTP-15445</p></li><li><p>The SSL code has been optimized in many small ways to reduce CPU load for
encryption/decryption, especially for Erlang's distribution protocol over TLS.</p><p>Own Id: OTP-15529</p></li><li><p>Add support for active N</p><p>Own Id: OTP-15665 Aux Id: ERL-811, PR-2072</p></li></ul><h2 id="ssl-9-1-2" class="section-heading">
  <a href="#ssl-9-1-2" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 9.1.2</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-107" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-107" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Fix encoding of the SRP extension length field in ssl. The old encoding of the
SRP extension length could cause interoperability problems with third party
SSL implementations when SRP was used.</p><p>Own Id: OTP-15477 Aux Id: ERL-790</p></li><li><p>Guarantee active once data delivery, handling TCP stream properly.</p><p>Own Id: OTP-15504 Aux Id: ERL-371</p></li><li><p>Correct gen_statem returns for some error cases</p><p>Own Id: OTP-15505</p></li></ul><h2 id="ssl-9-1-1" class="section-heading">
  <a href="#ssl-9-1-1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 9.1.1</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-108" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-108" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Fixed renegotiation bug. Client did not handle server initiated renegotiation
correctly after rewrite to two connection processes, due to ERL-622 commit
d87ac1c55188f5ba5cdf72384125d94d42118c18. This could manifest it self as a &quot;
bad_record_mac&quot; alert.</p><p>Also included are some optimizations</p><p>Own Id: OTP-15489 Aux Id: ERL-308</p></li></ul><h2 id="ssl-9-1" class="section-heading">
  <a href="#ssl-9-1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 9.1</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-109" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-109" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>PEM cache was not evicting expired entries due to due to timezone confusion.</p><p>Own Id: OTP-15368</p></li><li><p>Make sure an error is returned if a &quot;transport_accept socket&quot; is used in some
other call than ssl:handshake* or ssl:controlling_process</p><p>Own Id: OTP-15384 Aux Id: ERL-756</p></li><li><p>Fix timestamp handling in the PEM-cache could cause entries to not be
invalidated at the correct time.</p><p>Own Id: OTP-15402</p></li><li><p>Extend check for undelivered data at closing, could under some circumstances
fail to deliver all data that was actually received.</p><p>Own Id: OTP-15412 Aux Id: ERL-731</p></li><li><p>Correct signature check for TLS-1.2 that allows different algorithms for
signature of peer cert and peer cert key. Not all allowed combinations where
accepted.</p><p>Own Id: OTP-15415 Aux Id: ERL-763</p></li><li><p>Correct gen_statem return value, could cause renegotiation to fail.</p><p>Own Id: OTP-15418 Aux Id: ERL-770</p></li></ul><h3 id="improvements-and-new-features-47" class="section-heading">
  <a href="#improvements-and-new-features-47" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Add engine support for RSA key exchange</p><p>Own Id: OTP-15420 Aux Id: ERIERL-268</p></li><li><p>ssl now uses active n internally to boost performance. Old active once
behavior can be restored by setting application variable see manual page for
ssl application (man 6).</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-15449</p></li></ul><h2 id="ssl-9-0-3" class="section-heading">
  <a href="#ssl-9-0-3" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 9.0.3</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-110" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-110" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Correct alert handling with new TLS sender process, from ssl-9.0.2. CLOSE
ALERTS could under some circumstances be encoded using an incorrect cipher
state. This would cause the peer to regard them as unknown messages.</p><p>Own Id: OTP-15337 Aux Id: ERL-738</p></li><li><p>Correct handling of socket packet option with new TLS sender process, from
ssl-9.0.2. When changing the socket option {packet, 1|2|3|4} with
ssl:setopts/2 the option must internally be propagated to the sender process
as well as the reader process as this particular option also affects the data
to be sent.</p><p>Own Id: OTP-15348 Aux Id: ERL-747</p></li></ul><h2 id="ssl-9-0-2" class="section-heading">
  <a href="#ssl-9-0-2" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 9.0.2</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-111" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-111" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Use separate processes for sending and receiving application data for TLS
connections to avoid potential deadlock that was most likely to occur when
using TLS for Erlang distribution. Note does not change the API.</p><p>Own Id: OTP-15122</p></li><li><p>Correct handling of empty server SNI extension</p><p>Own Id: OTP-15168</p></li><li><p>Correct PSK cipher suite handling and add selected_cipher_suite to connection
information</p><p>Own Id: OTP-15172</p></li><li><p>Adopt to the fact that cipher suite sign restriction are relaxed in TLS-1.2</p><p>Own Id: OTP-15173</p></li><li><p>Enhance error handling of non existing PEM files</p><p>Own Id: OTP-15174</p></li><li><p>Correct close handling of transport accepted sockets in the error state</p><p>Own Id: OTP-15216</p></li><li><p>Correct PEM cache to not add references to empty entries when PEM file does
not exist.</p><p>Own Id: OTP-15224</p></li><li><p>Correct handling of all PSK cipher suites</p><p>Before only some PSK suites would be correctly negotiated and most PSK ciphers
suites would fail the connection.</p><p>Own Id: OTP-15285</p></li></ul><h3 id="improvements-and-new-features-48" class="section-heading">
  <a href="#improvements-and-new-features-48" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>TLS will now try to order certificate chains if they appear to be unordered.
That is prior to TLS 1.3, “certificate_list” ordering was required to be
strict, however some implementations already allowed for some flexibility. For
maximum compatibility, all implementations SHOULD be prepared to handle
potentially extraneous certificates and arbitrary orderings from any TLS
version.</p><p>Own Id: OTP-12983</p></li><li><p>TLS will now try to reconstructed an incomplete certificate chains from its
local CA-database and use that data for the certificate path validation. This
especially makes sense for partial chains as then the peer might not send an
intermediate CA as it is considered the trusted root in that case.</p><p>Own Id: OTP-15060</p></li><li><p>Option keyfile defaults to certfile and should be trumped with key. This
failed for engine keys.</p><p>Own Id: OTP-15193</p></li><li><p>Error message improvement when own certificate has decoding issues, see also
issue ERL-668.</p><p>Own Id: OTP-15234</p></li><li><p>Correct dialyzer spec for key option</p><p>Own Id: OTP-15281</p></li></ul><h2 id="ssl-9-0-1" class="section-heading">
  <a href="#ssl-9-0-1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 9.0.1</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-112" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-112" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Correct cipher suite handling for ECDHE_*, the incorrect handling could
cause an incorrrect suite to be selected and most likely fail the handshake.</p><p>Own Id: OTP-15203</p></li></ul><h2 id="ssl-9-0" class="section-heading">
  <a href="#ssl-9-0" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 9.0</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-113" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-113" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Correct handling of ECDH suites.</p><p>Own Id: OTP-14974</p></li><li><p>Proper handling of clients that choose to send an empty answer to a
certificate request</p><p>Own Id: OTP-15050</p></li></ul><h3 id="improvements-and-new-features-49" class="section-heading">
  <a href="#improvements-and-new-features-49" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Distribution over SSL (inet_tls) has, to improve performance, been rewritten
to not use intermediate processes and ports.</p><p>Own Id: OTP-14465</p></li><li><p>Add support for ECDHE_PSK cipher suites</p><p>Own Id: OTP-14547</p></li><li><p>For security reasons no longer support 3-DES cipher suites by default</p><p>*<strong> INCOMPATIBILITY with possibly *</strong></p><p>Own Id: OTP-14768</p></li><li><p>For security reasons RSA-key exchange cipher suites are no longer supported by
default</p><p>*<strong> INCOMPATIBILITY with possible *</strong></p><p>Own Id: OTP-14769</p></li><li><p>The interoperability option to fallback to insecure renegotiation now has to
be explicitly turned on.</p><p>*<strong> INCOMPATIBILITY with possibly *</strong></p><p>Own Id: OTP-14789</p></li><li><p>Drop support for SSLv2 enabled clients. SSLv2 has been broken for decades and
never supported by the Erlang SSL/TLS implementation. This option was by
default disabled and enabling it has proved to sometimes break connections not
using SSLv2 enabled clients.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-14824</p></li><li><p>Remove CHACHA20_POLY1305 ciphers form default for now. We have discovered
interoperability problems, ERL-538, that we believe needs to be solved in
crypto.</p><p>*<strong> INCOMPATIBILITY with possibly *</strong></p><p>Own Id: OTP-14882</p></li><li><p>Generalize DTLS packet multiplexing to make it easier to add future DTLS
features and uses.</p><p>Own Id: OTP-14888</p></li><li><p>Use uri_string module instead of http_uri.</p><p>Own Id: OTP-14902</p></li><li><p>The SSL distribution protocol <code class="inline">-proto inet_tls</code> has stopped setting the SSL
option <code class="inline">server_name_indication</code>. New verify funs for client and server in
<code class="inline">inet_tls_dist</code> has been added, not documented yet, that checks node name if
present in peer certificate. Usage is still also yet to be documented.</p><p>Own Id: OTP-14969 Aux Id: OTP-14465, ERL-598</p></li><li><p>Deprecate ssl:ssl_accept/[1,2,3] in favour of ssl:handshake/[1,2,3]</p><p>Own Id: OTP-15056</p></li><li><p>Customizes the hostname verification of the peer certificate, as different
protocols that use TLS such as HTTP or LDAP may want to do it differently</p><p>Own Id: OTP-15102 Aux Id: ERL-542, OTP-14962</p></li><li><p>Add utility function for converting erlang cipher suites to a string
representation (ERL-600).</p><p>Own Id: OTP-15106</p></li><li><p>First version with support for DTLS</p><p>Own Id: OTP-15142</p></li></ul><h2 id="ssl-8-2-6-4" class="section-heading">
  <a href="#ssl-8-2-6-4" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 8.2.6.4</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-114" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-114" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Add engine support for RSA key exchange</p><p>Own Id: OTP-15420</p></li></ul><h2 id="ssl-8-2-6-3" class="section-heading">
  <a href="#ssl-8-2-6-3" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 8.2.6.3</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-115" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-115" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Extend check for undelivered data at closing, could under some circumstances
fail to deliverd all data that was acctualy recivied.</p><p>Own Id: OTP-15412</p></li></ul><h2 id="ssl-8-2-6-2" class="section-heading">
  <a href="#ssl-8-2-6-2" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 8.2.6.2</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-116" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-116" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Correct handling of empty server SNI extension</p><p>Own Id: OTP-15168</p></li><li><p>Correct cipher suite handling for ECDHE_*, the incorrect handling could
cause an incorrrect suite to be selected and most likely fail the handshake.</p><p>Own Id: OTP-15203</p></li></ul><h2 id="ssl-8-2-6-1" class="section-heading">
  <a href="#ssl-8-2-6-1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 8.2.6.1</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-117" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-117" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Improve cipher suite handling correcting ECC and TLS-1.2 requierments.
Backport of solution for ERL-641</p><p>Own Id: OTP-15178</p></li></ul><h3 id="improvements-and-new-features-50" class="section-heading">
  <a href="#improvements-and-new-features-50" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Option keyfile defaults to certfile and should be trumped with key. This
failed for engine keys.</p><p>Own Id: OTP-15193</p></li></ul><h2 id="ssl-8-2-6" class="section-heading">
  <a href="#ssl-8-2-6" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 8.2.6</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-118" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-118" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Proper handling of clients that choose to send an empty answer to a
certificate request</p><p>Own Id: OTP-15050</p></li></ul><h2 id="ssl-8-2-5" class="section-heading">
  <a href="#ssl-8-2-5" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 8.2.5</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-119" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-119" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Fix filter function to not incorrectly exclude AEAD cipher suites</p><p>Own Id: OTP-14981</p></li></ul><h2 id="ssl-8-2-4" class="section-heading">
  <a href="#ssl-8-2-4" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 8.2.4</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-120" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-120" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Optimization of bad merge conflict resolution causing dubble decode</p><p>Own Id: OTP-14843</p></li><li><p>Restore error propagation to OTP-19.3 behaviour, in OTP-20.2 implementation
adjustments to gen_statem needed some further adjustments to avoid a race
condition. This could cause a TLS server to not always report file path errors
correctly.</p><p>Own Id: OTP-14852</p></li><li><p>Corrected RC4 suites listing function to regard TLS version</p><p>Own Id: OTP-14871</p></li><li><p>Fix alert handling so that unexpected messages are logged and alerted
correctly</p><p>Own Id: OTP-14919</p></li><li><p>Correct handling of anonymous cipher suites</p><p>Own Id: OTP-14952</p></li></ul><h3 id="improvements-and-new-features-51" class="section-heading">
  <a href="#improvements-and-new-features-51" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Added new API functions to facilitate cipher suite handling</p><p>Own Id: OTP-14760</p></li><li><p>Correct TLS_FALLBACK_SCSV handling so that this special flag suite is always
placed last in the cipher suite list in accordance with the specs. Also make
sure this functionality is used in DTLS.</p><p>Own Id: OTP-14828</p></li><li><p>Add TLS record version sanity check for early as possible error detection and
consistency in ALERT codes generated</p><p>Own Id: OTP-14892</p></li></ul><h2 id="ssl-8-2-3" class="section-heading">
  <a href="#ssl-8-2-3" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 8.2.3</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-121" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-121" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Packet options cannot be supported for unreliable transports, that is, packet
option for DTLS over udp will not be supported.</p><p>Own Id: OTP-14664</p></li><li><p>Ensure data delivery before close if possible. This fix is related to fix in
PR-1479.</p><p>Own Id: OTP-14794</p></li></ul><h3 id="improvements-and-new-features-52" class="section-heading">
  <a href="#improvements-and-new-features-52" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>The crypto API is extended to use private/public keys stored in an Engine for
sign/verify or encrypt/decrypt operations.</p><p>The ssl application provides an API to use this new engine concept in TLS.</p><p>Own Id: OTP-14448</p></li><li><p>Implemented renegotiation for DTLS</p><p>Own Id: OTP-14563</p></li><li><p>A new command line option <code class="inline">-ssl_dist_optfile</code> has been added to facilitate
specifying the many options needed when using SSL as the distribution
protocol.</p><p>Own Id: OTP-14657</p></li></ul><h2 id="ssl-8-2-2" class="section-heading">
  <a href="#ssl-8-2-2" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 8.2.2</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-122" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-122" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>TLS sessions must be registered with SNI if provided, so that sessions where
client hostname verification would fail cannot connect reusing a session
created when the server name verification succeeded.</p><p>Own Id: OTP-14632</p></li><li><p>An erlang TLS server configured with cipher suites using rsa key exchange, may
be vulnerable to an Adaptive Chosen Ciphertext attack (AKA Bleichenbacher
attack) against RSA, which when exploited, may result in plaintext recovery of
encrypted messages and/or a Man-in-the-middle (MiTM) attack, despite the
attacker not having gained access to the server’s private key itself.
<a href="https://nvd.nist.gov/vuln/detail/CVE-2017-1000385">CVE-2017-1000385</a></p><p>Exploiting this vulnerability to perform plaintext recovery of encrypted
messages will, in most practical cases, allow an attacker to read the
plaintext only after the session has completed. Only TLS sessions established
using RSA key exchange are vulnerable to this attack.</p><p>Exploiting this vulnerability to conduct a MiTM attack requires the attacker
to complete the initial attack, which may require thousands of server
requests, during the handshake phase of the targeted session within the window
of the configured handshake timeout. This attack may be conducted against any
TLS session using RSA signatures, but only if cipher suites using RSA key
exchange are also enabled on the server. The limited window of opportunity,
limitations in bandwidth, and latency make this attack significantly more
difficult to execute.</p><p>RSA key exchange is enabled by default although least prioritized if server
order is honored. For such a cipher suite to be chosen it must also be
supported by the client and probably the only shared cipher suite.</p><p>Captured TLS sessions encrypted with ephemeral cipher suites (DHE or ECDHE)
are not at risk for subsequent decryption due to this vulnerability.</p><p>As a workaround if default cipher suite configuration was used you can
configure the server to not use vulnerable suites with the ciphers option like
this:</p><p><code class="inline">{ciphers, [Suite || Suite &lt;- ssl:cipher_suites(), element(1,Suite) =/= rsa]}</code></p><p>that is your code will look somethingh like this:</p><p><code class="inline">ssl:listen(Port, [{ciphers, [Suite || Suite &lt;- ssl:cipher_suites(), element(1,S) =/= rsa]} | Options]).</code></p><p>Thanks to Hanno Böck, Juraj Somorovsky and Craig Young for reporting this
vulnerability.</p><p>Own Id: OTP-14748</p></li></ul><h3 id="improvements-and-new-features-53" class="section-heading">
  <a href="#improvements-and-new-features-53" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>If no SNI is available and the hostname is an IP-address also check for
IP-address match. This check is not as good as a DNS hostname check and
certificates using IP-address are not recommended.</p><p>Own Id: OTP-14655</p></li></ul><h2 id="ssl-8-2-1" class="section-heading">
  <a href="#ssl-8-2-1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 8.2.1</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-123" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-123" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Max session table works correctly again</p><p>Own Id: OTP-14556</p></li></ul><h3 id="improvements-and-new-features-54" class="section-heading">
  <a href="#improvements-and-new-features-54" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Customize alert handling for DTLS over UDP to mitigate DoS attacks</p><p>Own Id: OTP-14078</p></li><li><p>Improved error propagation and reports</p><p>Own Id: OTP-14236</p></li></ul><h2 id="ssl-8-2" class="section-heading">
  <a href="#ssl-8-2" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 8.2</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-124" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-124" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>ECDH-ECDSA key exchange supported, was accidentally dismissed in earlier
versions.</p><p>Own Id: OTP-14421</p></li><li><p>Correct close semantics for active once connections. This was a timing
dependent bug the resulted in the close message not always reaching the ssl
user process.</p><p>Own Id: OTP-14443</p></li></ul><h3 id="improvements-and-new-features-55" class="section-heading">
  <a href="#improvements-and-new-features-55" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>TLS-1.2 clients will now always send hello messages on its own format, as
opposed to earlier versions that will send the hello on the lowest supported
version, this is a change supported by the latest RFC.</p><p>This will make interoperability with some newer servers smoother. Potentially,
but unlikely, this could cause a problem with older servers if they do not
adhere to the RFC and ignore unknown extensions.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-13820</p></li><li><p>Allow Erlang/OTP to use OpenSSL in FIPS-140 mode, in order to satisfy specific
security requirements (mostly by different parts of the US federal
government).</p><p>See the new crypto users guide &quot;FIPS mode&quot; chapter about building and using
the FIPS support which is disabled by default.</p><p>(Thanks to dszoboszlay and legoscia)</p><p>Own Id: OTP-13921 Aux Id: PR-1180</p></li><li><p>Implemented DTLS cookie generation, required by spec, instead of using a
hardcoded value.</p><p>Own Id: OTP-14076</p></li><li><p>Implement sliding window replay protection of DTLS records.</p><p>Own Id: OTP-14077</p></li><li><p>TLS client processes will by default call public_key:pkix_verify_hostname/2 to
verify the hostname of the connection with the server certificates specified
hostname during certificate path validation. The user may explicitly disables
it. Also if the hostname cannot be derived from the first argument to connect
or is not supplied by the server name indication option, the check will not be
performed.</p><p>Own Id: OTP-14197</p></li><li><p>Extend connection_information/[1,2] . The values session_id, master_secret,
client_random and server_random can no be accessed by
connection_information/2. Note only session_id will be added to
connection_information/1. The rational is that values concerning the
connection security should have to be explicitly requested.</p><p>Own Id: OTP-14291</p></li><li><p>Chacha cipher suites are currently not tested enough to be most preferred ones</p><p>Own Id: OTP-14382</p></li><li><p>Basic support for DTLS that been tested together with OpenSSL.</p><p>Test by providing the option {protocol, dtls} to the ssl API functions
connect and listen.</p><p>Own Id: OTP-14388</p></li></ul><h2 id="ssl-8-1-3-1-1" class="section-heading">
  <a href="#ssl-8-1-3-1-1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 8.1.3.1.1</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-125" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-125" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Fix alert handling so that unexpected messages are logged and alerted
correctly</p><p>Own Id: OTP-14929</p></li></ul><h2 id="ssl-8-1-3-1" class="section-heading">
  <a href="#ssl-8-1-3-1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 8.1.3.1</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-126" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-126" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>An erlang TLS server configured with cipher suites using rsa key exchange, may
be vulnerable to an Adaptive Chosen Ciphertext attack (AKA Bleichenbacher
attack) against RSA, which when exploited, may result in plaintext recovery of
encrypted messages and/or a Man-in-the-middle (MiTM) attack, despite the
attacker not having gained access to the server’s private key itself.
<a href="https://nvd.nist.gov/vuln/detail/CVE-2017-1000385">CVE-2017-1000385</a></p><p>Exploiting this vulnerability to perform plaintext recovery of encrypted
messages will, in most practical cases, allow an attacker to read the
plaintext only after the session has completed. Only TLS sessions established
using RSA key exchange are vulnerable to this attack.</p><p>Exploiting this vulnerability to conduct a MiTM attack requires the attacker
to complete the initial attack, which may require thousands of server
requests, during the handshake phase of the targeted session within the window
of the configured handshake timeout. This attack may be conducted against any
TLS session using RSA signatures, but only if cipher suites using RSA key
exchange are also enabled on the server. The limited window of opportunity,
limitations in bandwidth, and latency make this attack significantly more
difficult to execute.</p><p>RSA key exchange is enabled by default although least prioritized if server
order is honored. For such a cipher suite to be chosen it must also be
supported by the client and probably the only shared cipher suite.</p><p>Captured TLS sessions encrypted with ephemeral cipher suites (DHE or ECDHE)
are not at risk for subsequent decryption due to this vulnerability.</p><p>As a workaround if default cipher suite configuration was used you can
configure the server to not use vulnerable suites with the ciphers option like
this:</p><p><code class="inline">{ciphers, [Suite || Suite &lt;- ssl:cipher_suites(), element(1,Suite) =/= rsa]}</code></p><p>that is your code will look somethingh like this:</p><p><code class="inline">ssl:listen(Port, [{ciphers, [Suite || Suite &lt;- ssl:cipher_suites(), element(1,S) =/= rsa]} | Options]).</code></p><p>Thanks to Hanno Böck, Juraj Somorovsky and Craig Young for reporting this
vulnerability.</p><p>Own Id: OTP-14748</p></li></ul><h2 id="ssl-8-1-3" class="section-heading">
  <a href="#ssl-8-1-3" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 8.1.3</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-127" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-127" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Remove debug printout</p><p>Own Id: OTP-14396</p></li></ul><h2 id="ssl-8-1-2" class="section-heading">
  <a href="#ssl-8-1-2" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 8.1.2</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-128" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-128" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Correct active once emulation, for TLS. Now all data received by the
connection process will be delivered through active once, even when the active
once arrives after that the gen_tcp socket is closed by the peer.</p><p>Own Id: OTP-14300</p></li></ul><h2 id="ssl-8-1-1" class="section-heading">
  <a href="#ssl-8-1-1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 8.1.1</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-129" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-129" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Corrected termination behavior, that caused a PEM cache bug and sometimes
resulted in connection failures.</p><p>Own Id: OTP-14100</p></li><li><p>Fix bug that could hang ssl connection processes when failing to require more
data for very large handshake packages. Add option max_handshake_size to
mitigate DoS attacks.</p><p>Own Id: OTP-14138</p></li><li><p>Improved support for CRL handling that could fail to work as intended when an
id-ce-extKeyUsage was present in the certificate. Also improvements where
needed to distributionpoint handling so that all revocations actually are
found and not deemed to be not determinable.</p><p>Own Id: OTP-14141</p></li><li><p>A TLS handshake might accidentally match old sslv2 format and ssl application
would incorrectly aborted TLS handshake with ssl_v2_client_hello_no_supported.
Parsing was altered to avoid this problem.</p><p>Own Id: OTP-14222</p></li><li><p>Correct default cipher list to prefer AES 128 before 3DES</p><p>Own Id: OTP-14235</p></li></ul><h3 id="improvements-and-new-features-56" class="section-heading">
  <a href="#improvements-and-new-features-56" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Move PEM cache to a dedicated process, to avoid making the SSL manager process
a bottleneck. This improves scalability of TLS connections.</p><p>Own Id: OTP-13874</p></li></ul><h2 id="ssl-8-1" class="section-heading">
  <a href="#ssl-8-1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 8.1</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-130" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-130" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>List of possible anonymous suites, never supported by default, where incorrect
for some TLS versions.</p><p>Own Id: OTP-13926</p></li></ul><h3 id="improvements-and-new-features-57" class="section-heading">
  <a href="#improvements-and-new-features-57" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Experimental version of DTLS. It is runnable but not complete and cannot be
considered reliable for production usage.</p><p>Own Id: OTP-12982</p></li><li><p>Add API options to handle ECC curve selection.</p><p>Own Id: OTP-13959</p></li></ul><h2 id="ssl-8-0-3" class="section-heading">
  <a href="#ssl-8-0-3" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 8.0.3</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-131" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-131" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>A timing related bug in event handling could cause interoperability problems
between an erlang TLS server and some TLS clients, especially noticed with
Firefox as TLS client.</p><p>Own Id: OTP-13917</p></li><li><p>Correct ECC curve selection, the error could cause the default to always be
selected.</p><p>Own Id: OTP-13918</p></li></ul><h2 id="ssl-8-0-2" class="section-heading">
  <a href="#ssl-8-0-2" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 8.0.2</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-132" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-132" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Correctly formed handshake messages received out of order will now correctly
fail the connection with unexpected message.</p><p>Own Id: OTP-13853</p></li><li><p>Correct handling of signature algorithm selection</p><p>Own Id: OTP-13711</p></li></ul><h3 id="improvements-and-new-features-58" class="section-heading">
  <a href="#improvements-and-new-features-58" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>ssl application now behaves gracefully also on partially incorrect input from
peer.</p><p>Own Id: OTP-13834</p></li><li><p>Add application environment configuration bypass_pem_cache. This can be used
as a workaround for the current implementation of the PEM-cache that has
proven to be a bottleneck.</p><p>Own Id: OTP-13883</p></li></ul><h2 id="ssl-8-0-1" class="section-heading">
  <a href="#ssl-8-0-1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 8.0.1</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-133" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-133" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>The TLS/SSL protocol version selection for the SSL server has been corrected
to follow RFC 5246 Appendix E.1 especially in case where the list of supported
versions has gaps. Now the server selects the highest protocol version it
supports that is not higher than what the client supports.</p><p>Own Id: OTP-13753 Aux Id: seq13150</p></li></ul><h2 id="ssl-8-0" class="section-heading">
  <a href="#ssl-8-0" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 8.0</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-134" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-134" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Server now rejects, a not requested client cert, as an incorrect handshake
message and ends the connection.</p><p>Own Id: OTP-13651</p></li></ul><h3 id="improvements-and-new-features-59" class="section-heading">
  <a href="#improvements-and-new-features-59" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Remove default support for DES cipher suites</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-13195</p></li><li><p>Deprecate the function <code class="inline">crypto:rand_bytes</code> and make sure that
<code class="inline">crypto:strong_rand_bytes</code> is used in all places that are cryptographically
significant.</p><p>Own Id: OTP-13214</p></li><li><p>Better error handling of user error during TLS upgrade. ERL-69 is solved by
gen_statem rewrite of ssl application.</p><p>Own Id: OTP-13255</p></li><li><p>Provide user friendly error message when crypto rejects a key</p><p>Own Id: OTP-13256</p></li><li><p>Add ssl:getstat/1 and ssl:getstat/2</p><p>Own Id: OTP-13415</p></li><li><p>TLS distribution connections now allow specifying the options <code class="inline">verify_fun</code>,
<code class="inline">crl_check</code> and <code class="inline">crl_cache</code>. See the documentation. GitHub pull req #956
contributed by Magnus Henoch.</p><p>Own Id: OTP-13429 Aux Id: Pull#956</p></li><li><p>Remove confusing error message when closing a distributed erlang node running
over TLS</p><p>Own Id: OTP-13431</p></li><li><p>Remove default support for use of md5 in TLS 1.2 signature algorithms</p><p>Own Id: OTP-13463</p></li><li><p>ssl now uses gen_statem instead of gen_fsm to implement the ssl connection
process, this solves some timing issues in addition to making the code more
intuitive as the behaviour can be used cleanly instead of having a lot of
workaround for shortcomings of the behaviour.</p><p>Own Id: OTP-13464</p></li><li><p>Phase out interoperability with clients that offer SSLv2. By default they are
no longer supported, but an option to provide interoperability is offered.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-13465</p></li><li><p>OpenSSL has functions to generate short (eight hex digits) hashes of issuers
of certificates and CRLs. These hashes are used by the &quot;c_rehash&quot; script to
populate directories of CA certificates and CRLs, e.g. in the Apache web
server. Add functionality to let an Erlang program find the right CRL for a
given certificate in such a directory.</p><p>Own Id: OTP-13530</p></li><li><p>Some legacy TLS 1.0 software does not tolerate the 1/n-1 content split BEAST
mitigation technique. Add a beast_mitigation SSL option (defaulting to
one_n_minus_one) to select or disable the BEAST mitigation technique.</p><p>Own Id: OTP-13629</p></li><li><p>Enhance error log messages to facilitate for users to understand the error</p><p>Own Id: OTP-13632</p></li><li><p>Increased default DH params to 2048-bit</p><p>Own Id: OTP-13636</p></li><li><p>Propagate CRL unknown CA error so that public_key validation process continues
correctly and determines what should happen.</p><p>Own Id: OTP-13656</p></li><li><p>Introduce a flight concept for handshake packages. This is a preparation for
enabling DTLS, however it can also have a positive effects for TLS on slow and
unreliable networks.</p><p>Own Id: OTP-13678</p></li></ul><h2 id="ssl-7-3-3-2" class="section-heading">
  <a href="#ssl-7-3-3-2" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 7.3.3.2</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-135" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-135" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>An erlang TLS server configured with cipher suites using rsa key exchange, may
be vulnerable to an Adaptive Chosen Ciphertext attack (AKA Bleichenbacher
attack) against RSA, which when exploited, may result in plaintext recovery of
encrypted messages and/or a Man-in-the-middle (MiTM) attack, despite the
attacker not having gained access to the server’s private key itself.
<a href="https://nvd.nist.gov/vuln/detail/CVE-2017-1000385">CVE-2017-1000385</a></p><p>Exploiting this vulnerability to perform plaintext recovery of encrypted
messages will, in most practical cases, allow an attacker to read the
plaintext only after the session has completed. Only TLS sessions established
using RSA key exchange are vulnerable to this attack.</p><p>Exploiting this vulnerability to conduct a MiTM attack requires the attacker
to complete the initial attack, which may require thousands of server
requests, during the handshake phase of the targeted session within the window
of the configured handshake timeout. This attack may be conducted against any
TLS session using RSA signatures, but only if cipher suites using RSA key
exchange are also enabled on the server. The limited window of opportunity,
limitations in bandwidth, and latency make this attack significantly more
difficult to execute.</p><p>RSA key exchange is enabled by default although least prioritized if server
order is honored. For such a cipher suite to be chosen it must also be
supported by the client and probably the only shared cipher suite.</p><p>Captured TLS sessions encrypted with ephemeral cipher suites (DHE or ECDHE)
are not at risk for subsequent decryption due to this vulnerability.</p><p>As a workaround if default cipher suite configuration was used you can
configure the server to not use vulnerable suites with the ciphers option like
this:</p><p><code class="inline">{ciphers, [Suite || Suite &lt;- ssl:cipher_suites(), element(1,Suite) =/= rsa]}</code></p><p>that is your code will look somethingh like this:</p><p><code class="inline">ssl:listen(Port, [{ciphers, [Suite || Suite &lt;- ssl:cipher_suites(), element(1,S) =/= rsa]} | Options]).</code></p><p>Thanks to Hanno Böck, Juraj Somorovsky and Craig Young for reporting this
vulnerability.</p><p>Own Id: OTP-14748</p></li></ul><h2 id="ssl-7-3-3" class="section-heading">
  <a href="#ssl-7-3-3" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 7.3.3</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-136" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-136" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Correct ssl:prf/5 to use the negotiated cipher suite's prf function in
ssl:prf/5 instead of the default prf.</p><p>Own Id: OTP-13546</p></li><li><p>Timeouts may have the value 0, guards have been corrected to allow this</p><p>Own Id: OTP-13635</p></li><li><p>Change of internal handling of hash sign pairs as the used one enforced to
much restrictions making some valid combinations unavailable.</p><p>Own Id: OTP-13670</p></li></ul><h2 id="ssl-7-3-3-0-1" class="section-heading">
  <a href="#ssl-7-3-3-0-1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 7.3.3.0.1</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-137" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-137" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>An erlang TLS server configured with cipher suites using rsa key exchange, may
be vulnerable to an Adaptive Chosen Ciphertext attack (AKA Bleichenbacher
attack) against RSA, which when exploited, may result in plaintext recovery of
encrypted messages and/or a Man-in-the-middle (MiTM) attack, despite the
attacker not having gained access to the server’s private key itself.
<a href="https://nvd.nist.gov/vuln/detail/CVE-2017-1000385">CVE-2017-1000385</a></p><p>Exploiting this vulnerability to perform plaintext recovery of encrypted
messages will, in most practical cases, allow an attacker to read the
plaintext only after the session has completed. Only TLS sessions established
using RSA key exchange are vulnerable to this attack.</p><p>Exploiting this vulnerability to conduct a MiTM attack requires the attacker
to complete the initial attack, which may require thousands of server
requests, during the handshake phase of the targeted session within the window
of the configured handshake timeout. This attack may be conducted against any
TLS session using RSA signatures, but only if cipher suites using RSA key
exchange are also enabled on the server. The limited window of opportunity,
limitations in bandwidth, and latency make this attack significantly more
difficult to execute.</p><p>RSA key exchange is enabled by default although least prioritized if server
order is honored. For such a cipher suite to be chosen it must also be
supported by the client and probably the only shared cipher suite.</p><p>Captured TLS sessions encrypted with ephemeral cipher suites (DHE or ECDHE)
are not at risk for subsequent decryption due to this vulnerability.</p><p>As a workaround if default cipher suite configuration was used you can
configure the server to not use vulnerable suites with the ciphers option like
this:</p><p><code class="inline">{ciphers, [Suite || Suite &lt;- ssl:cipher_suites(), element(1,Suite) =/= rsa]}</code></p><p>that is your code will look somethingh like this:</p><p><code class="inline">ssl:listen(Port, [{ciphers, [Suite || Suite &lt;- ssl:cipher_suites(), element(1,S) =/= rsa]} | Options]).</code></p><p>Thanks to Hanno Böck, Juraj Somorovsky and Craig Young for reporting this
vulnerability.</p><p>Own Id: OTP-14748</p></li></ul><h3 id="improvements-and-new-features-60" class="section-heading">
  <a href="#improvements-and-new-features-60" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Create a little randomness in sending of session invalidation messages, to
mitigate load when whole table is invalidated.</p><p>Own Id: OTP-13490</p></li></ul><h2 id="ssl-7-3-2" class="section-heading">
  <a href="#ssl-7-3-2" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 7.3.2</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-138" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-138" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Correct cipher suites conversion and guard expression. Caused problems with
GCM cipher suites and client side option to set signature_algorithms extension
values.</p><p>Own Id: OTP-13525</p></li></ul><h2 id="ssl-7-3-1" class="section-heading">
  <a href="#ssl-7-3-1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 7.3.1</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-139" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-139" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Corrections to cipher suite handling using the 3 and 4 tuple format in
addition to commit 89d7e21cf4ae988c57c8ef047bfe85127875c70c</p><p>Own Id: OTP-13511</p></li></ul><h3 id="improvements-and-new-features-61" class="section-heading">
  <a href="#improvements-and-new-features-61" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Make values for the TLS-1.2 signature_algorithms extension configurable</p><p>Own Id: OTP-13261</p></li></ul><h2 id="ssl-7-3" class="section-heading">
  <a href="#ssl-7-3" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 7.3</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-140" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-140" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Make sure there is only one poller validator at a time for validating the
session cache.</p><p>Own Id: OTP-13185</p></li><li><p>A timing related issue could cause ssl to hang, especially happened with newer
versions of OpenSSL in combination with ECC ciphers.</p><p>Own Id: OTP-13253</p></li><li><p>Work around a race condition in the TLS distribution start.</p><p>Own Id: OTP-13268</p></li><li><p>Big handshake messages are now correctly fragmented in the TLS record layer.</p><p>Own Id: OTP-13306</p></li><li><p>Improve portability of ECC tests in Crypto and SSL for &quot;exotic&quot; OpenSSL
versions.</p><p>Own Id: OTP-13311</p></li><li><p>Certificate extensions marked as critical are ignored when using verify_none</p><p>Own Id: OTP-13377</p></li><li><p>If a certificate doesn't contain a CRL Distribution Points extension, and the
relevant CRL is not in the cache, and the <code class="inline">crl_check</code> option is not set to
<code class="inline">best_effort</code> , the revocation check should fail.</p><p>Own Id: OTP-13378</p></li><li><p>Enable TLS distribution over IPv6</p><p>Own Id: OTP-13391</p></li></ul><h3 id="improvements-and-new-features-62" class="section-heading">
  <a href="#improvements-and-new-features-62" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Improve error reporting for TLS distribution</p><p>Own Id: OTP-13219</p></li><li><p>Include options from connect, listen and accept in
<code class="inline">connection_information/1,2</code></p><p>Own Id: OTP-13232</p></li><li><p>Allow adding extra options for outgoing TLS distribution connections, as
supported for plain TCP connections.</p><p>Own Id: OTP-13285</p></li><li><p>Use loopback as server option in TLS-distribution module</p><p>Own Id: OTP-13300</p></li><li><p>Verify certificate signature against original certificate binary.</p><p>This avoids bugs due to encoding errors when re-encoding a decode certificate.
As there exists several decode step and using of different ASN.1 specification
this is a risk worth avoiding.</p><p>Own Id: OTP-13334</p></li><li><p>Use <a href="../../apps/kernel/application.html#ensure_all_started/2"><code class="inline">application:ensure_all_started/2</code></a> instead of hard-coding dependencies</p><p>Own Id: OTP-13363</p></li></ul><h2 id="ssl-7-2" class="section-heading">
  <a href="#ssl-7-2" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 7.2</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-141" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-141" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Honor distribution port range options</p><p>Own Id: OTP-12838</p></li><li><p>Correct supervisor specification in TLS distribution.</p><p>Own Id: OTP-13134</p></li><li><p>Correct cache timeout</p><p>Own Id: OTP-13141</p></li><li><p>Avoid crash and restart of ssl process when key file does not exist.</p><p>Own Id: OTP-13144</p></li><li><p>Enable passing of raw socket options on the format {raw,<em>,</em>,_} to the
underlying socket.</p><p>Own Id: OTP-13166</p></li><li><p>Hibernation with small or a zero timeout will now work as expected</p><p>Own Id: OTP-13189</p></li></ul><h3 id="improvements-and-new-features-63" class="section-heading">
  <a href="#improvements-and-new-features-63" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Add upper limit for session cache, configurable on ssl application level.</p><p>If upper limit is reached, invalidate the current cache entries, e.i the
session lifetime is the max time a session will be kept, but it may be
invalidated earlier if the max limit for the table is reached. This will keep
the ssl manager process well behaved, not exhusting memory. Invalidating the
entries will incrementally empty the cache to make room for fresh sessions
entries.</p><p>Own Id: OTP-12392</p></li><li><p>Use new time functions to measure passed time.</p><p>Own Id: OTP-12457</p></li><li><p>Improved error handling in TLS distribution</p><p>Own Id: OTP-13142</p></li><li><p>Distribution over TLS now honors the nodelay distribution flag</p><p>Own Id: OTP-13143</p></li></ul><h2 id="ssl-7-1" class="section-heading">
  <a href="#ssl-7-1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 7.1</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-142" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-142" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Add DER encoded ECPrivateKey as valid input format for key option.</p><p>Own Id: OTP-12974</p></li><li><p>Correct return value of default session callback module</p><p>This error had the symptom that the client check for unique session would
always fail, potentially making the client session table grow a lot and
causing long setup times.</p><p>Own Id: OTP-12980</p></li></ul><h3 id="improvements-and-new-features-64" class="section-heading">
  <a href="#improvements-and-new-features-64" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Add possibility to downgrade an SSL/TLS connection to a tcp connection, and
give back the socket control to a user process.</p><p>This also adds the possibility to specify a timeout to the ssl:close function.</p><p>Own Id: OTP-11397</p></li><li><p>Add application setting to be able to change fatal alert shutdown timeout,
also shorten the default timeout. The fatal alert timeout is the number of
milliseconds between sending of a fatal alert and closing the connection.
Waiting a little while improves the peers chances to properly receiving the
alert so it may shutdown gracefully.</p><p>Own Id: OTP-12832</p></li></ul><h2 id="ssl-7-0" class="section-heading">
  <a href="#ssl-7-0" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 7.0</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-143" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-143" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Ignore signature_algorithm (TLS 1.2 extension) sent to TLS 1.0 or TLS 1.1
server</p><p>Own Id: OTP-12670</p></li><li><p>Improve error handling in TLS distribution module to avoid lingering sockets.</p><p>Own Id: OTP-12799 Aux Id: Tom Briden</p></li><li><p>Add option {client_renegotiation, boolean()} option to the server-side of
the SSL application.</p><p>Own Id: OTP-12815</p></li></ul><h3 id="improvements-and-new-features-65" class="section-heading">
  <a href="#improvements-and-new-features-65" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Add new API functions to handle CRL-verification</p><p>Own Id: OTP-10362 Aux Id: kunagi-215 [126]</p></li><li><p>Remove default support for SSL-3.0, due to Poodle vunrability in protocol
specification.</p><p>Add padding check for TLS-1.0 to remove Poodle vunrability from TLS 1.0, also
add the option padding_check. This option only affects TLS-1.0 connections and
if set to false it disables the block cipher padding check to be able to
interoperate with legacy software.</p><p>Remove default support for RC4 cipher suites, as they are consider too weak.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-12390</p></li><li><p>Add support for TLS ALPN (Application-Layer Protocol Negotiation) extension.</p><p>Own Id: OTP-12580</p></li><li><p>Add SNI (Server Name Indication) support for the server side.</p><p>Own Id: OTP-12736</p></li></ul><h2 id="ssl-6-0-1-1" class="section-heading">
  <a href="#ssl-6-0-1-1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 6.0.1.1</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-144" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-144" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Gracefully ignore proprietary hash_sign algorithms</p><p>Own Id: OTP-12829</p></li></ul><h2 id="ssl-6-0-1" class="section-heading">
  <a href="#ssl-6-0-1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 6.0.1</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-145" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-145" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Terminate gracefully when receiving bad input to premaster secret calculation</p><p>Own Id: OTP-12783</p></li></ul><h2 id="ssl-6-0" class="section-heading">
  <a href="#ssl-6-0" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 6.0</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-146" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-146" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Exclude self-signed trusted anchor certificates from certificate prospective
certification path according to RFC 3280.</p><p>This will avoid some unnecessary certificate processing.</p><p>Own Id: OTP-12449</p></li></ul><h3 id="improvements-and-new-features-66" class="section-heading">
  <a href="#improvements-and-new-features-66" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Separate client and server session cache internally.</p><p>Avoid session table growth when client starts many connections in such a
manner that many connections are started before session reuse is possible.
Only save a new session in client if there is no equivalent session already
stored.</p><p>Own Id: OTP-11365</p></li><li><p>The PEM cache is now validated by a background process, instead of always
keeping it if it is small enough and clearing it otherwise. That strategy
required that small caches where cleared by API function if a file changes on
disk.</p><p>However export the API function to clear the cache as it may still be useful.</p><p>Own Id: OTP-12391</p></li><li><p>Add padding check for TLS-1.0 to remove Poodle vulnerability from TLS 1.0,
also add the option padding_check. This option only affects TLS-1.0
connections and if set to false it disables the block cipher padding check to
be able to interoperate with legacy software.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-12420</p></li><li><p>Add support for TLS_FALLBACK_SCSV used to prevent undesired TLS version
downgrades. If used by a client that is vulnerable to the POODLE attack, and
the server also supports TLS_FALLBACK_SCSV, the attack can be prevented.</p><p>Own Id: OTP-12458</p></li></ul><h2 id="ssl-5-3-8" class="section-heading">
  <a href="#ssl-5-3-8" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 5.3.8</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-147" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-147" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Make sure the clean rule for ssh, ssl, eunit and otp_mibs actually removes
generated files.</p><p>Own Id: OTP-12200</p></li></ul><h3 id="improvements-and-new-features-67" class="section-heading">
  <a href="#improvements-and-new-features-67" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Change code to reflect that state data may be secret to avoid breaking
dialyzer contracts.</p><p>Own Id: OTP-12341</p></li></ul><h2 id="ssl-5-3-7" class="section-heading">
  <a href="#ssl-5-3-7" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 5.3.7</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-148" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-148" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Handle the fact that servers may send an empty SNI extension to the client.</p><p>Own Id: OTP-12198</p></li></ul><h2 id="ssl-5-3-6" class="section-heading">
  <a href="#ssl-5-3-6" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 5.3.6</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-149" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-149" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Corrected handling of ECC certificates, there where several small issues with
the handling of such certificates in the ssl and public_key application. Now
ECC signed ECC certificates shall work and not only RSA signed ECC
certificates.</p><p>Own Id: OTP-12026</p></li><li><p>Check that the certificate chain ends with a trusted ROOT CA e.i. a
self-signed certificate, but provide an option partial_chain to enable the
application to define an intermediat CA as trusted.</p><p>Own Id: OTP-12149</p></li></ul><h3 id="improvements-and-new-features-68" class="section-heading">
  <a href="#improvements-and-new-features-68" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Add decode functions for SNI (Server Name Indication)</p><p>Own Id: OTP-12048</p></li></ul><h2 id="ssl-5-3-5" class="section-heading">
  <a href="#ssl-5-3-5" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 5.3.5</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-150" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-150" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>ssl:recv now returns {error, einval} if applied to a non passive socket, the
same as gen_tcp:recv.</p><p>Thanks to Danil Zagoskin for reporting this issue</p><p>Own Id: OTP-11878</p></li><li><p>Corrected handling of default values for signature_algorithms extension in
TLS-1.2 and corresponding values used in previous versions that does not
support this extension.</p><p>Thanks to Danil Zagoskin</p><p>Own Id: OTP-11886</p></li><li><p>Handle socket option inheritance when pooling of accept sockets is used</p><p>Own Id: OTP-11897</p></li><li><p>Make sure that the list of versions, possibly supplied in the versions option,
is not order dependent.</p><p>Thanks to Ransom Richardson for reporting this issue</p><p>Own Id: OTP-11912</p></li><li><p>Reject connection if the next_protocol message is sent twice.</p><p>Own Id: OTP-11926</p></li><li><p>Correct options handling when ssl:ssl_accept/3 is called with new ssl options
after calling ssl:listen/2</p><p>Own Id: OTP-11950</p></li></ul><h3 id="improvements-and-new-features-69" class="section-heading">
  <a href="#improvements-and-new-features-69" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Gracefully handle unknown alerts</p><p>Thanks to Atul Atri for reporting this issue</p><p>Own Id: OTP-11874</p></li><li><p>Gracefully ignore cipher suites sent by client not supported by the SSL/TLS
version that the client has negotiated.</p><p>Thanks to Danil Zagoskin for reporting this issue</p><p>Own Id: OTP-11875</p></li><li><p>Gracefully handle structured garbage, i.e a client sends some garbage in a ssl
record instead of a valid fragment.</p><p>Thanks to Danil Zagoskin</p><p>Own Id: OTP-11880</p></li><li><p>Gracefully handle invalid alerts</p><p>Own Id: OTP-11890</p></li><li><p>Generalize handling of default ciphers</p><p>Thanks to Andreas Schultz</p><p>Own Id: OTP-11966</p></li><li><p>Make sure change cipher spec is correctly handled</p><p>Own Id: OTP-11975</p></li></ul><h2 id="ssl-5-3-4" class="section-heading">
  <a href="#ssl-5-3-4" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 5.3.4</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-151" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-151" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Fix incorrect dialyzer spec and types, also enhance documentation.</p><p>Thanks to Ayaz Tuncer.</p><p>Own Id: OTP-11627</p></li><li><p>Fix possible mismatch between SSL/TLS version and default ciphers. Could
happen when you specified SSL/TLS-version in optionlist to listen or accept.</p><p>Own Id: OTP-11712</p></li><li><p>Application upgrade (appup) files are corrected for the following
applications:</p><p><code class="inline">asn1, common_test, compiler, crypto, debugger, dialyzer, edoc, eldap, erl_docgen, et, eunit, gs, hipe, inets, observer, odbc, os_mon, otp_mibs, parsetools, percept, public_key, reltool, runtime_tools, ssh, syntax_tools, test_server, tools, typer, webtool, wx, xmerl</code></p><p>A new test utility for testing appup files is added to test_server. This is
now used by most applications in OTP.</p><p>(Thanks to Tobias Schlager)</p><p>Own Id: OTP-11744</p></li></ul><h3 id="improvements-and-new-features-70" class="section-heading">
  <a href="#improvements-and-new-features-70" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Moved elliptic curve definition from the crypto NIF/OpenSSL into Erlang code,
adds the RFC-5639 brainpool curves and makes TLS use them (RFC-7027).</p><p>Thanks to Andreas Schultz</p><p>Own Id: OTP-11578</p></li><li><p>Unicode adaptations</p><p>Own Id: OTP-11620</p></li><li><p>Added option honor_cipher_order. This instructs the server to prefer its own
cipher ordering rather than the client's and can help protect against things
like BEAST while maintaining compatibility with clients which only support
older ciphers.</p><p>Thanks to Andrew Thompson for the implementation, and Andreas Schultz for the
test cases.</p><p>Own Id: OTP-11621</p></li><li><p>Replace boolean checking in validate_option with is_boolean guard.</p><p>Thanks to Andreas Schultz.</p><p>Own Id: OTP-11634</p></li><li><p>Some function specs are corrected or moved and some edoc comments are
corrected in order to allow use of edoc. (Thanks to Pierre Fenoll)</p><p>Own Id: OTP-11702</p></li><li><p>Correct clean up of certificate database when certs are inputted in pure DER
format.The incorrect code could cause a memory leek when certs where inputted
in DER. Thanks to Bernard Duggan for reporting this.</p><p>Own Id: OTP-11733</p></li><li><p>Improved documentation of the cacertfile option</p><p>Own Id: OTP-11759 Aux Id: seq12535</p></li><li><p>Avoid next protocol negotiation failure due to incorrect option format.</p><p>Own Id: OTP-11760</p></li><li><p>Handle v1 CRLs, with no extensions and fixes issues with IDP (Issuing
Distribution Point) comparison during CRL validation.</p><p>Thanks to Andrew Thompson</p><p>Own Id: OTP-11761</p></li><li><p>Server now ignores client ECC curves that it does not support instead of
crashing.</p><p>Thanks to Danil Zagoskin for reporting the issue and suggesting a solution.</p><p>Own Id: OTP-11780</p></li><li><p>Handle SNI (Server Name Indication) alert unrecognized_name and gracefully
deal with unexpected alerts.</p><p>Thanks to Masatake Daimon for reporting this.</p><p>Own Id: OTP-11815</p></li><li><p>Add possibility to specify ssl options when calling ssl:ssl_accept</p><p>Own Id: OTP-11837</p></li></ul><h2 id="ssl-5-3-3" class="section-heading">
  <a href="#ssl-5-3-3" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 5.3.3</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-152" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-152" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Add missing validation of the server_name_indication option and test for its
explicit use. It was not possible to set or disable the default
server_name_indication as the validation of the option was missing.</p><p>Own Id: OTP-11567</p></li><li><p>Elliptic curve selection in server mode now properly selects a curve suggested
by the client, if possible, and the fallback alternative is changed to a more
widely supported curve.</p><p>Own Id: OTP-11575</p></li><li><p>Bug in the TLS hello extension handling caused the server to behave as it did
not understand secure renegotiation.</p><p>Own Id: OTP-11595</p></li></ul><h2 id="ssl-5-3-2" class="section-heading">
  <a href="#ssl-5-3-2" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 5.3.2</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-153" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-153" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Honors the clients advertised support of elliptic curves and no longer sends
incorrect elliptic curve extension in server hello.</p><p>Own Id: OTP-11370</p></li><li><p>Fix initialization of DTLS fragment reassembler, in previously contributed
code, for future support of DTLS . Thanks to Andreas Schultz.</p><p>Own Id: OTP-11376</p></li><li><p>Corrected type error in client_preferred_next_protocols documentation. Thanks
to Julien Barbot.</p><p>Own Id: OTP-11457</p></li></ul><h3 id="improvements-and-new-features-71" class="section-heading">
  <a href="#improvements-and-new-features-71" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>TLS code has been refactored to prepare for future DTLS support. Also some
DTLS code is in place but not yet runnable, some of it contributed by Andreas
Schultz and some of it written by the OTP team. Thanks to to Andreas for his
participation.</p><p>Own Id: OTP-11292</p></li><li><p>Remove extraneous dev debug code left in the close function. Thanks to Ken
Key.</p><p>Own Id: OTP-11447</p></li><li><p>Add SSL Server Name Indication (SNI) client support. Thanks to Julien Barbot.</p><p>Own Id: OTP-11460</p></li></ul><h2 id="ssl-5-3-1" class="section-heading">
  <a href="#ssl-5-3-1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 5.3.1</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-154" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-154" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Setopts during renegotiation caused the renegotiation to be unsuccessful.</p><p>If calling setopts during a renegotiation the FSM state might change during
the handling of the setopts messages, this is now handled correctly.</p><p>Own Id: OTP-11228</p></li><li><p>Now handles signature_algorithm field in digitally_signed properly with proper
defaults. Prior to this change some elliptic curve cipher suites could fail
reporting the error &quot;bad certificate&quot;.</p><p>Own Id: OTP-11229</p></li><li><p>The code emulating the inet header option was changed in the belief that it
made it inet compatible. However the testing is a bit hairy as the inet option
is actually broken, now the tests are corrected and the header option should
work in the same broken way as inet again, preferably use the bitsyntax
instead.</p><p>Own Id: OTP-11230</p></li></ul><h3 id="improvements-and-new-features-72" class="section-heading">
  <a href="#improvements-and-new-features-72" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Make the ssl manager name for erlang distribution over SSL/TLS relative to the
module name of the ssl_manager.</p><p>This can be beneficial when making tools that rename modules for internal
processing in the tool.</p><p>Own Id: OTP-11255</p></li><li><p>Add documentation regarding log_alert option.</p><p>Own Id: OTP-11271</p></li></ul><h2 id="ssl-5-3" class="section-heading">
  <a href="#ssl-5-3" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 5.3</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-155" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-155" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Honor the versions option to ssl:connect and ssl:listen.</p><p>Own Id: OTP-10905</p></li><li><p>Next protocol negotiation with reused sessions will now succeed</p><p>Own Id: OTP-10909</p></li></ul><h3 id="improvements-and-new-features-73" class="section-heading">
  <a href="#improvements-and-new-features-73" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Add support for PSK (Pre Shared Key) and SRP (Secure Remote Password) cipher
suites, thanks to Andreas Schultz.</p><p>Own Id: OTP-10450 Aux Id: kunagi-269 [180]</p></li><li><p>Fix SSL Next Protocol Negotiation documentation. Thanks to Julien Barbot.</p><p>Own Id: OTP-10955</p></li><li><p>Fix ssl_connection to support reading proxy/chain certificates. Thanks to
Valentin Kuznetsov.</p><p>Own Id: OTP-10980</p></li><li><p>Integrate elliptic curve contribution from Andreas Schultz</p><p>In order to be able to support elliptic curve cipher suites in SSL/TLS,
additions to handle elliptic curve infrastructure has been added to public_key
and crypto.</p><p>This also has resulted in a rewrite of the crypto API to gain consistency and
remove unnecessary overhead. All OTP applications using crypto has been
updated to use the new API.</p><p>Impact: Elliptic curve cryptography (ECC) offers equivalent security with
smaller key sizes than other public key algorithms. Smaller key sizes result
in savings for power, memory, bandwidth, and computational cost that make ECC
especially attractive for constrained environments.</p><p>Own Id: OTP-11009</p></li></ul><h2 id="ssl-5-2-1" class="section-heading">
  <a href="#ssl-5-2-1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 5.2.1</span>
</h2>
<h3 id="improvements-and-new-features-74" class="section-heading">
  <a href="#improvements-and-new-features-74" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Transport callback handling is changed so that gen_tcp is treated as a special
case where inet will be called directly for functions such as setopts, as
gen_tcp does not have its own setopts. This will enable users to use the
transport callback for other customizations such as websockets.</p><p>Own Id: OTP-10847</p></li><li><p>Follow up to OTP-10451 solved in ssl-5.2 R16A. Make sure format_error return
good strings. Replace confusing legacy atoms with more descriptive atoms.</p><p>Own Id: OTP-10864</p></li></ul><h2 id="ssl-5-1-2-1" class="section-heading">
  <a href="#ssl-5-1-2-1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 5.1.2.1</span>
</h2>
<h3 id="improvements-and-new-features-75" class="section-heading">
  <a href="#improvements-and-new-features-75" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Make log_alert configurable as option in ssl, SSLLogLevel added as option to
inets conf file</p><p>Own Id: OTP-11259</p></li></ul><h2 id="ssl-5-2" class="section-heading">
  <a href="#ssl-5-2" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 5.2</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-156" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-156" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>SSL: TLS 1.2, advertise sha224 support, thanks to Andreas Schultz.</p><p>Own Id: OTP-10586</p></li><li><p>If an ssl server is restarted with new options and a client tries to reuse a
session the server must make sure that it complies to the new options before
agreeing to reuse it.</p><p>Own Id: OTP-10595</p></li><li><p>Now handles cleaning of CA-certificate database correctly so that there will
be no memory leek, bug was introduced in ssl- 5.1 when changing implementation
to increase parallel execution.</p><p>Impact: Improved memory usage, especially if you have many different
certificates and upgrade tcp-connections to TLS-connections.</p><p>Own Id: OTP-10710</p></li></ul><h3 id="improvements-and-new-features-76" class="section-heading">
  <a href="#improvements-and-new-features-76" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Support Next Protocol Negotiation in TLS, thanks to Ben Murphy for the
contribution.</p><p>Impact: Could give performance benefit if used as it saves a round trip.</p><p>Own Id: OTP-10361 Aux Id: kunagi-214 [125]</p></li><li><p>TLS 1.2 will now be the default TLS version if sufficient crypto support is
available otherwise TLS 1.1 will be default.</p><p>Impact: A default TLS connection will have higher security and hence it may be
perceived as slower then before.</p><p>Own Id: OTP-10425 Aux Id: kunagi-275 [186]</p></li><li><p>It is now possible to call controlling_process on a listen socket, same as in
gen_tcp.</p><p>Own Id: OTP-10447</p></li><li><p>Remove filter mechanisms that made error messages backwards compatible with
old ssl but hid information about what actually happened.</p><p>This does not break the documented API however other reason terms may be
returned, so code that matches on the reason part of {error, Reason} may
fail.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-10451 Aux Id: kunagi-270 [181]</p></li><li><p>Added missing dependencies to Makefile</p><p>Own Id: OTP-10594</p></li><li><p>Removed deprecated function ssl:pid/0, it has been pointless since R14 but has
been keep for backwards compatibility.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-10613 Aux Id: kunagi-331 [242]</p></li><li><p>Refactor to simplify addition of key exchange methods, thanks to Andreas
Schultz.</p><p>Own Id: OTP-10709</p></li></ul><h2 id="ssl-5-1-2" class="section-heading">
  <a href="#ssl-5-1-2" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 5.1.2</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-157" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-157" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>ssl:ssl_accept/2 timeout is no longer ignored</p><p>Own Id: OTP-10600</p></li></ul><h2 id="ssl-5-1-1" class="section-heading">
  <a href="#ssl-5-1-1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 5.1.1</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-158" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-158" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>ssl:recv/3 could &quot;loose&quot; data when the timeout occurs. If the timeout in
ssl:connect or ssl:ssl_accept expired the ssl connection process was not
terminated as it should, this due to gen_fsm:send_all_state_event timeout is a
client side time out. These timouts are now handled by the gen_fsm-procss
instead.</p><p>Own Id: OTP-10569</p></li></ul><h3 id="improvements-and-new-features-77" class="section-heading">
  <a href="#improvements-and-new-features-77" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Better termination handling that avoids hanging.</p><p>Own Id: OTP-10574</p></li></ul><h2 id="ssl-5-1" class="section-heading">
  <a href="#ssl-5-1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 5.1</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-159" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-159" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Sometimes the client process could receive an extra {error, closed} message
after ssl:recv had returned {error, closed}.</p><p>Own Id: OTP-10118</p></li><li><p>ssl v3 alert number 41 (no_certificate_RESERVED) is now recognized</p><p>Own Id: OTP-10196</p></li></ul><h3 id="improvements-and-new-features-78" class="section-heading">
  <a href="#improvements-and-new-features-78" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Experimental support for TLS 1.1 is now available, will be officially
supported from OTP-R16. Thanks to Andreas Schultz for implementing the first
version.</p><p>Own Id: OTP-8871</p></li><li><p>Experimental support for TLS 1.2 is now available, will be officially
supported from OTP-R16. Thanks to Andreas Schultz for implementing the first
version.</p><p>Own Id: OTP-8872</p></li><li><p>Removed some bottlenecks increasing the applications parallelism especially
for the client side.</p><p>Own Id: OTP-10113</p></li><li><p>Workaround for handling certificates that wrongly encode X509countryname in
utf-8 when the actual value is a valid ASCCI value of length 2. Such
certificates are accepted by many browsers such as Chrome and Fierfox so for
interoperability reasons we will too.</p><p>Own Id: OTP-10222</p></li></ul><h2 id="ssl-5-0-1" class="section-heading">
  <a href="#ssl-5-0-1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 5.0.1</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-160" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-160" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Robustness and improvement to distribution over SSL</p><p>Fix a bug where ssl_tls_dist_proxy would crash at caller timeout. Fix a bug
where a timeout from the SSL layer would block the distribution indefinitely.
Run the proxy exclusively on the loopback interface. (Thanks to Paul Guyot)</p><p>Own Id: OTP-9915</p></li><li><p>Fix setup loop of SSL TLS dist proxy</p><p>Fix potential leak of processes waiting indefinitely for data from closed
sockets during socket setup phase. (Thanks to Paul Guyot)</p><p>Own Id: OTP-9916</p></li><li><p>Correct spelling of registered (Thanks to Richard Carlsson)</p><p>Own Id: OTP-9925</p></li><li><p>Added TLS PRF function to the SSL API for generation of additional key
material from a TLS session. (Thanks to Andreas Schultz)</p><p>Own Id: OTP-10024</p></li></ul><h2 id="ssl-5-0" class="section-heading">
  <a href="#ssl-5-0" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 5.0</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-161" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-161" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Invalidation handling of sessions could cause the time_stamp field in the
session record to be set to undefined crashing the session clean up process.
This did not affect the connections but would result in that the session table
would grow.</p><p>Own Id: OTP-9696 Aux Id: seq11947</p></li><li><p>Changed code to use ets:foldl and throw instead of ets:next traversal,
avoiding the need to explicitly call ets:safe_fixtable. It was possible to get
a badarg-crash under special circumstances.</p><p>Own Id: OTP-9703 Aux Id: seq11947</p></li><li><p>Send ssl_closed notification to active ssl user when a tcp error occurs.</p><p>Own Id: OTP-9734 Aux Id: seq11946</p></li><li><p>If a passive receive was ongoing during a renegotiation the process evaluating
ssl:recv could be left hanging for ever.</p><p>Own Id: OTP-9744</p></li></ul><h3 id="improvements-and-new-features-79" class="section-heading">
  <a href="#improvements-and-new-features-79" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Support for the old ssl implementation is dropped and the code is removed.</p><p>Own Id: OTP-7048</p></li><li><p>The erlang distribution can now be run over the new ssl implementation. All
options can currently not be set but it is enough to replace to old ssl
implementation.</p><p>Own Id: OTP-7053</p></li><li><p>public_key, ssl and crypto now supports PKCS-8</p><p>Own Id: OTP-9312</p></li><li><p>Implements a CBC timing attack counter measure. Thanks to Andreas Schultz for
providing the patch.</p><p>Own Id: OTP-9683</p></li><li><p>Mitigates an SSL/TLS Computational DoS attack by disallowing the client to
renegotiate many times in a row in a short time interval, thanks to Tuncer
Ayaz for alerting us about this.</p><p>Own Id: OTP-9739</p></li><li><p>Implements the 1/n-1 splitting countermeasure to the Rizzo Duong BEAST attack,
affects SSL 3.0 and TLS 1.0. Thanks to Tuncer Ayaz for alerting us about this.</p><p>Own Id: OTP-9750</p></li></ul><h2 id="ssl-4-1-6" class="section-heading">
  <a href="#ssl-4-1-6" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 4.1.6</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-162" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-162" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>replace &quot;a ssl&quot; with &quot;an ssl&quot; reindent pkix_path_validation/3 Trivial
documentation fixes (Thanks to Christian von Roques )</p><p>Own Id: OTP-9464</p></li></ul><h3 id="improvements-and-new-features-80" class="section-heading">
  <a href="#improvements-and-new-features-80" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Adds function clause to avoid denial of service attack. Thanks to Vinod for
reporting this vulnerability.</p><p>Own Id: OTP-9364</p></li><li><p>Error handling code now takes care of inet:getopts/2 and inets:setopts/2
crashes. Thanks to Richard Jones for reporting this.</p><p>Own Id: OTP-9382</p></li><li><p>Support explicit use of packet option httph and httph_bin</p><p>Own Id: OTP-9461</p></li><li><p>Decoding of hello extensions could fail to come to the correct conclusion due
to an error in a binary match pattern. Thanks to Ben Murphy.</p><p>Own Id: OTP-9589</p></li></ul><h2 id="ssl-4-1-5" class="section-heading">
  <a href="#ssl-4-1-5" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 4.1.5</span>
</h2>
<h3 id="improvements-and-new-features-81" class="section-heading">
  <a href="#improvements-and-new-features-81" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Calling gen_tcp:connect with option {ip, {127,0,0,1}} results in an exit
with reason badarg. Neither SSL nor INETS This was not caught, resulting in
crashes with incomprehensible reasons.</p><p>Own Id: OTP-9289 Aux Id: seq11845</p></li></ul><h2 id="ssl-4-1-3" class="section-heading">
  <a href="#ssl-4-1-3" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 4.1.3</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-163" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-163" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Fixed error in cache-handling fix from ssl-4.1.2</p><p>Own Id: OTP-9018 Aux Id: seq11739</p></li><li><p>Verification of a critical extended_key_usage-extension corrected</p><p>Own Id: OTP-9029 Aux Id: seq11541</p></li></ul><h2 id="ssl-4-1-2" class="section-heading">
  <a href="#ssl-4-1-2" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 4.1.2</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-164" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-164" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>The ssl application caches certificate files, it will now invalidate cache
entries if the diskfile is changed.</p><p>Own Id: OTP-8965 Aux Id: seq11739</p></li><li><p>Now runs the terminate function before returning from the call made by
ssl:close/1, as before the caller of ssl:close/1 could get problems with the
reuseaddr option.</p><p>Own Id: OTP-8992</p></li></ul><h2 id="ssl-4-1-1" class="section-heading">
  <a href="#ssl-4-1-1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 4.1.1</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-165" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-165" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>Correct handling of client certificate verify message When checking the client
certificate verify message the server used the wrong algorithm identifier to
determine the signing algorithm, causing a function clause error in the
public_key application when the key-exchange algorithm and the public key
algorithm of the client certificate happen to differ.</p><p>Own Id: OTP-8897</p></li></ul><h3 id="improvements-and-new-features-82" class="section-heading">
  <a href="#improvements-and-new-features-82" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>For testing purposes ssl now also support some anonymous cipher suites when
explicitly configured to do so.</p><p>Own Id: OTP-8870</p></li><li><p>Sends an error alert instead of crashing if a crypto function for the selected
cipher suite fails.</p><p>Own Id: OTP-8930 Aux Id: seq11720</p></li></ul><h2 id="ssl-4-1" class="section-heading">
  <a href="#ssl-4-1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 4.1</span>
</h2>
<h3 id="improvements-and-new-features-83" class="section-heading">
  <a href="#improvements-and-new-features-83" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Updated ssl to ignore CA certs that violate the asn1-spec for a certificate,
and updated public key asn1 spec to handle inherited DSS-params.</p><p>Own Id: OTP-7884</p></li><li><p>Changed ssl implementation to retain backwards compatibility for old option
{verify, 0} that shall be equivalent to {verify, verify_none}, also
separate the cases unknown ca and selfsigned peer cert, and restored return
value of deprecated function public_key:pem_to_der/1.</p><p>Own Id: OTP-8858</p></li><li><p>Changed the verify fun so that it differentiate between the peer certificate
and CA certificates by using valid_peer or valid as the second argument to the
verify fun. It may not always be trivial or even possible to know when the
peer certificate is reached otherwise.</p><p>*<strong> POTENTIAL INCOMPATIBILITY *</strong></p><p>Own Id: OTP-8873</p></li></ul><h2 id="ssl-4-0-1" class="section-heading">
  <a href="#ssl-4-0-1" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 4.0.1</span>
</h2>
<h3 id="fixed-bugs-and-malfunctions-166" class="section-heading">
  <a href="#fixed-bugs-and-malfunctions-166" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Fixed Bugs and Malfunctions</span>
</h3>
<ul><li><p>The server now verifies the client certificate verify message correctly,
instead of causing a case-clause.</p><p>Own Id: OTP-8721</p></li><li><p>The client hello message now always include ALL available cipher suites (or
those specified by the ciphers option). Previous implementation would filter
them based on the client certificate key usage extension (such filtering only
makes sense for the server certificate).</p><p>Own Id: OTP-8772</p></li><li><p>Fixed handling of the option {mode, list} that was broken for some packet
types for instance line.</p><p>Own Id: OTP-8785</p></li><li><p>Empty packets were not delivered to the client.</p><p>Own Id: OTP-8790</p></li><li><p>Building in a source tree without prebuilt platform independent build results
failed on the SSL examples when:</p><ul><li>cross building. This has been solved by not building the SSL examples during
a cross build.</li><li>building on Windows.</li></ul><p>Own Id: OTP-8791</p></li><li><p>Fixed a handshake error which occurred on some ssl implementations.</p><p>Own Id: OTP-8793</p></li></ul><h3 id="improvements-and-new-features-84" class="section-heading">
  <a href="#improvements-and-new-features-84" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>Revise the public_key API - Cleaned up and documented the public_key API to
make it useful for general use, also changed ssl to use the new API.</p><p>Own Id: OTP-8722</p></li><li><p>Added support for inputing certificates and keys directly in DER format these
options will override the pem-file options if specified.</p><p>Own Id: OTP-8723</p></li><li><p>To gain interoperability ssl will not check for padding errors when using TLS
1.0. It is first in TLS 1.1 that checking the padding is an requirement.</p><p>Own Id: OTP-8740</p></li><li><p>Changed the semantics of the verify_fun option in the ssl-application so that
it takes care of both application handling of path validation errors and
verification of application specific extensions. This means that it is now
possible for the server application in verify_peer mode to handle path
validation errors. This change moved some functionality earlier in ssl to the
public_key application.</p><p>Own Id: OTP-8770</p></li><li><p>Added the functionality so that the verification fun will be called when a
certificate is considered valid by the path validation to allow access to each
certificate in the path to the user application. Also try to verify
subject-AltName, if unable to verify it let the application verify it.</p><p>Own Id: OTP-8825</p></li></ul><h2 id="ssl-4-0" class="section-heading">
  <a href="#ssl-4-0" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">SSL 4.0</span>
</h2>
<h3 id="improvements-and-new-features-85" class="section-heading">
  <a href="#improvements-and-new-features-85" class="hover-link">
    <i class="ri-link-m" aria-hidden="true"></i>
  </a>
  <span class="text">Improvements and New Features</span>
</h3>
<ul><li><p>New ssl now support client/server-certificates signed by dsa keys.</p><p>Own Id: OTP-8587</p></li><li><p>Ssl has now switched default implementation and removed deprecated certificate
handling. All certificate handling is done by the public_key application.</p><p>Own Id: OTP-8695</p></li></ul>
</div>

<div class="bottom-actions" id="bottom-actions">
  <div class="bottom-actions-item">

      <a href="ssl_app.html" class="bottom-actions-button" rel="prev">
        <span class="subheader">
          ← Previous Page
        </span>
        <span class="title">
SSL Application
        </span>
      </a>

  </div>
  <div class="bottom-actions-item">

      <a href="ssl_protocol.html" class="bottom-actions-button" rel="next">
        <span class="subheader">
          Next Page →
        </span>
        <span class="title">
TLS/DTLS Protocol Overview
        </span>
      </a>

  </div>
</div>
    <footer class="footer">
      <p>

        <span class="line">
          <button class="a-main footer-button display-quick-switch" title="Search HexDocs packages">
            Search HexDocs
          </button>

            <a href="ssl.epub" title="ePub version">
              Download ePub version
            </a>

        </span>
      </p>

      <p class="built-using">
        Built using
        <a href="https://github.com/elixir-lang/ex_doc" title="ExDoc" target="_blank" rel="help noopener" translate="no">ExDoc</a> (v0.37.3) for the

          <a href="https://erlang.org" title="Erlang" target="_blank" translate="no">Erlang programming language</a>

      </p>
<p>Copyright © 1996-2025 <a href="https://www.ericsson.com">Ericsson AB</a></p>
    </footer>
  </div>
</main>
</div>
  <script defer src="https://cdn.jsdelivr.net/npm/mermaid@11.4.1/dist/mermaid.min.js"></script>
  <script>
  let initialized = false;

  window.addEventListener("exdoc:loaded", () => {
      if (!initialized) {
      mermaid.initialize({
          startOnLoad: false,
          theme: document.body.className.includes("dark") ? "dark" : "default"
      });
      initialized = true;
      }

      let id = 0;
      for (const codeEl of document.querySelectorAll("pre code.mermaid")) {
      const preEl = codeEl.parentElement;
      const graphDefinition = codeEl.textContent;
      const graphEl = document.createElement("div");
      const graphId = "mermaid-graph-" + id++;
      mermaid.render(graphId, graphDefinition).then(({svg, bindFunctions}) => {
          graphEl.innerHTML = svg;
          bindFunctions?.(graphEl);
          preEl.insertAdjacentElement("afterend", graphEl);
          preEl.remove();
      });
      }
  });
  </script>

  </body>
</html>
