<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html xmlns:erl="http://erlang.org" xmlns:fn="http://www.w3.org/2005/02/xpath-functions">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" href="../../otp_doc.css" type="text/css">
<title>Erlang -- Running Tests and Analyzing Results</title>
</head>
<body bgcolor="white" text="#000000" link="#0000ff" vlink="#ff00ff" alink="#ff0000"><div id="container">
<script id="js" type="text/javascript" language="JavaScript" src="../../js/flipmenu/flipmenu.js"></script><script id="js2" type="text/javascript" src="../../js/erlresolvelinks.js"></script><script language="JavaScript" type="text/javascript">
            <!--
              function getWinHeight() {
                var myHeight = 0;
                if( typeof( window.innerHeight ) == 'number' ) {
                  //Non-IE
                  myHeight = window.innerHeight;
                } else if( document.documentElement && ( document.documentElement.clientWidth ||
                                                         document.documentElement.clientHeight ) ) {
                  //IE 6+ in 'standards compliant mode'
                  myHeight = document.documentElement.clientHeight;
                } else if( document.body && ( document.body.clientWidth || document.body.clientHeight ) ) {
                  //IE 4 compatible
                  myHeight = document.body.clientHeight;
                }
                return myHeight;
              }

              function setscrollpos() {
                var objf=document.getElementById('loadscrollpos');
                 document.getElementById("leftnav").scrollTop = objf.offsetTop - getWinHeight()/2;
              }

              function addEvent(obj, evType, fn){
                if (obj.addEventListener){
                obj.addEventListener(evType, fn, true);
                return true;
              } else if (obj.attachEvent){
                var r = obj.attachEvent("on"+evType, fn);
                return r;
              } else {
                return false;
              }
             }

             addEvent(window, 'load', setscrollpos);

             //--></script><div id="leftnav"><div class="innertube">
<img alt="Erlang logo" src="../../erlang-logo.png"><br><small><a href="users_guide.html">User's Guide</a><br><a href="index.html">Reference Manual</a><br><a href="release_notes.html">Release Notes</a><br><a href="common_test.pdf">PDF</a><br><a href="../../index.html">Top</a></small><p><strong>Common Test</strong><br><strong>User's Guide</strong><br><small>Version 1.14</small></p>
<br><a href="javascript:openAllFlips()">Expand All</a><br><a href="javascript:closeAllFlips()">Contract All</a><p><small><strong>Chapters</strong></small></p>
<ul class="flipMenu" imagePath="../../js/flipmenu">
<li id="no" title="Introduction" expanded="false">Introduction<ul>
<li><a href="introduction.html">
              Top of chapter
            </a></li>
<li title="Scope"><a href="introduction.html#id58032">Scope</a></li>
<li title="Prerequisites"><a href="introduction.html#id70023">Prerequisites</a></li>
</ul>
</li>
<li id="no" title="Common Test Basics" expanded="false">Common Test Basics<ul>
<li><a href="basics_chapter.html">
              Top of chapter
            </a></li>
<li title="General"><a href="basics_chapter.html#id57978">General</a></li>
<li title="Test Suite Organisation"><a href="basics_chapter.html#id64675">Test Suite Organisation</a></li>
<li title="Support Libraries"><a href="basics_chapter.html#id62285">Support Libraries</a></li>
<li title="Suites and Test Cases"><a href="basics_chapter.html#id63359">Suites and Test Cases</a></li>
<li title="External Interfaces"><a href="basics_chapter.html#id61440">External Interfaces</a></li>
</ul>
</li>
<li id="no" title="Getting Started" expanded="false">Getting Started<ul>
<li><a href="getting_started_chapter.html">
              Top of chapter
            </a></li>
<li title="Introduction for Newcomers"><a href="getting_started_chapter.html#id70537">Introduction for Newcomers</a></li>
<li title="Test Case Execution"><a href="getting_started_chapter.html#id61029">Test Case Execution</a></li>
<li title="A Simple Test Suite"><a href="getting_started_chapter.html#id62912">A Simple Test Suite</a></li>
<li title="A Test Suite with Configuration Functions"><a href="getting_started_chapter.html#id69498">A Test Suite with Configuration Functions</a></li>
<li title="Questions and Answers"><a href="getting_started_chapter.html#id63443">Questions and Answers</a></li>
</ul>
</li>
<li id="no" title="Installation" expanded="false">Installation<ul>
<li><a href="install_chapter.html">
              Top of chapter
            </a></li>
<li title="General Information"><a href="install_chapter.html#id75958">General Information</a></li>
</ul>
</li>
<li id="no" title="Writing Test Suites" expanded="false">Writing Test Suites<ul>
<li><a href="write_test_chapter.html">
              Top of chapter
            </a></li>
<li title="Support for Test Suite Authors"><a href="write_test_chapter.html#id68554">Support for Test Suite Authors</a></li>
<li title="Test Suites"><a href="write_test_chapter.html#id68618">Test Suites</a></li>
<li title="Init and End per Suite"><a href="write_test_chapter.html#id68668">Init and End per Suite</a></li>
<li title="Init and End per Test Case"><a href="write_test_chapter.html#id75026">Init and End per Test Case</a></li>
<li title="Test Cases"><a href="write_test_chapter.html#id75325">Test Cases</a></li>
<li title="Test Case Information Function"><a href="write_test_chapter.html#id75513">Test Case Information Function</a></li>
<li title="Test Suite Information Function"><a href="write_test_chapter.html#id75710">Test Suite Information Function</a></li>
<li title="Test Case Groups"><a href="write_test_chapter.html#id76889">Test Case Groups</a></li>
<li title="Parallel Property and Nested Groups"><a href="write_test_chapter.html#id77324">Parallel Property and Nested Groups</a></li>
<li title="Parallel Test Cases and I/O"><a href="write_test_chapter.html#id77361">Parallel Test Cases and I/O</a></li>
<li title="Repeated Groups"><a href="write_test_chapter.html#id77414">Repeated Groups</a></li>
<li title="Shuffled Test Case Order"><a href="write_test_chapter.html#id77567">Shuffled Test Case Order</a></li>
<li title="Group Information Function"><a href="write_test_chapter.html#id77633">Group Information Function</a></li>
<li title="Information Functions for Init- and End-Configuration"><a href="write_test_chapter.html#id77674">Information Functions for Init- and End-Configuration</a></li>
<li title="Data and Private Directories"><a href="write_test_chapter.html#id77749">Data and Private Directories</a></li>
<li title="Execution Environment"><a href="write_test_chapter.html#id77907">Execution Environment</a></li>
<li title="Timetrap Time-Outs"><a href="write_test_chapter.html#id77944">Timetrap Time-Outs</a></li>
<li title="Logging - Categories and Verbosity Levels"><a href="write_test_chapter.html#id78145">Logging - Categories and Verbosity Levels</a></li>
<li title="Illegal Dependencies"><a href="write_test_chapter.html#id78538">Illegal Dependencies</a></li>
</ul>
</li>
<li id="no" title="Test Structure" expanded="false">Test Structure<ul>
<li><a href="test_structure_chapter.html">
              Top of chapter
            </a></li>
<li title="General"><a href="test_structure_chapter.html#id78731">General</a></li>
<li title="Skipping Test Cases"><a href="test_structure_chapter.html#id78750">Skipping Test Cases</a></li>
<li title="Definition of Terms"><a href="test_structure_chapter.html#id78829">Definition of Terms</a></li>
</ul>
</li>
<li id="no" title="Examples and Templates" expanded="false">Examples and Templates<ul>
<li><a href="example_chapter.html">
              Top of chapter
            </a></li>
<li title="Test Suite Example"><a href="example_chapter.html#id79140">Test Suite Example</a></li>
<li title="Test Suite Templates"><a href="example_chapter.html#id79193">Test Suite Templates</a></li>
</ul>
</li>
<li id="loadscrollpos" title="Running Tests and Analyzing Results" expanded="true">Running Tests and Analyzing Results<ul>
<li><a href="run_test_chapter.html">
              Top of chapter
            </a></li>
<li title="Using the Common Test Framework"><a href="run_test_chapter.html#id79388">Using the Common Test Framework</a></li>
<li title="Automatic Compilation of Test Suites and Help Modules"><a href="run_test_chapter.html#id79431">Automatic Compilation of Test Suites and Help Modules</a></li>
<li title="Running Tests from the OS Command Line"><a href="run_test_chapter.html#id79625">Running Tests from the OS Command Line</a></li>
<li title="Running Tests from the Erlang Shell or from an Erlang Program"><a href="run_test_chapter.html#id80316">Running Tests from the Erlang Shell or from an Erlang Program</a></li>
<li title="Test Case Group Execution"><a href="run_test_chapter.html#id80492">Test Case Group Execution</a></li>
<li title="Running the Interactive Shell Mode"><a href="run_test_chapter.html#id80998">Running the Interactive Shell Mode</a></li>
<li title="Step-by-Step Execution of Test Cases with the Erlang Debugger"><a href="run_test_chapter.html#id81221">Step-by-Step Execution of Test Cases with the Erlang Debugger</a></li>
<li title="Test Specifications"><a href="run_test_chapter.html#id81349">Test Specifications</a></li>
<li title="Running Tests from the Web-Based GUI"><a href="run_test_chapter.html#id82334">Running Tests from the Web-Based GUI</a></li>
<li title="Log Files"><a href="run_test_chapter.html#id82446">Log Files</a></li>
<li title="HTML Style Sheets"><a href="run_test_chapter.html#id82918">HTML Style Sheets</a></li>
<li title="Repeating Tests"><a href="run_test_chapter.html#id83096">Repeating Tests</a></li>
<li title="Silent Connections"><a href="run_test_chapter.html#id83461">Silent Connections</a></li>
</ul>
</li>
<li id="no" title="External Configuration Data" expanded="false">External Configuration Data<ul>
<li><a href="config_file_chapter.html">
              Top of chapter
            </a></li>
<li title="General"><a href="config_file_chapter.html#id83697">General</a></li>
<li title="Syntax"><a href="config_file_chapter.html#id83740">Syntax</a></li>
<li title="Requiring and Reading Configuration Data"><a href="config_file_chapter.html#id83763">Requiring and Reading Configuration Data</a></li>
<li title="Using Configuration Variables Defined in Multiple Files"><a href="config_file_chapter.html#id83896">Using Configuration Variables Defined in Multiple Files</a></li>
<li title="Encrypted Configuration Files"><a href="config_file_chapter.html#id83920">Encrypted Configuration Files</a></li>
<li title="Opening Connections Using Configuration Data"><a href="config_file_chapter.html#id83984">Opening Connections Using Configuration Data</a></li>
<li title="User-Specific Configuration Data Formats"><a href="config_file_chapter.html#id84055">User-Specific Configuration Data Formats</a></li>
<li title="Examples of Configuration Data Handling"><a href="config_file_chapter.html#id84272">Examples of Configuration Data Handling</a></li>
<li title="Example of User-Specific Configuration Handler"><a href="config_file_chapter.html#id84327">Example of User-Specific Configuration Handler</a></li>
</ul>
</li>
<li id="no" title="Code Coverage Analysis" expanded="false">Code Coverage Analysis<ul>
<li><a href="cover_chapter.html">
              Top of chapter
            </a></li>
<li title="General"><a href="cover_chapter.html#id84454">General</a></li>
<li title="Use"><a href="cover_chapter.html#id84488">Use</a></li>
<li title="Stopping the Cover Tool When Tests Are Completed"><a href="cover_chapter.html#id84603">Stopping the Cover Tool When Tests Are Completed</a></li>
<li title="The Cover Specification File"><a href="cover_chapter.html#id84664">The Cover Specification File</a></li>
<li title="Cross Cover Analysis"><a href="cover_chapter.html#id84727">Cross Cover Analysis</a></li>
<li title="Logging"><a href="cover_chapter.html#id84955">Logging</a></li>
</ul>
</li>
<li id="no" title="Using Common Test for Large-Scale Testing" expanded="false">Using Common Test for Large-Scale Testing<ul>
<li><a href="ct_master_chapter.html">
              Top of chapter
            </a></li>
<li title="General"><a href="ct_master_chapter.html#id85043">General</a></li>
<li title="Use"><a href="ct_master_chapter.html#id85121">Use</a></li>
<li title="Test Specifications"><a href="ct_master_chapter.html#id85314">Test Specifications</a></li>
<li title="Automatic Startup of Test Target Nodes"><a href="ct_master_chapter.html#id85564">Automatic Startup of Test Target Nodes</a></li>
</ul>
</li>
<li id="no" title="Event Handling" expanded="false">Event Handling<ul>
<li><a href="event_handler_chapter.html">
              Top of chapter
            </a></li>
<li title="General"><a href="event_handler_chapter.html#id85775">General</a></li>
<li title="Use"><a href="event_handler_chapter.html#id85916">Use</a></li>
</ul>
</li>
<li id="no" title="Dependencies between Test Cases and Suites" expanded="false">Dependencies between Test Cases and Suites<ul>
<li><a href="dependencies_chapter.html">
              Top of chapter
            </a></li>
<li title="General"><a href="dependencies_chapter.html#id87034">General</a></li>
<li title="Saving Configuration Data"><a href="dependencies_chapter.html#id87172">Saving Configuration Data</a></li>
<li title="Sequences"><a href="dependencies_chapter.html#id87345">Sequences</a></li>
</ul>
</li>
<li id="no" title="Common Test Hooks" expanded="false">Common Test Hooks<ul>
<li><a href="ct_hooks_chapter.html">
              Top of chapter
            </a></li>
<li title="General"><a href="ct_hooks_chapter.html#id87551">General</a></li>
<li title="Installing a CTH"><a href="ct_hooks_chapter.html#id87612">Installing a CTH</a></li>
<li title="CTH Scope"><a href="ct_hooks_chapter.html#id87794">CTH Scope</a></li>
<li title="Manipulating Tests"><a href="ct_hooks_chapter.html#id88155">Manipulating Tests</a></li>
<li title="Synchronizing External User Applications with Common Test"><a href="ct_hooks_chapter.html#id88539">Synchronizing External User Applications with Common Test</a></li>
<li title="Example CTH"><a href="ct_hooks_chapter.html#id88615">Example CTH</a></li>
<li title="Built-In CTHs"><a href="ct_hooks_chapter.html#id88674">Built-In CTHs</a></li>
</ul>
</li>
<li id="no" title="Some Thoughts about Testing" expanded="false">Some Thoughts about Testing<ul>
<li><a href="why_test_chapter.html">
              Top of chapter
            </a></li>
<li title="Goals"><a href="why_test_chapter.html#id88865">Goals</a></li>
<li title="What to Test"><a href="why_test_chapter.html#id88885">What to Test</a></li>
</ul>
</li>
</ul>
</div></div>
<div id="content">
<div class="innertube">
<h1>8 Running Tests and Analyzing Results</h1>
  

  <h3><a name="id79388">8.1 
        Using the Common Test Framework</a></h3>
    

    <p>The <span class="code">Common Test</span> framework provides a high-level
    operator interface for testing, providing the following features:</p>

    <ul>
	<li>Automatic compilation of test suites (and help modules)</li>
	<li>Creation of extra HTML pages for improved overview.</li>
	<li>Single-command interface for running all available tests</li>
	<li>Handling of configuration files specifying data related to
	  the System Under Test (SUT) (and any other variable data)</li>
	<li>Mode for running multiple independent test sessions in parallel with
	  central control and configuration</li>	
      </ul>
  

  <h3><a name="id79431">8.2 
        Automatic Compilation of Test Suites and Help Modules</a></h3>
    
    <p>When <span class="code">Common Test</span> starts, it automatically attempts to compile any
      suites included in the specified tests. If particular
      suites are specified, only those suites are compiled. If a
      particular test object directory is specified (meaning all suites
      in this directory are to be part of the test), <span class="code">Common Test</span> runs
      function <span class="code">make:all/1</span> in the directory to compile the suites.</p>

    <p>If compilation fails for one or more suites, the compilation errors
      are printed to tty and the operator is asked if the test run is to proceed
      without the missing suites, or be aborted. If the operator chooses to proceed, 
      the tests having missing suites are noted in the HTML log. If <span class="code">Common Test</span> is
      unable to prompt the user after compilation failure (if <span class="code">Common Test</span> does not
      control <span class="code">stdin</span>), the test run proceeds automatically without the missing
      suites. This behavior can however be modified with the
      <span class="code">ct_run</span> flag <span class="code">-abort_if_missing_suites</span>, 
      or the <span class="bold_code"><a href="../../man/ct.html#run_test-1"><span class="code">ct:run_test/1</span></a></span> option
      <span class="code">{abort_if_missing_suites,TrueOrFalse}</span>. If 
      <span class="code">abort_if_missing_suites</span> is set to <span class="code">true</span>, the test run
      stops immediately if some suites fail to compile.</p>

    <p>Any help module (that is, regular Erlang module with name not ending with
      "_SUITE") that resides in the same test object directory as a suite, 
      which is part of the test, is also automatically compiled. A help
      module is not mistaken for a test suite (unless it has a "_SUITE" name).
      All help modules in a particular test object directory
      are compiled, no matter if all or only particular suites in the directory 
      are part of the test.</p>

    <p>If test suites or help modules include header files stored in other
      locations than the test directory, these include directories can be specified
      by using flag <span class="code">-include</span> with 
      <span class="bold_code"><a href="../../man/ct_run.html"><span class="code">ct_run</span></a></span>, 
      or option <span class="code">include</span> with <span class="code">ct:run_test/1</span>.
      Also, an include path can be specified with an OS
      environment variable, <span class="code">CT_INCLUDE_PATH</span>.</p>
      <p><strong>Example (bash):</strong></p>

    <p><span class="code">$ export CT_INCLUDE_PATH=~testuser/common_suite_files/include:~testuser/common_lib_files/include</span></p>

    <p><span class="code">Common Test</span> passes all include directories (specified either with flag/option
      <span class="code">include</span>, or variable <span class="code">CT_INCLUDE_PATH</span>
      , or both, to the compiler.</p>

    <p>Include directories can also be specified in test specifications,
      see <span class="bold_code"><a href="#test_specifications">Test Specifications</a></span>.</p>

    <p>If the user wants to run all test suites for a test object (or an OTP application)
      by specifying only the top directory (for example, with start flag/option <span class="code">dir</span>),
      <span class="code">Common Test</span> primarily looks for test suite modules in a subdirectory named 
      <span class="code">test</span>. If this subdirectory does not exist, the specified top directory
      is assumed to be the test directory, and test suites are read from
      there instead.</p>

    <p>To disable the automatic compilation feature, use flag
      <span class="code">-no_auto_compile</span> with <span class="code">ct_run</span>, or
      option <span class="code">{auto_compile,false}</span> with 
      <span class="code">ct:run_test/1</span>. With automatic compilation
      disabled, the user is responsible for compiling the test suite modules 
      (and any help modules) before the test run. If the modules cannot be loaded
      from the local file system during startup of <span class="code">Common Test</span>, the user must
      preload the modules before starting the test. <span class="code">Common Test</span> only verifies
      that the specified test suites exist (that is, that they are, or can be, loaded).
      This is useful, for example, if the test suites are transferred and loaded as 
      binaries through RPC from a remote node.</p>
  

  <h3>
<a name="ct_run"></a><a name="id79625">8.3 
        Running Tests from the OS Command Line</a>
</h3>
  
    
    
    <p>The <span class="bold_code"><a href="../../man/ct_run.html"><span class="code">ct_run</span></a></span> program can be used 
       for running tests from the OS command line, for example, as follows:
    </p>
    <ul>
      <li><span class="code">ct_run -config &lt;configfilenames&gt; -dir &lt;dirs&gt;</span></li>
      <li>
<span class="code">ct_run -config &lt;configfilenames&gt; -suite &lt;suiteswithfullpath&gt;</span>
      </li>
      <li>
<span class="code">ct_run -userconfig &lt;callbackmodulename&gt; &lt;configfilenames&gt; -suite &lt;suiteswithfullpath&gt;</span>
      </li>
      <li><span class="code">ct_run -config &lt;configfilenames&gt; -suite &lt;suitewithfullpath&gt;
	      -group &lt;groups&gt; -case &lt;casenames&gt;</span></li>
    </ul>
    <p><strong>Examples:</strong></p>
    <div class="example"><pre>
 $ ct_run -config $CFGS/sys1.cfg $CFGS/sys2.cfg -dir $SYS1_TEST $SYS2_TEST
 $ ct_run -userconfig ct_config_xml $CFGS/sys1.xml $CFGS/sys2.xml -dir $SYS1_TEST $SYS2_TEST
 $ ct_run -suite $SYS1_TEST/setup_SUITE $SYS2_TEST/config_SUITE
 $ ct_run -suite $SYS1_TEST/setup_SUITE -case start stop
 $ ct_run -suite $SYS1_TEST/setup_SUITE -group installation -case start stop</pre></div>
    
    <p>The flags <span class="code">dir</span>, <span class="code">suite</span>, and <span class="code">group/case</span> can be combined.
    For example, to run <span class="code">x_SUITE</span> and <span class="code">y_SUITE</span> 
    in directory <span class="code">testdir</span>, as follows:</p>
    <div class="example"><pre>
 $ ct_run -dir ./testdir -suite x_SUITE y_SUITE</pre></div>

    <p>This has the same effect as the following:</p>
    <div class="example"><pre>
 $ ct_run -suite ./testdir/x_SUITE ./testdir/y_SUITE</pre></div>

    <p>For details, see 
    <span class="bold_code"><a href="run_test_chapter.html#group_execution">Test Case Group Execution</a></span>.</p>

    <p>The following flags can also be used with 
    <span class="bold_code"><a href="../../man/ct_run.html"><span class="code">ct_run</span></a></span>:</p>
    <dl>
      <dt><strong><span class="code">-help</span></strong></dt>
      <dd><p>Lists all available start flags.</p></dd>

      <dt><strong><span class="code">-logdir &lt;dir&gt;</span></strong></dt>
      <dd><p>Specifies where the HTML log files are to be written.</p></dd>

      <dt><strong><span class="code">-label &lt;name_of_test_run&gt;</span></strong></dt>
      <dd><p>Associates the test run with a name that gets printed
	in the overview HTML log files.</p></dd>

      <dt><strong><span class="code">-refresh_logs</span></strong></dt>
      <dd><p>Refreshes the top-level HTML index files.</p></dd>

      <dt><strong><span class="code">-vts</span></strong></dt>
      <dd><p>Starts web-based GUI (described later).</p></dd>

      <dt><strong><span class="code">-shell</span></strong></dt>
      <dd><p>Starts interactive shell mode (described later).</p></dd>

      <dt><strong><span class="code">-step [step_opts]</span></strong></dt>
      <dd><p>Steps through test cases using the Erlang Debugger (described later).</p></dd>

      <dt><strong><span class="code">-spec &lt;testspecs&gt;</span></strong></dt>
      <dd><p>Uses test specification as input (described later).</p></dd>

      <dt><strong><span class="code">-allow_user_terms</span></strong></dt>
      <dd><p>Allows user-specific terms in a test specification (described later).</p></dd>

      <dt><strong><span class="code">-silent_connections [conn_types]</span></strong></dt>
      <dd><p>, tells <span class="code">Common Test</span> to suppress printouts for
        specified connections (described later).</p></dd>

      <dt><strong><span class="code">-stylesheet &lt;css_file&gt;</span></strong></dt>
      <dd><p>Points out a user HTML style sheet (described later).</p></dd>

      <dt><strong><span class="code">-cover &lt;cover_cfg_file&gt;</span></strong></dt>
      <dd><p>To perform code coverage test (see 
	<span class="bold_code"><a href="cover_chapter.html#cover">Code Coverage Analysis</a></span>).</p></dd>

      <dt><strong><span class="code">-cover_stop &lt;bool&gt;</span></strong></dt>
      <dd><p>To specify if the <span class="code">cover</span> tool is to be stopped 
      after the test is completed (see
	<span class="bold_code"><a href="cover_chapter.html#cover_stop">Code Coverage Analysis</a></span>).</p></dd>

      <dt><strong><span class="code">-event_handler &lt;event_handlers&gt;</span></strong></dt>
      <dd><p>To install 
        <span class="bold_code"><a href="event_handler_chapter.html#event_handling">event handlers</a></span>.</p></dd>

      <dt><strong><span class="code">-event_handler_init &lt;event_handlers&gt;</span></strong></dt>
      <dd><p>To install
        <span class="bold_code"><a href="event_handler_chapter.html#event_handling">event handlers</a></span> 
      including start arguments.</p></dd>

      <dt><strong><span class="code">-ct_hooks &lt;ct_hooks&gt;</span></strong></dt>
      <dd><p>To install
        <span class="bold_code"><a href="ct_hooks_chapter.html#installing">Common Test Hooks</a></span> 
      including start arguments.</p></dd>

      <dt><strong><span class="code">-enable_builtin_hooks &lt;bool&gt;</span></strong></dt>
      <dd><p>To enable or disable
        <span class="bold_code"><a href="ct_hooks_chapter.html#builtin_cths">Built-in Common Test Hooks</a></span>. 
      Default is <span class="code">true</span>.</p></dd>

      <dt><strong><span class="code">-include</span></strong></dt>
      <dd><p>Specifies include directories (described earlier).</p></dd>

      <dt><strong><span class="code">-no_auto_compile</span></strong></dt>
      <dd><p>Disables the automatic test suite compilation feature (described earlier).</p></dd>

      <dt><strong><span class="code">-abort_if_missing_suites</span></strong></dt>
      <dd><p>Aborts the test run if one or more suites fail to compile (described earlier).</p></dd>

      <dt><strong><span class="code">-multiply_timetraps &lt;n&gt;</span></strong></dt>
      <dd><p>Extends <span class="bold_code"><a href="write_test_chapter.html#timetraps">timetrap time-out</a></span> values.</p></dd>

      <dt><strong><span class="code">-scale_timetraps &lt;bool&gt;</span></strong></dt>	  
      <dd><p>Enables automatic <span class="bold_code"><a href="write_test_chapter.html#timetraps">timetrap time-out</a></span> scaling.</p></dd>

      <dt><strong><span class="code">-repeat &lt;n&gt;</span></strong></dt>
      <dd><p>Tells <span class="code">Common Test</span> to repeat the tests <span class="code">n</span> times (described later).</p></dd> 

      <dt><strong><span class="code">-duration &lt;time&gt;</span></strong></dt>
      <dd><p>Tells <span class="code">Common Test</span> to repeat the tests for duration of time (described later).</p></dd> 

      <dt><strong><span class="code">-until &lt;stop_time&gt;</span></strong></dt>
      <dd><p>Tells <span class="code">Common Test</span> to repeat the tests until <span class="code">stop_time</span> (described later).</p></dd>

      <dt><strong><span class="code">-force_stop [skip_rest]</span></strong></dt>
      <dd><p>On time-out, the test run is aborted when the current test job is finished. If <span class="code">skip_rest</span> 
      is provided, the remaining test cases in the current test job are skipped (described later).</p></dd>

      <dt><strong><span class="code">-decrypt_key &lt;key&gt;</span></strong></dt>
      <dd><p>Provides a decryption key for 
      <span class="bold_code"><a href="config_file_chapter.html#encrypted_config_files">encrypted configuration files</a></span>.</p></dd>

      <dt><strong><span class="code">-decrypt_file &lt;key_file&gt;</span></strong></dt>
      <dd><p>Points out a file containing a decryption key for 
        <span class="bold_code"><a href="config_file_chapter.html#encrypted_config_files">encrypted configuration files</a></span>.</p></dd>

      <dt><strong><span class="code">-basic_html</span></strong></dt>
      <dd><p>Switches off HTML enhancements that can be incompatible with older browsers.</p></dd>

      <dt><strong><span class="code">-logopts &lt;opts&gt;</span></strong></dt>
      <dd><p>Enables modification of the logging behavior, see
      <span class="bold_code"><a href="run_test_chapter.html#logopts">Log options</a></span>.</p></dd>

      <dt><strong><span class="code">-verbosity &lt;levels&gt;</span></strong></dt>
      <dd><p>Sets <span class="bold_code"><a href="write_test_chapter.html#logging">verbosity levels for printouts</a></span>.</p></dd>

      <dt><strong><span class="code">-no_esc_chars</span></strong></dt>
      <dd><p>Disables automatic escaping of special HTML characters.
      See the <span class="bold_code"><a href="write_test_chapter.html#logging">Logging chapter</a></span>.</p></dd>
    </dl>

    <div class="note">
<div class="label">Note</div>
<div class="content"><p><p>Directories passed to <span class="code">Common Test</span> can have either relative or absolute paths.</p></p></div>
</div>

    <div class="note">
<div class="label">Note</div>
<div class="content"><p><p>Any start flags to the Erlang runtime system (application ERTS) can also be passed as
             parameters to <span class="code">ct_run</span>. It is, for example, useful to be able to
	     pass directories to be added to the Erlang code server search path
	     with flag <span class="code">-pa</span> or <span class="code">-pz</span>. If you have common help- or library 
	     modules for test suites (separately compiled), stored in other directories 
	     than the test suite directories, these <span class="code">help/lib</span> directories are preferably
	     added to the code path this way.</p>
	     <p><strong>Example:</strong></p>
	  <p><span class="code">$ ct_run -dir ./chat_server -logdir ./chat_server/testlogs -pa $PWD/chat_server/ebin</span></p>
	  <p>The absolute path of directory <span class="code">chat_server/ebin</span>
	     is here passed to the code server. This is essential because relative
	     paths are stored by the code server as relative, and <span class="code">Common Test</span> changes 
	     the current working directory of ERTS during the test run.</p>
    </p></div>
</div>
    
    <p>The <span class="code">ct_run</span> program sets the exit status before shutting down. The following values
      are defined:</p>
    <ul>
      <li>
<span class="code">0</span> indicates a successful testrun, that is, without failed or auto-skipped test cases.</li>
      <li>
<span class="code">1</span> indicates that one or more test cases have failed, or have been auto-skipped.</li>
      <li>
<span class="code">2</span> indicates that the test execution has failed because of, for example, compilation errors, or an
	illegal return value from an information function.</li>
    </ul>
    <p>If auto-skipped test cases do not affect the exit status. The default
      behavior can be changed using start flag:</p>
    <div class="example"><pre>
 -exit_status ignore_config</pre></div>
    
    <div class="note">
<div class="label">Note</div>
<div class="content"><p><p>Executing <span class="code">ct_run</span> without start flags is equal to the command:
    <span class="code">ct_run -dir ./</span></p></p></div>
</div>

    <p>For more information about the <span class="code">ct_run</span> program, see module
      <span class="bold_code"><a href="../../man/ct_run.html"><span class="code">ct_run</span></a></span> and section
      <span class="bold_code"><a href="install_chapter.html#general">Installation</a></span>.
    </p>
  
    
  <h3>
<a name="erlang_shell_or_program"></a><a name="id80316">8.4 
        Running Tests from the Erlang Shell or from an Erlang Program</a>
</h3>
    
    
    
    <p><span class="code">Common Test</span> provides an Erlang API for running tests. The main 
      (and most flexible) function for specifying and executing tests is
      <span class="bold_code"><a href="../../man/ct.html#run_test-1"><span class="code">ct:run_test/1</span></a></span>.
      It takes the same start parameters as
      <span class="bold_code"><a href="run_test_chapter.html#ct_run"><span class="code">ct_run</span></a></span>,
      but the flags are instead specified as options in a list of key-value tuples. 
      For example, a test specified with <span class="code">ct_run</span> as follows:</p>

      <p><span class="code">$ ct_run -suite ./my_SUITE -logdir ./results</span></p> 
      <p>is with <span class="bold_code"><a href="../../man/ct.html#run_test-1"><span class="code">ct:run_test/1</span></a></span> specified as:</p>
      <p><span class="code">1&gt; ct:run_test([{suite,"./my_SUITE"},{logdir,"./results"}]).</span></p>

      <p>The function returns the test result, represented by the tuple
	<span class="code">{Ok,Failed,{UserSkipped,AutoSkipped}}</span>, where each element is an
	integer. If test execution fails, the function returns the tuple
	<span class="code">{error,Reason}</span>, where the term <span class="code">Reason</span> explains the
	failure.</p>

      <p>The default start option <span class="code">{dir,Cwd}</span> (to run all suites in the current
      working directory) is used if the function is called with an empty
      list of options.</p>

	<h4>Releasing the Erlang Shell</h4>
	  
	  <p>During execution of tests started with
	  <span class="bold_code"><a href="../../man/ct.html#run_test-1"><span class="code">ct:run_test/1</span></a></span>,
	  the Erlang shell process, controlling <span class="code">stdin</span>, remains the top-level
	  process of the <span class="code">Common Test</span> system of processes. Consequently,
	  the Erlang shell is not available for interaction during
	  the test run. If this is not desirable, for example, because the shell 
	  is needed for debugging purposes or for interaction with the SUT during test
	  execution, set start option <span class="code">release_shell</span> to
	  <span class="code">true</span> (in the call to <span class="code">ct:run_test/1</span> or by
	  using the corresponding test specification term, described later). This
	  makes <span class="code">Common Test</span> release the shell immediately after the test suite
	  compilation stage. To accomplish this, a test runner process
	  is spawned to take control of the test execution. The effect is that
	  <span class="code">ct:run_test/1</span> returns the pid of this process rather than the
	  test result, which instead is printed to tty at the end of the test run.</p>
	  <div class="note">
<div class="label">Note</div>
<div class="content"><p><p>To use the functions
	  <span class="bold_code"><a href="../../man/ct.html#break-1"><span class="code">ct:break/1,2</span></a></span> and
	  <span class="bold_code"><a href="../../man/ct.html#continue-0"><span class="code">ct:continue/0,1</span></a></span>,
	  <span class="code">release_shell</span> <strong>must</strong> be set to <span class="code">true</span>.</p></p></div>
</div>
	
        
      <p>For details, see
        <span class="bold_code"><a href="../../man/ct.html#run_test-1"><span class="code">ct:run_test/1</span></a></span> manual page.</p>    
  
  
   <h3>
<a name="group_execution"></a><a name="id80492">8.5 
        Test Case Group Execution</a>
</h3>
    
    
    
    <p>With the <span class="code">ct_run</span> flag, or <span class="code">ct:run_test/1</span> option <span class="code">group</span>,
    one or more test case groups can be specified, optionally in combination
    with specific test cases. The syntax for specifying groups on the command line
    is as follows:</p>

    <div class="example"><pre>
 $ ct_run -group &lt;group_names_or_paths&gt; [-case &lt;cases&gt;]</pre></div>
    <p>The syntax in the Erlang shell is as follows:</p>
    <div class="example"><pre>
 1&gt; ct:run_test([{group,GroupsNamesOrPaths}, {case,Cases}]).</pre></div>
    
    <p>Parameter <span class="code">group_names_or_paths</span> specifies one
    or more group names and/or one or more group paths. At startup,
    <span class="code">Common Test</span> searches for matching groups in the group definitions
    tree (that is, the list returned from <span class="code">Suite:groups/0</span>; for details, see section
    <span class="bold_code"><a href="write_test_chapter.html#test_case_groups">Test Case Groups</a></span>.
    </p>

    <p>Given a group name, say <span class="code">g</span>, <span class="code">Common Test</span> searches for all paths
    leading to <span class="code">g</span>. By path is meant a sequence of nested groups,
    which must be followed to get from the top-level
    group to <span class="code">g</span>. To execute the test cases in group <span class="code">g</span>, 
    <span class="code">Common Test</span> must call the <span class="code">init_per_group/2</span> function for 
    each group in the path to <span class="code">g</span>, and all corresponding <span class="code">end_per_group/2</span>
    functions afterwards. This is because the configuration
    of a test case in <span class="code">g</span> (and its <span class="code">Config</span> input data) depends on
    <span class="code">init_per_testcase(TestCase, Config)</span> and its return value, which
    in turn depends on <span class="code">init_per_group(g, Config)</span> and its return value,
    which in turn depends on <span class="code">init_per_group/2</span> of the group above
    <span class="code">g</span>, and so on, all the way up to the top-level group.</p>

    <p>This means that if there is more than one way to locate a group 
    (and its test cases) in a path, the result of the group search operation 
    is a number of tests, all of which are to be performed.
    <span class="code">Common Test</span> interprets a group specification that consists of a
    single name as follows:</p>

    <p>"Search and find all paths in the group definitions tree that lead
    to the specified group and, for each path, create a test that does the following, 
    in order:</p>
    <ul>
      <li>Executes all configuration functions in the path to the specified group.</li>
      <li>Executes all, or all matching, test cases in this group.</li>
      <li>Executes all, or all matching, test cases in all subgroups of the group."</li>
    </ul>
    
    <p>The user can specify a specific group path with
    parameter <span class="code">group_names_or_paths</span>. With this type of specification
    execution of unwanted groups (in otherwise matching paths),
    and/or the execution of subgroups can be avoided. The command line syntax of the 
    group path is a list of group names in the path, for example:
    </p>
    <p><span class="code">$ ct_run -suite "./x_SUITE" -group [g1,g3,g4] -case tc1 tc5</span></p>
    <p>The syntax in the Erlang shell is as follows (requires a list within the groups list):</p>
    <p><span class="code">1&gt; ct:run_test([{suite,"./x_SUITE"}, {group,[[g1,g3,g4]]}, {testcase,[tc1,tc5]}]).</span></p>
    
    <p>The last group in the specified path is the terminating group in
    the test, that is, no subgroups following this group are executed. In the
    previous example, <span class="code">g4</span> is the terminating group. Hence, <span class="code">Common Test</span>
    executes a test that calls all <span class="code">init</span> configuration functions in the path to
    <span class="code">g4</span>, that is, <span class="code">g1..g3..g4</span>. It then calls test cases <span class="code">tc1</span>
    and <span class="code">tc5</span> in <span class="code">g4</span>, and finally all <span class="code">end</span> configuration functions 
    in order <span class="code">g4..g3..g1</span>.</p>
    
    <div class="note">
<div class="label">Note</div>
<div class="content"><p><p>The group path specification does not necessarily
    have to include <strong>all</strong> groups in the path to the terminating group.
    <span class="code">Common Test</span> searches for all matching paths if an incomplete 
    group path is specified.</p></p></div>
</div>
    
    <div class="note">
<div class="label">Note</div>
<div class="content"><p><p>Group names and group paths can be combined with parameter
    <span class="code">group_names_or_paths</span>. Each element is treated as an individual specification 
    in combination with parameter <span class="code">cases</span>.
    The following examples illustrates this.</p></p></div>
</div>   

    <p><strong>Examples:</strong></p>
    <div class="example"><pre>
 -module(x_SUITE).
 ...
 %% The group definitions:      
 groups() -&gt;
   [{top1,[],[tc11,tc12,
	      {sub11,[],[tc12,tc13]},
	      {sub12,[],[tc14,tc15,
			 {sub121,[],[tc12,tc16]}]}]},

    {top2,[],[{group,sub21},{group,sub22}]},
    {sub21,[],[tc21,{group,sub2X2}]},
    {sub22,[],[{group,sub221},tc21,tc22,{group,sub2X2}]},
    {sub221,[],[tc21,tc23]},
    {sub2X2,[],[tc21,tc24]}].</pre></div>

    <p>The following executes two tests, one for all cases and all subgroups 
    under <span class="code">top1</span>, and one for all under <span class="code">top2</span>:</p>
    <div class="example"><pre>
 $ ct_run -suite "x_SUITE" -group all
 1&gt; ct:run_test([{suite,"x_SUITE"}, {group,all}]).</pre></div>
    <p>Using <span class="code">-group top1 top2</span>, or <span class="code">{group,[top1,top2]}</span> gives the same result.</p>

    <p>The following executes one test for all cases and subgroups under <span class="code">top1</span>:</p>
    <div class="example"><pre>
 $ ct_run -suite "x_SUITE" -group top1
 1&gt; ct:run_test([{suite,"x_SUITE"}, {group,[top1]}]).</pre></div>

    <p>The following runs a test executing <span class="code">tc12</span> in <span class="code">top1</span> and any subgroup
    under <span class="code">top1</span> where it can be found (<span class="code">sub11</span> and <span class="code">sub121</span>):</p>
    <div class="example"><pre>
 $ ct_run -suite "x_SUITE" -group top1 -case tc12
 1&gt; ct:run_test([{suite,"x_SUITE"}, {group,[top1]}, {testcase,[tc12]}]).</pre></div>

    <p>The following executes <span class="code">tc12</span> <strong>only</strong> in group <span class="code">top1</span>:</p>
    <div class="example"><pre>
 $ ct_run -suite "x_SUITE" -group [top1] -case tc12
 1&gt; ct:run_test([{suite,"x_SUITE"}, {group,[[top1]]}, {testcase,[tc12]}]).</pre></div>
    
    <p>The following searches <span class="code">top1</span> and all its subgroups for <span class="code">tc16</span> resulting
    in that this test case executes in group <span class="code">sub121</span>:</p>
    <div class="example"><pre>
 $ ct_run -suite "x_SUITE" -group top1 -case tc16
 1&gt; ct:run_test([{suite,"x_SUITE"}, {group,[top1]}, {testcase,[tc16]}]).</pre></div>
    <p>Using the specific path <span class="code">-group [sub121]</span> or <span class="code">{group,[[sub121]]}</span> gives
    the same result in this example.</p>

    <p>The following executes two tests, one including all cases and subgroups under
    <span class="code">sub12</span>, and one with <strong>only</strong> the test cases in <span class="code">sub12</span>:</p>
    <div class="example"><pre>
 $ ct_run -suite "x_SUITE" -group sub12 [sub12]
 1&gt; ct:run_test([{suite,"x_SUITE"}, {group,[sub12,[sub12]]}]).</pre></div>

    <p>In the following example, <span class="code">Common Test</span> finds and executes two tests, 
    one for the path from <span class="code">top2</span> to <span class="code">sub2X2</span> through <span class="code">sub21</span>, 
    and one from <span class="code">top2</span> to <span class="code">sub2X2</span> through <span class="code">sub22</span>:</p>
    <div class="example"><pre>
 $ ct_run -suite "x_SUITE" -group sub2X2
 1&gt; ct:run_test([{suite,"x_SUITE"}, {group,[sub2X2]}]).</pre></div>

    <p>In the following example, by specifying the unique path <span class="code">top2 -&gt; sub21 -&gt; sub2X2</span>, 
    only one test is executed. The second possible path, from <span class="code">top2</span> to <span class="code">sub2X2</span> 
    (from the former example) is discarded:</p>
    <div class="example"><pre>
 $ ct_run -suite "x_SUITE" -group [sub21,sub2X2]
 1&gt; ct:run_test([{suite,"x_SUITE"}, {group,[[sub21,sub2X2]]}]).</pre></div>

    <p>The following executes only the test cases for <span class="code">sub22</span> and in reverse order 
    compared to the group definition:</p>
    <div class="example"><pre>
 $ ct_run -suite "x_SUITE" -group [sub22] -case tc22 tc21
 1&gt; ct:run_test([{suite,"x_SUITE"}, {group,[[sub22]]}, {testcase,[tc22,tc21]}]).</pre></div>

    <p>If a test case belonging to a group (according to the group definition) is executed
    without a group specification, that is, simply by
    (using the command line):</p>
    <p><span class="code">$ ct_run -suite "my_SUITE" -case my_tc</span></p>
    <p>or (using the Erlang shell):</p>
    <p><span class="code">1&gt; ct:run_test([{suite,"my_SUITE"}, {testcase,my_tc}]).</span></p>
    <p>then <span class="code">Common Test</span> ignores the group definition and executes the test case 
    in the scope of the test suite only (no group configuration functions are called).</p>

    <p>The group specification feature, as presented in this section, can also
    be used in <span class="bold_code"><a href="run_test_chapter.html#test_specifications">Test Specifications</a></span> (with some extra features added).</p>
   
      

  <h3><a name="id80998">8.6 
        Running the Interactive Shell Mode</a></h3>
    
    
    <p>You can start <span class="code">Common Test</span> in an interactive shell mode where no
      automatic testing is performed. Instead, <span class="code">Common Test</span>
      starts its utility processes, installs configuration data (if any),
      and waits for the user to call functions (typically test case support
      functions) from the Erlang shell.</p>

    <p>The shell mode is useful, for example, for debugging test suites, analyzing
      and debugging the SUT during "simulated" test case execution, and 
      trying out various operations during test suite development.</p>

    <p>To start the interactive shell mode, start an Erlang shell 
      manually and call <span class="bold_code"><a href="../../man/ct.html#install-1"><span class="code">ct:install/1</span></a></span> 
      to install any configuration data you might need (use <span class="code">[]</span> as argument otherwise). 
      Then call <span class="bold_code"><a href="../../man/ct.html#start_interactive-0"><span class="code">ct:start_interactive/0</span></a></span> 
      to start <span class="code">Common Test</span>.</p>
      
      <p>If you use the <span class="code">ct_run</span> program, you can start 
      the Erlang shell and <span class="code">Common Test</span> in one go by using the flag <span class="code">-shell</span> and, 
      optionally, flag <span class="code">-config</span> and/or <span class="code">-userconfig</span>.</p>
      <p><strong>Examples:</strong></p>
    <ul>
      <li><span class="code">ct_run -shell</span></li>
      <li><span class="code">ct_run -shell -config cfg/db.cfg</span></li>
      <li><span class="code">ct_run -shell -userconfig db_login testuser x523qZ</span></li>
    </ul>
    
    <p>If no configuration file is specified with command <span class="code">ct_run</span>,
      a warning is displayed. If <span class="code">Common Test</span> has been run from the same
      directory earlier, the same configuration file(s) are used again. If <span class="code">Common Test</span> 
      has not been run from this directory before, no configuration files are available.</p>
    
    <p>If any functions using "required configuration data" (for example, functions 
      <span class="code">ct_telnet</span> or <span class="code">ct_ftp</span>) are to be called from the Erlang shell, first require 
      configuration data with <span class="bold_code"><a href="../../man/ct.html#require-1"><span class="code">ct:require/1,2</span></a></span>. This is equivalent to a <span class="code">require</span> statement 
      in the <span class="bold_code"><a href="write_test_chapter.html#suite">Test Suite Information Function</a></span> 
      or in the <span class="bold_code"><a href="write_test_chapter.html#info_function">Test Case Information Function</a></span>.</p>
      
    <p><strong>Example:</strong></p>
    <div class="example"><pre> 
 1&gt; ct:require(unix_telnet, unix).
 ok
 2&gt; ct_telnet:open(unix_telnet).
 {ok,&lt;0.105.0&gt;}
 4&gt; ct_telnet:cmd(unix_telnet, "ls .").
 {ok,["ls .","file1  ...",...]}</pre></div>
    
    <p>Everything that <span class="code">Common Test</span> normally prints in the test case logs,
      are in the interactive mode written to a log named <span class="code">ctlog.html</span> 
      in directory  <span class="code">ct_run.&lt;timestamp&gt;</span>. A link to this 
      file is available in the file named <span class="code">last_interactive.html</span> in the 
      directory from which you execute <span class="code">ct_run</span>. Specifying a different
      root directory for the logs than the current working directory
      is not supported.</p>
    
    <p>If you wish to exit the interactive mode (for example, to start an automated 
      test run with <span class="bold_code"><a href="../../man/ct.html#run_test-1"><span class="code">ct:run_test/1</span></a></span>), 
      call function
      <span class="bold_code"><a href="../../man/ct.html#stop_interactive-0"><span class="code">ct:stop_interactive/0</span></a></span>. 
      This shuts down the running <span class="code">ct</span> application. Associations between
      configuration names and data created with <span class="code">require</span> are 
      consequently deleted. Function
      <span class="bold_code"><a href="../../man/ct.html#start_interactive-0"><span class="code">ct:start_interactive/0</span></a></span> 
      takes you back into interactive mode, but the previous state is not restored.</p>
  

  <h3><a name="id81221">8.7 
        Step-by-Step Execution of Test Cases with the Erlang Debugger</a></h3>
    
   
    <p>Using <span class="code">ct_run -step [opts]</span>, or by passing option <span class="code">{step,Opts}</span> 
       to <span class="bold_code"><a href="../../man/ct.html#run_test-1"><span class="code">ct:run_test/1</span></a></span>, 
       the following is possible:</p>
       <ul>
       <li>Get the Erlang Debugger started automatically.</li>
       <li>Use its graphical interface to investigate the state of the current test case.</li>
       <li>Execute the test case step-by-step and/or set execution breakpoints.</li>
     </ul>
    <p>If no extra options are specified with flag/option <span class="code">step</span>,
       breakpoints are set automatically on the test cases that
       are to be executed by <span class="code">Common Test</span>, and those functions only. If
       step option <span class="code">config</span> is specified, breakpoints are also initially 
       set on the configuration functions in the suite, that is,
       <span class="code">init_per_suite/1</span>, <span class="code">end_per_suite/1</span>,
       <span class="code">init_per_group/2</span>, <span class="code">end_per_group/2</span>,
       <span class="code">init_per_testcase/2</span> and <span class="code">end_per_testcase/2</span>.</p>
    <p><span class="code">Common Test</span> enables the Debugger auto-attach feature, which means
       that for every new interpreted test case function that starts to execute, 
       a new trace window automatically pops up (as each test 
       case executes on a dedicated Erlang process). Whenever a new test case starts,
       <span class="code">Common Test</span> attempts to close the inactive trace window of the previous 
       test case. However, if you prefer <span class="code">Common Test</span> to leave inactive trace 
       windows, use option <span class="code">keep_inactive</span>.</p>
    <p>The step functionality can be used together with flag/option <span class="code">suite</span> and 
       <span class="code">suite</span> + <span class="code">case/testcase</span>, but not together with <span class="code">dir</span>.</p>       
  

  <h3>
<a name="test_specifications"></a><a name="id81349">8.8 
        Test Specifications</a>
</h3>
  
    
    <h4>General Description</h4>
	
	<p>The most flexible way to specify what to test, is to use a
	test specification, which is a sequence of
	Erlang terms. The terms are normally declared in one or more text files
	(see <span class="bold_code"><a href="../../man/ct.html#run_test-1"><span class="code">ct:run_test/1</span></a></span>), but
	can also be passed to <span class="code">Common Test</span> on the form of a list (see
	<span class="bold_code"><a href="../../man/ct.html#run_testspec-1"><span class="code">ct:run_testspec/1</span></a></span>).
	There are two general types of terms: configuration terms and test
	specification terms.</p>

	<p>With configuration terms it is, for example, possible to do the following:</p>
	<ul>
       <li>Label the test run (similar to <span class="code">ct_run -label</span>).</li>
       <li>Evaluate any expressions before starting the test.</li>
       <li>Import configuration data (similar to <span class="code">ct_run -config/-userconfig</span>).</li>
       <li>Specify the top-level HTML log directory (similar to <span class="code">ct_run -logdir</span>).</li>
       <li>Enable code coverage analysis (similar to <span class="code">ct_run -cover</span>).</li>
       <li>Install <span class="code">Common Test Hooks</span> (similar to <span class="code">ct_run -ch_hooks</span>).</li>
       <li>Install <span class="code">event_handler</span> plugins (similar to <span class="code">ct_run -event_handler</span>).</li>
       <li>Specify include directories to be passed to the compiler for 
       automatic compilation (similar to <span class="code">ct_run -include</span>).</li>
       <li>Disable the auto-compilation feature (similar to <span class="code">ct_run -no_auto_compile</span>).</li>
       <li>Set verbosity levels (similar to <span class="code">ct_run -verbosity</span>).</li>
     </ul>

	<p>Configuration terms can be combined with <span class="code">ct_run</span> start flags
	or <span class="code">ct:run_test/1</span> options. The result is, for some flags/options
	and terms, that the values are merged (for example, configuration files,
	include directories, verbosity levels, and silent connections) and for
	others that the start flags/options override the test specification
	terms (for example, log directory, label, style sheet, and auto-compilation).</p>

	<p>With test specification terms, it is possible to state exactly
	which tests to run and in which order. A test term specifies
	either one or more suites, one or more test case groups (possibly nested),
	or one or more test cases in a group (or in multiple groups) or in a suite.</p>

	<p>Any number of test terms can be declared in sequence.
	<span class="code">Common Test</span> compiles by default the terms into one or more tests 
	to be performed in one resulting test run. A term that
	specifies a set of test cases "swallows" one that only
	specifies a subset of these cases. For example, the result of merging
	one term specifying that all cases in suite S are to be
	executed, with another term specifying only test case X and Y in
	S, is a test of all cases in S. However, if a term specifying
	test case X and Y in S is merged with a term specifying case Z
	in S, the result is a test of X, Y, and Z in S. To disable this
	behavior, that is, to instead perform each test sequentially in a 
	"script-like" manner, set term <span class="code">merge_tests</span> to <span class="code">false</span> 
	in the test specification.</p>

	<p>A test term can also specify one or more test suites, groups,
	or test cases to be skipped. Skipped suites, groups, and cases
	are not executed and show up in the HTML log files as <span class="code">SKIPPED</span>.</p>
    
    <h4>Using Multiple Test Specification Files</h4>
        
	
	<p>When multiple test specification files are specified at startup (either
	with <span class="code">ct_run -spec file1 file2 ...</span> or 
	<span class="code">ct:run_test([{spec, [File1,File2,...]}])</span>), 
	<span class="code">Common Test</span> either executes one test run per specification file, 
	or joins the files and performs all tests within one single test run. 
	The first behavior is the default one. The latter requires that start
	flag/option <span class="code">join_specs</span> is provided, for example,
	<span class="code">run_test -spec ./my_tests1.ts ./my_tests2.ts -join_specs</span>.</p>
	
	<p>Joining a number of specifications, or running them separately, can
	also be accomplished with (and can be combined with) test specification
	file inclusion.</p>
    
    <h4>Test Specification File Inclusion</h4>
      
        <p>With the term <span class="code">specs</span>, a test specification can include 
	other specifications. An included specification can either be joined 
	with the source specification or used to produce a separate test run 
	(as with start flag/option <span class="code">join_specs</span> above).</p>
	<p><strong>Example:</strong></p>

	<div class="example"><pre>
 %% In specification file "a.spec"
 {specs, join, ["b.spec", "c.spec"]}.
 {specs, separate, ["d.spec", "e.spec"]}.
 %% Config and test terms follow
 ...</pre></div>

	<p>In this example, the test terms defined in files "b.spec" and "c.spec"
	are joined with the terms in source specification "a.spec"
	(if any). The inclusion of specifications "d.spec" and
	"e.spec" results in two separate, and independent, test runs
	(one for each included specification).</p>

	<p>Option <span class="code">join</span> does not imply that the test terms
	are merged, only that all tests are executed in one single test run.</p>

	<p>Joined specifications share common configuration settings, such as
	the list of <span class="code">config</span> files or <span class="code">include</span> directories.
	For configurations that cannot be combined, such as settings for <span class="code">logdir</span>
	or <span class="code">verbosity</span>, it is up to the user to ensure there are no clashes
	when the test specifications are joined. Specifications included with
	option <span class="code">separate</span> do not share configuration settings with the
	source specification. This is useful, for example, if there are clashing
	configuration settings in included specifications, making it them impossible
	to join.</p>

	<p>If <span class="code">{merge_tests,true}</span> is set in the source specification
	(which is the default setting), terms in joined specifications are
	merged with terms in the source specification (according to the
	description of <span class="code">merge_tests</span> earlier).</p>

	<p>Notice that it is always the <span class="code">merge_tests</span> setting in the source
	specification that is used when joined with other specifications.
	Say, for example, that a source specification A, with tests TA1 and TA2, has
	<span class="code">{merge_tests,false}</span> set, and that it includes another specification,
	B, with tests TB1 and TB2, that has <span class="code">{merge_tests,true}</span> set.
	The result is that the test series <span class="code">TA1,TA2,merge(TB1,TB2)</span>
	is executed. The opposite <span class="code">merge_tests</span> settings would result in
	the test series <span class="code">merge(merge(TA1,TA2),TB1,TB2)</span>.</p>

	<p>The term <span class="code">specs</span> can be used to nest specifications,
	that is, have one specification include other specifications, which in turn
	include others, and so no</p>
    
      <h4>Test Case Groups</h4>
	

	<p>When a test case group is specified, the resulting test
	executes function <span class="code">init_per_group</span>, followed by all test
	cases and subgroups (including their configuration functions), and
	finally function <span class="code">end_per_group</span>. Also, if particular
	test cases in a group are specified, <span class="code">init_per_group</span>
	and <span class="code">end_per_group</span>, for the group in question, are
	called. If a group defined (in <span class="code">Suite:group/0</span>) as
	a subgroup of another group, is specified (or if particular test
	cases of a subgroup are), <span class="code">Common Test</span> calls the configuration
	functions for the top-level groups and for the subgroup
	in question (making it possible to pass configuration data all
	the way from <span class="code">init_per_suite</span> down to the test cases in the
	subgroup).</p>

	<p>The test specification uses the same mechanism for specifying
	test case groups through names and paths, as explained in section
	<span class="bold_code"><a href="run_test_chapter.html#group_execution">Test Case Group Execution</a></span>,
	with the addition of element <span class="code">GroupSpec</span>.</p>

	<p>Element <span class="code">GroupSpec</span> makes it possible to specify
	group execution properties that overrides those in the
	group definition (that is, in <span class="code">groups/0</span>). Execution properties for
	subgroups might be overridden as well. This feature makes it possible to
	change properties of groups at the time of execution,
	without having to edit the test suite. The same feature is available for 
	<span class="code">group</span> elements in the <span class="code">Suite:all/0</span> list. For details and examples,
	see section <span class="bold_code"><a href="write_test_chapter.html#test_case_groups">Test Case Groups</a></span>.</p>
      

      <h4>Test Specification Syntax</h4>
	

	<p>Test specifications can be used to run tests both in a single 
	test host environment and in a distributed <span class="code">Common Test</span> environment 
	(Large Scale Testing). The node parameters in term <span class="code">init</span> are only
	relevant in the latter (see section
	<span class="bold_code"><a href="ct_master_chapter.html#test_specifications">Test Specifications</a></span> 
	in Large Scale Testing). For details about the various terms, see the 
	corresponding sections in the User's Guide, for example, the following:
	</p>
	<ul>
       <li>The <span class="bold_code"><a href="run_test_chapter.html#ct_run"><span class="code">ct_run</span>program</a></span> for an overview of available start flags
	(as most flags have a corresponding configuration term)</li>
       <li>
<span class="bold_code"><a href="write_test_chapter.html#logging">Logging</a></span>
	(for terms <span class="code">verbosity</span>, <span class="code">stylesheet</span>, <span class="code">basic_html</span> and <span class="code">esc_chars</span>)</li>
       <li>
<span class="bold_code"><a href="config_file_chapter.html#top">External Configuration Data</a></span>
	(for terms <span class="code">config</span> and <span class="code">userconfig</span>)</li>
       <li>
<span class="bold_code"><a href="event_handler_chapter.html#event_handling">Event Handling</a></span> (for the <span class="code">event_handler</span> term)</li>
       <li>
<span class="bold_code"><a href="ct_hooks_chapter.html#installing">Common Test Hooks</a></span>
	(for term <span class="code">ct_hooks</span>)</li>
	</ul>

      <p><strong>Configuration terms:</strong></p>
      <div class="example"><pre>
 {merge_tests, Bool}.

 {define, Constant, Value}.

 {specs, InclSpecsOption, TestSpecs}.

 {node, NodeAlias, Node}.

 {init, InitOptions}.
 {init, [NodeAlias], InitOptions}.

 {label, Label}.
 {label, NodeRefs, Label}.

 {verbosity, VerbosityLevels}.
 {verbosity, NodeRefs, VerbosityLevels}.

 {stylesheet, CSSFile}.
 {stylesheet, NodeRefs, CSSFile}.

 {silent_connections, ConnTypes}.
 {silent_connections, NodeRefs, ConnTypes}.

 {multiply_timetraps, N}.
 {multiply_timetraps, NodeRefs, N}.

 {scale_timetraps, Bool}.
 {scale_timetraps, NodeRefs, Bool}.

 {cover, CoverSpecFile}.
 {cover, NodeRefs, CoverSpecFile}.

 {cover_stop, Bool}.
 {cover_stop, NodeRefs, Bool}.

 {include, IncludeDirs}.
 {include, NodeRefs, IncludeDirs}.

 {auto_compile, Bool},
 {auto_compile, NodeRefs, Bool},

 {abort_if_missing_suites, Bool},
 {abort_if_missing_suites, NodeRefs, Bool},

 {config, ConfigFiles}.
 {config, ConfigDir, ConfigBaseNames}.
 {config, NodeRefs, ConfigFiles}.
 {config, NodeRefs, ConfigDir, ConfigBaseNames}.

 {userconfig, {CallbackModule, ConfigStrings}}.
 {userconfig, NodeRefs, {CallbackModule, ConfigStrings}}.

 {logdir, LogDir}.                                        
 {logdir, NodeRefs, LogDir}.

 {logopts, LogOpts}.
 {logopts, NodeRefs, LogOpts}.

 {create_priv_dir, PrivDirOption}.
 {create_priv_dir, NodeRefs, PrivDirOption}.

 {event_handler, EventHandlers}.
 {event_handler, NodeRefs, EventHandlers}.
 {event_handler, EventHandlers, InitArgs}.
 {event_handler, NodeRefs, EventHandlers, InitArgs}.

 {ct_hooks, CTHModules}.
 {ct_hooks, NodeRefs, CTHModules}.

 {enable_builtin_hooks, Bool}.

 {basic_html, Bool}.
 {basic_html, NodeRefs, Bool}.

 {esc_chars, Bool}.
 {esc_chars, NodeRefs, Bool}.

 {release_shell, Bool}.</pre></div>
	
      <p><strong>Test terms:</strong></p>
      <div class="example"><pre>
 {suites, Dir, Suites}.                                
 {suites, NodeRefs, Dir, Suites}.

 {groups, Dir, Suite, Groups}.
 {groups, NodeRefs, Dir, Suite, Groups}.

 {groups, Dir, Suite, Groups, {cases,Cases}}.
 {groups, NodeRefs, Dir, Suite, Groups, {cases,Cases}}.

 {cases, Dir, Suite, Cases}.                           
 {cases, NodeRefs, Dir, Suite, Cases}.

 {skip_suites, Dir, Suites, Comment}.
 {skip_suites, NodeRefs, Dir, Suites, Comment}.

 {skip_groups, Dir, Suite, GroupNames, Comment}.
 {skip_groups, NodeRefs, Dir, Suite, GroupNames, Comment}.

 {skip_cases, Dir, Suite, Cases, Comment}.
 {skip_cases, NodeRefs, Dir, Suite, Cases, Comment}.</pre></div>

	<a name="types"></a>
      <p><strong>Types:</strong></p>
      <div class="example"><pre>
 Bool            = true | false
 Constant        = atom()
 Value           = term()
 InclSpecsOption = join | separate
 TestSpecs       = string() | [string()]
 NodeAlias       = atom()
 Node            = node()
 NodeRef         = NodeAlias | Node | master
 NodeRefs        = all_nodes | [NodeRef] | NodeRef
 InitOptions     = term()
 Label           = atom() | string()
 VerbosityLevels = integer() | [{Category,integer()}]
 Category        = atom()
 CSSFile         = string()
 ConnTypes       = all | [atom()]
 N               = integer()
 CoverSpecFile   = string()
 IncludeDirs     = string() | [string()]
 ConfigFiles     = string() | [string()]
 ConfigDir       = string()
 ConfigBaseNames = string() | [string()]
 CallbackModule  = atom()
 ConfigStrings   = string() | [string()]
 LogDir          = string()
 LogOpts         = [term()]
 PrivDirOption   = auto_per_run | auto_per_tc | manual_per_tc
 EventHandlers   = atom() | [atom()]
 InitArgs        = [term()]
 CTHModules      = [CTHModule |
		    {CTHModule, CTHInitArgs} |
		    {CTHModule, CTHInitArgs, CTHPriority}]
 CTHModule       = atom()
 CTHInitArgs     = term()
 Dir             = string()
 Suites          = atom() | [atom()] | all
 Suite           = atom()
 Groups          = GroupPath | [GroupPath] | GroupSpec | [GroupSpec] | all
 GroupPath       = [GroupName]
 GroupSpec       = GroupName | {GroupName,Properties} | {GroupName,Properties,GroupSpec}
 GroupName       = atom()
 GroupNames      = GroupName | [GroupName]
 Cases           = atom() | [atom()] | all
 Comment         = string() | ""</pre></div>
	
	<p>The difference between the <span class="code">config</span> terms above is that with
	<span class="code">ConfigDir</span>, <span class="code">ConfigBaseNames</span> is a list of base names,
	that is, without directory paths. <span class="code">ConfigFiles</span> must be full names,
	including paths. For example, the following two terms have the same meaning:</p>
	<div class="example"><pre>
 {config, ["/home/testuser/tests/config/nodeA.cfg",
           "/home/testuser/tests/config/nodeB.cfg"]}.

 {config, "/home/testuser/tests/config", ["nodeA.cfg","nodeB.cfg"]}.</pre></div>

	  <div class="note">
<div class="label">Note</div>
<div class="content"><p><p>Any relative paths, specified in the test specification, are
	  relative to the directory containing the test specification file if
	  <span class="code">ct_run -spec TestSpecFile ...</span> or
	  <span class="code">ct:run:test([{spec,TestSpecFile},...])</span>
	  executes the test.</p>
	  <p>The path is relative to the top-level log directory if
	  <span class="code">ct:run:testspec(TestSpec)</span> executes the test.</p></p></div>
</div>	  
	

	<h4>Constants</h4>
	  

	  <p>The term <span class="code">define</span> introduces a constant that is used to
	  replace the name <span class="code">Constant</span> with <span class="code">Value</span>, wherever it is found in
	  the test specification. This replacement occurs during an initial iteration
	  through the test specification. Constants can be used anywhere in the test
	  specification, for example, in any lists and tuples, and even in strings
	  and inside the value part of other constant definitions. A constant can
	  also be part of a node name, but that is the only place where a constant
	  can be part of an atom.</p>
	  
	  <div class="note">
<div class="label">Note</div>
<div class="content"><p><p>For the sake of readability, the name of the constant must always
	  begin with an uppercase letter, or a <span class="code">$</span>, <span class="code">?</span>, or <span class="code">_</span>.
	  This means that it must always be single quoted (as the constant name is 
	  an atom, not text).</p></p></div>
</div>
	  
	  <p>The main benefit of constants is that they can be used to reduce the size
	  (and avoid repetition) of long strings, such as file paths.</p>
	  <p><strong>Examples:</strong></p>
	  
	  <div class="example"><pre>
 %% 1a. no constant
 {config, "/home/testuser/tests/config", ["nodeA.cfg","nodeB.cfg"]}.
 {suites, "/home/testuser/tests/suites", all}.

 %% 1b. with constant
 {define, 'TESTDIR', "/home/testuser/tests"}.
 {config, "'TESTDIR'/config", ["nodeA.cfg","nodeB.cfg"]}.
 {suites, "'TESTDIR'/suites", all}.

 %% 2a. no constants
 {config, [testnode@host1, testnode@host2], "../config", ["nodeA.cfg","nodeB.cfg"]}.
 {suites, [testnode@host1, testnode@host2], "../suites", [x_SUITE, y_SUITE]}.

 %% 2b. with constants
 {define, 'NODE', testnode}.
 {define, 'NODES', ['NODE'@host1, 'NODE'@host2]}.
 {config, 'NODES', "../config", ["nodeA.cfg","nodeB.cfg"]}.
 {suites, 'NODES', "../suites", [x_SUITE, y_SUITE]}.</pre></div>

	    <p>Constants make the test specification term <span class="code">alias</span>, in previous
	    versions of <span class="code">Common Test</span>, redundant. This term is deprecated but
	    remains supported in upcoming <span class="code">Common Test</span> releases. Replacing <span class="code">alias</span>
	    terms with <span class="code">define</span> is strongly recommended though. An example
	    of such replacement follows:</p>
	    
	    <div class="example"><pre>
 %% using the old alias term
 {config, "/home/testuser/tests/config/nodeA.cfg"}.
 {alias, suite_dir, "/home/testuser/tests/suites"}.
 {groups, suite_dir, x_SUITE, group1}.

 %% replacing with constants
 {define, 'TestDir', "/home/testuser/tests"}.
 {define, 'CfgDir', "'TestDir'/config"}.
 {define, 'SuiteDir', "'TestDir'/suites"}.
 {config, 'CfgDir', "nodeA.cfg"}.
 {groups, 'SuiteDir', x_SUITE, group1}.</pre></div>
	      
	      <p>Constants can well replace term <span class="code">node</span> also, but
	      this still has a declarative value, mainly when used in combination
	      with <span class="code">NodeRefs == all_nodes</span> 
	      (see <span class="bold_code"><a href="#types">Types</a></span>).</p>
	

	<h4>Example</h4>
	  
	  
	  <p>Here follows a simple test specification example:</p>
	  <div class="example"><pre>
 {define, 'Top', "/home/test"}.
 {define, 'T1', "'Top'/t1"}.
 {define, 'T2', "'Top'/t2"}.
 {define, 'T3', "'Top'/t3"}.
 {define, 'CfgFile', "config.cfg"}.

 {logdir, "'Top'/logs"}.

 {config, ["'T1'/'CfgFile'", "'T2'/'CfgFile'", "'T3'/'CfgFile'"]}.

 {suites, 'T1', all}.
 {skip_suites, 'T1', [t1B_SUITE,t1D_SUITE], "Not implemented"}.
 {skip_cases, 'T1', t1A_SUITE, [test3,test4], "Irrelevant"}.
 {skip_cases, 'T1', t1C_SUITE, [test1], "Ignore"}.

 {suites, 'T2', [t2B_SUITE,t2C_SUITE]}.
 {cases, 'T2', t2A_SUITE, [test4,test1,test7]}.

 {skip_suites, 'T3', all, "Not implemented"}.</pre></div>
	  
	  <p>The example specifies the following:</p>
	  <ul>
	    <li>The specified <span class="code">logdir</span> directory is used for storing 
	    the HTML log files (in subdirectories tagged with node name, 
	    date, and time).</li>
	    <li>The variables in the specified test system configuration files are
	    imported for the test.</li>
	    <li>The first test to run includes all suites for system <span class="code">t1</span>. 
	    Suites <span class="code">t1B</span> and <span class="code">t1D</span> are excluded from the test. Test cases 
	    <span class="code">test3</span> and <span class="code">test4</span> in <span class="code">t1A</span> and <span class="code">test1</span> case in <span class="code">t1C</span> 
	    are also excluded from the test.</li>
	    <li>The second test to run is for system <span class="code">t2</span>. The included suites are
	    <span class="code">t2B</span> and <span class="code">t2C</span>. Test cases <span class="code">test4</span>, <span class="code">test1</span>, and <span class="code">test7</span> in suite
	    <span class="code">t2A</span> are also included. The test cases are executed in the specified order.</li>
	    <li>The last test to run is for system <span class="code">t3</span>. Here, all suites are skipped and this
	    is explicitly noted in the log files.</li>
	  </ul>
	

	<h4>The init Term</h4>
	  
	  <p>With term <span class="code">init</span> it is possible to specify initialization options
	  for nodes defined in the test specification. There are options
	  to start the node and to evaluate any function on the node.
	  For details, see section <span class="bold_code"><a href="ct_master_chapter.html#ct_slave">Automatic Startup of Test Target Nodes</a></span> in section Using Common Test for Large Scale Testing.</p>
	
	<h4>User-Specific Terms</h4>
	  
	  <p>The user can provide a test specification including (for <span class="code">Common Test</span>) 
	  unrecognizable terms. If this is desired, use flag <span class="code">-allow_user_terms</span> 
	  when starting tests with <span class="code">ct_run</span>. This forces <span class="code">Common Test</span> to ignore 
	  unrecognizable terms. In this mode, <span class="code">Common Test</span> is not able to check the 
	  specification for errors as efficiently as if the scanner runs in default mode. 
	  If <span class="bold_code"><a href="../../man/ct.html#run_test-1"><span class="code">ct:run_test/1</span></a></span> is used
	  for starting the tests, the relaxed scanner mode is enabled by tuple
	  <span class="code">{allow_user_terms,true}</span>.</p>
	
	<h4>Reading Test Specification Terms</h4>
	  
	  <p>Terms in the current test specification
	  (that is, the specification that has been used to configure and run the current test)
	  can be looked up.
	  The function <span class="bold_code"><a href="../../man/ct.html#get_testspec_terms-0"><span class="code">get_testspec_terms()</span></a></span> 
	  returns a list of all test specification terms (both configuration terms and test terms), 
	  and <span class="code">get_testspec_terms(Tags)</span> returns the term (or a list of terms) matching the 
	  tag (or tags) in <span class="code">Tags</span>.</p>
	  <p>For example, in the test specification:</p>
	  <div class="example"><pre>
 ...
 {label, my_server_smoke_test}.
 {config, "../../my_server_setup.cfg"}.
 {config, "../../my_server_interface.cfg"}.
 ...</pre></div>	    
	  <p>And in, for example, a test suite or a <span class="code">Common Test Hook</span> function:</p>
	  <div class="example"><pre>
 ...
 [{label,[{_Node,TestType}]}, {config,CfgFiles}] =
     ct:get_testspec_terms([label,config]),

 [verify_my_server_cfg(TestType, CfgFile) || {Node,CfgFile} &lt;- CfgFiles,
					     Node == node()];
 ...</pre></div>
	
  

  <h3><a name="id82334">8.9 
        Running Tests from the Web-Based GUI</a></h3>
    
    
    <p>The web-based GUI, Virtual Test Server (VTS), is started with the
      <span class="bold_code"><a href="run_test_chapter.html#ct_run"><span class="code">ct_run</span></a></span>
      program. From the GUI, you can load configuration files and select
      directories, suites, and cases to run. You can also state the
      configuration files, directories, suites, and cases on the command line
      when starting the web-based GUI.
    </p>
    <p><strong>Examples:</strong></p>
    <ul>
      <li><span class="code">ct_run -vts</span></li>
      <li><span class="code">ct_run -vts -config &lt;configfilename&gt;</span></li>
      <li><span class="code">ct_run -vts -config &lt;configfilename&gt; -suite &lt;suitewithfullpath&gt;
	      -case &lt;casename&gt;</span></li>
    </ul>
    
    <p>From the GUI you can run tests and view the result and the logs.
    </p>
    
    <p><span class="code">ct_run -vts</span> tries to open the <span class="code">Common Test</span> start
      page in an existing web browser window, or start the browser if it is
      not running. Which browser to start can be specified with
      the browser start command option:</p>
      <p><span class="code">ct_run -vts -browser &lt;browser_start_cmd&gt;</span></p>
      <p><strong>Example:</strong></p>
      <p><span class="code">$ ct_run -vts -browser 'firefox&amp;'</span></p>

      <div class="note">
<div class="label">Note</div>
<div class="content"><p><p>The browser must run as a separate OS process, otherwise VTS hangs.</p></p></div>
</div>

      <p>If no specific browser start command is specified, Firefox is
        the default browser on Unix platforms, and Internet Explorer on Windows.
	If <span class="code">Common Test</span> fails to start a browser automatically, or <span class="code">none</span> is
	specified as the value for <span class="code">-browser</span> (that is, <span class="code">-browser none</span>), start your
	favourite browser manually and type the URL that <span class="code">Common Test</span>
	displays in the shell.</p>    
  
  
  <h3>
<a name="log_files"></a><a name="id82446">8.10 
        Log Files</a>
</h3>
    
    
    
    <p>As the execution of the test suites proceed, events are logged in
      the following four different ways:</p>
      
      <ul>
	<li>Text to the operator console.</li>
	<li>Suite-related information is sent to the major log file.</li>
	<li>Case-related information is sent to the minor log file.</li>
	<li>The HTML overview log file is updated with test results.</li>
	<li>A link to all runs executed from a certain directory is written in
	  the log named <span class="code">all_runs.html</span> and direct links to all tests (the
	  latest results) are written to the top-level <span class="code">index.html</span>.</li>
      </ul>
      
      <p>Typically the operator, possibly running hundreds or thousands of
	test cases, does not want to fill the console with details
	about, or printouts from, specific test cases. By default, the 
	operator only sees the following:</p>
      
      <ul>
	<li>A confirmation that the test has started and information about how 
	  many test cases are executed in total.</li>
	<li>A small note about each failed test case.</li>
	<li>A summary of all the run test cases.</li>
	<li>A confirmation when the test run is complete.</li>
	<li>Some special information, such as error reports, progress
	  reports, and printouts written with <span class="code">erlang:display/1</span>, or <span class="code">io:format/3</span>
	  specifically addressed to a receiver other than <span class="code">standard_io</span>
	  (for example, the default group leader process <span class="code">user</span>).</li>
      </ul>

      <p>To dig deeper into the general results, or
        the result of a specific test case, the operator can do so by
	following the links in the HTML presentation and read the
	major or minor log files. The "all_runs.html" page is a good
	starting point. It is located in <span class="code">logdir</span> and contains
	a link to each test run, including a quick overview (with date and time,
	node name, number of tests, test names, and test result totals).</p>
	
      <p>An "index.html" page is written for each test run (that is, stored in
	the <span class="code">ct_run</span> directory tagged with node name, date, and time). This
	file provides an overview of all individual tests performed in the 
	same test run. The test names follow the following convention:</p>
      <ul>
	<li>
<span class="code">TopLevelDir.TestDir</span> (all suites in <span class="code">TestDir</span> executed)</li>
	<li>
<span class="code">TopLevelDir.TestDir:suites</span> (specific suites executed)</li>
	<li>
<span class="code">TopLevelDir.TestDir.Suite</span> (all cases in <span class="code">Suite</span> executed)</li>
	<li>
<span class="code">TopLevelDir.TestDir.Suite:cases</span> (specific test cases executed)</li>
	<li>
<span class="code">TopLevelDir.TestDir.Suite.Case</span> (only <span class="code">Case</span> executed)</li>
      </ul>
      
      <p>The "test run index" page includes a link to the <span class="code">Common Test</span>
        Framework Log file in which information about imported
        configuration data and general test progress is written. This
        log file is useful to get snapshot information about the test
        run during execution. It can also be helpful when
        analyzing test results or debugging test suites.</p>

      <p>The "test run index" page indicates if a test has missing
        suites (that is, suites that <span class="code">Common Test</span> failed to
        compile). Names of the missing suites can be found in the
        <span class="code">Common Test</span> Framework Log file.</p>

      <p>The major log file shows a detailed report of the test run. It
        includes test suite and test case names, execution time, the 
	exact reason for failures, and so on. The information is available in both
	a file with textual and with HTML representation. The HTML file shows a 
	summary that gives a good overview of the test run. It also has links 
	to each individual test case log file for quick viewing with an HTML 
	browser.</p>
      
      <p>The minor log files contain full details of every single test
	case, each in a separate file. This way, it is
	straightforward	to compare the latest results to that of previous
	test runs, even if the set of test cases changes. If application SASL
	is running, its logs are also printed to the current minor log file by the
	<span class="bold_code"><a href="ct_hooks_chapter.html#builtin_cths">cth_log_redirect built-in hook</a></span>.
      </p>

      <p>The full name of the minor log file (that is, the name of the file
	including the absolute directory path) can be read during execution
	of the test case. It comes as value in tuple
	<span class="code">{tc_logfile,LogFileName}</span> in the <span class="code">Config</span> list (which means it
	can also be read by a pre- or post <span class="code">Common Test Hook</span> function). Also,
	at the start of a test case, this data is sent with an event
	to any installed event handler.	For details, see section
	<span class="bold_code"><a href="event_handler_chapter.html#event_handling">Event Handling</a></span>.
      </p>

      <p>The log files are written continuously during a test run and links are
	always created initially when a test starts. Thevtest progress can therefore 
	be followed simply by refreshing pages in the HTML browser.
	Statistics totals are not presented until a test is complete however.</p>

	<h4>
<a name="logopts"></a>Log Options</h4>
	  
	  
	  <p>With start flag <span class="code">logopts</span> options that modify some aspects 
	  of the logging behavior can be specified.
	  The following options are available:</p>
	  <dl>
	    <dt><strong><span class="code">no_src</span></strong></dt>
	    <dd><p>The HTML version of the test suite source code is not 
	    generated during the test run (and is consequently not available 
	    in the log file system).</p></dd>
	    <dt><strong><span class="code">no_nl</span></strong></dt>
	    <dd><p><span class="code">Common Test</span> does not add a newline character <span class="code">(\n)</span> 
	    to the end of an output string that it receives from a call to, for example, 
	    <span class="code">io:format/2</span>, and which it prints to the test case log.</p></dd>
	    </dl>

	  <p>For example, if a test is started with:</p>
	  <p><span class="code">$ ct_run -suite my_SUITE -logopts no_src</span></p>
	  <p>then printouts during the test made by successive calls to <span class="code">io:format("x")</span>,
	  appears in the test case log as:</p>
	  <p><span class="code">xxx</span></p>
	  <p>instead of each <span class="code">x</span> printed on a new line, which is the default behavior.</p>
	

	<h4>
<a name="table_sorting"></a>Sorting HTML Table Columns</h4>
	  
	  
	  <p>By clicking the name in the column header of any table 
	    (for example, "Ok", "Case", "Time", and so on), the table rows are sorted 
	    in whatever order makes sense for the type of value (for example,
	    numerical for "Ok" or "Time", and alphabetical for "Case"). The sorting is 
	    performed through JavaScript code, automatically inserted into the HTML 
	    log files. <span class="code">Common Test</span> uses the <span class="bold_code"><a href="http://jquery.com">jQuery</a></span> 
	    library and the
	    <span class="bold_code"><a href="http://tablesorter.com">tablesorter</a></span> plugin, 
	    with customized sorting functions, for this implementation.</p>
	

	<h4>The Unexpected I/O Log</h4>
	  
	  <p>The test suites overview page includes a link to the Unexpected I/O Log.
	  In this log, <span class="code">Common Test</span> saves printouts made with
	  <span class="bold_code"><a href="../../man/ct.html#log-2"><span class="code">ct:log/2</span></a></span> and 
	  <span class="bold_code"><a href="../../man/ct.html#pal-2"><span class="code">ct:pal/2</span></a></span>, as well as captured system 
	  error- and progress reports, which cannot be associated with particular test cases and
	  therefore cannot be written to individual test case log files. This occurs,
	  for example, if a log printout is made from an external process (not a test 
	  case process), <strong>or</strong> if an error- or progress report comes in, during a short 
	  interval while <span class="code">Common Test</span> is not executing a test case or configuration 
	  function, <strong>or</strong> while <span class="code">Common Test</span> is currently executing a parallel 
	  test case group.</p>
	

	<h4>
<a name="pre_post_test_io_log"></a>The Pre- and Post Test I/O Log</h4>
	  
	  
	  <p>The <span class="code">Common Test</span> Framework Log page includes links to the
	  Pre- and Post Test I/O Log. In this log, <span class="code">Common Test</span> saves printouts made 
	  with <span class="code">ct:log/2</span> and <span class="code">ct:pal/2</span>, as well as captured system error-
	  and progress reports, which take place before, and after, the test run.
	  Examples of this are printouts from a CT hook init- or terminate function, or
	  progress reports generated when an OTP application is started from a CT hook
	  init function. Another example is an error report generated because of
	  a failure when an external application is stopped from a CT hook terminate function.
	  All information in these examples ends up in the Pre- and Post Test I/O Log.
	  For more information on how to synchronize test runs with external user
	  applications, see section
	  <span class="bold_code"><a href="ct_hooks_chapter.html#synchronizing">Synchronizing</a></span>
	  in section Common Test Hooks.</p>
	  <div class="note">
<div class="label">Note</div>
<div class="content"><p><p>Logging to file with <span class="code">ct:log/2</span> or <span class="code">ct:pal/2</span>
	  only works when <span class="code">Common Test</span> is running. Printouts with <span class="code">ct:pal/2</span>
	  are however always displayed on screen.</p></p></div>
</div>
	
      
  
      <h3>
<a name="html_stylesheet"></a><a name="id82918">8.11 
        HTML Style Sheets</a>
</h3>
	
	
	<p><span class="code">Common Test</span> uses an HTML Style Sheet (CSS file) to control the look of
	  the HTML log files generated during test runs. If the log files are not 
	  displayed correctly in the browser of your choice, or you prefer a more 
	  primitive ("pre <span class="code">Common Test</span> v1.6") look of the logs, use the start 
	  flag/option:</p>
	  <div class="example"><pre>
 basic_html</pre></div>
	<p>This disables the use of style sheets and JavaScripts (see
	  <span class="bold_code"><a href="#table_sorting">Sorting HTML Table Columns</a></span>).</p>
	  
	<p><span class="code">Common Test</span> includes an <strong>optional</strong> feature to allow
	  user HTML style sheets for customizing printouts. The
	  functions in <span class="code">ct</span> that print to a test case HTML log
	  file (<span class="code">log/3</span> and <span class="code">pal/3</span>) accept <span class="code">Category</span>
	  as first argument. With this argument a category can be specified 
	  that can be mapped to a selector in a CSS
	  definition. This is useful, especially for coloring text
	  differently depending on the type of (or reason for) the
	  printout. Say you want one color for test system
	  configuration information, a different one for test system
	  state information, and finally one for errors detected by the
	  test case functions. The corresponding style sheet can
	  look as follows:</p>

	<div class="example"><pre>
 div.sys_config  { background:blue; color:white }
 div.sys_state   { background:yellow; color:black }
 div.error       { background:red; color:white }</pre></div>

	<p>To install the CSS file (<span class="code">Common Test</span> inlines the definition in the 
	  HTML code), the name can be provided when executing <span class="code">ct_run</span>.</p>
	  <p><strong>Example:</strong></p>

	<div class="example"><pre>
 $ ct_run -dir $TEST/prog -stylesheet $TEST/styles/test_categories.css</pre></div>

	  <p>Categories in a CSS file installed with flag <span class="code">-stylesheet</span>
	    are on a global test level in the sense that they can be used in any 
	    suite that is part of the test run.</p>

	  <p>Style sheets can also be installed on a per suite and
	  per test case basis.</p>
	  <p><strong>Example:</strong></p>

	<div class="example"><pre>
 -module(my_SUITE).
 ...
 suite() -&gt; [..., {stylesheet,"suite_categories.css"}, ...].
 ...
 my_testcase(_) -&gt;
     ...
     ct:log(sys_config, "Test node version: ~p", [VersionInfo]),
     ...
     ct:log(sys_state, "Connections: ~p", [ConnectionInfo]),
     ...
     ct:pal(error, "Error ~p detected! Info: ~p", [SomeFault,ErrorInfo]),
     ct:fail(SomeFault).</pre></div>

	<p>If the style sheet is installed as in this example, the categories are 
	  private to the suite in question. They can be used by all test cases in the 
	  suite, but cannot be used by other suites. A suite private style sheet, 
	  if specified, is used in favor of a global style sheet (one specified 
	  with flag <span class="code">-stylesheet</span>). A stylesheet tuple (as returned by <span class="code">suite/0</span> 
	  above) can also be returned from a test case information function. In this case the 
	  categories specified in the style sheet can only be used in that particular 
	  test case. A test case private style sheet is used in favor of a suite or 
	  global level style sheet.
	</p>

	<p>In a tuple <span class="code">{stylesheet,CSSFile}</span>, if <span class="code">CSSFile</span> is specified
	  with a path, for example, <span class="code">"$TEST/styles/categories.css"</span>, this full
	  name is used to locate the file. However, if only the file name is specified,
	  for example, <span class="code">categories.css</span>, the CSS file is assumed to be located
	  in the data directory, <span class="code">data_dir</span>, of the suite. The latter use is
	  recommended, as it is portable compared to hard coding path names in the 
	  suite.</p>

	<p>Argument <span class="code">Category</span> in the previous example can have the
	  value (atom) <span class="code">sys_config</span> (white on blue), <span class="code">sys_state</span>
	  (black on yellow), or <span class="code">error</span> (white on red).</p>
  

  <h3>
<a name="repeating_tests"></a><a name="id83096">8.12 
        Repeating Tests</a>
</h3>
    
        
    <p>You can order <span class="code">Common Test</span> to repeat the tests you specify. You can choose
       to repeat tests a number of times, repeat tests for a specific period of time, 
       or repeat tests until a particular stop time is reached. If repetition is controlled by
       time, an action for <span class="code">Common Test</span> to take upon time-out can be specified. 
       Either <span class="code">Common Test</span> performs all tests in the current run 
       before stopping, or it stops when the current test job is finished. Repetition 
       can be activated by <span class="code">ct_run</span> start flags, or tuples in the <span class="code">ct:run:test/1</span>
       option list argument. The flags (options in parentheses) are the following:</p>
       <ul>
       <li>
<span class="code">-repeat N ({repeat,N})</span>, where <span class="code">N</span> is a positive integer</li>
       <li>
<span class="code">-duration DurTime ({duration,DurTime})</span>, where <span class="code">DurTime</span> is the duration</li>
       <li>
<span class="code">-until StopTime ({until,StopTime})</span>, where <span class="code">StopTime</span> is finish time</li>
       <li><span class="code">-force_stop ({force_stop,true})</span></li>
       <li><span class="code">-force_stop skip_rest ({force_stop,skip_rest})</span></li>
       </ul>
	  <dl>
	    <dt><strong><span class="code">DurTime</span></strong></dt>
	    <dd>
<p>The duration time is specified as <span class="code">HHMMSS</span>, for example, <span class="code">-duration 012030</span> 
	    or <span class="code">{duration,"012030"}</span></p>, which means that the tests are executed and 
	    (if time allows) repeated until time-out occurs after 1 hour, 20 minutes, and 30 seconds.
	    </dd>
	    <dt><strong><span class="code">StopTime</span></strong></dt>
	    <dd>
<p>The finish time can be specified as <span class="code">HHMMSS</span> and is then interpreted as a 
	    time today (or possibly tomorrow), but can also be specified as <span class="code">YYMoMoDDHHMMSS</span>,
	    for example, <span class="code">-until 071001120000</span> or <span class="code">{until,"071001120000"}</span>. This means
	    that the tests are executed and (if time allows) repeated, until 12 o'clock on the 1st 
	    of October 2007.</p>
	    </dd>
	  </dl>

       <p>When time-out occurs, <span class="code">Common Test</span> never aborts the ongoing test case,
          as this can leave the SUT in an undefined, and possibly bad, state.
	  Instead <span class="code">Common Test</span>, by default, finishes the current test
	  run before stopping. If flag <span class="code">force_stop</span> is
	  specified, <span class="code">Common Test</span> stops when the current test job
	  is finished. If flag <span class="code">force_stop</span> is specified with
	  <span class="code">skip_rest</span>, <span class="code">Common Test</span> only completes the current
	  test case and skips the remaining tests in the test job.</p>
	  <div class="note">
<div class="label">Note</div>
<div class="content"><p><p>As <span class="code">Common Test</span> always finishes at least the current test case,
	  the time specified with <span class="code">duration</span> or <span class="code">until</span> is never definitive.</p></p></div>
</div>

       <p>Log files from every repeated test run is saved in normal <span class="code">Common Test</span> 
       fashion (described earlier).</p>
       <p><span class="code">Common Test</span> might later support an optional feature to only store the last (and possibly 
       the first) set of logs of repeated test runs, but for now the user must be careful not 
       to run out of disk space if tests are repeated during long periods of time.</p>

       <p>For each test run that is part of a repeated session, information about the
          particular test run is printed in the <span class="code">Common Test</span> Framework Log. The information
	  includes the repetition number, remaining time, and so on.</p>

       <p><strong>Example 1:</strong></p>
       <div class="example"><pre>
 $ ct_run -dir $TEST_ROOT/to1 $TEST_ROOT/to2 -duration 001000 -force_stop</pre></div>

       <p>Here, the suites in test directory <span class="code">to1</span>, followed by the suites in <span class="code">to2</span>, are 
          executed in one test run. A time-out event occurs after 10 minutes. As long as there is 
	  time left, <span class="code">Common Test</span> repeats the test run (that is, starting over with test <span class="code">to1</span>). 
	  After time-out, <span class="code">Common Test</span> stops when the current job is finished
	  (because of flag <span class="code">force_stop</span>). As a result, the specified test run can be 
	  aborted after test <span class="code">to1</span> and before test <span class="code">to2</span>.</p>

       <p><strong>Example 2:</strong></p>
       <div class="example"><pre>
 $ ct_run -dir $TEST_ROOT/to1 $TEST_ROOT/to2 -duration 001000 -forces_stop skip_rest</pre></div>

       <p>Here, the same tests as in Example 1 are run, but with flag <span class="code">force_stop</span> set to 
       <span class="code">skip_rest</span>. If time-out occurs while executing tests in directory <span class="code">to1</span>, 
          the remaining test cases in <span class="code">to1</span> are skipped and the test is aborted without 
	  running the tests in <span class="code">to2</span> another time. If time-out occurs while executing 
	  tests in directory <span class="code">to2</span>, the remaining test cases in <span class="code">to2</span> are skipped and 
	  the test is aborted.</p>

       <p><strong>Example 3:</strong></p>
       <div class="example"><pre>
 $ date
 Fri Sep 28 15:00:00 MEST 2007

 $ ct_run -dir $TEST_ROOT/to1 $TEST_ROOT/to2 -until 160000</pre></div>

       <p>Here, the same test run as in the previous examples are executed (and possibly repeated). 
          However, when the time-out occurs, after 1 hour, <span class="code">Common Test</span> finishes the entire 
	  test run before stopping (that is, both <span class="code">to1</span> and <span class="code">to2</span> are always executed in 
          the same test run).</p>
       
       <p><strong>Example 4:</strong></p>
       <div class="example"><pre>
 $ ct_run -dir $TEST_ROOT/to1 $TEST_ROOT/to2 -repeat 5</pre></div>

       <p>Here, the test run, including both the <span class="code">to1</span> and the <span class="code">to2</span> test, is repeated 
          five times.</p>

       <div class="note">
<div class="label">Note</div>
<div class="content"><p><p>Do not confuse this feature with the <span class="code">repeat</span> property of a test
          case group. The options described here are used to repeat execution of entire test runs,
	  while the <span class="code">repeat</span> property of a test case group makes it possible to repeat
	  execution of sets of test cases within a suite. For more information about the latter,
	  see section <span class="bold_code"><a href="write_test_chapter.html#test_case_groups">Test Case Groups</a></span>
	  in section Writing Test Suites.</p></p></div>
</div>
  

  <h3>
<a name="silent_connections"></a><a name="id83461">8.13 
        Silent Connections</a>
</h3>
    
      
      <p>The protocol handling processes in <span class="code">Common Test</span>, implemented by <span class="code">ct_telnet</span>,
      <span class="code">ct_ssh</span>, <span class="code">ct_ftp</span>, and so on, do verbose printing to the test case logs. 
      This can be switched off with flag <span class="code">-silent_connections</span>:</p>
      
      <div class="example"><pre>
 ct_run -silent_connections [conn_types]</pre></div>
      
      <p>Here, <span class="code">conn_types</span> specifies SSH, Telnet, FTP, RPC, and/or SNMP.</p>
      
      <p><strong>Example 1:</strong></p>
      
      <div class="example"><pre>
 ct_run ... -silent_connections ssh telnet</pre></div>
      <p>This switches off logging for SSH and Telnet connections.</p>
      
      <p><strong>Example 2:</strong></p>
      
      <div class="example"><pre>
 ct_run ... -silent_connections</pre></div>
      <p>This switches off logging for all connection types.</p>
      
      
      <p>Fatal communication error and reconnection attempts are always printed, even if 
         logging has been suppressed for the connection type in question. However, operations
         such as sending and receiving data are performed silently.</p>
      
      <p><span class="code">silent_connections</span> can also be specified in a test suite. This is
	accomplished by returning a tuple, <span class="code">{silent_connections,ConnTypes}</span>, in the
	<span class="code">suite/0</span> or test case information list. If <span class="code">ConnTypes</span> is a list of atoms 
	(SSH, Telnet, FTP, RPC and/or SNMP), output for any corresponding connections 
	are suppressed. Full logging is by default enabled for any connection of type not 
	specified in <span class="code">ConnTypes</span>. Hence, if <span class="code">ConnTypes</span> is the empty list, logging 
	is enabled for all connections.</p>
      
	<p><strong>Example 3:</strong></p>
      
      <div class="example"><pre>
 -module(my_SUITE).

 suite() -&gt; [..., {silent_connections,[telnet,ssh]}, ...].

 ...

 my_testcase1() -&gt;
     [{silent_connections,[ssh]}].

 my_testcase1(_) -&gt;
     ...

 my_testcase2(_) -&gt;
     ...</pre></div>
      
      <p>In this example, <span class="code">suite/0</span> tells <span class="code">Common Test</span> to suppress
	printouts from Telnet and SSH connections. This is valid for
	all test cases. However, <span class="code">my_testcase1/0</span> specifies that
	for this test case, only SSH is to be silent. The result is
	that <span class="code">my_testcase1</span> gets Telnet information (if any) printed
	in the log, but not SSH information. <span class="code">my_testcase2</span> gets no
	information from either connection printed.</p>
      
	<p><span class="code">silent_connections</span> can also be specified with a term
	in a test specification
	(see section <span class="bold_code"><a href="run_test_chapter.html#test_specifications">Test Specifications</a></span> in section Running Tests and Analyzing Results).
	Connections provided with start	flag/option <span class="code">silent_connections</span>
	are merged with any connections listed in the test specification.</p>

	<p>Start flag/option <span class="code">silent_connections</span> and the test
	specification term override any settings made by the information functions
	inside the test suite.</p>
      
      <div class="note">
<div class="label">Note</div>
<div class="content"><p><p>In the current <span class="code">Common Test</span> version, the
	<span class="code">silent_connections</span> feature only works for Telnet
	and SSH connections. Support for other connection types can be added
	in future <span class="code">Common Test</span> versions.</p></p></div>
</div>
      
  
</div>
<div class="footer">
<hr>
<p>Copyright © 2003-2017 Ericsson AB. All Rights Reserved.</p>
</div>
</div>
</div></body>
</html>
