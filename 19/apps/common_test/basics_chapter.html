<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html xmlns:erl="http://erlang.org" xmlns:fn="http://www.w3.org/2005/02/xpath-functions">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" href="../../otp_doc.css" type="text/css">
<title>Erlang -- Common Test Basics</title>
</head>
<body bgcolor="white" text="#000000" link="#0000ff" vlink="#ff00ff" alink="#ff0000"><div id="container">
<script id="js" type="text/javascript" language="JavaScript" src="../../js/flipmenu/flipmenu.js"></script><script id="js2" type="text/javascript" src="../../js/erlresolvelinks.js"></script><script language="JavaScript" type="text/javascript">
            <!--
              function getWinHeight() {
                var myHeight = 0;
                if( typeof( window.innerHeight ) == 'number' ) {
                  //Non-IE
                  myHeight = window.innerHeight;
                } else if( document.documentElement && ( document.documentElement.clientWidth ||
                                                         document.documentElement.clientHeight ) ) {
                  //IE 6+ in 'standards compliant mode'
                  myHeight = document.documentElement.clientHeight;
                } else if( document.body && ( document.body.clientWidth || document.body.clientHeight ) ) {
                  //IE 4 compatible
                  myHeight = document.body.clientHeight;
                }
                return myHeight;
              }

              function setscrollpos() {
                var objf=document.getElementById('loadscrollpos');
                 document.getElementById("leftnav").scrollTop = objf.offsetTop - getWinHeight()/2;
              }

              function addEvent(obj, evType, fn){
                if (obj.addEventListener){
                obj.addEventListener(evType, fn, true);
                return true;
              } else if (obj.attachEvent){
                var r = obj.attachEvent("on"+evType, fn);
                return r;
              } else {
                return false;
              }
             }

             addEvent(window, 'load', setscrollpos);

             //--></script><div id="leftnav"><div class="innertube">
<img alt="Erlang logo" src="../../erlang-logo.png"><br><small><a href="users_guide.html">User's Guide</a><br><a href="index.html">Reference Manual</a><br><a href="release_notes.html">Release Notes</a><br><a href="common_test.pdf">PDF</a><br><a href="../../index.html">Top</a></small><p><strong>Common Test</strong><br><strong>User's Guide</strong><br><small>Version 1.14</small></p>
<br><a href="javascript:openAllFlips()">Expand All</a><br><a href="javascript:closeAllFlips()">Contract All</a><p><small><strong>Chapters</strong></small></p>
<ul class="flipMenu" imagePath="../../js/flipmenu">
<li id="no" title="Introduction" expanded="false">Introduction<ul>
<li><a href="introduction.html">
              Top of chapter
            </a></li>
<li title="Scope"><a href="introduction.html#id58032">Scope</a></li>
<li title="Prerequisites"><a href="introduction.html#id70023">Prerequisites</a></li>
</ul>
</li>
<li id="loadscrollpos" title="Common Test Basics" expanded="true">Common Test Basics<ul>
<li><a href="basics_chapter.html">
              Top of chapter
            </a></li>
<li title="General"><a href="basics_chapter.html#id57978">General</a></li>
<li title="Test Suite Organisation"><a href="basics_chapter.html#id64675">Test Suite Organisation</a></li>
<li title="Support Libraries"><a href="basics_chapter.html#id62285">Support Libraries</a></li>
<li title="Suites and Test Cases"><a href="basics_chapter.html#id63359">Suites and Test Cases</a></li>
<li title="External Interfaces"><a href="basics_chapter.html#id61440">External Interfaces</a></li>
</ul>
</li>
<li id="no" title="Getting Started" expanded="false">Getting Started<ul>
<li><a href="getting_started_chapter.html">
              Top of chapter
            </a></li>
<li title="Introduction for Newcomers"><a href="getting_started_chapter.html#id70537">Introduction for Newcomers</a></li>
<li title="Test Case Execution"><a href="getting_started_chapter.html#id61029">Test Case Execution</a></li>
<li title="A Simple Test Suite"><a href="getting_started_chapter.html#id62912">A Simple Test Suite</a></li>
<li title="A Test Suite with Configuration Functions"><a href="getting_started_chapter.html#id69498">A Test Suite with Configuration Functions</a></li>
<li title="Questions and Answers"><a href="getting_started_chapter.html#id63443">Questions and Answers</a></li>
</ul>
</li>
<li id="no" title="Installation" expanded="false">Installation<ul>
<li><a href="install_chapter.html">
              Top of chapter
            </a></li>
<li title="General Information"><a href="install_chapter.html#id75958">General Information</a></li>
</ul>
</li>
<li id="no" title="Writing Test Suites" expanded="false">Writing Test Suites<ul>
<li><a href="write_test_chapter.html">
              Top of chapter
            </a></li>
<li title="Support for Test Suite Authors"><a href="write_test_chapter.html#id68554">Support for Test Suite Authors</a></li>
<li title="Test Suites"><a href="write_test_chapter.html#id68618">Test Suites</a></li>
<li title="Init and End per Suite"><a href="write_test_chapter.html#id68668">Init and End per Suite</a></li>
<li title="Init and End per Test Case"><a href="write_test_chapter.html#id75026">Init and End per Test Case</a></li>
<li title="Test Cases"><a href="write_test_chapter.html#id75325">Test Cases</a></li>
<li title="Test Case Information Function"><a href="write_test_chapter.html#id75513">Test Case Information Function</a></li>
<li title="Test Suite Information Function"><a href="write_test_chapter.html#id75710">Test Suite Information Function</a></li>
<li title="Test Case Groups"><a href="write_test_chapter.html#id76889">Test Case Groups</a></li>
<li title="Parallel Property and Nested Groups"><a href="write_test_chapter.html#id77324">Parallel Property and Nested Groups</a></li>
<li title="Parallel Test Cases and I/O"><a href="write_test_chapter.html#id77361">Parallel Test Cases and I/O</a></li>
<li title="Repeated Groups"><a href="write_test_chapter.html#id77414">Repeated Groups</a></li>
<li title="Shuffled Test Case Order"><a href="write_test_chapter.html#id77567">Shuffled Test Case Order</a></li>
<li title="Group Information Function"><a href="write_test_chapter.html#id77633">Group Information Function</a></li>
<li title="Information Functions for Init- and End-Configuration"><a href="write_test_chapter.html#id77674">Information Functions for Init- and End-Configuration</a></li>
<li title="Data and Private Directories"><a href="write_test_chapter.html#id77749">Data and Private Directories</a></li>
<li title="Execution Environment"><a href="write_test_chapter.html#id77907">Execution Environment</a></li>
<li title="Timetrap Time-Outs"><a href="write_test_chapter.html#id77944">Timetrap Time-Outs</a></li>
<li title="Logging - Categories and Verbosity Levels"><a href="write_test_chapter.html#id78145">Logging - Categories and Verbosity Levels</a></li>
<li title="Illegal Dependencies"><a href="write_test_chapter.html#id78538">Illegal Dependencies</a></li>
</ul>
</li>
<li id="no" title="Test Structure" expanded="false">Test Structure<ul>
<li><a href="test_structure_chapter.html">
              Top of chapter
            </a></li>
<li title="General"><a href="test_structure_chapter.html#id78731">General</a></li>
<li title="Skipping Test Cases"><a href="test_structure_chapter.html#id78750">Skipping Test Cases</a></li>
<li title="Definition of Terms"><a href="test_structure_chapter.html#id78829">Definition of Terms</a></li>
</ul>
</li>
<li id="no" title="Examples and Templates" expanded="false">Examples and Templates<ul>
<li><a href="example_chapter.html">
              Top of chapter
            </a></li>
<li title="Test Suite Example"><a href="example_chapter.html#id79140">Test Suite Example</a></li>
<li title="Test Suite Templates"><a href="example_chapter.html#id79193">Test Suite Templates</a></li>
</ul>
</li>
<li id="no" title="Running Tests and Analyzing Results" expanded="false">Running Tests and Analyzing Results<ul>
<li><a href="run_test_chapter.html">
              Top of chapter
            </a></li>
<li title="Using the Common Test Framework"><a href="run_test_chapter.html#id79388">Using the Common Test Framework</a></li>
<li title="Automatic Compilation of Test Suites and Help Modules"><a href="run_test_chapter.html#id79431">Automatic Compilation of Test Suites and Help Modules</a></li>
<li title="Running Tests from the OS Command Line"><a href="run_test_chapter.html#id79625">Running Tests from the OS Command Line</a></li>
<li title="Running Tests from the Erlang Shell or from an Erlang Program"><a href="run_test_chapter.html#id80316">Running Tests from the Erlang Shell or from an Erlang Program</a></li>
<li title="Test Case Group Execution"><a href="run_test_chapter.html#id80492">Test Case Group Execution</a></li>
<li title="Running the Interactive Shell Mode"><a href="run_test_chapter.html#id80998">Running the Interactive Shell Mode</a></li>
<li title="Step-by-Step Execution of Test Cases with the Erlang Debugger"><a href="run_test_chapter.html#id81221">Step-by-Step Execution of Test Cases with the Erlang Debugger</a></li>
<li title="Test Specifications"><a href="run_test_chapter.html#id81349">Test Specifications</a></li>
<li title="Running Tests from the Web-Based GUI"><a href="run_test_chapter.html#id82334">Running Tests from the Web-Based GUI</a></li>
<li title="Log Files"><a href="run_test_chapter.html#id82446">Log Files</a></li>
<li title="HTML Style Sheets"><a href="run_test_chapter.html#id82918">HTML Style Sheets</a></li>
<li title="Repeating Tests"><a href="run_test_chapter.html#id83096">Repeating Tests</a></li>
<li title="Silent Connections"><a href="run_test_chapter.html#id83461">Silent Connections</a></li>
</ul>
</li>
<li id="no" title="External Configuration Data" expanded="false">External Configuration Data<ul>
<li><a href="config_file_chapter.html">
              Top of chapter
            </a></li>
<li title="General"><a href="config_file_chapter.html#id83697">General</a></li>
<li title="Syntax"><a href="config_file_chapter.html#id83740">Syntax</a></li>
<li title="Requiring and Reading Configuration Data"><a href="config_file_chapter.html#id83763">Requiring and Reading Configuration Data</a></li>
<li title="Using Configuration Variables Defined in Multiple Files"><a href="config_file_chapter.html#id83896">Using Configuration Variables Defined in Multiple Files</a></li>
<li title="Encrypted Configuration Files"><a href="config_file_chapter.html#id83920">Encrypted Configuration Files</a></li>
<li title="Opening Connections Using Configuration Data"><a href="config_file_chapter.html#id83984">Opening Connections Using Configuration Data</a></li>
<li title="User-Specific Configuration Data Formats"><a href="config_file_chapter.html#id84055">User-Specific Configuration Data Formats</a></li>
<li title="Examples of Configuration Data Handling"><a href="config_file_chapter.html#id84272">Examples of Configuration Data Handling</a></li>
<li title="Example of User-Specific Configuration Handler"><a href="config_file_chapter.html#id84327">Example of User-Specific Configuration Handler</a></li>
</ul>
</li>
<li id="no" title="Code Coverage Analysis" expanded="false">Code Coverage Analysis<ul>
<li><a href="cover_chapter.html">
              Top of chapter
            </a></li>
<li title="General"><a href="cover_chapter.html#id84454">General</a></li>
<li title="Use"><a href="cover_chapter.html#id84488">Use</a></li>
<li title="Stopping the Cover Tool When Tests Are Completed"><a href="cover_chapter.html#id84603">Stopping the Cover Tool When Tests Are Completed</a></li>
<li title="The Cover Specification File"><a href="cover_chapter.html#id84664">The Cover Specification File</a></li>
<li title="Cross Cover Analysis"><a href="cover_chapter.html#id84727">Cross Cover Analysis</a></li>
<li title="Logging"><a href="cover_chapter.html#id84955">Logging</a></li>
</ul>
</li>
<li id="no" title="Using Common Test for Large-Scale Testing" expanded="false">Using Common Test for Large-Scale Testing<ul>
<li><a href="ct_master_chapter.html">
              Top of chapter
            </a></li>
<li title="General"><a href="ct_master_chapter.html#id85043">General</a></li>
<li title="Use"><a href="ct_master_chapter.html#id85121">Use</a></li>
<li title="Test Specifications"><a href="ct_master_chapter.html#id85314">Test Specifications</a></li>
<li title="Automatic Startup of Test Target Nodes"><a href="ct_master_chapter.html#id85564">Automatic Startup of Test Target Nodes</a></li>
</ul>
</li>
<li id="no" title="Event Handling" expanded="false">Event Handling<ul>
<li><a href="event_handler_chapter.html">
              Top of chapter
            </a></li>
<li title="General"><a href="event_handler_chapter.html#id85775">General</a></li>
<li title="Use"><a href="event_handler_chapter.html#id85916">Use</a></li>
</ul>
</li>
<li id="no" title="Dependencies between Test Cases and Suites" expanded="false">Dependencies between Test Cases and Suites<ul>
<li><a href="dependencies_chapter.html">
              Top of chapter
            </a></li>
<li title="General"><a href="dependencies_chapter.html#id87034">General</a></li>
<li title="Saving Configuration Data"><a href="dependencies_chapter.html#id87172">Saving Configuration Data</a></li>
<li title="Sequences"><a href="dependencies_chapter.html#id87345">Sequences</a></li>
</ul>
</li>
<li id="no" title="Common Test Hooks" expanded="false">Common Test Hooks<ul>
<li><a href="ct_hooks_chapter.html">
              Top of chapter
            </a></li>
<li title="General"><a href="ct_hooks_chapter.html#id87551">General</a></li>
<li title="Installing a CTH"><a href="ct_hooks_chapter.html#id87612">Installing a CTH</a></li>
<li title="CTH Scope"><a href="ct_hooks_chapter.html#id87794">CTH Scope</a></li>
<li title="Manipulating Tests"><a href="ct_hooks_chapter.html#id88155">Manipulating Tests</a></li>
<li title="Synchronizing External User Applications with Common Test"><a href="ct_hooks_chapter.html#id88539">Synchronizing External User Applications with Common Test</a></li>
<li title="Example CTH"><a href="ct_hooks_chapter.html#id88615">Example CTH</a></li>
<li title="Built-In CTHs"><a href="ct_hooks_chapter.html#id88674">Built-In CTHs</a></li>
</ul>
</li>
<li id="no" title="Some Thoughts about Testing" expanded="false">Some Thoughts about Testing<ul>
<li><a href="why_test_chapter.html">
              Top of chapter
            </a></li>
<li title="Goals"><a href="why_test_chapter.html#id88865">Goals</a></li>
<li title="What to Test"><a href="why_test_chapter.html#id88885">What to Test</a></li>
</ul>
</li>
</ul>
</div></div>
<div id="content">
<div class="innertube">
<h1>2 Common Test Basics</h1>
  
  <a name="basics"></a>
  <h3><a name="id57978">2.1 
        General</a></h3>
    

    <p>The <span class="code">Common Test</span> framework is a tool that supports
      implementation and automated execution of test cases to any
      types of target systems. <span class="code">Common Test</span> is the main tool being used 
      in all testing- and verification activities that are part of Erlang/OTP 
      system development and maintenance.
    </p>

    <p>Test cases can be executed individually or in batches. <span class="code">Common Test</span>
      also features a distributed testing mode with central control and logging.
      With this feature, multiple systems can be tested independently in
      one common session. This is useful, for example, when running automated 
      large-scale regression tests.
    </p>

    <p>
      The System Under Test (SUT) can consist of one or more target
      nodes. <span class="code">Common Test</span> contains a generic test server that, 
      together with other test utilities, is used to perform test case execution. 
      The tests can be started from a GUI, from the OS shell, or from an
      Erlang shell. <strong>Test suites</strong> are files (Erlang
      modules) that contain the <strong>test cases</strong> (Erlang functions)
      to be executed. <strong>Support modules</strong> provide functions
      that the test cases use to do the tests.
    </p>
    
    <p>In a black-box testing scenario, <span class="code">Common Test</span>-based test programs connect to
      the target system(s) through standard O&amp;M and CLI protocols. <span class="code">Common Test</span>
      provides implementations of, and wrapper interfaces to, some of these
      protocols (most of which exist as standalone components and
      applications in OTP). The wrappers simplify configuration and add
      verbosity for logging purposes. <span class="code">Common Test</span> is continously extended with
      useful support modules. However, notice that it is
      a straightforward task to use any Erlang/OTP component
      for testing purposes with <span class="code">Common Test</span>, without needing a <span class="code">Common Test</span> 
      wrapper for it. It is as simple as calling Erlang functions. A number of 
      target-independent interfaces are supported in <span class="code">Common Test</span>, such as
      Generic Telnet and FTP. These can be specialized or used
      directly for controlling instruments, traffic load generators, and so on.
    </p> 
    
    <p><span class="code">Common Test</span> is also a very useful tool for white-box testing Erlang
      code (for example, module testing), as the test programs can call exported Erlang
      functions directly. there is very little overhead required for
      implementing basic test suites and executing simple tests. For black-box
      testing Erlang software, Erlang RPC and standard O&amp;M interfaces
      can be used for example.
    </p>
    
    <p>A test case can handle several connections to one or
      more target systems, instruments, and traffic generators in
      parallel to perform the necessary actions for a test. 
      The handling of many connections in parallel is one of
      the major strengths of <span class="code">Common Test</span>, thanks to the efficient
      support for concurrency in the Erlang runtime system, which <span class="code">Common Test</span> 
      users can take great advantage of.
    </p>
  

  <h3><a name="id64675">2.2 
        Test Suite Organisation</a></h3>
    
    <p>
      Test suites are organized in test directories and each test suite
      can have a separate data directory. Typically, these files and directories
      are version-controlled similar to other forms of source code (possibly by
      a version control system like GIT or Subversion). However, <span class="code">Common Test</span> 
      does not itself put any requirements on (or has any awareness of) 
      possible file and directory versions.
    </p>
  

  <h3><a name="id62285">2.3 
        Support Libraries</a></h3>
    
    <p>
      Support libraries contain functions that are useful for all test suites,
      or for test suites in a specific functional area or subsystem.
      In addition to the general support libraries provided by the
      <span class="code">Common Test</span> framework, and the various libraries and applications provided by
      Erlang/OTP, there can also be a need for customized (user specific) 
      support libraries. 
    </p>
  

  <h3><a name="id63359">2.4 
        Suites and Test Cases</a></h3>
    
    <p>
      Testing is performed by running test suites (sets of test cases) or 
      individual test cases. A test suite is implemented as an Erlang module named 
      <span class="code">&lt;suite_name&gt;_SUITE.erl</span> which contains a number of test cases.
      A test case is an Erlang function that tests one or more things. 
      The test case is the smallest unit that the <span class="code">Common Test</span> test server deals with.
    </p>
    <p>
      Subsets of test cases, called test case groups, can also be defined. A test case 
      group can have execution properties associated with it. Execution properties 
      specify if the test cases in the group are to be executed in
      random order, in parallel, or in sequence, and if the execution of the group 
      is to be repeated. Test case groups can also be nested (that is, a group can,
      besides test cases, contain subgroups).
    </p>
    <p>
      Besides test cases and groups, the test suite can also contain configuration 
      functions. These functions are meant to be used for setting up (and verifying)
      environment and state in the SUT (and/or the <span class="code">Common Test</span> host node), 
      required for the tests to execute correctly. Examples of operations are: 
      Opening a connection to the SUT, initializing a database, running an installation 
      script, and so on. Configuration can be performed per suite, per test case group,
      and per individual test case.
    </p>
    <p>
      The test suite module must conform to a
      <span class="bold_code"><a href="../../man/common_test.html">callback interface</a></span>
      specified by the <span class="code">Common Test</span> test server. For details, see section
      <span class="bold_code"><a href="write_test_chapter.html#intro">Writing Test Suites</a></span>.
    </p>

    <p>
      A test case is considered successful if it returns to the caller, no matter 
      what the returned value is. However, a few return values have special meaning
      as follows:</p>
      <ul>
       <li>
<span class="code">{skip,Reason}</span> indicates that the test case is skipped.</li>
       <li>
<span class="code">{comment,Comment}</span> prints a comment in the log for the test case.</li>
       <li>
<span class="code">{save_config,Config}</span> makes the <span class="code">Common Test</span> test server pass 
       <span class="code">Config</span> to the next test case.</li>
     </ul>
     <p>
      A test case failure is specified as a runtime error (a crash), no matter what 
      the reason for termination is. If you use Erlang pattern matching effectively,
      you can take advantage of this property. The result is concise and 
      readable test case functions that look much more like scripts than actual programs. 
      A simple example:
    </p>
    <div class="example"><pre>
 session(_Config) -&gt;
     {started,ServerId} = my_server:start(),
     {clients,[]} = my_server:get_clients(ServerId),
     MyId = self(),
     connected = my_server:connect(ServerId, MyId),
     {clients,[MyId]} = my_server:get_clients(ServerId),
     disconnected = my_server:disconnect(ServerId, MyId),
     {clients,[]} = my_server:get_clients(ServerId),
     stopped = my_server:stop(ServerId).</pre></div>
    <p>
      As a test suite runs, all information (including output to <span class="code">stdout</span>) is 
      recorded in many different log files. A minimum of information is displayed 
      in the user console (only start and stop information, plus a note 
      for each failed test case).
    </p>
    <p>
      The result from each test case is recorded in a dedicated HTML log file, created 
      for the particular test run. An overview page displays each test case represented 
      by a table row showing total execution time, if the case was successful,
      failed, or skipped, plus an optional user comment. For a failed test case, the 
      reason for termination is also printed in the comment field. The overview page
      has a link to each test case log file, providing simple navigation with any standard
      HTML browser.
    </p>
    

  <h3>
<a name="External_Interfaces"></a><a name="id61440">2.5 
        External Interfaces</a>
</h3>

    
    <p>
      The <span class="code">Common Test</span> test server requires that the test suite defines and exports the 
      following mandatory or optional callback functions:
    </p>
    
    <dl>
      <dt><strong><span class="code">all()</span></strong></dt>
        <dd><p>Returns a list of all test cases and groups in the suite. (Mandatory)</p></dd>
      <dt><strong><span class="code">suite()</span></strong></dt>
        <dd><p>Information function used to return properties for the suite. (Optional)</p></dd>
      <dt><strong><span class="code">groups()</span></strong></dt>
        <dd><p>For declaring test case groups. (Optional)</p></dd>
      <dt><strong><span class="code">init_per_suite(Config)</span></strong></dt>
        <dd><p>Suite level configuration function, executed before the first 
	test case. (Optional)</p></dd>
      <dt><strong><span class="code">end_per_suite(Config)</span></strong></dt>
        <dd><p>Suite level configuration function, executed after the last 
	test case. (Optional)</p></dd>
      <dt><strong><span class="code">group(GroupName)</span></strong></dt>
        <dd><p>Information function used to return properties for a test case group. (Optional)</p></dd>	
      <dt><strong><span class="code">init_per_group(GroupName, Config)</span></strong></dt>
        <dd><p>Configuration function for a group, executed before the first 
	test case. (Optional)</p></dd>
      <dt><strong><span class="code">end_per_group(GroupName, Config)</span></strong></dt>
        <dd><p>Configuration function for a group, executed after the last 
	test case. (Optional)</p></dd>
      <dt><strong><span class="code">init_per_testcase(TestCase, Config)</span></strong></dt>
        <dd><p>Configuration function for a testcase, executed before each 
	test case. (Optional)</p></dd>
      <dt><strong><span class="code">end_per_testcase(TestCase, Config)</span></strong></dt>
      <dd><p>Configuration function for a testcase, executed after each 
      test case. (Optional)</p></dd> 
    </dl>
      <p>
	For each test case, the <span class="code">Common Test</span> test server expects the
	following functions:
      </p>
      <dl>
	<dt><strong>Testcasename()</strong></dt>
	  <dd><p>Information function that returns a list of test case properties. (Optional)</p></dd>
	<dt><strong>Testcasename(Config)</strong></dt> 
	  <dd><p>The test case function.</p></dd> 
      </dl>
    
</div>
<div class="footer">
<hr>
<p>Copyright © 2003-2017 Ericsson AB. All Rights Reserved.</p>
</div>
</div>
</div></body>
</html>
