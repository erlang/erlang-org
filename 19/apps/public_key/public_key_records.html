<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html xmlns:erl="http://erlang.org" xmlns:fn="http://www.w3.org/2005/02/xpath-functions">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" href="../../otp_doc.css" type="text/css">
<title>Erlang -- Public-Key Records</title>
</head>
<body bgcolor="white" text="#000000" link="#0000ff" vlink="#ff00ff" alink="#ff0000"><div id="container">
<script id="js" type="text/javascript" language="JavaScript" src="../../js/flipmenu/flipmenu.js"></script><script id="js2" type="text/javascript" src="../../js/erlresolvelinks.js"></script><script language="JavaScript" type="text/javascript">
            <!--
              function getWinHeight() {
                var myHeight = 0;
                if( typeof( window.innerHeight ) == 'number' ) {
                  //Non-IE
                  myHeight = window.innerHeight;
                } else if( document.documentElement && ( document.documentElement.clientWidth ||
                                                         document.documentElement.clientHeight ) ) {
                  //IE 6+ in 'standards compliant mode'
                  myHeight = document.documentElement.clientHeight;
                } else if( document.body && ( document.body.clientWidth || document.body.clientHeight ) ) {
                  //IE 4 compatible
                  myHeight = document.body.clientHeight;
                }
                return myHeight;
              }

              function setscrollpos() {
                var objf=document.getElementById('loadscrollpos');
                 document.getElementById("leftnav").scrollTop = objf.offsetTop - getWinHeight()/2;
              }

              function addEvent(obj, evType, fn){
                if (obj.addEventListener){
                obj.addEventListener(evType, fn, true);
                return true;
              } else if (obj.attachEvent){
                var r = obj.attachEvent("on"+evType, fn);
                return r;
              } else {
                return false;
              }
             }

             addEvent(window, 'load', setscrollpos);

             //--></script><div id="leftnav"><div class="innertube">
<img alt="Erlang logo" src="../../erlang-logo.png"><br><small><a href="users_guide.html">User's Guide</a><br><a href="index.html">Reference Manual</a><br><a href="release_notes.html">Release Notes</a><br><a href="public_key.pdf">PDF</a><br><a href="../../index.html">Top</a></small><p><strong>public_key</strong><br><strong>User's Guide</strong><br><small>Version 1.4</small></p>
<br><a href="javascript:openAllFlips()">Expand All</a><br><a href="javascript:closeAllFlips()">Contract All</a><p><small><strong>Chapters</strong></small></p>
<ul class="flipMenu" imagePath="../../js/flipmenu">
<li id="no" title="Introduction" expanded="false">Introduction<ul>
<li><a href="introduction.html">
              Top of chapter
            </a></li>
<li title="Purpose"><a href="introduction.html#id61551">Purpose</a></li>
<li title="Prerequisites"><a href="introduction.html#id63270">Prerequisites</a></li>
<li title="Performance Tips"><a href="introduction.html#id62056">Performance Tips</a></li>
</ul>
</li>
<li id="loadscrollpos" title="Public-Key Records" expanded="true">Public-Key Records<ul>
<li><a href="public_key_records.html">
              Top of chapter
            </a></li>
<li title="Data Types"><a href="public_key_records.html#id57319">Data Types</a></li>
<li title="RSA"><a href="public_key_records.html#id63287">RSA</a></li>
<li title="DSA"><a href="public_key_records.html#id61574">DSA</a></li>
<li title="ECDSA "><a href="public_key_records.html#id61008">ECDSA </a></li>
<li title="PKIX Certificates"><a href="public_key_records.html#id61032">PKIX Certificates</a></li>
<li title="Standard Certificate Extensions"><a href="public_key_records.html#id63074">Standard Certificate Extensions</a></li>
<li title="Private Internet Extensions"><a href="public_key_records.html#id62433">Private Internet Extensions</a></li>
<li title="CRL and CRL Extensions Profile"><a href="public_key_records.html#id62694">CRL and CRL Extensions Profile</a></li>
</ul>
</li>
<li id="no" title="Getting Started" expanded="false">Getting Started<ul>
<li><a href="using_public_key.html">
              Top of chapter
            </a></li>
<li title="PEM Files"><a href="using_public_key.html#id61998">PEM Files</a></li>
<li title="RSA Public-Key Cryptography"><a href="using_public_key.html#id66381">RSA Public-Key Cryptography</a></li>
<li title="Digital Signatures"><a href="using_public_key.html#id66445">Digital Signatures</a></li>
<li title="Verifying a certificate hostname"><a href="using_public_key.html#id66528">Verifying a certificate hostname</a></li>
<li title="SSH Files"><a href="using_public_key.html#id67159">SSH Files</a></li>
</ul>
</li>
</ul>
</div></div>
<div id="content">
<div class="innertube">
<h1>2 Public-Key Records</h1>
  
    
  <p>This chapter briefly describes Erlang records derived from ASN.1
  specifications used to handle public key infrastructure.
  The scope is to describe the data types of each component,
  not the semantics. For information on the
  semantics, refer to the relevant standards and RFCs linked in the sections below.</p>

  <p>Use the following include directive to get access to the
  records and constant macros described in the following sections:</p>
  
  <div class="example"><pre> -include_lib("public_key/include/public_key.hrl"). </pre></div>

 <h3><a name="id57319">2.1 
        Data Types</a></h3>
       

    <p>Common non-standard Erlang
    data types used to describe the record fields in the
    following sections and which are not defined in the Public Key <span class="bold_code"><a href="../../man/public_key.html">Reference Manual</a></span>
    follows here:</p>
    
    <dl>
      <dt><strong><span class="code">time() =</span></strong></dt>
      <dd><p><span class="code">utc_time() | general_time()</span></p></dd>

      <dt><strong><span class="code">utc_time() =</span></strong></dt>
      <dd><p><span class="code">{utcTime, "YYMMDDHHMMSSZ"}</span></p></dd>

      <dt><strong><span class="code">general_time() =</span></strong></dt>
      <dd><p><span class="code">{generalTime, "YYYYMMDDHHMMSSZ"}</span></p></dd>
 
      <dt><strong><span class="code">general_name() =</span></strong></dt>
      <dd>
<p><span class="code">{rfc822Name, string()}</span></p>
      <p><span class="code">| {dNSName, string()}</span></p>
      <p><span class="code">| {x400Address, string()}</span></p>
      <p><span class="code">| {directoryName, {rdnSequence, [#AttributeTypeAndValue'{}]}}</span></p>
      <p><span class="code">| {eidPartyName, special_string()}</span></p>
      <p><span class="code">| {eidPartyName, special_string(), special_string()}</span></p>
      <p><span class="code">| {uniformResourceIdentifier, string()}</span></p>
      <p><span class="code">| {ipAddress, string()}</span></p>
      <p><span class="code">| {registeredId, oid()}</span></p>
      <p><span class="code">| {otherName, term()}</span></p>
      </dd>

      <dt><strong><span class="code">special_string() =</span></strong></dt>
      <dd>
<p><span class="code">{teletexString, string()}</span></p>
      <p><span class="code">| {printableString, string()}</span></p>
      <p><span class="code">| {universalString, string()}</span></p>
      <p><span class="code">| {utf8String, binary()}</span></p>
      <p><span class="code">| {bmpString, string()}</span></p>
      </dd>

      <dt><strong><span class="code">dist_reason() =</span></strong></dt>
      <dd>
<p><span class="code">unused</span></p>
      <p><span class="code">| keyCompromise</span></p>
      <p><span class="code">| cACompromise</span></p>
      <p><span class="code">| affiliationChanged</span></p>
      <p><span class="code">| superseded</span></p>
      <p><span class="code">| cessationOfOperation</span></p>
      <p><span class="code">| certificateHold</span></p>
      <p><span class="code">| privilegeWithdrawn</span></p>
      <p><span class="code">| aACompromise</span></p>
      </dd>

      <dt><strong><span class="code">OID_macro() =</span></strong></dt>
      <dd>
<p><span class="code">?OID_name()</span></p>
      </dd>
      
      <dt><strong><span class="code">OID_name() =</span></strong></dt>
      <dd>
<p><span class="code">atom()</span></p>
      </dd>
      
    </dl>

  
  
  <h3><a name="id63287">2.2 
        RSA</a></h3>
    
    <p>Erlang representation of <span class="bold_code"><a href="http://www.ietf.org/rfc/rfc3447.txt"> 
    Rivest-Shamir-Adleman cryptosystem (RSA)</a></span> keys follows:</p>
    
    <div class="example"><pre>
#'RSAPublicKey'{
	  modulus,       % integer()
	  publicExponent % integer()
	  }.

#'RSAPrivateKey'{
          version,         % two-prime | multi
	  modulus,         % integer()
	  publicExponent,  % integer()
	  privateExponent, % integer()
	  prime1,          % integer() 
	  prime2,          % integer()
	  exponent1,       % integer()
	  exponent2,       % integer()
	  coefficient,     % integer()
	  otherPrimeInfos  % [#OtherPrimeInfo{}] | asn1_NOVALUE
	 }.

#'OtherPrimeInfo'{
	prime,           % integer()
	exponent,        % integer()
	coefficient      % integer()
 	 }.	 </pre></div>

  

  <h3><a name="id61574">2.3 
        DSA</a></h3>
    
     <p>Erlang representation of <span class="bold_code"><a href="http://www.ietf.org/rfc/rfc6979.txt">Digital Signature Algorithm (DSA)</a></span> keys</p>
    <div class="example"><pre>	 
#'DSAPrivateKey',{
	  version,      % integer()
	  p,            % integer()
	  q,            % integer()
	  g,            % integer()
	  y,            % integer()
	  x             % integer()
	  }.

#'Dss-Parms',{
         p,         % integer()
	 q,         % integer()
	 g          % integer()
	 }. </pre></div>
	
  

  <h3><a name="id61008">2.4 
        ECDSA </a></h3>
       
       <p>Erlang representation of  <span class="bold_code"><a href="http://www.ietf.org/rfc/rfc6979.txt">Elliptic Curve Digital Signature Algorithm (ECDSA)</a></span> keys follows:</p> 
    
    <div class="example"><pre>	 
#'ECPrivateKey'{
          version,       % integer()
	  privateKey,    % binary()  
	  parameters,    % der_encoded() - {'EcpkParameters', #'ECParameters'{}} |
	                                   {'EcpkParameters', {namedCurve, oid()}} |
	                                   {'EcpkParameters', 'NULL'} % Inherited by CA
	  publicKey      % bitstring()
	  }.
	  
#'ECParameters'{
      version,    % integer()
      fieldID,    % #'FieldID'{}
      curve,      % #'Curve'{}
      base,       % binary()       
      order,      % integer()        
      cofactor    % integer()
      }.
      
#'Curve'{
	a,        % binary()
	b,        % binary() 
	seed      % bitstring() - optional

	}.

#'FieldID'{
	fieldType,    % oid()
	parameters    % Depending on fieldType
	}.

#'ECPoint'{
      point %  binary() - the public key
      }.</pre></div>
  

  <h3><a name="id61032">2.5 
        PKIX Certificates</a></h3>
       
    <p>Erlang representation of PKIX certificates derived from ASN.1 
    specifications see also <span class="bold_code"><a href="http://www.ietf.org/rfc/rfc5280.txt">X509 certificates (RFC 5280)</a></span>, also referred to as <span class="code">plain</span> type,  are as follows:</p>
<div class="example"><pre>
#'Certificate'{
		tbsCertificate,        % #'TBSCertificate'{}
		signatureAlgorithm,    % #'AlgorithmIdentifier'{} 
		signature              % bitstring()
	       }.

#'TBSCertificate'{
	  version,              % v1 | v2 | v3 
	  serialNumber,         % integer() 
	  signature,            % #'AlgorithmIdentifier'{} 
	  issuer,               % {rdnSequence, [#AttributeTypeAndValue'{}]} 
	  validity,             % #'Validity'{}
	  subject,              % {rdnSequence, [#AttributeTypeAndValue'{}]} 
	  subjectPublicKeyInfo, % #'SubjectPublicKeyInfo'{}
	  issuerUniqueID,       % binary() | asn1_novalue
	  subjectUniqueID,      % binary() | asn1_novalue
	  extensions            % [#'Extension'{}] 
	 }.
	  
#'AlgorithmIdentifier'{
	  algorithm,  % oid() 
	  parameters  % der_encoded()
	 }.</pre></div>

<p>Erlang alternate representation of PKIX certificate, also referred to as <span class="code">otp</span> type</p>
	 
<div class="example"><pre>
#'OTPCertificate'{
		tbsCertificate,        % #'OTPTBSCertificate'{}
		signatureAlgorithm,    % #'SignatureAlgorithm'
		signature              % bitstring()
	       }.

#'OTPTBSCertificate'{
	  version,              % v1 | v2 | v3 
	  serialNumber,         % integer() 
	  signature,            % #'SignatureAlgorithm'
	  issuer,               % {rdnSequence, [#AttributeTypeAndValue'{}]} 
	  validity,             % #'Validity'{}
	  subject,              % {rdnSequence, [#AttributeTypeAndValue'{}]} 
	  subjectPublicKeyInfo, % #'OTPSubjectPublicKeyInfo'{}
	  issuerUniqueID,       % binary() | asn1_novalue
	  subjectUniqueID,      % binary() | asn1_novalue
	  extensions            % [#'Extension'{}] 
	 }.
	  
#'SignatureAlgorithm'{
	  algorithm,  % id_signature_algorithm()
	  parameters  % asn1_novalue | #'Dss-Parms'{}
	 }.</pre></div>

<p><span class="code">id_signature_algorithm() = OID_macro()</span></p>

<p>The available OID names are as follows:</p>
<table border="1" cellpadding="2" cellspacing="0">
<tr>
    <td align="left" valign="middle"><strong>OID Name</strong></td>
  </tr>
<tr>
    <td align="left" valign="middle">id-dsa-with-sha1</td>
      </tr>
<tr>
	<td align="left" valign="middle">id-dsaWithSHA1 (ISO or OID to above)</td>
      </tr>
<tr>
	<td align="left" valign="middle">md2WithRSAEncryption</td>
      </tr>
<tr>
	<td align="left" valign="middle">md5WithRSAEncryption</td>
      </tr>
<tr>
	<td align="left" valign="middle">sha1WithRSAEncryption</td>
      </tr>
<tr>
	<td align="left" valign="middle">sha-1WithRSAEncryption (ISO or OID to above)</td>
      </tr>
<tr>
	<td align="left" valign="middle">sha224WithRSAEncryption</td>
      </tr>
<tr>
	<td align="left" valign="middle">sha256WithRSAEncryption</td>
      </tr>
<tr>
	<td align="left" valign="middle">sha512WithRSAEncryption</td>
      </tr>
<tr>
	  <td align="left" valign="middle">ecdsa-with-SHA1</td>
     </tr>
</table>
<em>Table
        2.1:
         
        Signature Algorithm OIDs </em>
    
<p>The data type <span class="code">'AttributeTypeAndValue'</span>, is represented as
 the following erlang record:</p>

<div class="example"><pre>
#'AttributeTypeAndValue'{
	  type,   % id_attributes()
	  value   % term() 
	 }.</pre></div>

<p>The attribute OID name atoms and their corresponding value types
are as follows:</p>
<table border="1" cellpadding="2" cellspacing="0">
<tr>
    <td align="left" valign="middle"><strong>OID Name</strong></td>
    <td align="left" valign="middle"><strong>Value Type</strong></td>
  </tr>
<tr>
    <td align="left" valign="middle">id-at-name</td>
    <td align="left" valign="middle">special_string()</td>
  </tr>
<tr>
    <td align="left" valign="middle">id-at-surname</td>
    <td align="left" valign="middle">special_string()</td>
  </tr>
<tr>
    <td align="left" valign="middle">id-at-givenName</td>
    <td align="left" valign="middle">special_string()</td>
  </tr>
<tr>
    <td align="left" valign="middle">id-at-initials </td>
    <td align="left" valign="middle">special_string()</td>
  </tr>
<tr>
    <td align="left" valign="middle">id-at-generationQualifier</td>
    <td align="left" valign="middle">special_string()</td>
  </tr>
<tr>
    <td align="left" valign="middle">id-at-commonName</td>
    <td align="left" valign="middle">special_string()</td>
  </tr>
<tr>
    <td align="left" valign="middle">id-at-localityName</td>
    <td align="left" valign="middle">special_string()</td>
  </tr>
<tr>
    <td align="left" valign="middle">id-at-stateOrProvinceName</td>
    <td align="left" valign="middle">special_string()</td>
  </tr>
<tr>
    <td align="left" valign="middle">id-at-organizationName</td>
    <td align="left" valign="middle">special_string()</td>
  </tr>
<tr>
    <td align="left" valign="middle">id-at-title</td>
    <td align="left" valign="middle">special_string()</td>
  </tr>
<tr>
    <td align="left" valign="middle">id-at-dnQualifier</td>
    <td align="left" valign="middle">{printableString, string()}</td>
  </tr>
<tr>
    <td align="left" valign="middle">id-at-countryName</td>
    <td align="left" valign="middle">{printableString, string()}</td>
  </tr>
<tr>
    <td align="left" valign="middle">id-at-serialNumber</td>
    <td align="left" valign="middle">{printableString, string()}</td>
  </tr>
<tr>
    <td align="left" valign="middle">id-at-pseudonym</td>
    <td align="left" valign="middle">special_string()</td>
  </tr>
</table>
<em>Table
        2.2:
         
        Attribute OIDs</em>
    
<p>The data types <span class="code">'Validity'</span>, <span class="code">'SubjectPublicKeyInfo'</span>, and 
<span class="code">'SubjectPublicKeyInfoAlgorithm'</span> are represented as the following Erlang records:</p>

<div class="example"><pre>
#'Validity'{ 
	  notBefore, % time()
	  notAfter   % time()
	 }.
	 
#'SubjectPublicKeyInfo'{
	  algorithm,       % #AlgorithmIdentifier{} 
	  subjectPublicKey % binary() 
	 }.

#'SubjectPublicKeyInfoAlgorithm'{
	  algorithm,  % id_public_key_algorithm()
	  parameters  % public_key_params()
	 }.</pre></div>

<p>The public-key algorithm OID name atoms are as follows:</p>
<table border="1" cellpadding="2" cellspacing="0">
<tr>
    <td align="left" valign="middle"><strong>OID Name</strong></td>
  </tr>
<tr>
    <td align="left" valign="middle">rsaEncryption</td>
      </tr>
<tr>
	<td align="left" valign="middle">id-dsa</td>
      </tr>
<tr>
	<td align="left" valign="middle">dhpublicnumber</td>
      </tr>
<tr>
	<td align="left" valign="middle">id-keyExchangeAlgorithm</td>
      </tr>
<tr>
	<td align="left" valign="middle">id-ecPublicKey</td>
      </tr>
</table>
<em>Table
        2.3:
         
        Public-Key Algorithm OIDs</em>
    
<div class="example"><pre>
#'Extension'{
	  extnID,    % id_extensions() | oid() 
	  critical,  % boolean()
	  extnValue  % der_encoded()
	 }.</pre></div>

<p><span class="code">id_extensions()</span>  
  <span class="bold_code"><a href="#StdCertExt">Standard Certificate Extensions</a></span>, 
  <span class="bold_code"><a href="#PrivIntExt">Private Internet Extensions</a></span>,  
  <span class="bold_code"><a href="#CRLCertExt">CRL Extensions</a></span> and 
  <span class="bold_code"><a href="#CRLEntryExt">CRL Entry Extensions</a></span>.
</p>
    

  
<h3>
<a name="StdCertExt"></a><a name="id63074">2.6 
        Standard Certificate Extensions</a>
</h3>
  
  
    
  <p>The standard certificate extensions OID name atoms and their 
  corresponding value types are as follows:</p>

  <table border="1" cellpadding="2" cellspacing="0">
<tr>
	<td align="left" valign="middle"><strong>OID Name</strong></td>
	<td align="left" valign="middle"><strong>Value Type</strong></td>
      </tr>
<tr>
	<td align="left" valign="middle">id-ce-authorityKeyIdentifier</td>
	<td align="left" valign="middle">#'AuthorityKeyIdentifier'{}</td>
      </tr>
<tr>
	<td align="left" valign="middle">id-ce-subjectKeyIdentifier</td>
	<td align="left" valign="middle">oid()</td>
      </tr>
<tr>
	<td align="left" valign="middle">id-ce-keyUsage</td>
	<td align="left" valign="middle">[key_usage()]</td>
      </tr>
<tr>
	<td align="left" valign="middle">id-ce-privateKeyUsagePeriod</td>
	<td align="left" valign="middle">#'PrivateKeyUsagePeriod'{}</td>
      </tr>
<tr>
	<td align="left" valign="middle">id-ce-certificatePolicies</td>
	<td align="left" valign="middle">#'PolicyInformation'{}</td>
      </tr>
<tr>
	<td align="left" valign="middle">id-ce-policyMappings</td>
	<td align="left" valign="middle">#'PolicyMappings_SEQOF'{}</td>
      </tr>
<tr>
	<td align="left" valign="middle">id-ce-subjectAltName</td>
	<td align="left" valign="middle">general_name()</td>
      </tr>
<tr>
	<td align="left" valign="middle">id-ce-issuerAltName</td>
	<td align="left" valign="middle">general_name()</td>
      </tr>
<tr>
	<td align="left" valign="middle">id-ce-subjectDirectoryAttributes</td>
	<td align="left" valign="middle"> [#'Attribute'{}]</td>
      </tr>
<tr>
          <td align="left" valign="middle">id-ce-basicConstraints</td>
	  <td align="left" valign="middle">#'BasicConstraints'{}</td>
      </tr>
<tr>
	<td align="left" valign="middle">id-ce-nameConstraints</td>
	<td align="left" valign="middle">#'NameConstraints'{}</td>
      </tr>
<tr>
	<td align="left" valign="middle">id-ce-policyConstraints</td>
	<td align="left" valign="middle">#'PolicyConstraints'{}</td>
      </tr>
<tr>
	<td align="left" valign="middle">id-ce-extKeyUsage</td>
	<td align="left" valign="middle">[id_key_purpose()]</td>
      </tr>
<tr>
	<td align="left" valign="middle">id-ce-cRLDistributionPoints</td>
	<td align="left" valign="middle">[#'DistributionPoint'{}]</td>
      </tr>
<tr>
	<td align="left" valign="middle">id-ce-inhibitAnyPolicy</td>
	<td align="left" valign="middle">integer()</td>
      </tr>
<tr>
	<td align="left" valign="middle">id-ce-freshestCRL</td>
	<td align="left" valign="middle">[#'DistributionPoint'{}]</td>
      </tr>
</table>
<em>Table
        2.4:
         
        Standard Certificate Extensions</em>

    <p>Here:</p>
    <dl>
      <dt><strong><span class="code">key_usage()</span></strong></dt>
      <dd>= <p><span class="code">digitalSignature</span></p>
      <p><span class="code">| nonRepudiation</span></p>
      <p><span class="code">| keyEncipherment</span></p>
      <p><span class="code">| dataEncipherment</span></p>
      <p><span class="code">| keyAgreement</span></p>
      <p><span class="code">| keyCertSign</span></p>
      <p><span class="code">| cRLSign</span></p>
      <p><span class="code">| encipherOnly</span></p>
      <p><span class="code">| decipherOnly </span></p>
      </dd>
    </dl>
   
    <p>And for <span class="code">id_key_purpose()</span>:</p>
    
<table border="1" cellpadding="2" cellspacing="0">
<tr>
    <td align="left" valign="middle"><strong>OID Name</strong></td>
  </tr>
<tr>
    <td align="left" valign="middle">id-kp-serverAuth</td>
      </tr>
<tr>
	<td align="left" valign="middle">id-kp-clientAuth</td>
      </tr>
<tr>
	<td align="left" valign="middle">id-kp-codeSigning</td>
      </tr>
<tr>
	<td align="left" valign="middle">id-kp-emailProtection</td>
      </tr>
<tr>
	<td align="left" valign="middle">id-kp-timeStamping</td>
      </tr>
<tr>
	<td align="left" valign="middle">id-kp-OCSPSigning</td>
      </tr>
</table>
<em>Table
        2.5:
         
        Key Purpose OIDs</em>
    
    <div class="example"><pre>
#'AuthorityKeyIdentifier'{
	  keyIdentifier,	    % oid()
	  authorityCertIssuer,      % general_name()
	  authorityCertSerialNumber % integer() 
	 }.

#'PrivateKeyUsagePeriod'{
	  notBefore,   % general_time()
	  notAfter     % general_time()
	 }.

#'PolicyInformation'{
	  policyIdentifier,  % oid()
	  policyQualifiers   % [#PolicyQualifierInfo{}]
	 }.

#'PolicyQualifierInfo'{
	  policyQualifierId,   % oid()
	  qualifier            % string() | #'UserNotice'{}
	 }.

#'UserNotice'{
         noticeRef,   % #'NoticeReference'{}
	 explicitText % string()
	 }.

#'NoticeReference'{
         organization,    % string()
	 noticeNumbers    % [integer()]
	 }.

#'PolicyMappings_SEQOF'{
	  issuerDomainPolicy,  % oid()
	  subjectDomainPolicy  % oid()
	 }.

#'Attribute'{
          type,  % oid()
	  values % [der_encoded()]
	  }).

#'BasicConstraints'{
	  cA,		    % boolean()
	  pathLenConstraint % integer()
	 }).

#'NameConstraints'{
	  permittedSubtrees, % [#'GeneralSubtree'{}]
	  excludedSubtrees   % [#'GeneralSubtree'{}]
	 }).

#'GeneralSubtree'{
	  base,    % general_name()
	  minimum, % integer()
	  maximum  % integer()
	 }).

#'PolicyConstraints'{
	  requireExplicitPolicy, % integer()
	  inhibitPolicyMapping   % integer()
	 }).

#'DistributionPoint'{
	  distributionPoint, % {fullName, [general_name()]} | {nameRelativeToCRLIssuer,
	  [#AttributeTypeAndValue{}]}
	  reasons,           % [dist_reason()]
	  cRLIssuer          % [general_name()]
	 }).</pre></div>



 <h3>
<a name="PrivIntExt"></a><a name="id62433">2.7 
        Private Internet Extensions</a>
</h3>
   
      

   <p>The private internet extensions OID name atoms and their corresponding value 
   types are as follows:</p>

   <table border="1" cellpadding="2" cellspacing="0">
<tr>
          <td align="left" valign="middle"><strong>OID Name</strong></td>
          <td align="left" valign="middle"><strong>Value Type</strong></td>
        </tr>
<tr>
          <td align="left" valign="middle">id-pe-authorityInfoAccess</td>
          <td align="left" valign="middle">[#'AccessDescription'{}]</td>
        </tr>
<tr>
          <td align="left" valign="middle">id-pe-subjectInfoAccess</td>
          <td align="left" valign="middle">[#'AccessDescription'{}]</td>
        </tr>
</table>
<em>Table
        2.6:
         
        Private Internet Extensions</em>   
 
<div class="example"><pre>
#'AccessDescription'{
           accessMethod,    % oid()
	   accessLocation   % general_name()
	 }).</pre></div>

 
 
<h3><a name="id62694">2.8 
        CRL and CRL Extensions Profile</a></h3>
    

    <p>Erlang representation of CRL and CRL extensions profile 
    derived from ASN.1 specifications and RFC 5280 are as follows:</p>

 <div class="example"><pre>
#'CertificateList'{
          tbsCertList,        % #'TBSCertList{}
          signatureAlgorithm, % #'AlgorithmIdentifier'{} 
          signature           % bitstring()
	  }).

#'TBSCertList'{
      version,             % v2 (if defined)
      signature,           % #AlgorithmIdentifier{}
      issuer,              % {rdnSequence, [#AttributeTypeAndValue'{}]} 
      thisUpdate,          % time()
      nextUpdate,          % time() 
      revokedCertificates, % [#'TBSCertList_revokedCertificates_SEQOF'{}]
      crlExtensions        % [#'Extension'{}]
      }).

#'TBSCertList_revokedCertificates_SEQOF'{
         userCertificate,      % integer()
 	 revocationDate,       % timer()
	 crlEntryExtensions    % [#'Extension'{}]
	 }).</pre></div>
 
 <h4>
<a name="CRLCertExt"></a>CRL Extensions</h4>
   
   

   <p>The CRL extensions OID name atoms and their corresponding value types are as follows:</p>
   
   
        <table border="1" cellpadding="2" cellspacing="0">
<tr>
          <td align="left" valign="middle"><strong>OID Name</strong></td>
          <td align="left" valign="middle"><strong>Value Type</strong></td>
        </tr>
<tr>
          <td align="left" valign="middle">id-ce-authorityKeyIdentifier</td>
          <td align="left" valign="middle">#'AuthorityKeyIdentifier{}</td>
        </tr>
<tr>
          <td align="left" valign="middle">id-ce-issuerAltName</td>
          <td align="left" valign="middle">{rdnSequence, [#AttributeTypeAndValue'{}]}</td>
           </tr>
<tr>
          <td align="left" valign="middle">id-ce-cRLNumber</td>
          <td align="left" valign="middle">integer()</td>
           </tr>
<tr>
          <td align="left" valign="middle">id-ce-deltaCRLIndicator</td>
          <td align="left" valign="middle">integer()</td>
           </tr>
<tr>
          <td align="left" valign="middle">id-ce-issuingDistributionPoint</td>
          <td align="left" valign="middle">#'IssuingDistributionPoint'{}</td>
           </tr>
<tr>
          <td align="left" valign="middle">id-ce-freshestCRL</td>
          <td align="left" valign="middle">[#'Distributionpoint'{}]</td>
           </tr>
</table>
<em>Table
        2.7:
         
        CRL Extensions</em>
      
      <p>Here, the data type <span class="code">'IssuingDistributionPoint'</span> is represented as 
      the following Erlang record:</p>

      <div class="example"><pre>
#'IssuingDistributionPoint'{
          distributionPoint,         % {fullName, [general_name()]} | {nameRelativeToCRLIssuer,
	  [#AttributeTypeAndValue'{}]}
	  onlyContainsUserCerts,     % boolean()
	  onlyContainsCACerts,       % boolean()
	  onlySomeReasons,           % [dist_reason()]
	  indirectCRL,               % boolean()
	  onlyContainsAttributeCerts % boolean()
	  }).</pre></div> 
 
 
 <h4>
<a name="CRLEntryExt"></a>CRL Entry Extensions</h4>
   
   

   <p>The CRL entry extensions OID name atoms and their corresponding value types are as follows:</p>

       <table border="1" cellpadding="2" cellspacing="0">
<tr>
          <td align="left" valign="middle"><strong>OID Name</strong></td>
          <td align="left" valign="middle"><strong>Value Type</strong></td>
        </tr>
<tr>
          <td align="left" valign="middle">id-ce-cRLReason</td>
          <td align="left" valign="middle">crl_reason()</td>
        </tr>
<tr>
          <td align="left" valign="middle">id-ce-holdInstructionCode</td>
          <td align="left" valign="middle">oid()</td>
           </tr>
<tr>
          <td align="left" valign="middle">id-ce-invalidityDate</td>
          <td align="left" valign="middle">general_time()</td>
           </tr>
<tr>
          <td align="left" valign="middle">id-ce-certificateIssuer</td>
          <td align="left" valign="middle">general_name()</td>
           </tr>
</table>
<em>Table
        2.8:
         
        CRL Entry Extensions</em>


       <p>Here:</p>
       <dl>
      <dt><strong><span class="code">crl_reason()</span></strong></dt>
      <dd>= <p><span class="code">unspecified</span></p>
      <p><span class="code">| keyCompromise</span></p>
      <p><span class="code">| cACompromise</span></p>
      <p><span class="code">| affiliationChanged</span></p>
      <p><span class="code">| superseded</span></p>
      <p><span class="code">| cessationOfOperation</span></p>
      <p><span class="code">| certificateHold</span></p>
      <p><span class="code">| removeFromCRL</span></p>
      <p><span class="code">| privilegeWithdrawn</span></p>
      <p><span class="code">| aACompromise</span></p>
      </dd>
       </dl>

 

 <h4>
<a name="PKCS10"></a>PKCS#10 Certification Request</h4>
   
   
   <p>Erlang representation of a PKCS#10 certification request 
   derived from ASN.1 specifications and RFC 5280 are as follows:</p>
   <div class="example"><pre>
#'CertificationRequest'{
          certificationRequestInfo #'CertificationRequestInfo'{},
	  signatureAlgorithm	   #'CertificationRequest_signatureAlgorithm'{}}.
	  signature                bitstring()
	  }

#'CertificationRequestInfo'{
	  version       atom(),
	  subject       {rdnSequence, [#AttributeTypeAndValue'{}]} ,
	  subjectPKInfo #'CertificationRequestInfo_subjectPKInfo'{},
	  attributes    [#'AttributePKCS-10' {}]
	  }

#'CertificationRequestInfo_subjectPKInfo'{
          algorithm		#'CertificationRequestInfo_subjectPKInfo_algorithm'{}
	  subjectPublicKey 	  bitstring()
	  }

#'CertificationRequestInfo_subjectPKInfo_algorithm'{
     algorithm = oid(),
     parameters = der_encoded()
}	  

#'CertificationRequest_signatureAlgorithm'{
     algorithm = oid(),
     parameters = der_encoded()
     }

#'AttributePKCS-10'{
    type = oid(),
    values = [der_encoded()]
}  </pre></div> 
 

</div>
<div class="footer">
<hr>
<p>Copyright © 2008-2017 Ericsson AB, All Rights Reserved</p>
</div>
</div>
</div></body>
</html>
