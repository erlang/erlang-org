<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html xmlns:erl="http://erlang.org" xmlns:fn="http://www.w3.org/2005/02/xpath-functions">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta charset="utf-8">
<link rel="stylesheet" href="../../otp_doc.css" type="text/css">
<meta name="major-vsn" content="24">
<title>Erlang -- Configuring algorithms in SSH</title>
</head>
<body>
<div id="container">
<script id="js" type="text/javascript" language="JavaScript" src="../../js/flipmenu/flipmenu.js"></script><script id="js2" type="text/javascript" src="../../js/erlresolvelinks.js"></script><script id="js3" type="text/javascript" src="../../../../doc/js/topbar.js"></script><script language="JavaScript" type="text/javascript">
            <!--
              function setscrollpos() {
                var objf = document.getElementById('loadscrollpos');
                if (objf) {
                  document.getElementById("leftnav").firstChild.scrollTop = objf.offsetTop - 10;
                }
              }

              function addEvent(obj, evType, fn){
                if (obj.addEventListener){
                obj.addEventListener(evType, fn, true);
                return true;
              } else if (obj.attachEvent){
                var r = obj.attachEvent("on"+evType, fn);
                return r;
              } else {
                return false;
              }
             }

             addEvent(window, 'load', setscrollpos);

             //-->
</script><div class="topbar">
<div class="topbar-expand "><button onclick="toggleDisplay();"><svg xmlns="http://www.w3.org/2000/svg" version="1.1" id="Capa_1" viewBox="0 0 54 54" width="24" height="24"><g><path style="fill:#000000;" d="M27,54c-0.552,0-1-0.448-1-1V8c0-0.552,0.448-1,1-1s1,0.448,1,1v45C28,53.552,27.552,54,27,54z"></path><path style="fill:#000000;" d="M11,25c-0.256,0-0.512-0.098-0.707-0.293c-0.391-0.391-0.391-1.023,0-1.414l16-16                                      c0.391-0.391,1.023-0.391,1.414,0s0.391,1.023,0,1.414l-16,16C11.512,24.902,11.256,25,11,25z"></path><path style="fill:#000000;" d="M43,25c-0.256,0-0.512-0.098-0.707-0.293l-16-16c-0.391-0.391-0.391-1.023,0-1.414                                      s1.023-0.391,1.414,0l16,16c0.391,0.391,0.391,1.023,0,1.414C43.512,24.902,43.256,25,43,25z"></path><path style="fill:#000000;" d="M43,2H11c-0.552,0-1-0.448-1-1s0.448-1,1-1h32c0.552,0,1,0.448,1,1S43.552,2,43,2z"></path></g></svg></button></div>
<div class="topbar-title"><h1 id="Configuring algorithms in SSH">5 
                Configuring algorithms in SSH</h1></div>
<div class="search-expand ">        <button id="docsearch-mobile">
            <svg fill="#000000" xmlns="http://www.w3.org/2000/svg"  viewBox="0 0 50 50" width="24" height="24"><path d="M 21 3 C 11.621094 3 4 10.621094 4 20 C 4 29.378906 11.621094 37 21 37 C 24.710938 37 28.140625 35.804688 30.9375 33.78125 L 44.09375 46.90625 L 46.90625 44.09375 L 33.90625 31.0625 C 36.460938 28.085938 38 24.222656 38 20 C 38 10.621094 30.378906 3 21 3 Z M 21 5 C 29.296875 5 36 11.703125 36 20 C 36 28.296875 29.296875 35 21 35 C 12.703125 35 6 28.296875 6 20 C 6 11.703125 12.703125 5 21 5 Z"/></svg>
        </button>
</div>
</div>
<aside class="hide-mobile" id="leftnav"><nav class="leftnav-tube"><div class="erlang-logo-wrapper"><a href="../../index.html"><img alt="Erlang Logo" src="../../erlang-logo.png" class="erlang-logo"></a></div>
<p class="section-title">SSH</p>
<p class="section-subtitle">User's Guide</p>
<p class="section-version">Version 4.13.2.6</p>
<ul class="panel-sections">
<li><a href="users_guide.html">User's Guide</a></li>
<li><a href="index.html">Reference Manual</a></li>
<li><a href="notes.html">Release Notes</a></li>
<li><a href="ssh.pdf">PDF</a></li>
<li><a href="../../index.html">Top</a></li>
</ul>
<div id="docsearch"></div>
<div style="padding-left: 1rem; padding-top: 0.1rem;"><a href="/doc/search?v=24">Paginated Search</a></div>
<ul class="expand-collapse-items">
<li><a href="javascript:openAllFlips()">Expand All</a></li>
<li><a href="javascript:closeAllFlips()">Contract All</a></li>
</ul>
<h3 id="chapters">Chapters</h3>
<ul class="flipMenu" imagePath="../../js/flipmenu">
<li id="no" title="Introduction" expanded="false">Introduction<ul>
<li><a href="introduction.html">
              Top of chapter
            </a></li>
<li title="Scope and Purpose"><a href="introduction.html#scope-and-purpose">Scope and Purpose</a></li>
<li title="Prerequisites"><a href="introduction.html#prerequisites">Prerequisites</a></li>
<li title="SSH Protocol Overview"><a href="introduction.html#ssh-protocol-overview">SSH Protocol Overview</a></li>
<li title="Where to Find More Information"><a href="introduction.html#where-to-find-more-information">Where to Find More Information</a></li>
</ul>
</li>
<li id="no" title="Getting Started" expanded="false">Getting Started<ul>
<li><a href="using_ssh.html">
              Top of chapter
            </a></li>
<li title="General Information"><a href="using_ssh.html#general-information">General Information</a></li>
<li title="Using the Erlang ssh Terminal Client"><a href="using_ssh.html#using-the-erlang-ssh-terminal-client">Using the Erlang ssh Terminal Client</a></li>
<li title="Running an Erlang ssh Daemon"><a href="using_ssh.html#running-an-erlang-ssh-daemon">Running an Erlang ssh Daemon</a></li>
<li title="One-Time Execution"><a href="using_ssh.html#one-time-execution">One-Time Execution</a></li>
<li title="SFTP Server"><a href="using_ssh.html#sftp-server">SFTP Server</a></li>
<li title="SFTP Client"><a href="using_ssh.html#sftp-client">SFTP Client</a></li>
<li title="SFTP Client with TAR Compression"><a href="using_ssh.html#sftp-client-with-tar-compression">SFTP Client with TAR Compression</a></li>
<li title="Creating a Subsystem"><a href="using_ssh.html#creating-a-subsystem">Creating a Subsystem</a></li>
</ul>
</li>
<li id="no" title="Terminology" expanded="false">Terminology<ul>
<li><a href="terminology.html">
              Top of chapter
            </a></li>
<li title="General Information"><a href="terminology.html#general-information">General Information</a></li>
<li title='The term "user"'><a href="terminology.html#the-term--user-">The term "user"</a></li>
</ul>
</li>
<li id="no" title="Configuration in SSH" expanded="false">Configuration in SSH<ul>
<li><a href="configurations.html">
              Top of chapter
            </a></li>
<li title="Introduction"><a href="configurations.html#introduction">Introduction</a></li>
<li title="Options configuration"><a href="configurations.html#options-configuration">Options configuration</a></li>
<li title="Precedens"><a href="configurations.html#precedens">Precedens</a></li>
</ul>
</li>
<li id="loadscrollpos" title="Configuring algorithms in SSH" expanded="true">Configuring algorithms in SSH<ul>
<li><a href="configure_algos.html">
              Top of chapter
            </a></li>
<li title="Introduction"><a href="configure_algos.html#introduction">Introduction</a></li>
<li title="Replacing the default set: preferred_algorithms"><a href="configure_algos.html#replacing-the-default-set--preferred_algorithms">Replacing the default set: preferred_algorithms</a></li>
<li title="Modifying the default set: modify_algorithms"><a href="configure_algos.html#modifying-the-default-set--modify_algorithms">Modifying the default set: modify_algorithms</a></li>
</ul>
</li>
<li id="no" title="Hardening" expanded="false">Hardening<ul>
<li><a href="hardening.html">
              Top of chapter
            </a></li>
<li title="Introduction"><a href="hardening.html#introduction">Introduction</a></li>
<li title="Resilience to DoS attacks"><a href="hardening.html#resilience-to-dos-attacks">Resilience to DoS attacks</a></li>
<li title="Verifying the remote daemon (server) in an SSH client"><a href="hardening.html#verifying-the-remote-daemon--server--in-an-ssh-client">Verifying the remote daemon (server) in an SSH client</a></li>
<li title="Verifying the remote client in a daemon (server)"><a href="hardening.html#verifying-the-remote-client-in-a-daemon--server-">Verifying the remote client in a daemon (server)</a></li>
<li title="Hardening in the cryptographic area"><a href="hardening.html#hardening-in-the-cryptographic-area">Hardening in the cryptographic area</a></li>
<li title="Hardening of the SSH protocol - both daemons and clients"><a href="hardening.html#hardening-of-the-ssh-protocol---both-daemons-and-clients">Hardening of the SSH protocol - both daemons and clients</a></li>
<li title="Client connection options"><a href="hardening.html#client-connection-options">Client connection options</a></li>
</ul>
</li>
</ul></nav></aside><div id="content">
<div class="innertube">
<h1 id="Configuring algorithms in SSH">5 Configuring algorithms in SSH</h1>
  

  <a name="introduction"></a><h3 id="introduction" class="title-link" onMouseOver="document.getElementById('ghlink-introduction-idm680').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-introduction-idm680').style.visibility = 'hidden';">
<div class="title-name">5.1 
        Introduction</div>
<div class="title-anchors"><span id="ghlink-introduction-idm680" class="ghlink-after"><a href="#introduction" title="Link to this place!"><span class="paperclip-after"></span></a><a href="https://github.com/erlang/otp/edit/maint/lib/ssh/doc/src/configure_algos.xml#L35" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil-after"></span></a></span></div>
</h3>
    
    
    <p>To fully understand how to configure the algorithms, it is essential to have a basic understanding of the SSH protocol
    and how OTP SSH app handles the corresponding items</p>

    <p>The first subsection will give a short background of the SSH protocol while later sections describes
    the implementation and provides some examples</p>

    <p>How the different levels of configuration "interfer" with this, see the section
    <span class="bold_code bc-15"><a href="configurations.html#algorithm-configuration">Algorithm Configuration</a></span> in the chapter
    <span class="bold_code bc-19"><a href="configurations.html">Configuration in SSH</a></span>.
    </p>

    <h4 id="basics-of-the-ssh-protocol's-algorithms-handling" class="title-link" onMouseOver="document.getElementById('ghlink-basics-of-the-ssh-protocol's-algorithms-handling-idm688').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-basics-of-the-ssh-protocol's-algorithms-handling-idm688').style.visibility = 'hidden';">
<div class="title-name">Basics of the ssh protocol's algorithms handling</div>
<div class="title-anchors"><span id="ghlink-basics-of-the-ssh-protocol's-algorithms-handling-idm688" class="ghlink-after"><a href="#basics-of-the-ssh-protocol's-algorithms-handling" title="Link to this place!"><span class="paperclip-after"></span></a><a href="https://github.com/erlang/otp/edit/maint/lib/ssh/doc/src/configure_algos.xml#L49" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil-after"></span></a></span></div>
</h4>
      

      <p>SSH uses different sets of algorithms in different phases of a session. Which
      algorithms to use is negotiated by the client and the server at the beginning of a session.
      See <span class="bold_code bc-20"><a href="https://tools.ietf.org/html/rfc4253">RFC 4253</a></span>,
      "The Secure Shell (SSH) Transport Layer Protocol" for details.
      </p>

      <p>The negotiation is simple: both peers sends their list of supported alghorithms to the other part.
      The first algorithm on the client's list that also in on the server's list is selected. So it is the
      client's orderering of the list that gives the priority for the algorithms.</p>

      <p>There are five lists exchanged in the connection setup. Three of them are also divided in two
      directions, to and from the server.</p>

      <p>The lists are (named as in the SSH application's options):</p>
      <dl>
	<dt><strong><span class="code">kex</span></strong></dt>
	<dd>
	  <p>Key exchange.</p>
	  <p>An algorithm is selected for computing a secret encryption key. Among examples are:
	  the old nowadays week <span class="code">'diffie-hellman-group-exchange-sha1'</span> and the very strong and modern
	  <span class="code">'ecdh-sha2-nistp512'</span>.</p>
	</dd>

	<dt><strong><span class="code">public_key</span></strong></dt>
	<dd>
	  <p>Server host key</p>
	  <p>The asymetric encryption algorithm used in the server's private-public host key pair.
	  Examples include the well-known RSA <span class="code">'ssh-rsa'</span> and elliptic curve <span class="code">'ecdsa-sha2-nistp521'</span>.
	  </p>
	</dd>

	<dt><strong><span class="code">cipher</span></strong></dt>
	<dd>
	  <p>Symetric cipher algorithm used for the payload encryption. This algorithm will use the key calculated
	  in the kex phase (together with other info) to genereate the actual key used. Examples are 
	  tripple-DES <span class="code">'3des-cbc'</span> and one of many AES variants <span class="code">'aes192-ctr'</span>.
	  </p>
	  <p>This list is actually two - one for each direction server-to-client and client-to-server. Therefore it
	  is possible but rare to have different algorithms in the two directions in one connection.</p>
	</dd>

	<dt><strong><span class="code">mac</span></strong></dt>
	<dd>
	  <p>Message authentication code</p>
	  <p>"Check sum" of each message sent between the peers. Examples are SHA <span class="code">'hmac-sha1'</span> and
	  SHA2 <span class="code">'hmac-sha2-512'</span>.</p>
	  <p>This list is also divided into two for the both directions</p>
	</dd>

	<dt><strong><span class="code">compression</span></strong></dt>
	<dd>
	  <p>If and how to compress the message. Examples are <span class="code">none</span>, that is, no compression and
	  <span class="code">zlib</span>.</p>
	  <p>This list is also divided into two for the both directions</p>
	</dd>
	
      </dl>
    

    <h4 id="the-ssh-app's-mechanism" class="title-link" onMouseOver="document.getElementById('ghlink-the-ssh-app's-mechanism-idm732').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-the-ssh-app's-mechanism-idm732').style.visibility = 'hidden';">
<div class="title-name">The SSH app's mechanism</div>
<div class="title-anchors"><span id="ghlink-the-ssh-app's-mechanism-idm732" class="ghlink-after"><a href="#the-ssh-app's-mechanism" title="Link to this place!"><span class="paperclip-after"></span></a><a href="https://github.com/erlang/otp/edit/maint/lib/ssh/doc/src/configure_algos.xml#L111" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil-after"></span></a></span></div>
</h4>
      
      <p>The set of algorithms that the SSH app uses by default depends on the algoritms supported by the:</p>
      <ul>
	<li>
<p><span class="bold_code bc-18"><a href="../../man/crypto.html">crypto</a></span> app,</p>
	</li>
	<li>
<p>The cryptolib OTP is linked with, usally the one the OS uses, probably OpenSSL,</p>
	</li>
	<li>
<p>and finaly what the SSH app implements</p>
	</li>
      </ul>
      <p>Due to this, it impossible to list in documentation what algorithms that are available in a certain installation.</p>
      <p>There is an important command to list the actual algorithms and their ordering:
      <span class="bold_code bc-15"><a href="../../man/ssh.html#default_algorithms-0">ssh:default_algorithms/0</a></span>.</p>
      <a name="example_default_algorithms"></a>
      <div class="example example-erl"><pre>0&gt; ssh:default_algorithms().
[{kex,['ecdh-sha2-nistp384','ecdh-sha2-nistp521',
       'ecdh-sha2-nistp256','diffie-hellman-group-exchange-sha256',
       'diffie-hellman-group16-sha512',
       'diffie-hellman-group18-sha512',
       'diffie-hellman-group14-sha256',
       'diffie-hellman-group14-sha1',
       'diffie-hellman-group-exchange-sha1']},
 {public_key,['ecdsa-sha2-nistp384','ecdsa-sha2-nistp521',
              'ecdsa-sha2-nistp256','ssh-rsa','rsa-sha2-256',
              'rsa-sha2-512','ssh-dss']},
 {cipher,[{client2server,['aes256-gcm@openssh.com',
                          'aes256-ctr','aes192-ctr','aes128-gcm@openssh.com',
                          'aes128-ctr','aes128-cbc','3des-cbc']},
          {server2client,['aes256-gcm@openssh.com','aes256-ctr',
                          'aes192-ctr','aes128-gcm@openssh.com','aes128-ctr',
                          'aes128-cbc','3des-cbc']}]},
 {mac,[{client2server,['hmac-sha2-256','hmac-sha2-512',
                       'hmac-sha1']},
       {server2client,['hmac-sha2-256','hmac-sha2-512',
                       'hmac-sha1']}]},
 {compression,[{client2server,[none,'zlib@openssh.com',zlib]},
               {server2client,[none,'zlib@openssh.com',zlib]}]}]</pre></div>
      <p>To change the algorithm list, there are two options which can be used in 
      <span class="bold_code bc-15"><a href="../../man/ssh.html#connect-3">ssh:connect/2,3,4</a></span>
      and
      <span class="bold_code bc-15"><a href="../../man/ssh.html#daemon-2">ssh:daemon/2,3</a></span>. The options could of course
      be used in all other functions that initiates connections.</p>
      
      <p>The options are
      <span class="bold_code bc-15"><a href="../../man/ssh.html#type-preferred_algorithms_common_option">preferred_algorithms</a></span> and
      <span class="bold_code bc-15"><a href="../../man/ssh.html#type-modify_algorithms_common_option">modify_algorithms</a></span>.
      The first one replaces the default set, while the latter modifies the default set.</p>
    
  
      
  <h3 id="replacing-the-default-set--preferred_algorithms" class="title-link" onMouseOver="document.getElementById('ghlink-replacing-the-default-set--preferred_algorithms-idm754').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-replacing-the-default-set--preferred_algorithms-idm754').style.visibility = 'hidden';">
<div class="title-name">5.2 
        Replacing the default set: preferred_algorithms</div>
<div class="title-anchors"><span id="ghlink-replacing-the-default-set--preferred_algorithms-idm754" class="ghlink-after"><a href="#replacing-the-default-set--preferred_algorithms" title="Link to this place!"><span class="paperclip-after"></span></a><a href="https://github.com/erlang/otp/edit/maint/lib/ssh/doc/src/configure_algos.xml#L165" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil-after"></span></a></span></div>
</h3>
    
    <p>See the <span class="bold_code bc-15"><a href="../../man/ssh.html#type-preferred_algorithms_common_option">Reference Manual</a></span> for details</p>
    
    <p>Here follows a series of examples ranging from simple to more complex.</p>

    <p>To forsee the effect of an option there is an experimental function <span class="code">ssh:chk_algos_opts(Opts)</span>.
    It mangles the options <span class="code">preferred_algorithms</span>
    and <span class="code">modify_algorithms</span> in the same way as <span class="code">ssh:dameon</span>, <span class="code">ssh:connect</span> and their friends does.</p>

    <h4 id="example-1" class="title-link" onMouseOver="document.getElementById('ghlink-example-1-idm765').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-example-1-idm765').style.visibility = 'hidden';">
<div class="title-name">Example 1</div>
<div class="title-anchors"><span id="ghlink-example-1-idm765" class="ghlink-after"><a href="#example-1" title="Link to this place!"><span class="paperclip-after"></span></a><a href="https://github.com/erlang/otp/edit/maint/lib/ssh/doc/src/configure_algos.xml#L175" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil-after"></span></a></span></div>
</h4>
      
      <p>Replace the kex algorithms list with the single algorithm <span class="code">'diffie-hellman-group14-sha256'</span>:</p>
      <div class="example example-none"><pre>1&gt; ssh:chk_algos_opts(
               [{preferred_algorithms,
                     [{kex, ['diffie-hellman-group14-sha256']}
                     ]
                }
              ]).
[{kex,['diffie-hellman-group14-sha256']},
 {public_key,['ecdsa-sha2-nistp384','ecdsa-sha2-nistp521',
              'ecdsa-sha2-nistp256','ssh-rsa','rsa-sha2-256',
              'rsa-sha2-512','ssh-dss']},
 {cipher,[{client2server,['aes256-gcm@openssh.com',
                          'aes256-ctr','aes192-ctr','aes128-gcm@openssh.com',
                          'aes128-ctr','aes128-cbc','3des-cbc']},
          {server2client,['aes256-gcm@openssh.com','aes256-ctr',
                          'aes192-ctr','aes128-gcm@openssh.com','aes128-ctr',
                          'aes128-cbc','3des-cbc']}]},
 {mac,[{client2server,['hmac-sha2-256','hmac-sha2-512',
                       'hmac-sha1']},
       {server2client,['hmac-sha2-256','hmac-sha2-512',
                       'hmac-sha1']}]},
 {compression,[{client2server,[none,'zlib@openssh.com',zlib]},
               {server2client,[none,'zlib@openssh.com',zlib]}]}]</pre></div>
      <p>Note that the unmentioned lists (<span class="code">public_key</span>, <span class="code">cipher</span>, <span class="code">mac</span> and <span class="code">compression</span>)
      are un-changed.</p>
    
      
    <h4 id="example-2" class="title-link" onMouseOver="document.getElementById('ghlink-example-2-idm775').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-example-2-idm775').style.visibility = 'hidden';">
<div class="title-name">Example 2</div>
<div class="title-anchors"><span id="ghlink-example-2-idm775" class="ghlink-after"><a href="#example-2" title="Link to this place!"><span class="paperclip-after"></span></a><a href="https://github.com/erlang/otp/edit/maint/lib/ssh/doc/src/configure_algos.xml#L206" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil-after"></span></a></span></div>
</h4>
      
      <p>In the lists that are divided in two for the two directions (c.f <span class="code">cipher</span>) it is possible
      to change both directions at once:</p>
      <div class="example example-none"><pre>2&gt; ssh:chk_algos_opts(
               [{preferred_algorithms,
                     [{cipher,['aes128-ctr']}
                     ]
                }
              ]).
[{kex,['ecdh-sha2-nistp384','ecdh-sha2-nistp521',
       'ecdh-sha2-nistp256','diffie-hellman-group-exchange-sha256',
       'diffie-hellman-group16-sha512',
       'diffie-hellman-group18-sha512',
       'diffie-hellman-group14-sha256',
       'diffie-hellman-group14-sha1',
       'diffie-hellman-group-exchange-sha1']},
 {public_key,['ecdsa-sha2-nistp384','ecdsa-sha2-nistp521',
              'ecdsa-sha2-nistp256','ssh-rsa','rsa-sha2-256',
              'rsa-sha2-512','ssh-dss']},
 {cipher,[{client2server,['aes128-ctr']},
          {server2client,['aes128-ctr']}]},
 {mac,[{client2server,['hmac-sha2-256','hmac-sha2-512',
                       'hmac-sha1']},
       {server2client,['hmac-sha2-256','hmac-sha2-512',
                       'hmac-sha1']}]},
 {compression,[{client2server,[none,'zlib@openssh.com',zlib]},
               {server2client,[none,'zlib@openssh.com',zlib]}]}]</pre></div>
      <p>Note that both lists in <span class="code">cipher</span> has been changed to the provided value (<span class="code">'aes128-ctr'</span>).</p>
    
      
    <h4 id="example-3" class="title-link" onMouseOver="document.getElementById('ghlink-example-3-idm783').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-example-3-idm783').style.visibility = 'hidden';">
<div class="title-name">Example 3</div>
<div class="title-anchors"><span id="ghlink-example-3-idm783" class="ghlink-after"><a href="#example-3" title="Link to this place!"><span class="paperclip-after"></span></a><a href="https://github.com/erlang/otp/edit/maint/lib/ssh/doc/src/configure_algos.xml#L239" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil-after"></span></a></span></div>
</h4>
      
      <p>In the lists that are divided in two for the two directions (c.f <span class="code">cipher</span>) it is possible
      to change only one of the directions:</p>
      <div class="example example-none"><pre>3&gt; ssh:chk_algos_opts(
               [{preferred_algorithms,
                     [{cipher,[{client2server,['aes128-ctr']}]}
                     ]
                }
              ]).
[{kex,['ecdh-sha2-nistp384','ecdh-sha2-nistp521',
       'ecdh-sha2-nistp256','diffie-hellman-group-exchange-sha256',
       'diffie-hellman-group16-sha512',
       'diffie-hellman-group18-sha512',
       'diffie-hellman-group14-sha256',
       'diffie-hellman-group14-sha1',
       'diffie-hellman-group-exchange-sha1']},
 {public_key,['ecdsa-sha2-nistp384','ecdsa-sha2-nistp521',
              'ecdsa-sha2-nistp256','ssh-rsa','rsa-sha2-256',
              'rsa-sha2-512','ssh-dss']},
 {cipher,[{client2server,['aes128-ctr']},
          {server2client,['aes256-gcm@openssh.com','aes256-ctr',
                          'aes192-ctr','aes128-gcm@openssh.com','aes128-ctr',
                          'aes128-cbc','3des-cbc']}]},
 {mac,[{client2server,['hmac-sha2-256','hmac-sha2-512',
                       'hmac-sha1']},
       {server2client,['hmac-sha2-256','hmac-sha2-512',
                       'hmac-sha1']}]},
 {compression,[{client2server,[none,'zlib@openssh.com',zlib]},
               {server2client,[none,'zlib@openssh.com',zlib]}]}]</pre></div>
    

    <h4 id="example-4" class="title-link" onMouseOver="document.getElementById('ghlink-example-4-idm788').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-example-4-idm788').style.visibility = 'hidden';">
<div class="title-name">Example 4</div>
<div class="title-anchors"><span id="ghlink-example-4-idm788" class="ghlink-after"><a href="#example-4" title="Link to this place!"><span class="paperclip-after"></span></a><a href="https://github.com/erlang/otp/edit/maint/lib/ssh/doc/src/configure_algos.xml#L273" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil-after"></span></a></span></div>
</h4>
      
      <p>It is of course possible to change more than one list:</p>
      <div class="example example-none"><pre>4&gt; ssh:chk_algos_opts(
               [{preferred_algorithms,
                     [{cipher,['aes128-ctr']},
		      {mac,['hmac-sha2-256']},
                      {kex,['ecdh-sha2-nistp384']},
		      {public_key,['ssh-rsa']},
		      {compression,[{server2client,[none]},
		                    {client2server,[zlib]}]}
                     ]
                }
              ]).
[{kex,['ecdh-sha2-nistp384']},
 {public_key,['ssh-rsa']},
 {cipher,[{client2server,['aes128-ctr']},
          {server2client,['aes128-ctr']}]},
 {mac,[{client2server,['hmac-sha2-256']},
       {server2client,['hmac-sha2-256']}]},
 {compression,[{client2server,[zlib]},
               {server2client,[none]}]}]</pre></div>
      <p>Note that the ordering of the tuples in the lists didn't matter.</p>
    
      
  
  <h3 id="modifying-the-default-set--modify_algorithms" class="title-link" onMouseOver="document.getElementById('ghlink-modifying-the-default-set--modify_algorithms-idm793').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-modifying-the-default-set--modify_algorithms-idm793').style.visibility = 'hidden';">
<div class="title-name">5.3 
        Modifying the default set: modify_algorithms</div>
<div class="title-anchors"><span id="ghlink-modifying-the-default-set--modify_algorithms-idm793" class="ghlink-after"><a href="#modifying-the-default-set--modify_algorithms" title="Link to this place!"><span class="paperclip-after"></span></a><a href="https://github.com/erlang/otp/edit/maint/lib/ssh/doc/src/configure_algos.xml#L302" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil-after"></span></a></span></div>
</h3>
    
    <p>A situation where it might be useful to add an algorithm is when one need to use a supported but disabled one.
    An example is the <span class="code">'diffie-hellman-group1-sha1'</span> which nowadays is very unsecure and therefore disabled. It is 
    however still supported and might be used.</p>
    
    <p>The option <span class="code">preferred_algorithms</span> may be complicated to use for adding or removing single algorithms.
    First one has to list them with <span class="code">ssh:default_algorithms()</span> and then do changes in the lists.</p>

    <p>To facilitate addition or removal of algorithms the option <span class="code">modify_algorithms</span> is available.
    See the <span class="bold_code bc-15"><a href="../../man/ssh.html#type-modify_algorithms_common_option">Reference Manual</a></span> for details.</p>
 
    <p>The option takes a list with instructions to append, prepend or remove algorithms:</p>
    <div class="example example-erl"><pre>{modify_algorithms, [{append,  ...},
                     {prepend, ...},
		     {rm,      ...}
		    ]}</pre></div>
    <p>Each of the <span class="code">...</span> can be a <span class="code">algs_list()</span> as the argument to the  <span class="code">preferred_algorithms</span> option.</p>
    <h4 id="example-5" class="title-link" onMouseOver="document.getElementById('ghlink-example-5-idm809').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-example-5-idm809').style.visibility = 'hidden';">
<div class="title-name">Example 5</div>
<div class="title-anchors"><span id="ghlink-example-5-idm809" class="ghlink-after"><a href="#example-5" title="Link to this place!"><span class="paperclip-after"></span></a><a href="https://github.com/erlang/otp/edit/maint/lib/ssh/doc/src/configure_algos.xml#L322" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil-after"></span></a></span></div>
</h4>
      
      <p>As an example let's add the Diffie-Hellman Group1 first in the kex list. It is supported according to 
      <span class="bold_code bc-15"><a href="../../man/SSH_app.html#supported_algos">Supported algoritms</a></span>.</p>
      <div class="example example-erl"><pre>5&gt; ssh:chk_algos_opts(
         [{modify_algorithms,
	       [{prepend,
	           [{kex,['diffie-hellman-group1-sha1']}]
		   }
	       ]
          }
        ]).
[{kex,['diffie-hellman-group1-sha1','ecdh-sha2-nistp384',
       'ecdh-sha2-nistp521','ecdh-sha2-nistp256',
       'diffie-hellman-group-exchange-sha256',
       'diffie-hellman-group16-sha512',
       'diffie-hellman-group18-sha512',
       'diffie-hellman-group14-sha256',
       'diffie-hellman-group14-sha1',
       'diffie-hellman-group-exchange-sha1']},
 {public_key,['ecdsa-sha2-nistp384','ecdsa-sha2-nistp521',
              'ecdsa-sha2-nistp256','ssh-rsa','rsa-sha2-256',
              'rsa-sha2-512','ssh-dss']},
 {cipher,[{client2server,['aes256-gcm@openssh.com',
                          'aes256-ctr','aes192-ctr','aes128-gcm@openssh.com',
                          'aes128-ctr','aes128-cbc','3des-cbc']},
          {server2client,['aes256-gcm@openssh.com','aes256-ctr',
                          'aes192-ctr','aes128-gcm@openssh.com','aes128-ctr',
                          'aes128-cbc','3des-cbc']}]},
 {mac,[{client2server,['hmac-sha2-256','hmac-sha2-512',
                       'hmac-sha1']},
       {server2client,['hmac-sha2-256','hmac-sha2-512',
                       'hmac-sha1']}]},
 {compression,[{client2server,[none,'zlib@openssh.com',zlib]},
               {server2client,[none,'zlib@openssh.com',zlib]}]}]</pre></div>
      <p>And the result shows that the Diffie-Hellman Group1 is added at the head of the kex list</p>
    
    
    <h4 id="example-6" class="title-link" onMouseOver="document.getElementById('ghlink-example-6-idm815').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-example-6-idm815').style.visibility = 'hidden';">
<div class="title-name">Example 6</div>
<div class="title-anchors"><span id="ghlink-example-6-idm815" class="ghlink-after"><a href="#example-6" title="Link to this place!"><span class="paperclip-after"></span></a><a href="https://github.com/erlang/otp/edit/maint/lib/ssh/doc/src/configure_algos.xml#L363" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil-after"></span></a></span></div>
</h4>
      
      <p>In this example, we in put the 'diffie-hellman-group1-sha1' first and also move the
      <span class="code">'ecdh-sha2-nistp521'</span> to the end in the kex list, that is, <span class="code">append</span> it.</p>
      <div class="example example-erl"><pre>6&gt; ssh:chk_algos_opts(
         [{modify_algorithms,
	       [{prepend,
	           [{kex, ['diffie-hellman-group1-sha1']}
		   ]},
		{append,
                   [{kex, ['ecdh-sha2-nistp521']}
                   ]}
	       ]
          }
        ]).
[{kex,['diffie-hellman-group1-sha1','ecdh-sha2-nistp384',
       'ecdh-sha2-nistp256','diffie-hellman-group-exchange-sha256',
       'diffie-hellman-group16-sha512',
       'diffie-hellman-group18-sha512',
       'diffie-hellman-group14-sha256',
       'diffie-hellman-group14-sha1',
       'diffie-hellman-group-exchange-sha1','ecdh-sha2-nistp521']},
 {public_key,['ecdsa-sha2-nistp384','ecdsa-sha2-nistp521',
   .....
] </pre></div>
      <p>Note that the appended algorithm is removed from its original place and then appended to the same list.</p>
    
    
    <h4 id="example-7" class="title-link" onMouseOver="document.getElementById('ghlink-example-7-idm822').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-example-7-idm822').style.visibility = 'hidden';">
<div class="title-name">Example 7</div>
<div class="title-anchors"><span id="ghlink-example-7-idm822" class="ghlink-after"><a href="#example-7" title="Link to this place!"><span class="paperclip-after"></span></a><a href="https://github.com/erlang/otp/edit/maint/lib/ssh/doc/src/configure_algos.xml#L393" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil-after"></span></a></span></div>
</h4>
      
      <p>In this example, we use both options (<span class="code">preferred_algorithms</span> and <span class="code">modify_algorithms</span>) and
      also try to prepend an unsupported algorithm.   Any unsupported algorithm is quietly removed.</p>
      <div class="example example-erl"><pre>7&gt; ssh:chk_algos_opts(
         [{preferred_algorithms,
               [{cipher,['aes128-ctr']},
	        {mac,['hmac-sha2-256']},
                {kex,['ecdh-sha2-nistp384']},
		{public_key,['ssh-rsa']},
		{compression,[{server2client,[none]},
		              {client2server,[zlib]}]}
               ]
           },
          {modify_algorithms,
	       [{prepend,
	           [{kex, ['some unsupported algorithm']}
		   ]},
		{append,
                   [{kex, ['diffie-hellman-group1-sha1']}
                   ]}
	       ]
          }
        ]).
[{kex,['ecdh-sha2-nistp384','diffie-hellman-group1-sha1']},
 {public_key,['ssh-rsa']},
 {cipher,[{client2server,['aes128-ctr']},
          {server2client,['aes128-ctr']}]},
 {mac,[{client2server,['hmac-sha2-256']},
       {server2client,['hmac-sha2-256']}]},
 {compression,[{client2server,[zlib]},
               {server2client,[none]}]}]</pre></div>
      <p>It is of course questionable why anyone would like to use the both these options together,
      but it is possible if an unforeseen need should arise.</p>
    
    
    <h4 id="example-8" class="title-link" onMouseOver="document.getElementById('ghlink-example-8-idm829').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-example-8-idm829').style.visibility = 'hidden';">
<div class="title-name">Example 8</div>
<div class="title-anchors"><span id="ghlink-example-8-idm829" class="ghlink-after"><a href="#example-8" title="Link to this place!"><span class="paperclip-after"></span></a><a href="https://github.com/erlang/otp/edit/maint/lib/ssh/doc/src/configure_algos.xml#L432" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil-after"></span></a></span></div>
</h4>
      
      <p>In this example, we need to use a diffie-hellman-group1-sha1 key exchange algorithm
      although it is unsage and disabled by default.
      </p>
      <p>We use the
      <span class="bold_code bc-15"><a href="../../man/ssh.html#type-modify_algorithms_common_option">modify_algorithms</a></span>
      option, because we want to keep all other algorithm definitions.
      </p>
      <p>We add the option:
      </p>
      <div class="example example-erl"><pre>  {modify_algorithms, [{append, [{kex,['diffie-hellman-group1-sha1']}]}]}</pre></div>
      <p>either to the Options list in a function call, in the <span class="code">ssh.app</span> file or in a <span class="code">.config</span> file for
      the <span class="code">erl</span> command.
      See the chapter
      <span class="bold_code bc-18"><a href="configurations.html">Configuration in SSH</a></span>
      in the SSH User's Guide.
      </p>
    

    <h4 id="example-9" class="title-link" onMouseOver="document.getElementById('ghlink-example-9-idm841').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-example-9-idm841').style.visibility = 'hidden';">
<div class="title-name">Example 9</div>
<div class="title-anchors"><span id="ghlink-example-9-idm841" class="ghlink-after"><a href="#example-9" title="Link to this place!"><span class="paperclip-after"></span></a><a href="https://github.com/erlang/otp/edit/maint/lib/ssh/doc/src/configure_algos.xml#L454" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil-after"></span></a></span></div>
</h4>
      
      <p>In this example, we need to use a DSA key for sign and verify.
      It might be either as a user's key, a host's key or both.
      </p>
      <p>To do that, we enable the 'ssh-dss' algorithm that is disabled by default by security reasons. We use the
      <span class="bold_code bc-15"><a href="../../man/ssh.html#type-modify_algorithms_common_option">modify_algorithms</a></span>
      option, because we want to keep all other algorithm definitions.
      </p>
      <p>We add the option:
      </p>
      <div class="example example-erl"><pre>  {modify_algorithms, [{append, [{public_key,['ssh-dss']}]}]}</pre></div>
      <p>either to the Options list in a function call, in the <span class="code">ssh.app</span> file or in a <span class="code">.config</span> file for
      the <span class="code">erl</span> command.
      See the chapter
      <span class="bold_code bc-18"><a href="configurations.html">Configuration in SSH</a></span>
      in the SSH User's Guide.
      </p>
    
    
  

</div>
<div class="footer">
<hr>
<p>Copyright © 2005-2024 Ericsson AB. All Rights Reserved.</p>
</div>
</div>
</div>
<script type="text/javascript">window.__otpTopDocDir = '../../js/';</script><script type="text/javascript" src="../../js/highlight.js"></script>
<script type="text/javascript">
_docsearch_version = "24";
</script> 
<script src="/assets/js/doc-search.bundle.js"></script>
</body>
</html>
