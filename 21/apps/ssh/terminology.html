<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html xmlns:erl="http://erlang.org" xmlns:fn="http://www.w3.org/2005/02/xpath-functions">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" href="../../otp_doc.css" type="text/css">
<title>Erlang -- Terminology</title>
</head>
<body>
<div id="container">
<script id="js" type="text/javascript" language="JavaScript" src="../../js/flipmenu/flipmenu.js"></script><script id="js2" type="text/javascript" src="../../js/erlresolvelinks.js"></script><script language="JavaScript" type="text/javascript">
            <!--
              function getWinHeight() {
                var myHeight = 0;
                if( typeof( window.innerHeight ) == 'number' ) {
                  //Non-IE
                  myHeight = window.innerHeight;
                } else if( document.documentElement && ( document.documentElement.clientWidth ||
                                                         document.documentElement.clientHeight ) ) {
                  //IE 6+ in 'standards compliant mode'
                  myHeight = document.documentElement.clientHeight;
                } else if( document.body && ( document.body.clientWidth || document.body.clientHeight ) ) {
                  //IE 4 compatible
                  myHeight = document.body.clientHeight;
                }
                return myHeight;
              }

              function setscrollpos() {
                var objf=document.getElementById('loadscrollpos');
                 document.getElementById("leftnav").scrollTop = objf.offsetTop - getWinHeight()/2;
              }

              function addEvent(obj, evType, fn){
                if (obj.addEventListener){
                obj.addEventListener(evType, fn, true);
                return true;
              } else if (obj.attachEvent){
                var r = obj.attachEvent("on"+evType, fn);
                return r;
              } else {
                return false;
              }
             }

             addEvent(window, 'load', setscrollpos);

             //--></script><div id="leftnav"><div class="innertube">
<div class="erlang-logo-wrapper"><a href="../../index.html"><img alt="Erlang Logo" src="../../erlang-logo.png" class="erlang-logo"></a></div>
<p class="section-title">SSH</p>
<p class="section-subtitle">User's Guide</p>
<p class="section-version">Version 4.7.6.6</p>
<ul class="panel-sections">
<li><a href="users_guide.html">User's Guide</a></li>
<li><a href="index.html">Reference Manual</a></li>
<li><a href="release_notes.html">Release Notes</a></li>
<li><a href="ssh.pdf">PDF</a></li>
<li><a href="../../index.html">Top</a></li>
</ul>
<ul class="expand-collapse-items">
<li><a href="javascript:openAllFlips()">Expand All</a></li>
<li><a href="javascript:closeAllFlips()">Contract All</a></li>
</ul>
<h3>Chapters</h3>
<ul class="flipMenu" imagePath="../../js/flipmenu">
<li id="no" title="Introduction" expanded="false">Introduction<ul>
<li><a href="introduction.html">
              Top of chapter
            </a></li>
<li title="Scope and Purpose"><a href="introduction.html#scope-and-purpose">Scope and Purpose</a></li>
<li title="Prerequisites"><a href="introduction.html#prerequisites">Prerequisites</a></li>
<li title="SSH Protocol Overview"><a href="introduction.html#ssh-protocol-overview">SSH Protocol Overview</a></li>
<li title="Where to Find More Information"><a href="introduction.html#where-to-find-more-information">Where to Find More Information</a></li>
</ul>
</li>
<li id="no" title="Getting Started" expanded="false">Getting Started<ul>
<li><a href="using_ssh.html">
              Top of chapter
            </a></li>
<li title="General Information"><a href="using_ssh.html#general-information">General Information</a></li>
<li title="Using the Erlang ssh Terminal Client"><a href="using_ssh.html#using-the-erlang-ssh-terminal-client">Using the Erlang ssh Terminal Client</a></li>
<li title="Running an Erlang ssh Daemon"><a href="using_ssh.html#running-an-erlang-ssh-daemon">Running an Erlang ssh Daemon</a></li>
<li title="One-Time Execution"><a href="using_ssh.html#one-time-execution">One-Time Execution</a></li>
<li title="SFTP Server"><a href="using_ssh.html#sftp-server">SFTP Server</a></li>
<li title="SFTP Client"><a href="using_ssh.html#sftp-client">SFTP Client</a></li>
<li title="SFTP Client with TAR Compression and Encryption"><a href="using_ssh.html#sftp-client-with-tar-compression-and-encryption">SFTP Client with TAR Compression and Encryption</a></li>
<li title="Creating a Subsystem"><a href="using_ssh.html#creating-a-subsystem">Creating a Subsystem</a></li>
</ul>
</li>
<li id="loadscrollpos" title="Terminology" expanded="true">Terminology<ul>
<li><a href="terminology.html">
              Top of chapter
            </a></li>
<li title="General Information"><a href="terminology.html#general-information">General Information</a></li>
<li title='The term "user"'><a href="terminology.html#the-term--user-">The term "user"</a></li>
</ul>
</li>
<li id="no" title="Configuring algorithms in SSH" expanded="false">Configuring algorithms in SSH<ul>
<li><a href="configure_algos.html">
              Top of chapter
            </a></li>
<li title="Introduction"><a href="configure_algos.html#introduction">Introduction</a></li>
<li title="Replacing the default set: preferred_algorithms"><a href="configure_algos.html#replacing-the-default-set--preferred_algorithms">Replacing the default set: preferred_algorithms</a></li>
<li title="Modifying the default set: modify_algorithms"><a href="configure_algos.html#modifying-the-default-set--modify_algorithms">Modifying the default set: modify_algorithms</a></li>
</ul>
</li>
</ul>
</div></div>
<div id="content">
<div class="innertube">
<h1>3 Terminology</h1>
  

  <h3><span onMouseOver="document.getElementById('ghlink-general-information-idm276').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-general-information-idm276').style.visibility = 'hidden';"><span id="ghlink-general-information-idm276" class="ghlink"><a href="https://github.com/erlang/otp/edit/maint/lib/ssh/doc/src/terminology.xml#L35" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil"></span></a></span><a class="title_link" name="general-information" href="#general-information">3.1 
          General Information</a></span></h3>
    
    <p>In the following terms that may cause confusion are explained.
    </p>
  

  <h3><span onMouseOver="document.getElementById('ghlink-the-term--user--idm279').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-the-term--user--idm279').style.visibility = 'hidden';"><span id="ghlink-the-term--user--idm279" class="ghlink"><a href="https://github.com/erlang/otp/edit/maint/lib/ssh/doc/src/terminology.xml#L41" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil"></span></a></span><a class="title_link" name="the-term--user-" href="#the-term--user-">3.2 
          The term "user"</a></span></h3>
    
    <p>A "user" is a term that everyone understands intuitively. However, the understandings may differ which can
       cause confusion.
    </p>
    <p>The term is used differently in <span class="bold_code bc-20"><a href="http://www.openssh.com">OpenSSH</a></span> and SSH in Erlang/OTP.
       The reason is the different environments and use cases that are not immediatly obvious.
    </p>
    <p>This chapter aims at explaining the differences and giving a rationale for why Erlang/OTP handles "user" as
       it does.
    </p>

    <h4><span onMouseOver="document.getElementById('ghlink-in-openssh-idm285').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-in-openssh-idm285').style.visibility = 'hidden';"><span id="ghlink-in-openssh-idm285" class="ghlink"><a href="https://github.com/erlang/otp/edit/maint/lib/ssh/doc/src/terminology.xml#L53" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil"></span></a></span><a class="title_link" name="in-openssh" href="#in-openssh">In OpenSSH</a></span></h4>
      
      <p>Many have been in contact with the command 'ssh' on a Linux machine (or similar) to remotly log in on
      another machine. One types 
      </p>
      <div class="example"><pre>ssh host</pre></div>
      <p>to log in on the machine named <span class="code">host</span>. The command prompts for your password on the remote <span class="code">host</span> and
      then you can read, write and execute as your <i>user name</i> has rights on the remote <span class="code">host</span>. There are
      stronger variants with pre-distributed keys or certificates, but that are for now just details in the
      authentication process.
      </p>
      <p>You could log in as the user <span class="code">anotheruser</span> with
      </p>
      <div class="example"><pre>ssh anotheruser@host</pre></div>
      <p>and you will then be enabled to act as <span class="code">anotheruser</span> on the <span class="code">host</span> if authorized correctly.
      </p>
      <p>So what does <i>"your user name has rights"</i> mean? In a UNIX/Linux/etc context it is exactly as that context:
      The <i>user</i> could read, write and execute programs according to the OS rules.
      In addition, the user has a home directory (<span class="code">$HOME</span>) and there is a <span class="code">$HOME/.ssh/</span> directory
      with ssh-specific files.
      </p>
      <h5>SSH password authentication</h5>
	
	<p>When SSH tries to log in to a host, the ssh protocol communicates the user name (as a string) and a password.
	The remote ssh server checks that there is such a user defined and that the provided password is acceptable.
	</p>
	<p>If so, the user is authorized.
	</p>
      
      <h5>SSH public key authentication</h5>
	
	<p>This is a stronger method where the ssh protocol brings the user name, the user's public key and some
	cryptographic information which we could ignore here.
	</p>
	<p>The ssh server on the remote host checks:
	</p>
	<ul>
	  <li>That the <i>user</i> has a home directory,</li>
	  <li>that home directory contains a .ssh/ directory and</li>
	  <li>the .ssh/ directory contains the public key just received in the <span class="code">authorized_keys</span> file</li>
	</ul>
	<p>if so, the user is authorized.
	</p>
      
      <h5>The SSH server on UNIX/Linux/etc after a succesful authentication</h5>
	
	<p>After a succesful incoming authentication, a new process runs as the just authenticated user.</p>
	<p>Next step is to start a service according to the ssh request. In case of a request of a shell, 
	a new one is started which handles the OS-commands that arrives from the client (that's "you").
	</p>
	<p>In case of a sftp request, an sftp server is started in with the user's rights. So it could read, write or delete
	files if allowed for that user.
	</p>
      
    

    <h4><span onMouseOver="document.getElementById('ghlink-in-erlang-otp-ssh-idm325').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-in-erlang-otp-ssh-idm325').style.visibility = 'hidden';"><span id="ghlink-in-erlang-otp-ssh-idm325" class="ghlink"><a href="https://github.com/erlang/otp/edit/maint/lib/ssh/doc/src/terminology.xml#L109" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil"></span></a></span><a class="title_link" name="in-erlang-otp-ssh" href="#in-erlang-otp-ssh">In Erlang/OTP SSH</a></span></h4>
      
      <p>For the Erlang/OTP SSH server the situation is different. The server executes in an Erlang process
      in the Erlang emulator which in turn executes in an OS process. The emulator does not try to change its
      user when authenticated over the SSH protocol.
      So the remote user name is only for authentication purposes in the Erlang/OTP SSH application.
      </p>
      <h5>Password authentication in Erlang SSH</h5>
	
	<p>The Erlang/OTP SSH server checks the user name and password in the following order:
	</p>
	<ul>
	  <li>If a 
	  <span class="bold_code bc-13"><a href="../../man/ssh.html#option-pwdfun"><span class="code">pwdfun</span></a></span>
	  is defined, that one is called and the returned boolean is the authentication result.
	  </li>
	  <li>Else, if the 
	  <span class="bold_code bc-13"><a href="../../man/ssh.html#option-user_passwords"><span class="code">user_passwords</span></a></span>
	  option is defined and the username and the password matches, the authentication is a success.
	  </li>
	  <li>Else, if the option 
	  <span class="bold_code bc-13"><a href="../../man/ssh.html#option-password"><span class="code">password</span></a></span>
	  is defined and matches the password the authentication is a success.
	  Note that the use of this option is not recommended in non-test code.
	  </li>
	</ul>
      
      <h5>Public key authentication in Erlang SSH</h5>
	
	<p>The user name, public key and cryptographic data (a signature) that is sent by the client, are used as follows
	(some steps left out for clearity):
	</p>
	<ul>
	  <li>A callback module is selected using the options 
	  <span class="bold_code bc-13"><a href="../../man/ssh.html#type-key_cb_common_option"><span class="code">key_cb</span></a></span>.
	  </li>
	  <li>The callback module is used to check that the provided public key is one of the user's pre-stored.
	        In case of the default callback module, the files <span class="code">authorized_keys</span> and <span class="code">authorized_keys2</span>
		are searched in a directory found in the following order:
		<ul>
		  <li>If the option
		  <span class="bold_code bc-13"><a href="../../man/ssh_file.html#type-user_dir_fun_common_option"><span class="code">user_dir_fun</span></a></span>
		  is defined, that fun is called and the returned directory is used,
		  </li>
		  <li>Else, If the option 
		  <span class="bold_code bc-13"><a href="../../man/ssh_file.html#type-user_dir_common_option"><span class="code">user_dir</span></a></span>
			is defined, that directory is used,
		  </li>
		  <li>Else the subdirectory <span class="code">.ssh</span> in the home directory of the user executing
		  the OS process of the Erlang emulator is used.
		  </li>
		</ul>
		If the provided public key is not found, the authentication fails.
	  </li>
	  <li>Finally, if the provided public key is found, the signature provided by the client is checked with
	  the public key.
	  </li>
	</ul>
      
      <h5>The Erlang/OTP SSH server after a succesful authentication</h5>
	
	<p>After a successful authentication an <i>Erlang process</i> is handling the service request from the remote
	ssh client. The rights of that process are those of the user of the OS process running the Erlang emulator.
	</p>
	<p>If a shell service request arrives to the server, an <i>Erlang shell</i> is opened in the server's emulator.
	The rights in that shell is independent of the just authenticated user.
	</p>
	<p>In case of an sftp request, an sftp server is started with the rights of the user of the Erlang emulator's OS
	process. So with sftp the authenticated user does not influence the rights.
	</p>
	<p>So after an authentication, the user name is not used anymore and has no influence.
	</p>
      
    
  
</div>
<div class="footer">
<hr>
<p>Copyright © 2005-2021 Ericsson AB. All Rights Reserved.</p>
</div>
</div>
</div>
<script type="text/javascript">window.__otpTopDocDir = '../../js/';</script><script type="text/javascript" src="../../js/highlight.js"></script>
</body>
</html>
