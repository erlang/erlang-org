<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html xmlns:erl="http://erlang.org" xmlns:fn="http://www.w3.org/2005/02/xpath-functions">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" href="../../otp_doc.css" type="text/css">
<title>Erlang -- Using Common Test for Large-Scale Testing</title>
</head>
<body>
<div id="container">
<script id="js" type="text/javascript" language="JavaScript" src="../../js/flipmenu/flipmenu.js"></script><script id="js2" type="text/javascript" src="../../js/erlresolvelinks.js"></script><script language="JavaScript" type="text/javascript">
            <!--
              function getWinHeight() {
                var myHeight = 0;
                if( typeof( window.innerHeight ) == 'number' ) {
                  //Non-IE
                  myHeight = window.innerHeight;
                } else if( document.documentElement && ( document.documentElement.clientWidth ||
                                                         document.documentElement.clientHeight ) ) {
                  //IE 6+ in 'standards compliant mode'
                  myHeight = document.documentElement.clientHeight;
                } else if( document.body && ( document.body.clientWidth || document.body.clientHeight ) ) {
                  //IE 4 compatible
                  myHeight = document.body.clientHeight;
                }
                return myHeight;
              }

              function setscrollpos() {
                var objf=document.getElementById('loadscrollpos');
                 document.getElementById("leftnav").scrollTop = objf.offsetTop - getWinHeight()/2;
              }

              function addEvent(obj, evType, fn){
                if (obj.addEventListener){
                obj.addEventListener(evType, fn, true);
                return true;
              } else if (obj.attachEvent){
                var r = obj.attachEvent("on"+evType, fn);
                return r;
              } else {
                return false;
              }
             }

             addEvent(window, 'load', setscrollpos);

             //--></script><div id="leftnav"><div class="innertube">
<div class="erlang-logo-wrapper"><a href="../../index.html"><img alt="Erlang Logo" src="../../erlang-logo.png" class="erlang-logo"></a></div>
<p class="section-title">Common Test</p>
<p class="section-subtitle">User's Guide</p>
<p class="section-version">Version 1.17.2.1</p>
<ul class="panel-sections">
<li><a href="users_guide.html">User's Guide</a></li>
<li><a href="index.html">Reference Manual</a></li>
<li><a href="release_notes.html">Release Notes</a></li>
<li><a href="common_test.pdf">PDF</a></li>
<li><a href="../../index.html">Top</a></li>
</ul>
<ul class="expand-collapse-items">
<li><a href="javascript:openAllFlips()">Expand All</a></li>
<li><a href="javascript:closeAllFlips()">Contract All</a></li>
</ul>
<h3>Chapters</h3>
<ul class="flipMenu" imagePath="../../js/flipmenu">
<li id="no" title="Introduction" expanded="false">Introduction<ul>
<li><a href="introduction.html">
              Top of chapter
            </a></li>
<li title="Scope"><a href="introduction.html#scope">Scope</a></li>
<li title="Prerequisites"><a href="introduction.html#prerequisites">Prerequisites</a></li>
</ul>
</li>
<li id="no" title="Common Test Basics" expanded="false">Common Test Basics<ul>
<li><a href="basics_chapter.html">
              Top of chapter
            </a></li>
<li title="General"><a href="basics_chapter.html#general">General</a></li>
<li title="Test Suite Organisation"><a href="basics_chapter.html#test-suite-organisation">Test Suite Organisation</a></li>
<li title="Support Libraries"><a href="basics_chapter.html#support-libraries">Support Libraries</a></li>
<li title="Suites and Test Cases"><a href="basics_chapter.html#suites-and-test-cases">Suites and Test Cases</a></li>
<li title="External Interfaces"><a href="basics_chapter.html#external-interfaces">External Interfaces</a></li>
</ul>
</li>
<li id="no" title="Getting Started" expanded="false">Getting Started<ul>
<li><a href="getting_started_chapter.html">
              Top of chapter
            </a></li>
<li title="Introduction for Newcomers"><a href="getting_started_chapter.html#introduction-for-newcomers">Introduction for Newcomers</a></li>
<li title="Test Case Execution"><a href="getting_started_chapter.html#test-case-execution">Test Case Execution</a></li>
<li title="A Simple Test Suite"><a href="getting_started_chapter.html#a-simple-test-suite">A Simple Test Suite</a></li>
<li title="A Test Suite with Configuration Functions"><a href="getting_started_chapter.html#a-test-suite-with-configuration-functions">A Test Suite with Configuration Functions</a></li>
<li title="Questions and Answers"><a href="getting_started_chapter.html#questions-and-answers">Questions and Answers</a></li>
</ul>
</li>
<li id="no" title="Installation" expanded="false">Installation<ul>
<li><a href="install_chapter.html">
              Top of chapter
            </a></li>
<li title="General Information"><a href="install_chapter.html#general-information">General Information</a></li>
</ul>
</li>
<li id="no" title="Writing Test Suites" expanded="false">Writing Test Suites<ul>
<li><a href="write_test_chapter.html">
              Top of chapter
            </a></li>
<li title="Support for Test Suite Authors"><a href="write_test_chapter.html#support-for-test-suite-authors">Support for Test Suite Authors</a></li>
<li title="Test Suites"><a href="write_test_chapter.html#test-suites">Test Suites</a></li>
<li title="Init and End per Suite"><a href="write_test_chapter.html#init-and-end-per-suite">Init and End per Suite</a></li>
<li title="Init and End per Test Case"><a href="write_test_chapter.html#init-and-end-per-test-case">Init and End per Test Case</a></li>
<li title="Test Cases"><a href="write_test_chapter.html#test-cases">Test Cases</a></li>
<li title="Test Case Information Function"><a href="write_test_chapter.html#test-case-information-function">Test Case Information Function</a></li>
<li title="Test Suite Information Function"><a href="write_test_chapter.html#test-suite-information-function">Test Suite Information Function</a></li>
<li title="Test Case Groups"><a href="write_test_chapter.html#test-case-groups">Test Case Groups</a></li>
<li title="Parallel Property and Nested Groups"><a href="write_test_chapter.html#parallel-property-and-nested-groups">Parallel Property and Nested Groups</a></li>
<li title="Parallel Test Cases and I/O"><a href="write_test_chapter.html#parallel-test-cases-and-i-o">Parallel Test Cases and I/O</a></li>
<li title="Repeated Groups"><a href="write_test_chapter.html#repeated-groups">Repeated Groups</a></li>
<li title="Shuffled Test Case Order"><a href="write_test_chapter.html#shuffled-test-case-order">Shuffled Test Case Order</a></li>
<li title="Group Information Function"><a href="write_test_chapter.html#group-information-function">Group Information Function</a></li>
<li title="Information Functions for Init- and End-Configuration"><a href="write_test_chapter.html#information-functions-for-init--and-end-configuration">Information Functions for Init- and End-Configuration</a></li>
<li title="Data and Private Directories"><a href="write_test_chapter.html#data-and-private-directories">Data and Private Directories</a></li>
<li title="Execution Environment"><a href="write_test_chapter.html#execution-environment">Execution Environment</a></li>
<li title="Timetrap Time-Outs"><a href="write_test_chapter.html#timetrap-time-outs">Timetrap Time-Outs</a></li>
<li title="Logging - Categories and Verbosity Levels"><a href="write_test_chapter.html#logging---categories-and-verbosity-levels">Logging - Categories and Verbosity Levels</a></li>
<li title="Illegal Dependencies"><a href="write_test_chapter.html#illegal-dependencies">Illegal Dependencies</a></li>
</ul>
</li>
<li id="no" title="Test Structure" expanded="false">Test Structure<ul>
<li><a href="test_structure_chapter.html">
              Top of chapter
            </a></li>
<li title="General"><a href="test_structure_chapter.html#general">General</a></li>
<li title="Skipping Test Cases"><a href="test_structure_chapter.html#skipping-test-cases">Skipping Test Cases</a></li>
<li title="Definition of Terms"><a href="test_structure_chapter.html#definition-of-terms">Definition of Terms</a></li>
</ul>
</li>
<li id="no" title="Examples and Templates" expanded="false">Examples and Templates<ul>
<li><a href="example_chapter.html">
              Top of chapter
            </a></li>
<li title="Test Suite Example"><a href="example_chapter.html#test-suite-example">Test Suite Example</a></li>
<li title="Test Suite Templates"><a href="example_chapter.html#test-suite-templates">Test Suite Templates</a></li>
</ul>
</li>
<li id="no" title="Running Tests and Analyzing Results" expanded="false">Running Tests and Analyzing Results<ul>
<li><a href="run_test_chapter.html">
              Top of chapter
            </a></li>
<li title="Using the Common Test Framework"><a href="run_test_chapter.html#using-the-common-test-framework">Using the Common Test Framework</a></li>
<li title="Automatic Compilation of Test Suites and Help Modules"><a href="run_test_chapter.html#automatic-compilation-of-test-suites-and-help-modules">Automatic Compilation of Test Suites and Help Modules</a></li>
<li title="Running Tests from the OS Command Line"><a href="run_test_chapter.html#running-tests-from-the-os-command-line">Running Tests from the OS Command Line</a></li>
<li title="Running Tests from the Erlang Shell or from an Erlang Program"><a href="run_test_chapter.html#running-tests-from-the-erlang-shell-or-from-an-erlang-program">Running Tests from the Erlang Shell or from an Erlang Program</a></li>
<li title="Test Case Group Execution"><a href="run_test_chapter.html#test-case-group-execution">Test Case Group Execution</a></li>
<li title="Running the Interactive Shell Mode"><a href="run_test_chapter.html#running-the-interactive-shell-mode">Running the Interactive Shell Mode</a></li>
<li title="Step-by-Step Execution of Test Cases with the Erlang Debugger"><a href="run_test_chapter.html#step-by-step-execution-of-test-cases-with-the-erlang-debugger">Step-by-Step Execution of Test Cases with the Erlang Debugger</a></li>
<li title="Test Specifications"><a href="run_test_chapter.html#test-specifications">Test Specifications</a></li>
<li title="Running Tests from the Web-Based GUI"><a href="run_test_chapter.html#running-tests-from-the-web-based-gui">Running Tests from the Web-Based GUI</a></li>
<li title="Log Files"><a href="run_test_chapter.html#log-files">Log Files</a></li>
<li title="HTML Style Sheets"><a href="run_test_chapter.html#html-style-sheets">HTML Style Sheets</a></li>
<li title="Repeating Tests"><a href="run_test_chapter.html#repeating-tests">Repeating Tests</a></li>
<li title="Silent Connections"><a href="run_test_chapter.html#silent-connections">Silent Connections</a></li>
</ul>
</li>
<li id="no" title="External Configuration Data" expanded="false">External Configuration Data<ul>
<li><a href="config_file_chapter.html">
              Top of chapter
            </a></li>
<li title="General"><a href="config_file_chapter.html#general">General</a></li>
<li title="Syntax"><a href="config_file_chapter.html#syntax">Syntax</a></li>
<li title="Requiring and Reading Configuration Data"><a href="config_file_chapter.html#requiring-and-reading-configuration-data">Requiring and Reading Configuration Data</a></li>
<li title="Using Configuration Variables Defined in Multiple Files"><a href="config_file_chapter.html#using-configuration-variables-defined-in-multiple-files">Using Configuration Variables Defined in Multiple Files</a></li>
<li title="Encrypted Configuration Files"><a href="config_file_chapter.html#encrypted-configuration-files">Encrypted Configuration Files</a></li>
<li title="Opening Connections Using Configuration Data"><a href="config_file_chapter.html#opening-connections-using-configuration-data">Opening Connections Using Configuration Data</a></li>
<li title="User-Specific Configuration Data Formats"><a href="config_file_chapter.html#user-specific-configuration-data-formats">User-Specific Configuration Data Formats</a></li>
<li title="Examples of Configuration Data Handling"><a href="config_file_chapter.html#examples-of-configuration-data-handling">Examples of Configuration Data Handling</a></li>
<li title="Example of User-Specific Configuration Handler"><a href="config_file_chapter.html#example-of-user-specific-configuration-handler">Example of User-Specific Configuration Handler</a></li>
</ul>
</li>
<li id="no" title="Code Coverage Analysis" expanded="false">Code Coverage Analysis<ul>
<li><a href="cover_chapter.html">
              Top of chapter
            </a></li>
<li title="General"><a href="cover_chapter.html#general">General</a></li>
<li title="Use"><a href="cover_chapter.html#use">Use</a></li>
<li title="Stopping the Cover Tool When Tests Are Completed"><a href="cover_chapter.html#stopping-the-cover-tool-when-tests-are-completed">Stopping the Cover Tool When Tests Are Completed</a></li>
<li title="The Cover Specification File"><a href="cover_chapter.html#the-cover-specification-file">The Cover Specification File</a></li>
<li title="Cross Cover Analysis"><a href="cover_chapter.html#cross-cover-analysis">Cross Cover Analysis</a></li>
<li title="Logging"><a href="cover_chapter.html#logging">Logging</a></li>
</ul>
</li>
<li id="loadscrollpos" title="Using Common Test for Large-Scale Testing" expanded="true">Using Common Test for Large-Scale Testing<ul>
<li><a href="ct_master_chapter.html">
              Top of chapter
            </a></li>
<li title="General"><a href="ct_master_chapter.html#general">General</a></li>
<li title="Use"><a href="ct_master_chapter.html#use">Use</a></li>
<li title="Test Specifications"><a href="ct_master_chapter.html#test-specifications">Test Specifications</a></li>
<li title="Automatic Startup of Test Target Nodes"><a href="ct_master_chapter.html#automatic-startup-of-test-target-nodes">Automatic Startup of Test Target Nodes</a></li>
</ul>
</li>
<li id="no" title="Event Handling" expanded="false">Event Handling<ul>
<li><a href="event_handler_chapter.html">
              Top of chapter
            </a></li>
<li title="General"><a href="event_handler_chapter.html#general">General</a></li>
<li title="Use"><a href="event_handler_chapter.html#use">Use</a></li>
</ul>
</li>
<li id="no" title="Dependencies between Test Cases and Suites" expanded="false">Dependencies between Test Cases and Suites<ul>
<li><a href="dependencies_chapter.html">
              Top of chapter
            </a></li>
<li title="General"><a href="dependencies_chapter.html#general">General</a></li>
<li title="Saving Configuration Data"><a href="dependencies_chapter.html#saving-configuration-data">Saving Configuration Data</a></li>
<li title="Sequences"><a href="dependencies_chapter.html#sequences">Sequences</a></li>
</ul>
</li>
<li id="no" title="Common Test Hooks" expanded="false">Common Test Hooks<ul>
<li><a href="ct_hooks_chapter.html">
              Top of chapter
            </a></li>
<li title="General"><a href="ct_hooks_chapter.html#general">General</a></li>
<li title="Installing a CTH"><a href="ct_hooks_chapter.html#installing-a-cth">Installing a CTH</a></li>
<li title="CTH Scope"><a href="ct_hooks_chapter.html#cth-scope">CTH Scope</a></li>
<li title="Manipulating Tests"><a href="ct_hooks_chapter.html#manipulating-tests">Manipulating Tests</a></li>
<li title="Synchronizing External User Applications with Common Test"><a href="ct_hooks_chapter.html#synchronizing-external-user-applications-with-common-test">Synchronizing External User Applications with Common Test</a></li>
<li title="Example CTH"><a href="ct_hooks_chapter.html#example-cth">Example CTH</a></li>
<li title="Built-In CTHs"><a href="ct_hooks_chapter.html#built-in-cths">Built-In CTHs</a></li>
</ul>
</li>
<li id="no" title="Some Thoughts about Testing" expanded="false">Some Thoughts about Testing<ul>
<li><a href="why_test_chapter.html">
              Top of chapter
            </a></li>
<li title="Goals"><a href="why_test_chapter.html#goals">Goals</a></li>
<li title="What to Test"><a href="why_test_chapter.html#what-to-test">What to Test</a></li>
</ul>
</li>
</ul>
</div></div>
<div id="content">
<div class="innertube">
<h1>11 Using Common Test for Large-Scale Testing</h1>
  

  <h3>
<a name="general"></a><span onMouseOver="document.getElementById('ghlink-general-idm2689').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-general-idm2689').style.visibility = 'hidden';"><span id="ghlink-general-idm2689" class="ghlink"><a href="https://github.com/erlang/otp/edit/maint/lib/common_test/doc/src/ct_master_chapter.xml#L33" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil"></span></a></span><a class="title_link" name="general" href="#general">11.1 
          General</a></span>
</h3>
    
    
    <p>Large-scale automated testing requires running multiple independent 
      test sessions in parallel. This is accomplished by running
      some <span class="code">Common Test</span> nodes on one or more hosts, testing
      different target systems. Configuring, starting, and controlling the
      test nodes independently can be a cumbersome operation. To aid
      this kind of automated large-scale testing, <span class="code">Common Test</span> offers a master 
      test node component, <span class="code">Common Test</span> Master, which handles central configuration and control
      in a system of distributed <span class="code">Common Test</span> nodes.</p>

    <p>The <span class="code">Common Test</span> Master server runs on one dedicated Erlang node and uses distributed
      Erlang to communicate with any number of <span class="code">Common Test</span> test nodes, each hosting a regular
      <span class="code">Common Test</span> server. Test specifications are used as input to specify what to test on which 
      test nodes, using what configuration.</p> 

    <p>The <span class="code">Common Test</span> Master server writes progress information to HTML log files similarly 
      to the regular <span class="code">Common Test</span> server. The logs contain test statistics and links to the 
      log files written by each independent <span class="code">Common Test</span> server.</p>

    <p>The <span class="code">Common Test</span> Master API is exported by module 
    <span class="bold_code bc-19"><a href="../../man/ct_master.html"><span class="code">ct_master</span></a></span>.</p>
  
  <h3><span onMouseOver="document.getElementById('ghlink-use-idm2709').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-use-idm2709').style.visibility = 'hidden';"><span id="ghlink-use-idm2709" class="ghlink"><a href="https://github.com/erlang/otp/edit/maint/lib/common_test/doc/src/ct_master_chapter.xml#L57" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil"></span></a></span><a class="title_link" name="use" href="#use">11.2 
          Use</a></span></h3>
    
    <p><span class="code">Common Test</span> Master requires all test nodes to be on the same network and share a common 
      file system. <span class="code">Common Test</span> Master cannot start test nodes
      automatically. The nodes must be started in advance for <span class="code">Common Test</span> Master to be 
      able to start test sessions on them.</p>
      
    <p>Tests are started by calling 
     <span class="bold_code bc-15"><a href="../../man/ct_master.html#run-1"><span class="code">ct_master:run(TestSpecs)</span></a></span> or 
     <span class="bold_code bc-15"><a href="../../man/ct_master.html#run-3"><span class="code">ct_master:run(TestSpecs, InclNodes, ExclNodes)</span></a></span></p>
    
    <p><span class="code">TestSpecs</span> is either the name of a test specification file (string) or a list 
      of test specifications. If it is a list, the specifications are handled (and
      the corresponding tests executed) in sequence. An element in a <span class="code">TestSpecs</span> list 
      can also be list of test specifications. The specifications in such a list are 
      merged into one combined specification before test execution.</p>

    <p><strong>Example:</strong></p>  
    <div class="example"><pre>
 ct_master:run(["ts1","ts2",["ts3","ts4"]])</pre></div>

    <p>Here, the tests specified by "ts1" run first, then the tests specified by "ts2",
      and finally the tests specified by both "ts3" and "ts4".</p>

    <p>The <span class="code">InclNodes</span> argument to <span class="code">run/3</span> is a list of node names. Function
      <span class="code">run/3</span> runs the tests in <span class="code">TestSpecs</span> just like <span class="code">run/1</span>, but also 
      takes any test in <span class="code">TestSpecs</span>, which is not explicitly tagged with a particular 
      node name, and execute it on the nodes listed in <span class="code">InclNodes</span>. By using <span class="code">run/3</span> 
      this way, any test specification can be used, with or without node information, 
      in a large-scale test environment.</p>
      
      <p><span class="code">ExclNodes</span> is a list of nodes to be
      excluded from the test. That is, tests that are specified in the test specification 
      to run on a particular node are not performed if that node is 
      listed in <span class="code">ExclNodes</span> at runtime.</p>

      <p>If <span class="code">Common Test</span> Master fails initially to connect to any of the test nodes specified in a 
      test specification or in the <span class="code">InclNodes</span> list, the operator is prompted with 
      the option to either start over again (after manually checking the status of the 
      nodes in question), to run without the missing nodes, or to abort the operation.</p>

      <p>When tests start, <span class="code">Common Test</span> Master displays information to console about the involved nodes.  
      <span class="code">Common Test</span> Master also reports when tests finish, successfully or unsuccessfully. If
      connection is lost to a node, the test on that node is considered finished. <span class="code">Common Test</span> Master 
      does not attempt to re-establish contact with the failing node.</p>

      <p>At any time, to get the current status of the test nodes, call function 
      <span class="bold_code bc-15"><a href="../../man/ct_master.html#progress-0"><span class="code">ct_master:progress()</span></a></span>.</p>

      <p>To stop one or more tests, use function
      <span class="bold_code bc-15"><a href="../../man/ct_master.html#abort-0"><span class="code">ct_master:abort()</span></a></span> (to stop all) or
      <span class="bold_code bc-15"><a href="../../man/ct_master.html#abort-1"><span class="code">ct_master:abort(Nodes)</span></a></span>.</p>

      <p>For details about the <span class="code">Common Test</span> Master API, see module
      <span class="bold_code bc-19"><a href="../../man/ct_master.html"><span class="code">ct_master</span></a></span>.</p>
  
  <h3>
<a name="test_specifications"></a><span onMouseOver="document.getElementById('ghlink-test-specifications-idm2758').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-test-specifications-idm2758').style.visibility = 'hidden';"><span id="ghlink-test-specifications-idm2758" class="ghlink"><a href="https://github.com/erlang/otp/edit/maint/lib/common_test/doc/src/ct_master_chapter.xml#L113" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil"></span></a></span><a class="title_link" name="test-specifications" href="#test-specifications">11.3 
          Test Specifications</a></span>
</h3>
    
    
    <p>The test specifications used as input to <span class="code">Common Test</span> Master are fully compatible with the
    specifications used as input to the regular <span class="code">Common Test</span> server. The syntax is described in section 
    <span class="bold_code bc-15"><a href="run_test_chapter.html#test_specifications">Test Specifications</a></span>
    in section Running Tests and Analyzing Results.</p>

    <p>All test specification terms can have a <span class="code">NodeRefs</span> element. This element
    specifies which node or nodes a configuration operation or a test is to be executed 
    on. <span class="code">NodeRefs</span> is defined as follows:</p>
    
    <p><span class="code">NodeRefs = all_nodes | [NodeRef] | NodeRef</span></p>

    <p><span class="code">NodeRef = NodeAlias | node() | master</span></p>

    <p>A <span class="code">NodeAlias</span> (<span class="code">atom()</span>) is used in a test specification as a 
    reference to a node name (so the node name only needs to be declared once,
    which also can be achieved using constants). 
    The alias is declared with a <span class="code">node</span> term as follows:</p>

    <p><span class="code">{node, NodeAlias, NodeName}</span></p>

    <p>If <span class="code">NodeRefs</span> has the value <span class="code">all_nodes</span>, the operation or test
    is performed on all specified test nodes. (Declaring a term without a <span class="code">NodeRefs</span> 
    element has the same effect). If <span class="code">NodeRefs</span> has the value 
    <span class="code">master</span>, the operation is only performed on the <span class="code">Common Test</span> Master node (namely set 
    the log directory or install an event handler).</p>

    <p>Consider the example in section 
    <span class="bold_code bc-15"><a href="run_test_chapter.html#test_specifications">Test Specifications</a></span>
    in section Running Tests and Analysing Results,
     now extended with node information and intended to be executed by
    <span class="code">Common Test</span> Master:</p>

    <div class="example"><pre>
 {define, 'Top', "/home/test"}.
 {define, 'T1', "'Top'/t1"}.
 {define, 'T2', "'Top'/t2"}.
 {define, 'T3', "'Top'/t3"}.
 {define, 'CfgFile', "config.cfg"}.
 {define, 'Node', ct_node}.

 {node, node1, 'Node@host_x'}.
 {node, node2, 'Node@host_y'}.

 {logdir, master, "'Top'/master_logs"}.
 {logdir, "'Top'/logs"}.

 {config, node1, "'T1'/'CfgFile'"}.
 {config, node2, "'T2'/'CfgFile'"}.
 {config, "'T3'/'CfgFile'"}.

 {suites, node1, 'T1', all}.
 {skip_suites, node1, 'T1', [t1B_SUITE,t1D_SUITE], "Not implemented"}.
 {skip_cases, node1, 'T1', t1A_SUITE, [test3,test4], "Irrelevant"}.
 {skip_cases, node1, 'T1', t1C_SUITE, [test1], "Ignore"}.

 {suites, node2, 'T2', [t2B_SUITE,t2C_SUITE]}.
 {cases, node2, 'T2', t2A_SUITE, [test4,test1,test7]}.

 {skip_suites, 'T3', all, "Not implemented"}.</pre></div>

    <p>This example specifies the same tests as the original example. But 
    now if started with a call to <span class="code">ct_master:run(TestSpecName)</span>, test 
    <span class="code">t1</span> is executed on node <span class="code">ct_node@host_x</span> (<span class="code">node1</span>), test
    <span class="code">t2</span> on <span class="code">ct_node@host_y</span> (<span class="code">node2</span>) and test <span class="code">t3</span>
    on both <span class="code">node1</span> and <span class="code">node2</span>. Configuration file <span class="code">t1</span> is only read on
    <span class="code">node1</span> and configuration file <span class="code">t2</span> only on <span class="code">node2</span>, while the 
    configuration file <span class="code">t3</span> is read on both <span class="code">node1</span> and <span class="code">node2</span>. 
    Both test nodes write log files to the same directory. (However, the <span class="code">Common Test</span> Master 
    node uses a different log directory than the test nodes.)</p>

    <p>If the test session is instead started with a call to 
    <span class="code">ct_master:run(TestSpecName, [ct_node@host_z], [ct_node@host_x])</span>, 
    the result is that test <span class="code">t1</span> does not run on 
    <span class="code">ct_node@host_x</span> (or any other node) while test <span class="code">t3</span> runs on both
    <span class="code">ct_node@host_y</span> and <span class="code">ct_node@host_z</span>.</p>
    
    <p>A nice feature is that a test specification that includes node 
      information can still be used as input to the regular <span class="code">Common Test</span> server 
      (as described in section
    <span class="bold_code bc-15"><a href="run_test_chapter.html#test_specifications">Test Specifications</a></span>). 
    The result is that any test specified to run on a node with the same
    name as the <span class="code">Common Test</span> node in question (typically <span class="code">ct@somehost</span> if started
    with the <span class="code">ct_run</span> program), is performed. Tests without explicit
    node association are always performed too, of course.</p>
  

  <h3><span onMouseOver="document.getElementById('ghlink-automatic-startup-of-test-target-nodes-idm2821').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-automatic-startup-of-test-target-nodes-idm2821').style.visibility = 'hidden';"><span id="ghlink-automatic-startup-of-test-target-nodes-idm2821" class="ghlink"><a href="https://github.com/erlang/otp/edit/maint/lib/common_test/doc/src/ct_master_chapter.xml#L202" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil"></span></a></span><a class="title_link" name="automatic-startup-of-test-target-nodes" href="#automatic-startup-of-test-target-nodes">11.4 
          Automatic Startup of Test Target Nodes</a></span></h3>
    
    <a name="ct_slave"></a>
    <p>Initial actions can be started and performed automatically on
      test target nodes using test specification term <span class="code">init</span>.</p>
    <p>Two subterms are supported, <span class="code">node_start</span> and <span class="code">eval</span>.</p>
    <p><strong>Example:</strong></p>
    <div class="example"><pre>
 {node, node1, node1@host1}.
 {node, node2, node1@host2}.
 {node, node3, node2@host2}.
 {node, node4, node1@host3}.
 {init, node1, [{node_start, [{callback_module, my_slave_callback}]}]}.
 {init, [node2, node3], {node_start, [{username, "ct_user"}, {password, "ct_password"}]}}.
 {init, node4, {eval, {module, function, []}}}.</pre></div>

    <p>This test specification declares that <span class="code">node1@host1</span> is to be started using
      the user callback function <span class="code">callback_module:my_slave_callback/0</span>, and nodes
      <span class="code">node1@host2</span> and <span class="code">node2@host2</span> are to be started with the default callback
      module <span class="code">ct_slave</span>. The specified username and password are used to log on to remote
      host <span class="code">host2</span>. Also, function <span class="code">module:function/0</span> is evaluated on
      <span class="code">node1@host3</span>, and the result of this call is printed to the log.</p>

    <p>The default callback module <span class="bold_code bc-19"><a href="../../man/ct_slave.html">ct_slave</a></span>,
       has the following features:
    </p>
    <ul>
     <li>Starting Erlang target nodes on local or remote hosts
       (application <span class="code">SSH</span> is used for communication).
     </li>
     <li>Ability to start an Erlang emulator with more flags
       (any flags supported by <span class="code">erl</span> are supported).
     </li>
     <li>Supervision of a node being started using internal callback
        functions. Used to prevent hanging nodes. (Configurable.)
     </li>
     <li>Monitoring of the master node by the slaves. A slave node can be
        stopped if the master node terminates. (Configurable.)
     </li>
     <li>Execution of user functions after a slave node is started. Functions can 
     be specified as a list of <span class="code">{Module, Function, Arguments}</span> tuples.
     </li>
    </ul>
    <div class="note">
<div class="label">Note</div>
<div class="content"><p><p>An <span class="code">eval</span> term for the node and
    <span class="code">startup_functions</span> in the <span class="code">node_start</span> options list can be specified. 
    In this case, the node is started first, then the <span class="code">startup_functions</span> are
    executed, and finally functions specified with <span class="code">eval</span> are called.
    </p></p></div>
</div>
  

</div>
<div class="footer">
<hr>
<p>Copyright © 2003-2021 Ericsson AB. All Rights Reserved.</p>
</div>
</div>
</div>
<script type="text/javascript">window.__otpTopDocDir = '../../js/';</script><script type="text/javascript" src="../../js/highlight.js"></script>
</body>
</html>
