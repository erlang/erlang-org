<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html xmlns:erl="http://erlang.org" xmlns:fn="http://www.w3.org/2005/02/xpath-functions">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" href="../otp_doc.css" type="text/css">
<title>Erlang -- dyntrace</title>
</head>
<body>
<div id="container">
<script id="js" type="text/javascript" language="JavaScript" src="../js/flipmenu/flipmenu.js"></script><script id="js2" type="text/javascript" src="../js/erlresolvelinks.js"></script><script language="JavaScript" type="text/javascript">
            <!--
              function getWinHeight() {
                var myHeight = 0;
                if( typeof( window.innerHeight ) == 'number' ) {
                  //Non-IE
                  myHeight = window.innerHeight;
                } else if( document.documentElement && ( document.documentElement.clientWidth ||
                                                         document.documentElement.clientHeight ) ) {
                  //IE 6+ in 'standards compliant mode'
                  myHeight = document.documentElement.clientHeight;
                } else if( document.body && ( document.body.clientWidth || document.body.clientHeight ) ) {
                  //IE 4 compatible
                  myHeight = document.body.clientHeight;
                }
                return myHeight;
              }

              function setscrollpos() {
                var objf=document.getElementById('loadscrollpos');
                 document.getElementById("leftnav").scrollTop = objf.offsetTop - getWinHeight()/2;
              }

              function addEvent(obj, evType, fn){
                if (obj.addEventListener){
                obj.addEventListener(evType, fn, true);
                return true;
              } else if (obj.attachEvent){
                var r = obj.attachEvent("on"+evType, fn);
                return r;
              } else {
                return false;
              }
             }

             addEvent(window, 'load', setscrollpos);

             //--></script><div id="leftnav"><div class="innertube">
<div class="erlang-logo-wrapper"><a href="../index.html"><img alt="Erlang Logo" src="../erlang-logo.png" class="erlang-logo"></a></div>
<p class="section-title">Runtime_Tools</p>
<p class="section-subtitle">Reference Manual</p>
<p class="section-version">Version 1.13.2.1</p>
<ul class="panel-sections">
<li><a href="../apps/runtime_tools/users_guide.html">User's Guide</a></li>
<li><a href="../apps/runtime_tools/index.html">Reference Manual</a></li>
<li><a href="../apps/runtime_tools/release_notes.html">Release Notes</a></li>
<li><a href="../apps/runtime_tools/runtime_tools.pdf">PDF</a></li>
<li><a href="../index.html">Top</a></li>
</ul>
<ul class="expand-collapse-items">
<li><a href="javascript:openAllFlips()">Expand All</a></li>
<li><a href="javascript:closeAllFlips()">Contract All</a></li>
</ul>
<h3>Table of Contents</h3>
<ul class="flipMenu">
<li title="runtime_tools (App)"><a href="runtime_tools_app.html">runtime_tools (App)
                </a></li>
<li id="no" title="dbg " expanded="false">dbg<ul>
<li><a href="dbg.html">
                  Top of manual page
                </a></li>
    <li title="c-3"><a href="dbg.html#c-3">c/3</a></li>
    <li title="c-4"><a href="dbg.html#c-4">c/4</a></li>
    <li title="cn-1"><a href="dbg.html#cn-1">cn/1</a></li>
    <li title="ctp-0"><a href="dbg.html#ctp-0">ctp/0</a></li>
    <li title="ctp-1"><a href="dbg.html#ctp-1">ctp/1</a></li>
    <li title="ctp-2"><a href="dbg.html#ctp-2">ctp/2</a></li>
    <li title="ctp-3"><a href="dbg.html#ctp-3">ctp/3</a></li>
    <li title="ctp-1"><a href="dbg.html#ctp-1">ctp/1</a></li>
    <li title="ctpe-1"><a href="dbg.html#ctpe-1">ctpe/1</a></li>
    <li title="ctpg-0"><a href="dbg.html#ctpg-0">ctpg/0</a></li>
    <li title="ctpg-1"><a href="dbg.html#ctpg-1">ctpg/1</a></li>
    <li title="ctpg-2"><a href="dbg.html#ctpg-2">ctpg/2</a></li>
    <li title="ctpg-3"><a href="dbg.html#ctpg-3">ctpg/3</a></li>
    <li title="ctpg-1"><a href="dbg.html#ctpg-1">ctpg/1</a></li>
    <li title="ctpl-0"><a href="dbg.html#ctpl-0">ctpl/0</a></li>
    <li title="ctpl-1"><a href="dbg.html#ctpl-1">ctpl/1</a></li>
    <li title="ctpl-2"><a href="dbg.html#ctpl-2">ctpl/2</a></li>
    <li title="ctpl-3"><a href="dbg.html#ctpl-3">ctpl/3</a></li>
    <li title="ctpl-1"><a href="dbg.html#ctpl-1">ctpl/1</a></li>
    <li title="dtp-0"><a href="dbg.html#dtp-0">dtp/0</a></li>
    <li title="dtp-1"><a href="dbg.html#dtp-1">dtp/1</a></li>
    <li title="flush_trace_port-0"><a href="dbg.html#flush_trace_port-0">flush_trace_port/0</a></li>
    <li title="flush_trace_port-1"><a href="dbg.html#flush_trace_port-1">flush_trace_port/1</a></li>
    <li title="fun2ms-1"><a href="dbg.html#fun2ms-1">fun2ms/1</a></li>
    <li title="get_tracer-0"><a href="dbg.html#get_tracer-0">get_tracer/0</a></li>
    <li title="get_tracer-1"><a href="dbg.html#get_tracer-1">get_tracer/1</a></li>
    <li title="h-0"><a href="dbg.html#h-0">h/0</a></li>
    <li title="h-1"><a href="dbg.html#h-1">h/1</a></li>
    <li title="i-0"><a href="dbg.html#i-0">i/0</a></li>
    <li title="ln-0"><a href="dbg.html#ln-0">ln/0</a></li>
    <li title="ltp-0"><a href="dbg.html#ltp-0">ltp/0</a></li>
    <li title="n-1"><a href="dbg.html#n-1">n/1</a></li>
    <li title="p-1"><a href="dbg.html#p-1">p/1</a></li>
    <li title="p-2"><a href="dbg.html#p-2">p/2</a></li>
    <li title="rtp-1"><a href="dbg.html#rtp-1">rtp/1</a></li>
    <li title="stop-0"><a href="dbg.html#stop-0">stop/0</a></li>
    <li title="stop_clear-0"><a href="dbg.html#stop_clear-0">stop_clear/0</a></li>
    <li title="stop_trace_client-1"><a href="dbg.html#stop_trace_client-1">stop_trace_client/1</a></li>
    <li title="tp-2"><a href="dbg.html#tp-2">tp/2</a></li>
    <li title="tp-3"><a href="dbg.html#tp-3">tp/3</a></li>
    <li title="tp-4"><a href="dbg.html#tp-4">tp/4</a></li>
    <li title="tp-2"><a href="dbg.html#tp-2">tp/2</a></li>
    <li title="tpe-2"><a href="dbg.html#tpe-2">tpe/2</a></li>
    <li title="tpl-2"><a href="dbg.html#tpl-2">tpl/2</a></li>
    <li title="tpl-3"><a href="dbg.html#tpl-3">tpl/3</a></li>
    <li title="tpl-4"><a href="dbg.html#tpl-4">tpl/4</a></li>
    <li title="tpl-2"><a href="dbg.html#tpl-2">tpl/2</a></li>
    <li title="trace_client-2"><a href="dbg.html#trace_client-2">trace_client/2</a></li>
    <li title="trace_client-3"><a href="dbg.html#trace_client-3">trace_client/3</a></li>
    <li title="trace_port-2"><a href="dbg.html#trace_port-2">trace_port/2</a></li>
    <li title="trace_port_control-1"><a href="dbg.html#trace_port_control-1">trace_port_control/1</a></li>
    <li title="trace_port_control-2"><a href="dbg.html#trace_port_control-2">trace_port_control/2</a></li>
    <li title="tracer-0"><a href="dbg.html#tracer-0">tracer/0</a></li>
    <li title="tracer-2"><a href="dbg.html#tracer-2">tracer/2</a></li>
    <li title="tracer-3"><a href="dbg.html#tracer-3">tracer/3</a></li>
    <li title="wtp-1"><a href="dbg.html#wtp-1">wtp/1</a></li>
    </ul>
</li>
<li id="loadscrollpos" title="dyntrace " expanded="true">dyntrace<ul>
<li><a href="dyntrace.html">
                  Top of manual page
                </a></li>
    <li title="available-0"><a href="dyntrace.html#available-0">available/0</a></li>
    <li title="get_tag-0"><a href="dyntrace.html#get_tag-0">get_tag/0</a></li>
    <li title="get_tag-0"><a href="dyntrace.html#get_tag-0">get_tag/0</a></li>
    <li title="p-0"><a href="dyntrace.html#p-0">p/0</a></li>
    <li title="p-1"><a href="dyntrace.html#p-1">p/1</a></li>
    <li title="p-2"><a href="dyntrace.html#p-2">p/2</a></li>
    <li title="p-3"><a href="dyntrace.html#p-3">p/3</a></li>
    <li title="p-4"><a href="dyntrace.html#p-4">p/4</a></li>
    <li title="p-5"><a href="dyntrace.html#p-5">p/5</a></li>
    <li title="p-6"><a href="dyntrace.html#p-6">p/6</a></li>
    <li title="p-7"><a href="dyntrace.html#p-7">p/7</a></li>
    <li title="p-8"><a href="dyntrace.html#p-8">p/8</a></li>
    <li title="put_tag-1"><a href="dyntrace.html#put_tag-1">put_tag/1</a></li>
    <li title="restore_tag-1"><a href="dyntrace.html#restore_tag-1">restore_tag/1</a></li>
    <li title="spread_tag-1"><a href="dyntrace.html#spread_tag-1">spread_tag/1</a></li>
    </ul>
</li>
<li id="no" title="erts_alloc_config " expanded="false">erts_alloc_config<ul>
<li><a href="erts_alloc_config.html">
                  Top of manual page
                </a></li>
    <li title="make_config-0"><a href="erts_alloc_config.html#make_config-0">make_config/0</a></li>
    <li title="make_config-1"><a href="erts_alloc_config.html#make_config-1">make_config/1</a></li>
    <li title="save_scenario-0"><a href="erts_alloc_config.html#save_scenario-0">save_scenario/0</a></li>
    <li title="stop-0"><a href="erts_alloc_config.html#stop-0">stop/0</a></li>
    </ul>
</li>
<li id="no" title="msacc " expanded="false">msacc<ul>
<li><a href="msacc.html">
                  Top of manual page
                </a></li>
    <li title="available-0"><a href="msacc.html#available-0">available/0</a></li>
    <li title="from_file-1"><a href="msacc.html#from_file-1">from_file/1</a></li>
    <li title="print-0"><a href="msacc.html#print-0">print/0</a></li>
    <li title="print-1"><a href="msacc.html#print-1">print/1</a></li>
    <li title="print-2"><a href="msacc.html#print-2">print/2</a></li>
    <li title="print-3"><a href="msacc.html#print-3">print/3</a></li>
    <li title="reset-0"><a href="msacc.html#reset-0">reset/0</a></li>
    <li title="start-0"><a href="msacc.html#start-0">start/0</a></li>
    <li title="start-1"><a href="msacc.html#start-1">start/1</a></li>
    <li title="stats-0"><a href="msacc.html#stats-0">stats/0</a></li>
    <li title="stats-2"><a href="msacc.html#stats-2">stats/2</a></li>
    <li title="stop-0"><a href="msacc.html#stop-0">stop/0</a></li>
    <li title="to_file-1"><a href="msacc.html#to_file-1">to_file/1</a></li>
    </ul>
</li>
<li id="no" title="scheduler " expanded="false">scheduler<ul>
<li><a href="scheduler.html">
                  Top of manual page
                </a></li>
    <li title="sample-0"><a href="scheduler.html#sample-0">sample/0</a></li>
    <li title="sample_all-0"><a href="scheduler.html#sample_all-0">sample_all/0</a></li>
    <li title="utilization-1"><a href="scheduler.html#utilization-1">utilization/1</a></li>
    <li title="utilization-2"><a href="scheduler.html#utilization-2">utilization/2</a></li>
    </ul>
</li>
<li id="no" title="system_information " expanded="false">system_information<ul>
<li><a href="system_information.html">
                  Top of manual page
                </a></li>
    <li title="sanity_check-0"><a href="system_information.html#sanity_check-0">sanity_check/0</a></li>
    <li title="to_file-1"><a href="system_information.html#to_file-1">to_file/1</a></li>
    </ul>
</li>
</ul>
</div></div>
<div id="content">
<div class="innertube">
<!-- refpage --><center><h1>dyntrace</h1></center>
  
  <h3><span onMouseOver="document.getElementById('ghlink-module-idm2009').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-module-idm2009').style.visibility = 'hidden';"><span id="ghlink-module-idm2009"></span><a class="title_link" name="module" href="#module">Module</a></span></h3>
<div class="REFBODY module-body">dyntrace</div>
  <h3><span onMouseOver="document.getElementById('ghlink-module-summary-idm2010').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-module-summary-idm2010').style.visibility = 'hidden';"><span id="ghlink-module-summary-idm2010"></span><a class="title_link" name="module-summary" href="#module-summary">Module Summary</a></span></h3>
<div class="REFBODY module-summary-body">Interface to dynamic tracing</div>
<h3><span onMouseOver="document.getElementById('ghlink-since-idm2010').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-since-idm2010').style.visibility = 'hidden';"><span id="ghlink-since-idm2010"></span><a class="title_link" name="since" href="#since">Since</a></span></h3>
<div class="REFBODY module-since">
	Module dyntrace was introduced in
	OTP R15B01.
      </div>
  <h3><span onMouseOver="document.getElementById('ghlink-description-idm2011').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-description-idm2011').style.visibility = 'hidden';"><span id="ghlink-description-idm2011" class="ghlink"><a href="https://github.com/erlang/otp/edit/maint/lib/runtime_tools/doc/src/dyntrace.xml#L37" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil"></span></a></span><a class="title_link" name="description" href="#description">Description</a></span></h3>
<div class="REFBODY description-body"><p>
    <p>This module implements interfaces to dynamic tracing, should such be compiled into the virtual machine. For a standard and/or commercial build, no dynamic tracing is available, in which case none of the functions in this module is usable or give any effect.</p>
    <p>Should dynamic tracing be enabled in the current build, either by configuring with <span class="code">./configure --with-dynamic-trace=dtrace</span> or with  <span class="code">./configure --with-dynamic-trace=systemtap</span>, the module can be used for two things:</p>
    <ul>
      <li>Trigger the user-probe <span class="code">user_trace_i4s4</span> in the NIF library <span class="code">dyntrace.so</span> by calling <span class="code">dyntrace:p/{1,2,3,4,5,6,7,8}</span>.</li>
      <li>Set a user specified tag that will be present in the trace messages of both the <span class="code">efile_drv</span> and the user-probe mentioned above.</li>
    </ul>
      <p>Both building with dynamic trace probes and using them is experimental and unsupported by Erlang/OTP. It is included as an option for the developer to trace and debug performance issues in their systems.</p>
      <p>The original implementation is mostly done by Scott Lystiger Fritchie as an Open Source Contribution and it should be viewed as such even though the source for dynamic tracing as well as this module is included in the main distribution. However, the ability to use dynamic tracing of the virtual machine is a very valuable contribution which OTP has every intention to maintain as a tool for the developer.</p>
      <p>How to write <span class="code">d</span> programs or <span class="code">systemtap</span> scripts can be learned from books and from a lot of pages on the Internet. This manual page does not include any documentation about using the dynamic trace tools of respective platform. The <span class="code">examples</span> directory of the <span class="code">runtime_tools</span> application however contains comprehensive examples of both <span class="code">d</span> and <span class="code">systemtap</span> programs that will help you get started. Another source of information is the <span class="bold_code bc-19"><a href="../apps/runtime_tools/DTRACE.html">dtrace</a></span> and <span class="bold_code bc-19"><a href="../apps/runtime_tools/SYSTEMTAP.html">systemtap</a></span> chapters in the Runtime Tools Users' Guide.</p>
  </p></div>
  <h3><span onMouseOver="document.getElementById('ghlink-exports-idm2034').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-exports-idm2034').style.visibility = 'hidden';"><span id="ghlink-exports-idm2034"></span><a class="title_link" name="exports" href="#exports">Exports</a></span></h3>
<div class="exports-body">
    <table class="func-table"><tr class="func-tr">
<td class="func-td"><div class="bold_code fun-type"><span onMouseOver="document.getElementById('ghlink-available-0-idm2036').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-available-0-idm2036').style.visibility = 'hidden';"><span id="ghlink-available-0-idm2036" class="ghlink"><a href="https://github.com/erlang/otp/edit/maint/lib/runtime_tools/doc/src/dyntrace.xml#L49" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil"></span></a></span><a class="title_link" name="available-0" href="#available-0">available() -&gt; boolean()</a></span></div></td>
<td class="func-since-td"><span class="since">OTP R15B01</span></td>
</tr></table>
<div class="REFBODY rb-7"><p>
	<p>This function uses the NIF library to determine if dynamic
	tracing is available. Usually calling <span class="bold_code bc-13"><a href="erlang.html#system_info-1">erlang:system_info/1</a></span>
	is a better indicator of the availability of dynamic
	tracing.</p>
	<p>The function will throw an exception if the <span class="code">dyntrace</span> NIF library could not be loaded by the on_load function of this module.</p>
      </p></div>
    <table class="func-table"><tr class="func-tr">
<td class="func-td"><div class="bold_code fun-type"><span onMouseOver="document.getElementById('ghlink-p-0-idm2044').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-p-0-idm2044').style.visibility = 'hidden';"><span id="ghlink-p-0-idm2044" class="ghlink"><a href="https://github.com/erlang/otp/edit/maint/lib/runtime_tools/doc/src/dyntrace.xml#L61" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil"></span></a></span><a class="title_link" name="p-0" href="#p-0">p() -&gt; true | false | error | badarg</a></span></div></td>
<td class="func-since-td"><span class="since">OTP R15B01</span></td>
</tr></table>
<div class="REFBODY rb-7"><p>
        <p>Calling this function will trigger the "user" trace probe user_trace_i4s4 in the dyntrace NIF module, sending a trace message only containing the user tag and zeroes/empty strings in all other fields.</p>
      </p></div>
    <table class="func-table"><tr class="func-tr">
<td class="func-td"><div class="bold_code fun-type"><span onMouseOver="document.getElementById('ghlink-p-1-idm2049').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-p-1-idm2049').style.visibility = 'hidden';"><span id="ghlink-p-1-idm2049" class="ghlink"><a href="https://github.com/erlang/otp/edit/maint/lib/runtime_tools/doc/src/dyntrace.xml#L68" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil"></span></a></span><a class="title_link" name="p-1" href="#p-1">p(integer() | string()) -&gt; true | false | error | badarg</a></span></div></td>
<td class="func-since-td"><span class="since">OTP R15B01</span></td>
</tr></table>
<div class="REFBODY rb-7"><p>
        <p>Calling this function will trigger the "user" trace probe user_trace_i4s4 in the dyntrace NIF module, sending a trace message containing the user tag and the integer or string parameter in the first integer/string field.</p>
      </p></div>
    <table class="func-table"><tr class="func-tr">
<td class="func-td"><div class="bold_code fun-type"><span onMouseOver="document.getElementById('ghlink-p-2-idm2054').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-p-2-idm2054').style.visibility = 'hidden';"><span id="ghlink-p-2-idm2054" class="ghlink"><a href="https://github.com/erlang/otp/edit/maint/lib/runtime_tools/doc/src/dyntrace.xml#L75" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil"></span></a></span><a class="title_link" name="p-2" href="#p-2">p(integer() | string(), integer() | string()) -&gt; true | false | error | badarg</a></span></div></td>
<td class="func-since-td"><span class="since">OTP R15B01</span></td>
</tr></table>
<div class="REFBODY rb-7"><p>
        <p>Calling this function will trigger the "user" trace probe user_trace_i4s4 in the dyntrace NIF module, sending a trace message containing the user tag and the integer() or string() parameters as the first fields of respective type. integer() parameters should be put before any string() parameters. I.e. <span class="code">p(1,"Hello")</span> is ok, as is <span class="code">p(1,1)</span> and <span class="code">p("Hello","Again")</span>, but not <span class="code">p("Hello",1)</span>.</p>
      </p></div>
    <table class="func-table"><tr class="func-tr">
<td class="func-td"><div class="bold_code fun-type"><span onMouseOver="document.getElementById('ghlink-p-3-idm2063').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-p-3-idm2063').style.visibility = 'hidden';"><span id="ghlink-p-3-idm2063" class="ghlink"><a href="https://github.com/erlang/otp/edit/maint/lib/runtime_tools/doc/src/dyntrace.xml#L82" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil"></span></a></span><a class="title_link" name="p-3" href="#p-3">p(integer() | string(), integer() | string(), integer() | string()) -&gt; true | false | error | badarg</a></span></div></td>
<td class="func-since-td"><span class="since">OTP R15B01</span></td>
</tr></table>
<div class="REFBODY rb-7"><p>
        <p>Calling this function will trigger the "user" trace probe user_trace_i4s4 in the dyntrace NIF module, sending a trace message containing the user tag and the integer() or string() parameters as the first fields of respective type. integer() parameters should be put before any string() parameters, as in <span class="bold_code bc-17"><a href="#p-2">p/2</a></span>.</p>
      </p></div>
    <table class="func-table"><tr class="func-tr">
<td class="func-td"><div class="bold_code fun-type"><span onMouseOver="document.getElementById('ghlink-p-4-idm2069').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-p-4-idm2069').style.visibility = 'hidden';"><span id="ghlink-p-4-idm2069" class="ghlink"><a href="https://github.com/erlang/otp/edit/maint/lib/runtime_tools/doc/src/dyntrace.xml#L89" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil"></span></a></span><a class="title_link" name="p-4" href="#p-4">p(integer() | string(), integer() | string(), integer() | string(), integer() | string()) -&gt; true | false | error | badarg</a></span></div></td>
<td class="func-since-td"><span class="since">OTP R15B01</span></td>
</tr></table>
<div class="REFBODY rb-7"><p>
        <p>Calling this function will trigger the "user" trace probe user_trace_i4s4 in the dyntrace NIF module, sending a trace message containing the user tag and the integer() or string() parameters as the first fields of respective type. integer() parameters should be put before any string() parameters, as in <span class="bold_code bc-17"><a href="#p-2">p/2</a></span>.</p>
      </p></div>
    <table class="func-table"><tr class="func-tr">
<td class="func-td"><div class="bold_code fun-type"><span onMouseOver="document.getElementById('ghlink-p-5-idm2075').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-p-5-idm2075').style.visibility = 'hidden';"><span id="ghlink-p-5-idm2075" class="ghlink"><a href="https://github.com/erlang/otp/edit/maint/lib/runtime_tools/doc/src/dyntrace.xml#L96" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil"></span></a></span><a class="title_link" name="p-5" href="#p-5">p(integer(), integer() | string(), integer() | string(), integer() | string(), string()) -&gt; true | false | error | badarg</a></span></div></td>
<td class="func-since-td"><span class="since">OTP R15B01</span></td>
</tr></table>
<div class="REFBODY rb-7"><p>
        <p>Calling this function will trigger the "user" trace probe user_trace_i4s4 in the dyntrace NIF module, sending a trace message containing the user tag and the integer() or string() parameters as the first fields of respective type. integer() parameters should be put before any string() parameters, as in <span class="bold_code bc-17"><a href="#p-2">p/2</a></span>.</p>
	<p>There can be no more than four parameters of any type (integer() or string()), so the first parameter has to be an integer() and the last a string().</p> 
      </p></div>
     <table class="func-table"><tr class="func-tr">
<td class="func-td"><div class="bold_code fun-type"><span onMouseOver="document.getElementById('ghlink-p-6-idm2082').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-p-6-idm2082').style.visibility = 'hidden';"><span id="ghlink-p-6-idm2082" class="ghlink"><a href="https://github.com/erlang/otp/edit/maint/lib/runtime_tools/doc/src/dyntrace.xml#L104" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil"></span></a></span><a class="title_link" name="p-6" href="#p-6">p(integer(), integer(), integer() | string(), integer() | string(), string(), string()) -&gt; true | false | error | badarg</a></span></div></td>
<td class="func-since-td"><span class="since">OTP R15B01</span></td>
</tr></table>
<div class="REFBODY rb-7"><p>
        <p>Calling this function will trigger the "user" trace probe user_trace_i4s4 in the dyntrace NIF module, sending a trace message containing the user tag and the integer() or string() parameters as the first fields of respective type. integer() parameters should be put before any string() parameters, as in <span class="bold_code bc-17"><a href="#p-2">p/2</a></span>.</p>
	<p>There can be no more than four parameters of any type (integer() or string()), so the first two parameters has to be integer()'s and the last two string()'s.</p> 
      </p></div>
     <table class="func-table"><tr class="func-tr">
<td class="func-td"><div class="bold_code fun-type"><span onMouseOver="document.getElementById('ghlink-p-7-idm2089').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-p-7-idm2089').style.visibility = 'hidden';"><span id="ghlink-p-7-idm2089" class="ghlink"><a href="https://github.com/erlang/otp/edit/maint/lib/runtime_tools/doc/src/dyntrace.xml#L112" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil"></span></a></span><a class="title_link" name="p-7" href="#p-7">p(integer(), integer(), integer(), integer() | string(), string(), string(), string()) -&gt; true | false | error | badarg</a></span></div></td>
<td class="func-since-td"><span class="since">OTP R15B01</span></td>
</tr></table>
<div class="REFBODY rb-7"><p>
        <p>Calling this function will trigger the "user" trace probe user_trace_i4s4 in the dyntrace NIF module, sending a trace message containing the user tag and the integer() or string() parameters as the first fields of respective type. integer() parameters should be put before any string() parameters, as in <span class="bold_code bc-17"><a href="#p-2">p/2</a></span>.</p>
	<p>There can be no more than four parameters of any type (integer() or string()), so the first three parameters has to be integer()'s and the last three string()'s.</p> 
      </p></div>
     <table class="func-table"><tr class="func-tr">
<td class="func-td"><div class="bold_code fun-type"><span onMouseOver="document.getElementById('ghlink-p-8-idm2096').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-p-8-idm2096').style.visibility = 'hidden';"><span id="ghlink-p-8-idm2096" class="ghlink"><a href="https://github.com/erlang/otp/edit/maint/lib/runtime_tools/doc/src/dyntrace.xml#L120" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil"></span></a></span><a class="title_link" name="p-8" href="#p-8">p(integer(), integer(), integer(), integer(), string(), string(), string(), string()) -&gt; true | false | error | badarg</a></span></div></td>
<td class="func-since-td"><span class="since">OTP R15B01</span></td>
</tr></table>
<div class="REFBODY rb-7"><p>
        <p>Calling this function will trigger the "user" trace probe user_trace_i4s4 in the dyntrace NIF module, sending a trace message containing all the integer()'s and string()'s provided, as well as any user tag set in the current process.</p> 
      </p></div>
    <table class="func-table"><tr class="func-tr">
<td class="func-td"><div class="bold_code fun-type"><span onMouseOver="document.getElementById('ghlink-get_tag-0-idm2101').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-get_tag-0-idm2101').style.visibility = 'hidden';"><span id="ghlink-get_tag-0-idm2101" class="ghlink"><a href="https://github.com/erlang/otp/edit/maint/lib/runtime_tools/doc/src/dyntrace.xml#L127" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil"></span></a></span><a class="title_link" name="get_tag-0" href="#get_tag-0">get_tag() -&gt; binary() | undefined</a></span></div></td>
<td class="func-since-td"><span class="since">OTP R15B01</span></td>
</tr></table>
<div class="REFBODY rb-7"><p>
	<p>This function returns the user tag set in the current
	process. If no tag is set or dynamic tracing is not available,
	it returns <span class="code">undefined</span></p>
      </p></div>
    <table class="func-table"><tr class="func-tr">
<td class="func-td"><div class="bold_code fun-type"><span onMouseOver="document.getElementById('ghlink-get_tag-0-idm2107').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-get_tag-0-idm2107').style.visibility = 'hidden';"><span id="ghlink-get_tag-0-idm2107" class="ghlink"><a href="https://github.com/erlang/otp/edit/maint/lib/runtime_tools/doc/src/dyntrace.xml#L136" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil"></span></a></span><a class="title_link" name="get_tag-0" href="#get_tag-0">get_tag() -&gt; binary() | undefined</a></span></div></td>
<td class="func-since-td"><span class="since">OTP R15B01</span></td>
</tr></table>
<div class="REFBODY rb-7"><p>
	<p>This function returns the user tag set in the current
	process or, if no user tag is present, the last user tag sent
	to the process together with a message (in the same way as
	<span class="bold_code bc-18"><a href="seq_trace.html">sequential trace tokens</a></span> are spread to other processes together with
	messages. For an explanation of how user tags can be spread
	together with messages, see <span class="bold_code bc-17"><a href="#spread_tag-1">spread_tag/1</a></span>. If no tag is
	found or dynamic tracing is not available, it returns
	<span class="code">undefined</span></p>
      </p></div>
    
    <table class="func-table"><tr class="func-tr">
<td class="func-td"><div class="bold_code fun-type"><span onMouseOver="document.getElementById('ghlink-put_tag-1-idm2115').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-put_tag-1-idm2115').style.visibility = 'hidden';"><span id="ghlink-put_tag-1-idm2115" class="ghlink"><a href="https://github.com/erlang/otp/edit/maint/lib/runtime_tools/doc/src/dyntrace.xml#L153" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil"></span></a></span><a class="title_link" name="put_tag-1" href="#put_tag-1">put_tag(Item) -&gt; binary() | undefined </a></span></div></td>
<td class="func-since-td"><span class="since">OTP R15B01</span></td>
</tr></table>
<div class="REFBODY rb-5">
<h3 class="func-types-title">Types</h3>
        <div class="REFTYPES rt-4">
<span class="bold_code fun-param-type">Item = iodata()</span><br>
</div>
      </div>
<div class="REFBODY rb-7"><p>
        <p>This function sets the user tag of the current process. The user tag is a binary(), but can be specified as any iodata(), which is automatically converted to a binary by this function.</p>
	<p>The user tag is provided to the user probes triggered by calls top <span class="code">dyntrace:p/{1,2,3,4,5,6,7,8}</span> as well as probes in the efile_driver. In the future, user tags might be added to more probes.</p>
	<p>The old user tag (if any) is returned, or <span class="code">undefined</span> if no user tag was present or dynamic tracing is not enabled.</p>
      </p></div>
    <table class="func-table"><tr class="func-tr">
<td class="func-td"><div class="bold_code fun-type"><span onMouseOver="document.getElementById('ghlink-spread_tag-1-idm2126').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-spread_tag-1-idm2126').style.visibility = 'hidden';"><span id="ghlink-spread_tag-1-idm2126" class="ghlink"><a href="https://github.com/erlang/otp/edit/maint/lib/runtime_tools/doc/src/dyntrace.xml#L165" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil"></span></a></span><a class="title_link" name="spread_tag-1" href="#spread_tag-1">spread_tag(boolean()) -&gt; TagData</a></span></div></td>
<td class="func-since-td"><span class="since">OTP R15B01</span></td>
</tr></table>
<div class="REFBODY rb-5">
<h3 class="func-types-title">Types</h3>
        <div class="REFTYPES rt-4">
<span class="bold_code fun-param-type">TagData = opaque data that can be used as parameter to <span class="bold_code bc-17"><a href="#restore_tag-1">restore_tag/1</a></span></span><br>
</div>
      </div>
<div class="REFBODY rb-7"><p>
        <p>This function controls if user tags are to be spread to other processes with the next message. Spreading of user tags work like spreading of sequential trace tokens, so that a received user tag will be active in the process until the next message arrives (if that message does not also contain the user tag.</p>
	<p>This functionality is used when a client process communicates with a file i/o-server to spread the user tag to the I/O-server and then down to the efile_drv driver. By using <span class="code">spread_tag/1</span> and <span class="code">restore_tag/1</span>, one can enable or disable spreading of user tags to other processes and then restore the previous state of the user tag. The TagData returned from this call contains all previous information so the state (including any previously spread user tags) will be completely restored by a later call to <span class="code">restore_tag/1</span>.</p> 
	<p>The <span class="bold_code bc-18"><a href="file.html">file</a></span> module already spread's tags, so there is noo need to manually call these function to get user tags spread to the efile driver through that module.</p>
	<p>The most use of this function would be if one for example uses the <span class="bold_code bc-18"><a href="io.html">io</a></span> module to communicate with an I/O-server for a regular file, like in the following example:</p>
<div class="example"><pre>
f() -&gt;
   {ok, F} = file:open("test.tst",[write]),
   Saved = dyntrace:spread_tag(true),
   io:format(F,"Hello world!",[]),
   dyntrace:restore_tag(Saved),
   file:close(F).
</pre></div>
          <p>In this example, any user tag set in the calling process will be spread to the I/O-server when the io:format call is done.</p>
      </p></div>
    <table class="func-table"><tr class="func-tr">
<td class="func-td"><div class="bold_code fun-type"><span onMouseOver="document.getElementById('ghlink-restore_tag-1-idm2144').style.visibility = 'visible';" onMouseOut="document.getElementById('ghlink-restore_tag-1-idm2144').style.visibility = 'hidden';"><span id="ghlink-restore_tag-1-idm2144" class="ghlink"><a href="https://github.com/erlang/otp/edit/maint/lib/runtime_tools/doc/src/dyntrace.xml#L187" title="Found an issue with the documentation? Fix it by clicking here!"><span class="pencil"></span></a></span><a class="title_link" name="restore_tag-1" href="#restore_tag-1">restore_tag(TagData) -&gt; true</a></span></div></td>
<td class="func-since-td"><span class="since">OTP R15B01</span></td>
</tr></table>
<div class="REFBODY rb-5">
<h3 class="func-types-title">Types</h3>
        <div class="REFTYPES rt-4">
<span class="bold_code fun-param-type">TagData = opaque data returned by <span class="bold_code bc-17"><a href="#spread_tag-1">spread_tag/1</a></span></span><br>
</div>
      </div>
<div class="REFBODY rb-7"><p>
	<p>Restores the previous state of user tags and their spreading as it was before a call to <span class="bold_code bc-17"><a href="#spread_tag-1">spread_tag/1</a></span>. Note that the restoring is not limited to the same process, one can utilize this to turn off spreding in one process and restore it in a newly created, the one that actually is going to send messages:</p>
<div class="example"><pre>
f() -&gt;
    TagData=dyntrace:spread_tag(false),
    spawn(fun() -&gt;
             dyntrace:restore_tag(TagData),
             do_something()
          end),
    do_something_else(),
    dyntrace:restore_tag(TagData).
</pre></div>
        <p>Correctly handling user tags and their spreading might take some effort, as Erlang programs tend to send and receive messages so that sometimes the user tag gets lost due to various things, like double receives or communication with a port (ports do not handle user tags, in the same way as they do not handle regular sequential trace tokens).</p>
      </p></div>
  </div>
 </div>
<div class="footer">
<hr>
<p>Copyright © 1999-2021 Ericsson AB. All Rights Reserved.</p>
</div>
</div>
</div>
<script type="text/javascript">window.__otpTopDocDir = '../js/';</script><script type="text/javascript" src="../js/highlight.js"></script>
</body>
</html>
