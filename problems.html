<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html xmlns:fn="http://www.w3.org/2005/02/xpath-functions">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" href="./otp_doc.css" type="text/css">
<title>Erlang -- Troubleshooting, Problems and 'Gotchas'</title>
</head>
<body bgcolor="white" text="#000000" link="#0000ff" vlink="#ff00ff" alink="#ff0000"><div id="container">
<script id="js" type="text/javascript" language="JavaScript" src="./js/flipmenu/flipmenu.js"></script><script id="js2" type="text/javascript" src="./js/erlresolvelinks.js"></script><script language="JavaScript" type="text/javascript">
            <!--            
              function getWinHeight() {
                var myHeight = 0;
                if( typeof( window.innerHeight ) == 'number' ) {
                  //Non-IE
                  myHeight = window.innerHeight;
                } else if( document.documentElement && ( document.documentElement.clientWidth || 
                                                         document.documentElement.clientHeight ) ) {
                  //IE 6+ in 'standards compliant mode'
                  myHeight = document.documentElement.clientHeight;
                } else if( document.body && ( document.body.clientWidth || document.body.clientHeight ) ) {
                  //IE 4 compatible
                  myHeight = document.body.clientHeight;
                }
                return myHeight;            
              }

              function setscrollpos() {
                var objf=document.getElementById('loadscrollpos');
                 document.getElementById("leftnav").scrollTop = objf.offsetTop - getWinHeight()/2;
              }

              function addEvent(obj, evType, fn){ 
                if (obj.addEventListener){ 
                obj.addEventListener(evType, fn, true); 
                return true; 
              } else if (obj.attachEvent){ 
                var r = obj.attachEvent("on"+evType, fn); 
                return r; 
              } else { 
                return false; 
              } 
             }

             addEvent(window, 'load', setscrollpos);

             //--></script><div id="leftnav"><div class="innertube">
<img alt="Erlang logo" src="./erlang-logo.png"><br><p><strong>Troubleshooting, Problems and 'Gotchas'</strong><br><strong></strong><br></p>
<a href="faq.html">Cover</a><br><br><a href="javascript:openAllFlips()">Expand All</a><br><a href="javascript:closeAllFlips()">Contract All</a><p><small><strong>Table of Contents</strong></small></p>
<ul class="flipMenu" imagepath="./js/flipmenu">
<li id="no" title="What is Erlang" expanded="false">What is Erlang<ul>
<li><a href="introduction.html">
              Top of chapter
            </a></li>
<li title="In a nutshell, what is Erlang?"><a href="introduction.html#idm19">In a nutshell, what is Erlang?</a></li>
<li title="What is OTP?"><a href="introduction.html#idm24">What is OTP?</a></li>
<li title="What sort of applications is Erlang particularly suitable for?
"><a href="introduction.html#idm27">What sort of applications is Erlang particularly suitable for?
</a></li>
<li title="What sort of problems is Erlang not particularly suitable for?
"><a href="introduction.html#idm53">What sort of problems is Erlang not particularly suitable for?
</a></li>
<li title=" Who uses Erlang for product development?"><a href="introduction.html#idm60"> Who uses Erlang for product development?</a></li>
<li title=" Who uses Erlang for research and teaching?"><a href="introduction.html#idm148"> Who uses Erlang for research and teaching?</a></li>
<li title=" Can I get commercial support for Erlang?"><a href="introduction.html#idm214"> Can I get commercial support for Erlang?</a></li>
</ul>
</li>
<li id="no" title="Questions about this FAQ" expanded="false">Questions about this FAQ<ul>
<li><a href="faq_questions.html">
              Top of chapter
            </a></li>
<li title="Where can I get the latest version of the FAQ?"><a href="faq_questions.html#idm226">Where can I get the latest version of the FAQ?</a></li>
<li title="What's new?"><a href="faq_questions.html#idm230">What's new?</a></li>
<li title="Where do I ask questions which are not answered in this FAQ?"><a href="faq_questions.html#idm234">Where do I ask questions which are not answered in this FAQ?</a></li>
<li title="The answer to question 2.4 is wrong!"><a href="faq_questions.html#idm240">The answer to question 2.4 is wrong!</a></li>
<li title="Disclaimer/Distribution"><a href="faq_questions.html#idm248">Disclaimer/Distribution</a></li>
</ul>
</li>
<li id="no" title="Obtaining Erlang/OTP and books/articles about it" expanded="false">Obtaining Erlang/OTP and books/articles about it<ul>
<li><a href="obtaining.html">
              Top of chapter
            </a></li>
<li title="Where can I get Erlang/OTP?"><a href="obtaining.html#idm260">Where can I get Erlang/OTP?</a></li>
<li title="What's the current version of (Open Source) Erlang?"><a href="obtaining.html#idm273">What's the current version of (Open Source) Erlang?</a></li>
<li title=" Which licence is Open Source Erlang shipped with?"><a href="obtaining.html#idm279"> Which licence is Open Source Erlang shipped with?</a></li>
<li title="Where is the Erlang documentation?"><a href="obtaining.html#idm284">Where is the Erlang documentation?</a></li>
<li title="Which book about Erlang should I read?"><a href="obtaining.html#idm291">Which book about Erlang should I read?</a></li>
<li title=" What advanced Erlang documentation is there?"><a href="obtaining.html#idm323"> What advanced Erlang documentation is there?</a></li>
<li title=" What documentation is there in related subjects?"><a href="obtaining.html#idm352"> What documentation is there in related subjects?</a></li>
<li title="Is there public repository for the Erlang source?"><a href="obtaining.html#idm365">Is there public repository for the Erlang source?</a></li>
<li title="How can I contribute to Erlang?"><a href="obtaining.html#idm371">How can I contribute to Erlang?</a></li>
<li title="How can I propose changes to the language itself?"><a href="obtaining.html#idm385">How can I propose changes to the language itself?</a></li>
<li title="How do I report a bug?"><a href="obtaining.html#idm389">How do I report a bug?</a></li>
<li title="Where is Erlang discussed in the real world?"><a href="obtaining.html#idm393">Where is Erlang discussed in the real world?</a></li>
<li title="Where is Erlang discussed online?"><a href="obtaining.html#idm408">Where is Erlang discussed online?</a></li>
<li title="Where can I find Erlang programmers/employers?"><a href="obtaining.html#idm432">Where can I find Erlang programmers/employers?</a></li>
</ul>
</li>
<li id="no" title="Getting Started" expanded="false">Getting Started<ul>
<li><a href="getting_started.html">
              Top of chapter
            </a></li>
<li title="How long does it take to learn Erlang?"><a href="getting_started.html#idm457">How long does it take to learn Erlang?</a></li>
<li title="How can I learn Erlang?"><a href="getting_started.html#idm462">How can I learn Erlang?</a></li>
<li title='What does "hello world" look like?'><a href="getting_started.html#idm479">What does "hello world" look like?</a></li>
<li title="How do I quit the Erlang shell?"><a href="getting_started.html#idm488">How do I quit the Erlang shell?</a></li>
<li title="Why does Erlang print &quot;ok&quot; after my program's output?"><a href="getting_started.html#idm498">Why does Erlang print "ok" after my program's output?</a></li>
</ul>
</li>
<li id="no" title="How do I..." expanded="false">How do I...<ul>
<li><a href="how_do_i.html">
              Top of chapter
            </a></li>
<li title="...compare numbers?"><a href="how_do_i.html#idm523">...compare numbers?</a></li>
<li title="...represent a text-string?"><a href="how_do_i.html#idm529">...represent a text-string?</a></li>
<li title="...convert a string to lower case?"><a href="how_do_i.html#idm544">...convert a string to lower case?</a></li>
<li title="...convert a text string representation of a term to a term?"><a href="how_do_i.html#idm550">...convert a text string representation of a term to a term?</a></li>
<li title="...use unicode/UTF-8?"><a href="how_do_i.html#idm555">...use unicode/UTF-8?</a></li>
<li title="...destructively update data, like in C"><a href="how_do_i.html#idm559">...destructively update data, like in C</a></li>
<li title="...run an Erlang program directly from the unix shell?"><a href="how_do_i.html#idm566">...run an Erlang program directly from the unix shell?</a></li>
<li title="...communicate with non-Erlang programs?"><a href="how_do_i.html#idm575">...communicate with non-Erlang programs?</a></li>
<li title="...write a unix pipe program in Erlang?"><a href="how_do_i.html#idm603">...write a unix pipe program in Erlang?</a></li>
<li title="...communicate with a DBMS?"><a href="how_do_i.html#idm609">...communicate with a DBMS?</a></li>
<li title="...decode binary Erlang terms"><a href="how_do_i.html#idm613">...decode binary Erlang terms</a></li>
<li title="...decode Erlang crash dumps"><a href="how_do_i.html#idm619">...decode Erlang crash dumps</a></li>
<li title="...estimate performance of an Erlang system?"><a href="how_do_i.html#idm623">...estimate performance of an Erlang system?</a></li>
<li title="...measure performance of an Erlang system?"><a href="how_do_i.html#idm638">...measure performance of an Erlang system?</a></li>
<li title="...measure memory consumption in an Erlang system?"><a href="how_do_i.html#idm645">...measure memory consumption in an Erlang system?</a></li>
<li title="...estimate productivity in an Erlang project?"><a href="how_do_i.html#idm673">...estimate productivity in an Erlang project?</a></li>
<li title="...use multiple CPUs (or cores) in one server?"><a href="how_do_i.html#idm678">...use multiple CPUs (or cores) in one server?</a></li>
<li title="...run distributed Erlang through a firewall?"><a href="how_do_i.html#idm681">...run distributed Erlang through a firewall?</a></li>
<li title="...distribute the Erlang programs I write to my friends/colleagues/users?"><a href="how_do_i.html#idm688">...distribute the Erlang programs I write to my friends/colleagues/users?</a></li>
<li title="...write to standard error (stderr)?"><a href="how_do_i.html#idm694">...write to standard error (stderr)?</a></li>
</ul>
</li>
<li id="no" title="Erlang Libraries" expanded="false">Erlang Libraries<ul>
<li><a href="libraries.html">
              Top of chapter
            </a></li>
<li title=" What's in the OTP libraries?"><a href="libraries.html#idm710"> What's in the OTP libraries?</a></li>
<li title=" Is there a collection of data structures, e.g. balanced trees?"><a href="libraries.html#idm736"> Is there a collection of data structures, e.g. balanced trees?</a></li>
<li title="Is there a serial port driver for Erlang?"><a href="libraries.html#idm768">Is there a serial port driver for Erlang?</a></li>
<li title="Is there a toolkit for building GUIs?"><a href="libraries.html#idm773">Is there a toolkit for building GUIs?</a></li>
<li title="I've written an application/library. How do I package it so others can use it?"><a href="libraries.html#idm786">I've written an application/library. How do I package it so others can use it?</a></li>
<li title="I've written a library to handle XYZ. How do I get it into the standard Erlang distribution?"><a href="libraries.html#idm797">I've written a library to handle XYZ. How do I get it into the standard Erlang distribution?</a></li>
</ul>
</li>
<li id="no" title="Erlang Tools" expanded="false">Erlang Tools<ul>
<li><a href="tools.html">
              Top of chapter
            </a></li>
<li title="Is there a pretty printer for Erlang?"><a href="tools.html#idm811">Is there a pretty printer for Erlang?</a></li>
<li title="Is there an erlang formatter for CI?"><a href="tools.html#idm815">Is there an erlang formatter for CI?</a></li>
<li title="Where is the source for LEEX (the erlang lexer)?"><a href="tools.html#idm819">Where is the source for LEEX (the erlang lexer)?</a></li>
<li title="Is there a diagram tool specifically for Erlang?"><a href="tools.html#idm828">Is there a diagram tool specifically for Erlang?</a></li>
<li title="What code testing tools and suites exist for and in Erlang/OTP?"><a href="tools.html#idm836">What code testing tools and suites exist for and in Erlang/OTP?</a></li>
<li title="Is there a way to benchmark an Erlang implementation?"><a href="tools.html#idm848">Is there a way to benchmark an Erlang implementation?</a></li>
<li title="Does anyone have a magic file for Erlang?"><a href="tools.html#idm852">Does anyone have a magic file for Erlang?</a></li>
<li title="Which IDE should I use for Erlang development?"><a href="tools.html#idm856">Which IDE should I use for Erlang development?</a></li>
<li title="Are there Erlang Coding Guidelines?"><a href="tools.html#idm877">Are there Erlang Coding Guidelines?</a></li>
<li title="What refactoring tools are there for Erlang"><a href="tools.html#idm881">What refactoring tools are there for Erlang</a></li>
<li title="What static code analysis tools are there?"><a href="tools.html#idm890">What static code analysis tools are there?</a></li>
<li title='Is there a "reverse compiler" for BEAM files?'><a href="tools.html#idm900">Is there a "reverse compiler" for BEAM files?</a></li>
</ul>
</li>
<li id="no" title="Implementations and Ports of Erlang" expanded="false">Implementations and Ports of Erlang<ul>
<li><a href="implementations.html">
              Top of chapter
            </a></li>
<li title="Open Source Erlang"><a href="implementations.html#idm922">Open Source Erlang</a></li>
<li title="What Experimental, Research and Historical
Implementations are there?"><a href="implementations.html#idm926">What Experimental, Research and Historical
Implementations are there?</a></li>
<li title=" Which version of Erlang am I running?"><a href="implementations.html#idm944"> Which version of Erlang am I running?</a></li>
<li title=" What operating systems does Erlang run on?"><a href="implementations.html#idm950"> What operating systems does Erlang run on?</a></li>
<li title=" What implementations of the Erlang Virtual Machine are there?"><a href="implementations.html#idm969"> What implementations of the Erlang Virtual Machine are there?</a></li>
<li title="Can Erlang be compiled under Microsoft Windows?"><a href="implementations.html#idm980">Can Erlang be compiled under Microsoft Windows?</a></li>
<li title="How can I cross-compile Erlang?"><a href="implementations.html#idm983">How can I cross-compile Erlang?</a></li>
<li title="Is Erlang small enough for embedded systems?"><a href="implementations.html#idm987">Is Erlang small enough for embedded systems?</a></li>
</ul>
</li>
<li id="loadscrollpos" title="Troubleshooting, Problems and 'Gotchas'" expanded="true">Troubleshooting, Problems and 'Gotchas'<ul>
<li><a href="problems.html">
              Top of chapter
            </a></li>
<li title="Why can't I write a = 3 (badmatch)?"><a href="problems.html#idm1004">Why can't I write a = 3 (badmatch)?</a></li>
<li title="Why can't I change the value of a variable?"><a href="problems.html#idm1017">Why can't I change the value of a variable?</a></li>
<li title="Why do lists of numbers get printed incorrectly?"><a href="problems.html#idm1024">Why do lists of numbers get printed incorrectly?</a></li>
<li title=" Why can't I call arbitrary functions in a guard?"><a href="problems.html#idm1035"> Why can't I call arbitrary functions in a guard?</a></li>
<li title=" Why can't I use &quot;or&quot; in a guard?"><a href="problems.html#idm1047"> Why can't I use "or" in a guard?</a></li>
<li title=" Why does 'catch' give me a syntax error?"><a href="problems.html#idm1063"> Why does 'catch' give me a syntax error?</a></li>
<li title=" What is a sticky directory?"><a href="problems.html#idm1069"> What is a sticky directory?</a></li>
<li title="Why won't my distributed Erlang nodes communicate?"><a href="problems.html#idm1076">Why won't my distributed Erlang nodes communicate?</a></li>
<li title="When distribution won't work"><a href="problems.html#idm1099">When distribution won't work</a></li>
<li title="Avoiding DNS"><a href="problems.html#idm1114">Avoiding DNS</a></li>
<li title="
Why does my application die every second time I load new code into it?
"><a href="problems.html#idm1120">
Why does my application die every second time I load new code into it?
</a></li>
<li title="Why can't I open devices (e.g. a serial port) like normal files?
"><a href="problems.html#idm1127">Why can't I open devices (e.g. a serial port) like normal files?
</a></li>
<li title="
Why doesn't the stack backtrace show the right functions for
this code:
"><a href="problems.html#idm1132">
Why doesn't the stack backtrace show the right functions for
this code:
</a></li>
<li title="What do I do if I get an error when compiling Open Source Erlang?
"><a href="problems.html#idm1136">What do I do if I get an error when compiling Open Source Erlang?
</a></li>
<li title="Why do errors in the shell kill other processes?"><a href="problems.html#idm1149">Why do errors in the shell kill other processes?</a></li>
<li title="Why do I get incorrect answers for floating-point operations?"><a href="problems.html#idm1157">Why do I get incorrect answers for floating-point operations?</a></li>
</ul>
</li>
<li id="no" title="Academic and Historical Questions" expanded="false">Academic and Historical Questions<ul>
<li><a href="academic.html">
              Top of chapter
            </a></li>
<li title=' Why is Erlang called "Erlang"?'><a href="academic.html#idm1175"> Why is Erlang called "Erlang"?</a></li>
<li title="Who invented Erlang?"><a href="academic.html#idm1178">Who invented Erlang?</a></li>
<li title="Where does Erlang syntax come from?"><a href="academic.html#idm1183">Where does Erlang syntax come from?</a></li>
<li title="Why is Ericsson giving away Erlang?"><a href="academic.html#idm1186">Why is Ericsson giving away Erlang?</a></li>
<li title="What does soft realtime mean?"><a href="academic.html#idm1197">What does soft realtime mean?</a></li>
<li title=" How did the first Erlang compiler get written?"><a href="academic.html#idm1211"> How did the first Erlang compiler get written?</a></li>
<li title=" Erlang Syntax and Semantics Details"><a href="academic.html#idm1225"> Erlang Syntax and Semantics Details</a></li>
<li title=" Is the order of message reception guaranteed?"><a href="academic.html#idm1229"> Is the order of message reception guaranteed?</a></li>
<li title="If I send a message, is it guaranteed to reach the receiver?
"><a href="academic.html#idm1234">If I send a message, is it guaranteed to reach the receiver?
</a></li>
<li title=" What limits does Erlang have?"><a href="academic.html#idm1276"> What limits does Erlang have?</a></li>
<li title="Do funs behave during a code change?"><a href="academic.html#idm1280">Do funs behave during a code change?</a></li>
<li title="Examples of bound funs causing surprises"><a href="academic.html#idm1288">Examples of bound funs causing surprises</a></li>
<li title="Is it just me, or are records ugly?"><a href="academic.html#idm1301">Is it just me, or are records ugly?</a></li>
<li title="Can a process receive messages with varying priorities?"><a href="academic.html#idm1312">Can a process receive messages with varying priorities?</a></li>
<li title="What's the history of static type checking in Erlang?"><a href="academic.html#idm1316">What's the history of static type checking in Erlang?</a></li>
<li title="How does type checking in Erlang compare to
Java/Python/C/C++/Haskell?"><a href="academic.html#idm1321">How does type checking in Erlang compare to
Java/Python/C/C++/Haskell?</a></li>
<li title="What's Erlang's relation to 'object oriented' programming?"><a href="academic.html#idm1328">What's Erlang's relation to 'object oriented' programming?</a></li>
<li title="How are strings implemented and how can I speed up my string code?"><a href="academic.html#idm1338">How are strings implemented and how can I speed up my string code?</a></li>
<li title=" How does the Garbage Collector (GC) work?"><a href="academic.html#idm1357"> How does the Garbage Collector (GC) work?</a></li>
<li title="Can I exploit knowledge about my program to make the GC more efficient?"><a href="academic.html#idm1362">Can I exploit knowledge about my program to make the GC more efficient?</a></li>
<li title="Could the Java Virtual Machine be used to run Erlang?"><a href="academic.html#idm1376">Could the Java Virtual Machine be used to run Erlang?</a></li>
<li title="Is it possible to prove the correctness of Erlang programs?
"><a href="academic.html#idm1381">Is it possible to prove the correctness of Erlang programs?
</a></li>
<li title="I've heard it's a bad idea to program defensively in Erlang. Why?"><a href="academic.html#idm1387">I've heard it's a bad idea to program defensively in Erlang. Why?</a></li>
</ul>
</li>
<li id="no" title="Mnesia Database Questions" expanded="false">Mnesia Database Questions<ul>
<li><a href="mnesia.html">
              Top of chapter
            </a></li>
<li title="What is Mnesia good at?"><a href="mnesia.html#idm1411">What is Mnesia good at?</a></li>
<li title="What is Mnesia not so good at?"><a href="mnesia.html#idm1425">What is Mnesia not so good at?</a></li>
<li title="Is Mnesia good for storing blobs?"><a href="mnesia.html#idm1429">Is Mnesia good for storing blobs?</a></li>
<li title="Is there an SQL interface for mnesia?"><a href="mnesia.html#idm1444">Is there an SQL interface for mnesia?</a></li>
<li title="How much data can be stored in Mnesia?"><a href="mnesia.html#idm1448">How much data can be stored in Mnesia?</a></li>
</ul>
</li>
</ul>
</div></div>
<div id="content">
<div class="innertube">
<h1>9 Troubleshooting, Problems and 'Gotchas'</h1>
  

<p>

	This section looks at problems which trip up many beginners,
	starting with some minor syntactic irritations. If you
	bump into something confusing which isn't listed here,
	try posting a question to the <span class="bold_code"><a href="obtaining.html#mailing-lists">
	mailing lists</a></span>.

</p>

<h3><a name="idm1004">9.1 
        Why can't I write a = 3 (badmatch)?</a></h3>
<p>

	In Erlang, all variables must start with a capital letter,
	so you can write <span class="code">A = 3.</span> but not
	<span class="code">a = 3.</span> In the latter case Erlang
	complains that this is a "bad match".
	</p>
<p>

	In the second version, the 'a' is an atom while 3 is a number.
	'a' cannot be <strong>pattern matched</strong> with 3. The use of
	capital letters for variables comes from Prolog.
	</p>
<p>

	If the terms <strong>atom</strong> and <strong>pattern match </strong> are new to you,
	have a read of the first chapter or two of the
        <span class="bold_code"><a href="http://www.erlang.org/doc.html"> Erlang book</a></span>.
	(<strong>Very</strong> roughly, an atom corresponds to
	an enum in C and pattern matching in this case is like an
	<span class="code">assert</span> statement.

</p>
<h3><a name="idm1017">9.2 
        Why can't I change the value of a variable?</a></h3>
<p>

	Erlang only lets you assign a variable once in a function.
	Some simple examples of when you bump into this are:

	</p>
	<div class="example"><pre>
		1&gt; A = 3.
		3
		2&gt; A = 4.
		** exited: {{badmatch,4},[{erl_eval,expr,3}]} **
		3&gt; A = A + 4.
		** exited: {{badmatch,7},[{erl_eval,expr,3}]} **
	</pre></div>
        <p>

	The usual "workaround" is to use a new variable:

	</p>
	<div class="example"><pre>
		4&gt; B = A + 4.
		7
	</pre></div>

        <p>
	(This behaviour is called "single assignment", and it's
	considered to be a feature, not a bug. Most functional
	languages, including ML and Haskell, also behave this way.
	Among other things, It's nice being able to rely on a
	certain variable always having the same value.)
        </p>


<h3><a name="idm1024">9.3 
        Why do lists of numbers get printed incorrectly?</a></h3>
<p>

	Sometimes the shell (or a program) prints a list of
	number in an unexpected way, for instance:

	</p>
	<div class="example"><pre>
	1&gt; [65, 66, 67].
	"ABC"
	</pre></div>

<p>
	This happens because Erlang represents strings as lists of
	integers, so if you ask the shell to print a list of
	integers, the shell takes a guess as to whether you want
	to see it as a list of numbers or as a string. The shell bases
	its guess on checking whether or not the list contains all
	printable characters, so you can force a string to be unprintable:

	</p>
	<div class="example"><pre>
	5&gt; [0, 65, 66, 67].
	[0,65,66,67]
	</pre></div>

<p>
	In Erlang/OTP R16B and above, you can use the function
	<span class="code">shell:strings/1</span> to turn off this behaviour in the shell:
	</p>
	<div class="example"><pre>
	2&gt; shell:strings(false).
	true
	3&gt; [65, 66, 67].
	[65,66,67]
	</pre></div>

<p>
	A similar problem occurs with <span class="code">io:fwrite()</span>,
	but in that case you can take direct control by specifying the
	appropriate formatting character. "~s" always prints the
	argument as a string, "~w" always prints it as a list.
</p>


<h3><a name="idm1035">9.4 
         Why can't I call arbitrary functions in a guard?</a></h3>
<p>

        If that was allowed, there would be no guarantee that guards
        were side-effect free.
        </p>
<p>

	Also, it is convenient to be able to program as though guards do not
	consume any significant amount of execution time. There's
	a list of BIFs which can be called from within guards in
	the Erlang book and the standard Erlang spec, some examples
	are <span class="code">size(), length(), integer(), record()</span>.
	</p>
<p>

	The "problem" often crops up when using <span class="code">if</span>:

	</p>
	<div class="example"><pre>
	issue_warning() -&gt;
	  if (os:type() == {win32, windows}) -&gt;    %% illegal guard
	    ok = io:fwrite("you are using windows\n");
	  true -&gt;
	    ok = io:fwrite("no problem\n")
	  end.
	</pre></div>

        <p>
        The solution is usually to use <span class="code">case</span>
	instead. Case is used much more frequently than
	<span class="code">if</span> in most Erlang programs:

	</p>
	<div class="example"><pre>
	issue_warning() -&gt;
          case os:type() of
            {win32, windows} -&gt; ok = io:fwrite("you are using windows\n");
            _ -&gt; ok = io:fwrite("no problem\n")
	  end.
	</pre></div>


<h3><a name="idm1047">9.5 
         Why can't I use "or" in a guard?</a></h3>
<p>

	You can. Since R6A, several guards separated with semicolons
	perform a logical 'or', for example:

	</p>
	<div class="example"><pre>
	f(N) when (N - 1) &gt; 3; atom(N) -&gt; yes;
	f(N) -&gt; no.
	</pre></div>

<p>
	will return <span class="code">yes</span> for
	<span class="code">f(5)</span> as well as
	<span class="code">f(blork)</span>. Similarly, the comma is
	used for logical and:

	</p>
	<div class="example"><pre>
	g(N) when integer(N), N &gt; 5 -&gt; yes;
	g(N) -&gt; no.
	</pre></div>

<p>
	Beware! The semicolon operator
	doesn't mean exactly the same thing as 'or', for instance
	<span class="code">f(hello)</span> returns <span class="code">yes </span>, whereas evaluating
	<span class="code">f(hello - 1) &gt; 3 or atom(hello)</span>
	returns a <span class="code">badarith</span> error.
	The first example, f(), is <strong>defined</strong>
	 as having the same effect as writing:

	</p>
	<div class="example"><pre>
	f(N) when (N - 1) &gt; 3 -&gt; yes;
	f(N) when atom(N) -&gt; yes;
	f(N) -&gt; no.
	</pre></div>


<h3><a name="idm1063">9.6 
         Why does 'catch' give me a syntax error?</a></h3>
<p>

	It seems natural enough to write
</p>

	<div class="example"><pre>
	2&gt; A = catch 1/0.
	** 2: syntax error before: 'catch' **
	</pre></div>

<p>
	But the parsing rules for Erlang are a bit unexpected here,
	catch binds less tightly than you might expect it to.
	To make it parse the way you really want:
</p>

	<div class="example"><pre>
	3&gt; A = (catch 1/0).
	{'EXIT',{badarith,[{erl_eval,eval_op,3},
                   {erl_eval,expr,3},
                   {erl_eval,exprs,4},
                   {shell,eval_loop,2}]}}
	</pre></div>


<h3><a name="idm1069">9.7 
         What is a sticky directory?</a></h3>
<p>

	This typically crops up when playing with examples from the
	old (last century) Erlang book, for instance:

</p>

	<div class="example"><pre>
        1&gt; c(sets.erl).
        {error,sticky_directory}
	</pre></div>

<p>
	The problem is that there already is a standard library module
	called 'sets'. The Erlang runtime system is protecting
	you.

	</p>
<p>

	The easiest solution is to rename your module, e.g. to
	<span class="code">mysets.erl</span>. It is also possible to
	'un-stick' the directory containing the library module.

</p>
<h3><a name="idm1076">9.8 
        Why won't my distributed Erlang nodes communicate?</a></h3>
<p>

	For Erlang nodes to be able to communicate, you need
</p>

	<ul>
	<li><p>A working tcp network between the nodes.
		On unix systems	you can check this by using telnet,
		though a working telnet doesn't guarantee that
		enough of your network is working, e.g. DNS problems
		throw a spanner in Erlang's distribution mechanisms.
</p></li>

	<li><p>The nodes to use the same node naming scheme
		(you cannot have a system where some nodes use fully
		qualified names and others use short names).
</p></li>

	<li><p>The nodes must agree to use the same
		"magic security cookie".
</p></li>
	</ul>

<p>
	Here's an example of how to create two nodes on different machines
	called <strong>martell</strong> and <strong>grolsch</strong>
	and verify that they're connected. On one machine:

	</p>
	<div class="example"><pre>
	~ &gt;rlogin martell
	Last login: Sat Feb 5 20:40:52 from super
	~ &gt;erl -sname first_node
	Eshell V4.9.1.1  (abort with ^G)
	(first_node@martell)1&gt; erlang:set_cookie(first_node, nocookie).
	true
	</pre></div>
<p>

	And on the other

	</p>
	<div class="example"><pre>
	~ &gt;rlogin grolsch
	Last login: Thu Feb 3 10:54:20 from :0
	~ &gt;erl -sname second_node
	Eshell V4.9.1.1  (abort with ^G)
	(second_node@grolsch)1&gt; erlang:set_cookie(second_node, nocookie).
	true
	(second_node@grolsch)2&gt; net:ping(first_node@martell).
	pong
	(second_node@grolsch)3&gt; rpc:call(first_node@martell, os, type, []).
	{unix,sunos}
	</pre></div>
<p>

	The <span class="code">pong</span> tells us that the
	connection works, the result
	of <span class="code">net:ping()</span> is <span class="code">pang </span> when the connection isn't working.
	The <span class="code">rpc:call()</span> command illustrates
	executing a command on the other node.
	</p>

	<div class="warning">
<div class="label">Warning</div>
<div class="content"><p>
	<p>Cookies are a password for Erlang nodes. The example above
	sets the password to "nocookie", which removes almost
	all security. Anyone on your network can use your Erlang node
	for anything, including deleting all of your files. </p>
	</p></div>
</div>


<h3><a name="idm1099">9.9 
        When distribution won't work</a></h3>

<p>
	One simple reason why distribution won't work is if you're
	combining different versions of Erlang.

	The OTP group's aim is to maintain backwards compatibility
	with the two previous major versions of Erlang/OTP, i.e. R13B
	works with all R13B minor releases as well as with R12B and
	R11B.  </p>
<p>

	Beyond that, you need to start digging. Erlang nodes communicate
	by connecting to the <span class="code">epmd</span> daemon.
	The daemon is started
	automatically the first time you start a distributed node. For
	debugging, it's useful to kill it by running <span class="code">epmd -kill
	</span>) and
	then restart it with the debugging flag. You can find
	<span class="code">epmd</span> in the same directory as the erlang binary:

	</p>
	<div class="example"><pre>
	~ &gt;/otp/releases/otp_beam_sunos5_r6b/erts-4.9.1/bin/epmd -d -d
	epmd: Sat Feb 5 21:04:39 2000: epmd running - daemon = 0
	epmd: Sat Feb 5 21:04:39 2000: try to initiate listening port 4369
	epmd: Sat Feb 5 21:04:39 2000: starting
	epmd: Sat Feb 5 21:04:39 2000: entering the main select() loop
	</pre></div>

<p>
	When you start a distributed node on the same system, you
	should see a message in the <span class="code">epmd</span> window:

	</p>
	<div class="example"><pre>
	epmd: Sat Feb 5 21:07:33 2000: registering 'first_node:1', port 53566
	</pre></div>

<p>
	Similarly, when you use <span class="code">net:ping</span> from a
	node on another
	system, you should see some messages go by. If nothing seems
	to be happening on <span class="code">epmd</span>,
	it's useful to scan for
	packets on the ethernet to see if the information is really
	getting out on the net. On unix systems you can do this with
	tcpdump:

	</p>
	<div class="example"><pre>
	# /usr/local/sbin/tcpdump port 4369
	tcpdump: listening on le0
	21:10:17.349286 grolsch.37558 &gt; martell.4369: S 747683789:747683789(0)
	</pre></div>


<h3><a name="idm1114">9.10 
        Avoiding DNS</a></h3>
<p>

	One fairly common obstacle to getting distribution to work is
	a broken DNS setup. One way to avoid that, or test for it, is
	to start distributed Erlang with IP addresses instead of hostnames,
	e.g. on one machine or window:
	</p>

        <div class="example"><pre>
        ~ &gt;erl -name first_node@127.0.0.1
        Erlang (BEAM) emulator version 5.5.5 [source] [64-bit]
        Eshell V5.5.5  (abort with ^G)
	(first_node@127.0.0.1)1&gt; erlang:set_cookie('second_node@127.0.0.1', nocookie).
	true
	(first_node@127.0.0.1)2&gt; net:ping('second_node@127.0.0.1').
	pong
        </pre></div>

	<p>
        and in the other:
	</p>

        <div class="example"><pre>
        ~ &gt;erl -name second_node@127.0.0.1
        Erlang (BEAM) emulator version 5.5.5 [source] [64-bit] [async-threads:0]
        Eshell V5.5.5  (abort with ^G)
        (second_node@127.0.0.1)1&gt; erlang:set_cookie('first_node@127.0.0.1', nocookie).
        </pre></div>


<h3><a name="idm1120">9.11 
        
Why does my application die every second time I load new code into it?
</a></h3>
<p>

	Erlang's code replacement system is based around there being
	(up to) two copies of the code loaded at any time, these
	are called "old" and "new". When you load new code, the
	current version becomes "old" and the "old" code is thrown
	away. Any processes still running "old" code are killed.
	</p>
<p>

	You can check if there is any old code for a particular
	module still running:

	</p>
	<div class="example"><pre>
	Eshell V4.9.1  (abort with ^G)
	1&gt; l(erl).
	{module,erl}
	2&gt; code:soft_purge(erl).
	false
	</pre></div>

<p>
	In this case old code is still running. You can also check
	if a particular process is running old code, by using
	<span class="code">erlang:check_process_code(Pid, Module)</span>.

</p>
<h3><a name="idm1127">9.12 
        Why can't I open devices (e.g. a serial port) like normal files?
</a></h3>
<p>

	Short answer: because the erlang runtime system was not
	designed to do that.

	The Erlang runtime system's internal file access system,
	efile, must avoid blocking, otherwise the whole Erlang
	system will block. This is not a good thing in a soft
	real-time system.

	When accessing regular files, it's generally a reasonable
	assumption that operations will not block. Devices, on the
	other hand, are quite likely to block. Some devices, such
	as serial ports, may block indefinitely.

        There are several possible ways to solve this. The Erlang
	runtime system could be altered, or an external port program
	could be used to access the device.

	Two mailing list discussions about the topic can be found
	<span class="bold_code"><a href="http://erlang.org/pipermail/erlang-questions/2004-January/011353.html">here</a></span> and
	<span class="bold_code"><a href="http://erlang.org/pipermail/erlang-questions/2000-March/001050.html">
here</a></span>.
	</p>


<h3><a name="idm1132">9.13 
        
Why doesn't the stack backtrace show the right functions for
this code:
</a></h3>
	<div class="example"><pre>
	-module(erl).
	-export([a/0]).

	a() -&gt; b().
	b() -&gt; c().
	c() -&gt; 3 = 4.           %% will cause badmatch
	</pre></div>

<p>

	The stack backtrace only shows function c(), rather
	than a(), b() and c(). This is because of last-call-optimisation;
	the compiler knows it does not need to generate a stack frame
	for a() or b() because the last thing it did was call another
	function, hence the stack frame does not appear in the stack backtrace.

</p>
<h3><a name="idm1136">9.14 
        What do I do if I get an error when compiling Open Source Erlang?
</a></h3>
<p>

	Consider using a binary release (Debian GNU/Linux includes them in the
	woody and potato releases, windows binaries are on the
	<span class="bold_code"><a href="http://www.erlang.org/download.html">
	download page </a></span>).

	</p>
<p>

	Ask for help on the mailing list, providing as many details
	as you can, including
</p>

	<ul>
	<li><p> your system details (OS, OS version, compiler version)
</p></li>
	<li><p> the error messages you get
</p></li>
	<li><p> any errors you got when you ran <span class="code">configure
	</span> </p></li>
	</ul>


<h3><a name="idm1149">9.15 
        Why do errors in the shell kill other processes?</a></h3>
<p>

	Because the other processes are linked to the shell process.

</p>
<p>

	Each time an error occurs in the erlang shell, the shell
        process exits and a new one is started:
</p>

	<div class="example"><pre>
	1&gt; self().
	&lt;0.23.0&gt;
	2&gt; x - y.
	** exited: {badarith,[{erl_eval,eval_op,3},
                      {erl_eval,exprs,4},
                      {shell,eval_loop,2}]} **
	3&gt; self().
	&lt;0.40.0&gt;
	</pre></div>

<p>
	Thus all processes linked to &lt;0.23.0&gt; will receive exit
	signals. Unless they trap exits, they will exit too. One
	way to avoid this is avoid linking "background" processes
	to shell processes, for instance by using <span class="code">spawn</span>
	instead of <span class="code">spawn_link</span>.
</p>



<h3><a name="idm1157">9.16 
        Why do I get incorrect answers for floating-point operations?</a></h3>

<p>
  Some floating point operations produce results which surprise some people.
  Here's an example:
</p>

<div class="example"><pre>
  5&gt; 1.001 * 1000.
  1000.9999999999999
</pre></div>

<p>
  This is not an error, it is a property of floating point arithmetic
  and it is not specific to Erlang. Any language which uses floating point
  arithmetic behaves this way.
</p>

<p>
  <span class="bold_code"><a href="http://floating-point-gui.de/">http://floating-point-gui.de/</a></span>
  is a relaxed introduction to the topic. <span class="bold_code"><a href="http://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html">What
  Every Computer Scientist Should Know About Floating-Point
  Arithmetic</a></span> goes into more depth.
</p>

<p>
  Erlang's output formatting lets you specify the precision, for
  instance:
</p>

<div class="example"><pre>
  1&gt; io:fwrite("~.3f\n", [1.001 * 1000]).
  1001.000
</pre></div>



</div>
<div class="footer">
<hr>
<p><br></p>
</div>
</div>
</div></body>
</html>
